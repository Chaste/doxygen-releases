<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Chaste: PetscMatTools Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.2 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="classes.html"><span>Class&nbsp;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>PetscMatTools Class Reference</h1><!-- doxytag: class="PetscMatTools" -->
<p><code>#include &lt;<a class="el" href="PetscMatTools_8hpp_source.html">PetscMatTools.hpp</a>&gt;</code></p>

<p><a href="classPetscMatTools-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#ad2991678b6341cb488fcf53bca9c7af1">SetElement</a> (<a class="el" href="classMat.html">Mat</a> matrix, <a class="el" href="classPetscInt.html">PetscInt</a> row, <a class="el" href="classPetscInt.html">PetscInt</a> col, <a class="el" href="classdouble.html">double</a> value)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#a07f631eba92647e0f96eb9c007668b89">AddToElement</a> (<a class="el" href="classMat.html">Mat</a> matrix, <a class="el" href="classPetscInt.html">PetscInt</a> row, <a class="el" href="classPetscInt.html">PetscInt</a> col, <a class="el" href="classdouble.html">double</a> value)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#aa9717ce944536cda4afaac557aba7254">Finalise</a> (<a class="el" href="classMat.html">Mat</a> matrix)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#a81ec00917b30dcf7da65791a05eb35ee">SwitchWriteMode</a> (<a class="el" href="classMat.html">Mat</a> matrix)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#ad78e39050573affee9679e2b5b2807fd">Display</a> (<a class="el" href="classMat.html">Mat</a> matrix)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#a4653d233e1382cf612d0cef06f43e630">SetRow</a> (<a class="el" href="classMat.html">Mat</a> matrix, <a class="el" href="classPetscInt.html">PetscInt</a> row, <a class="el" href="classdouble.html">double</a> value)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#a5a68cf8b1e9a1630f54a60feb03084b9">ZeroRowsWithValueOnDiagonal</a> (<a class="el" href="classMat.html">Mat</a> matrix, std::vector&lt; <a class="el" href="classunsigned.html">unsigned</a> &gt; &amp;rRows, <a class="el" href="classdouble.html">double</a> diagonalValue)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#a742a2bec669f75b1067b282ce6cf3b11">ZeroRowsAndColumnsWithValueOnDiagonal</a> (<a class="el" href="classMat.html">Mat</a> matrix, std::vector&lt; <a class="el" href="classunsigned.html">unsigned</a> &gt; rowColIndices, <a class="el" href="classdouble.html">double</a> diagonalValue)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#ac790257be5a8cc501376fef953a76cee">ZeroColumn</a> (<a class="el" href="classMat.html">Mat</a> matrix, <a class="el" href="classPetscInt.html">PetscInt</a> col)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#a18737a2adfa34aa5d7c9bec630c8a688">Zero</a> (<a class="el" href="classMat.html">Mat</a> matrix)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classunsigned.html">unsigned</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#a871794b7b4edc05a98810c83a6e59f05">GetSize</a> (<a class="el" href="classMat.html">Mat</a> matrix)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#a7a9a78b5ccdd2ac99a9e46f09de9e04e">GetOwnershipRange</a> (<a class="el" href="classMat.html">Mat</a> matrix, <a class="el" href="classPetscInt.html">PetscInt</a> &amp;lo, <a class="el" href="classPetscInt.html">PetscInt</a> &amp;hi)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classdouble.html">double</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#a04bf4f209ef30a6118bba7c90279844a">GetElement</a> (<a class="el" href="classMat.html">Mat</a> matrix, <a class="el" href="classPetscInt.html">PetscInt</a> row, <a class="el" href="classPetscInt.html">PetscInt</a> col)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#a5aa09bdaed7d4372cab33f898c593399">SetOption</a> (<a class="el" href="classMat.html">Mat</a> matrix, MatOption option)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classVec.html">Vec</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#a8a201396f082f8e0cb5b27cc4694f8d8">GetMatrixRowDistributed</a> (<a class="el" href="classMat.html">Mat</a> matrix, <a class="el" href="classunsigned.html">unsigned</a> rowIndex)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classbool.html">bool</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#ad5c7e184836edcfcacdf6f2af9bfb48a">CheckEquality</a> (const <a class="el" href="classMat.html">Mat</a> mat1, const <a class="el" href="classMat.html">Mat</a> mat2, <a class="el" href="classdouble.html">double</a> tol=1e-10)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classbool.html">bool</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#a6ae709c830c74b78f9c6ec0c1e6ad49a">CheckSymmetry</a> (const <a class="el" href="classMat.html">Mat</a> matrix, <a class="el" href="classdouble.html">double</a> tol=1e-10)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#ae34f801127811d479e384e725514c9bb">TurnOffVariableAllocationError</a> (<a class="el" href="classMat.html">Mat</a> matrix)</td></tr>
<tr><td class="memTemplParams" colspan="2">template&lt;size_t MATRIX_SIZE&gt; </td></tr>
<tr><td class="memTemplItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#ac2876ae775b40c4188e483c42aaf6017">AddMultipleValues</a> (<a class="el" href="classMat.html">Mat</a> matrix, <a class="el" href="classunsigned.html">unsigned</a> *matrixRowAndColIndices, c_matrix&lt; <a class="el" href="classdouble.html">double</a>, MATRIX_SIZE, MATRIX_SIZE &gt; &amp;rSmallMatrix)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>A collection of static methods for working with PETSc matrices. </p>

<p>Definition at line <a class="el" href="PetscMatTools_8hpp_source.html#l00048">48</a> of file <a class="el" href="PetscMatTools_8hpp_source.html">PetscMatTools.hpp</a>.</p>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="ac2876ae775b40c4188e483c42aaf6017"></a><!-- doxytag: member="PetscMatTools::AddMultipleValues" ref="ac2876ae775b40c4188e483c42aaf6017" args="(Mat matrix, unsigned *matrixRowAndColIndices, c_matrix&lt; double, MATRIX_SIZE, MATRIX_SIZE &gt; &amp;rSmallMatrix)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;size_t MATRIX_SIZE&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">static void PetscMatTools::AddMultipleValues </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&nbsp;</td>
          <td class="paramname"> <em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classunsigned.html">unsigned</a> *&nbsp;</td>
          <td class="paramname"> <em>matrixRowAndColIndices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">c_matrix&lt; <a class="el" href="classdouble.html">double</a>, MATRIX_SIZE, MATRIX_SIZE &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>rSmallMatrix</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Add multiple values to a matrix.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>matrix</em>&nbsp;</td><td>the matrix </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>matrixRowAndColIndices</em>&nbsp;</td><td>mapping from index of the ublas matrix (see param below) to index of the PETSc matrix of this linear system </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rSmallMatrix</em>&nbsp;</td><td>Ublas matrix containing the values to be added</td></tr>
  </table>
  </dd>
</dl>
<p>N.B. Values which are not local (ie the row is not owned) will be skipped. </p>

<p>Definition at line <a class="el" href="PetscMatTools_8hpp_source.html#l00237">237</a> of file <a class="el" href="PetscMatTools_8hpp_source.html">PetscMatTools.hpp</a>.</p>

<p>References <a class="el" href="PetscMatTools_8cpp_source.html#l00298">GetOwnershipRange()</a>.</p>

<p>Referenced by <a class="el" href="LinearSystem_8hpp_source.html#l00540">LinearSystem::AddLhsMultipleValues()</a>.</p>

</div>
</div>
<a class="anchor" id="a07f631eba92647e0f96eb9c007668b89"></a><!-- doxytag: member="PetscMatTools::AddToElement" ref="a07f631eba92647e0f96eb9c007668b89" args="(Mat matrix, PetscInt row, PetscInt col, double value)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::AddToElement </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&nbsp;</td>
          <td class="paramname"> <em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPetscInt.html">PetscInt</a>&nbsp;</td>
          <td class="paramname"> <em>row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPetscInt.html">PetscInt</a>&nbsp;</td>
          <td class="paramname"> <em>col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdouble.html">double</a>&nbsp;</td>
          <td class="paramname"> <em>value</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Add the specified value to an entry of a matrix.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>matrix</em>&nbsp;</td><td>the matrix </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>row</em>&nbsp;</td><td>the row index </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>col</em>&nbsp;</td><td>the column index </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td>the value for this entry </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00056">56</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p>References <a class="el" href="PetscMatTools_8cpp_source.html#l00298">GetOwnershipRange()</a>.</p>

<p>Referenced by <a class="el" href="LinearSystem_8cpp_source.html#l00311">LinearSystem::AddToMatrixElement()</a>, and <a class="el" href="NodeBasedCellPopulationWithBuskeUpdate_8cpp_source.html#l00057">NodeBasedCellPopulationWithBuskeUpdate&lt; DIM &gt;::UpdateNodeLocations()</a>.</p>

</div>
</div>
<a class="anchor" id="ad5c7e184836edcfcacdf6f2af9bfb48a"></a><!-- doxytag: member="PetscMatTools::CheckEquality" ref="ad5c7e184836edcfcacdf6f2af9bfb48a" args="(const Mat mat1, const Mat mat2, double tol=1e&#45;10)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> PetscMatTools::CheckEquality </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMat.html">Mat</a>&nbsp;</td>
          <td class="paramname"> <em>mat1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMat.html">Mat</a>&nbsp;</td>
          <td class="paramname"> <em>mat2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdouble.html">double</a>&nbsp;</td>
          <td class="paramname"> <em>tol</em> = <code>1e-10</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="return"><dt><b>Returns:</b></dt><dd>true if two matrices are equal to within a given tolerance.</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>mat1</em>&nbsp;</td><td>the first matrix </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>mat2</em>&nbsp;</td><td>the second matrix </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>tol</em>&nbsp;</td><td>the tolerance </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00371">371</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p>References <a class="el" href="PetscTools_8hpp_source.html#l00349">PetscTools::Destroy()</a>.</p>

<p>Referenced by <a class="el" href="PetscMatTools_8cpp_source.html#l00394">CheckSymmetry()</a>, and <a class="el" href="AbstractNonlinearAssemblerSolverHybrid_8hpp_source.html#l00416">AbstractNonlinearAssemblerSolverHybrid&lt; ELEMENT_DIM, SPACE_DIM, PROBLEM_DIM &gt;::VerifyJacobian()</a>.</p>

</div>
</div>
<a class="anchor" id="a6ae709c830c74b78f9c6ec0c1e6ad49a"></a><!-- doxytag: member="PetscMatTools::CheckSymmetry" ref="a6ae709c830c74b78f9c6ec0c1e6ad49a" args="(const Mat matrix, double tol=1e&#45;10)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> PetscMatTools::CheckSymmetry </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMat.html">Mat</a>&nbsp;</td>
          <td class="paramname"> <em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdouble.html">double</a>&nbsp;</td>
          <td class="paramname"> <em>tol</em> = <code>1e-10</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="return"><dt><b>Returns:</b></dt><dd>true if the matrix is symmetric Check whether a matrix is symmetric, to within a given tolerance, by checking if it is (approximately) equal to its transpose.</dd></dl>
<p>Note that while there is a PETSc method MatIsSymmetric, it won't work in parallel on some PETSc versions: "Matrix of type &lt;mpiaij&gt; does not support checking for symmetric!"</p>
<p>Also checking for exact equality of the transpose can break on 32bit systems.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>matrix</em>&nbsp;</td><td>the matrix to check </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>tol</em>&nbsp;</td><td>the tolerance </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00394">394</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p>References <a class="el" href="PetscMatTools_8cpp_source.html#l00371">CheckEquality()</a>, and <a class="el" href="PetscTools_8hpp_source.html#l00349">PetscTools::Destroy()</a>.</p>

</div>
</div>
<a class="anchor" id="ad78e39050573affee9679e2b5b2807fd"></a><!-- doxytag: member="PetscMatTools::Display" ref="ad78e39050573affee9679e2b5b2807fd" args="(Mat matrix)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::Display </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&nbsp;</td>
          <td class="paramname"> <em>matrix</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Display a matrix.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>matrix</em>&nbsp;</td><td>the matrix </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00079">79</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p>Referenced by <a class="el" href="LinearSystem_8cpp_source.html#l00358">LinearSystem::DisplayMatrix()</a>.</p>

</div>
</div>
<a class="anchor" id="aa9717ce944536cda4afaac557aba7254"></a><!-- doxytag: member="PetscMatTools::Finalise" ref="aa9717ce944536cda4afaac557aba7254" args="(Mat matrix)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::Finalise </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&nbsp;</td>
          <td class="paramname"> <em>matrix</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Sets up the matrix ready for use, e.g. in solving a linear system. This is a wrapper to PETSc functions like MatAssemblyBegin(matrix, MAT_FINAL_ASSEMBLY). </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>matrix</em>&nbsp;</td><td>the matrix </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00067">67</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p>Referenced by <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00679">AbstractContinuumMechanicsSolver&lt; DIM &gt;::ApplyDirichletBoundaryConditions()</a>, <a class="el" href="BoundaryConditionsContainerImplementation_8hpp_source.html#l00530">BoundaryConditionsContainer&lt; ELEMENT_DIM, SPACE_DIM, PROBLEM_DIM &gt;::ApplyDirichletToNonlinearJacobian()</a>, <a class="el" href="StokesFlowSolver_8hpp_source.html#l00283">StokesFlowSolver&lt; DIM &gt;::AssembleSystem()</a>, <a class="el" href="AbstractNonlinearAssemblerSolverHybrid_8hpp_source.html#l00294">AbstractNonlinearAssemblerSolverHybrid&lt; ELEMENT_DIM, SPACE_DIM, PROBLEM_DIM &gt;::ComputeJacobian()</a>, <a class="el" href="AbstractNonlinearAssemblerSolverHybrid_8hpp_source.html#l00315">AbstractNonlinearAssemblerSolverHybrid&lt; ELEMENT_DIM, SPACE_DIM, PROBLEM_DIM &gt;::ComputeJacobianNumerically()</a>, <a class="el" href="LinearSystem_8cpp_source.html#l00328">LinearSystem::FinaliseLhsMatrix()</a>, <a class="el" href="LinearSystem_8cpp_source.html#l00338">LinearSystem::FinalisePrecondMatrix()</a>, <a class="el" href="AbstractNonlinearElasticitySolver_8hpp_source.html#l00832">AbstractNonlinearElasticitySolver&lt; DIM &gt;::FinishAssembleSystem()</a>, <a class="el" href="NodePartitioner_8cpp_source.html#l00236">NodePartitioner&lt; ELEMENT_DIM, SPACE_DIM &gt;::PetscMatrixPartitioning()</a>, <a class="el" href="VentilationProblem_8cpp_source.html#l00162">VentilationProblem::SetupIterativeSolver()</a>, <a class="el" href="OperatorSplittingMonodomainSolver_8cpp_source.html#l00040">OperatorSplittingMonodomainSolver&lt; ELEMENT_DIM, SPACE_DIM &gt;::SetupLinearSystem()</a>, <a class="el" href="MonodomainSolver_8cpp_source.html#l00042">MonodomainSolver&lt; ELEMENT_DIM, SPACE_DIM &gt;::SetupLinearSystem()</a>, <a class="el" href="ExtendedBidomainSolver_8cpp_source.html#l00065">ExtendedBidomainSolver&lt; ELEM_DIM, SPACE_DIM &gt;::SetupLinearSystem()</a>, <a class="el" href="BidomainSolver_8cpp_source.html#l00066">BidomainSolver&lt; ELEMENT_DIM, SPACE_DIM &gt;::SetupLinearSystem()</a>, <a class="el" href="NodeBasedCellPopulationWithBuskeUpdate_8cpp_source.html#l00057">NodeBasedCellPopulationWithBuskeUpdate&lt; DIM &gt;::UpdateNodeLocations()</a>, <a class="el" href="PetscMatTools_8cpp_source.html#l00248">ZeroColumn()</a>, <a class="el" href="PetscMatTools_8cpp_source.html#l00184">ZeroRowsAndColumnsWithValueOnDiagonal()</a>, and <a class="el" href="PetscMatTools_8cpp_source.html#l00102">ZeroRowsWithValueOnDiagonal()</a>.</p>

</div>
</div>
<a class="anchor" id="a04bf4f209ef30a6118bba7c90279844a"></a><!-- doxytag: member="PetscMatTools::GetElement" ref="a04bf4f209ef30a6118bba7c90279844a" args="(Mat matrix, PetscInt row, PetscInt col)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classdouble.html">double</a> PetscMatTools::GetElement </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&nbsp;</td>
          <td class="paramname"> <em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPetscInt.html">PetscInt</a>&nbsp;</td>
          <td class="paramname"> <em>row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPetscInt.html">PetscInt</a>&nbsp;</td>
          <td class="paramname"> <em>col</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="return"><dt><b>Returns:</b></dt><dd>an element of a matrix. May only be called for elements you own.</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>matrix</em>&nbsp;</td><td>the matrix </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>row</em>&nbsp;</td><td>the row index </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>col</em>&nbsp;</td><td>the column index </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00303">303</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p>References <a class="el" href="PetscMatTools_8cpp_source.html#l00298">GetOwnershipRange()</a>.</p>

<p>Referenced by <a class="el" href="LinearSystem_8cpp_source.html#l00474">LinearSystem::GetMatrixElement()</a>, and <a class="el" href="PetscMatTools_8cpp_source.html#l00248">ZeroColumn()</a>.</p>

</div>
</div>
<a class="anchor" id="a8a201396f082f8e0cb5b27cc4694f8d8"></a><!-- doxytag: member="PetscMatTools::GetMatrixRowDistributed" ref="a8a201396f082f8e0cb5b27cc4694f8d8" args="(Mat matrix, unsigned rowIndex)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classVec.html">Vec</a> PetscMatTools::GetMatrixRowDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&nbsp;</td>
          <td class="paramname"> <em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classunsigned.html">unsigned</a>&nbsp;</td>
          <td class="paramname"> <em>rowIndex</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Returns the i-th row of the LHS matrix as a distributed PETSc Vec</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>matrix</em>&nbsp;</td><td>the matrix </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rowIndex</em>&nbsp;</td><td>the row index </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>rowIndex-th row of the matrix in distributed format </dd></dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00330">330</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p>References <a class="el" href="PetscTools_8cpp_source.html#l00203">PetscTools::CreateVec()</a>, <a class="el" href="PetscMatTools_8cpp_source.html#l00298">GetOwnershipRange()</a>, and <a class="el" href="PetscMatTools_8cpp_source.html#l00289">GetSize()</a>.</p>

<p>Referenced by <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00679">AbstractContinuumMechanicsSolver&lt; DIM &gt;::ApplyDirichletBoundaryConditions()</a>.</p>

</div>
</div>
<a class="anchor" id="a7a9a78b5ccdd2ac99a9e46f09de9e04e"></a><!-- doxytag: member="PetscMatTools::GetOwnershipRange" ref="a7a9a78b5ccdd2ac99a9e46f09de9e04e" args="(Mat matrix, PetscInt &amp;lo, PetscInt &amp;hi)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::GetOwnershipRange </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&nbsp;</td>
          <td class="paramname"> <em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPetscInt.html">PetscInt</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>lo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPetscInt.html">PetscInt</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>hi</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="return"><dt><b>Returns:</b></dt><dd>this process's ownership range of the contents of the system.</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>matrix</em>&nbsp;</td><td>the matrix </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>lo</em>&nbsp;</td><td>lowest index owned by this process </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>hi</em>&nbsp;</td><td>highest index owned by this process </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00298">298</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p>Referenced by <a class="el" href="PetscMatTools_8hpp_source.html#l00237">AddMultipleValues()</a>, <a class="el" href="PetscMatTools_8cpp_source.html#l00056">AddToElement()</a>, <a class="el" href="PetscMatTools_8cpp_source.html#l00303">GetElement()</a>, <a class="el" href="PetscMatTools_8cpp_source.html#l00330">GetMatrixRowDistributed()</a>, <a class="el" href="PetscMatTools_8cpp_source.html#l00045">SetElement()</a>, <a class="el" href="PetscMatTools_8cpp_source.html#l00086">SetRow()</a>, <a class="el" href="PetscMatTools_8cpp_source.html#l00248">ZeroColumn()</a>, and <a class="el" href="PetscMatTools_8cpp_source.html#l00184">ZeroRowsAndColumnsWithValueOnDiagonal()</a>.</p>

</div>
</div>
<a class="anchor" id="a871794b7b4edc05a98810c83a6e59f05"></a><!-- doxytag: member="PetscMatTools::GetSize" ref="a871794b7b4edc05a98810c83a6e59f05" args="(Mat matrix)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classunsigned.html">unsigned</a> PetscMatTools::GetSize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&nbsp;</td>
          <td class="paramname"> <em>matrix</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="return"><dt><b>Returns:</b></dt><dd>the size of a matrix </dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>matrix</em>&nbsp;</td><td>the matrix </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00289">289</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p>Referenced by <a class="el" href="AbstractContinuumMechanicsAssembler_8hpp_source.html#l00351">AbstractContinuumMechanicsAssembler&lt; DIM, CAN_ASSEMBLE_VECTOR, CAN_ASSEMBLE_MATRIX &gt;::DoAssemble()</a>, and <a class="el" href="PetscMatTools_8cpp_source.html#l00330">GetMatrixRowDistributed()</a>.</p>

</div>
</div>
<a class="anchor" id="ad2991678b6341cb488fcf53bca9c7af1"></a><!-- doxytag: member="PetscMatTools::SetElement" ref="ad2991678b6341cb488fcf53bca9c7af1" args="(Mat matrix, PetscInt row, PetscInt col, double value)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::SetElement </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&nbsp;</td>
          <td class="paramname"> <em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPetscInt.html">PetscInt</a>&nbsp;</td>
          <td class="paramname"> <em>row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPetscInt.html">PetscInt</a>&nbsp;</td>
          <td class="paramname"> <em>col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdouble.html">double</a>&nbsp;</td>
          <td class="paramname"> <em>value</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Change one of the entries of a matrix to the specified value.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>matrix</em>&nbsp;</td><td>the matrix </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>row</em>&nbsp;</td><td>the row index </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>col</em>&nbsp;</td><td>the column index </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td>the value for this entry </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00045">45</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p>References <a class="el" href="PetscMatTools_8cpp_source.html#l00298">GetOwnershipRange()</a>.</p>

<p>Referenced by <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00804">AbstractContinuumMechanicsSolver&lt; DIM &gt;::AddIdentityBlockForDummyPressureVariables()</a>, <a class="el" href="BoundaryConditionsContainerImplementation_8hpp_source.html#l00426">BoundaryConditionsContainer&lt; ELEMENT_DIM, SPACE_DIM, PROBLEM_DIM &gt;::ApplyPeriodicBcsToLinearProblem()</a>, <a class="el" href="AbstractNonlinearAssemblerSolverHybrid_8hpp_source.html#l00315">AbstractNonlinearAssemblerSolverHybrid&lt; ELEMENT_DIM, SPACE_DIM, PROBLEM_DIM &gt;::ComputeJacobianNumerically()</a>, <a class="el" href="AbstractBidomainSolver_8cpp_source.html#l00335">AbstractBidomainSolver&lt; ELEMENT_DIM, SPACE_DIM &gt;::FinaliseForBath()</a>, <a class="el" href="LinearSystem_8cpp_source.html#l00306">LinearSystem::SetMatrixElement()</a>, and <a class="el" href="PetscMatTools_8cpp_source.html#l00086">SetRow()</a>.</p>

</div>
</div>
<a class="anchor" id="a5aa09bdaed7d4372cab33f898c593399"></a><!-- doxytag: member="PetscMatTools::SetOption" ref="a5aa09bdaed7d4372cab33f898c593399" args="(Mat matrix, MatOption option)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::SetOption </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&nbsp;</td>
          <td class="paramname"> <em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MatOption&nbsp;</td>
          <td class="paramname"> <em>option</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Set a PETSc matrix option to be true, using the PETSc method MatSetOption.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>matrix</em>&nbsp;</td><td>the matrix for which to set the option </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>option</em>&nbsp;</td><td>the option to set </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00321">321</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p>Referenced by <a class="el" href="LinearSystem_8cpp_source.html#l00529">LinearSystem::SetMatrixIsSymmetric()</a>, and <a class="el" href="VentilationProblem_8cpp_source.html#l00162">VentilationProblem::SetupIterativeSolver()</a>.</p>

</div>
</div>
<a class="anchor" id="a4653d233e1382cf612d0cef06f43e630"></a><!-- doxytag: member="PetscMatTools::SetRow" ref="a4653d233e1382cf612d0cef06f43e630" args="(Mat matrix, PetscInt row, double value)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::SetRow </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&nbsp;</td>
          <td class="paramname"> <em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPetscInt.html">PetscInt</a>&nbsp;</td>
          <td class="paramname"> <em>row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdouble.html">double</a>&nbsp;</td>
          <td class="paramname"> <em>value</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Set all entries in a given row of a matrix to a certain value. This must be called by the process who owns the row, (but other processors will treat it as a null-op</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>matrix</em>&nbsp;</td><td>the matrix </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>row</em>&nbsp;</td><td>the row index </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td>the value to set each entry in this row </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00086">86</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p>References <a class="el" href="PetscMatTools_8cpp_source.html#l00298">GetOwnershipRange()</a>, and <a class="el" href="PetscMatTools_8cpp_source.html#l00045">SetElement()</a>.</p>

<p>Referenced by <a class="el" href="LinearSystem_8cpp_source.html#l00368">LinearSystem::SetMatrixRow()</a>.</p>

</div>
</div>
<a class="anchor" id="a81ec00917b30dcf7da65791a05eb35ee"></a><!-- doxytag: member="PetscMatTools::SwitchWriteMode" ref="a81ec00917b30dcf7da65791a05eb35ee" args="(Mat matrix)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::SwitchWriteMode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&nbsp;</td>
          <td class="paramname"> <em>matrix</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This must be called if switching between inserting or adding values to the matrix, to ensure all processes are in sync. This is a wrapper to PETSc functions like MatAssemblyBegin(matrix, MAT_FLUSH_ASSEMBLY). </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>matrix</em>&nbsp;</td><td>the matrix </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00073">73</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p>Referenced by <a class="el" href="StokesFlowSolver_8hpp_source.html#l00283">StokesFlowSolver&lt; DIM &gt;::AssembleSystem()</a>, <a class="el" href="IncompressibleNonlinearElasticitySolver_8cpp_source.html#l00052">IncompressibleNonlinearElasticitySolver&lt; DIM &gt;::AssembleSystem()</a>, <a class="el" href="AbstractNonlinearAssemblerSolverHybrid_8hpp_source.html#l00294">AbstractNonlinearAssemblerSolverHybrid&lt; ELEMENT_DIM, SPACE_DIM, PROBLEM_DIM &gt;::ComputeJacobian()</a>, <a class="el" href="AbstractNonlinearElasticitySolver_8hpp_source.html#l00832">AbstractNonlinearElasticitySolver&lt; DIM &gt;::FinishAssembleSystem()</a>, and <a class="el" href="LinearSystem_8cpp_source.html#l00333">LinearSystem::SwitchWriteModeLhsMatrix()</a>.</p>

</div>
</div>
<a class="anchor" id="ae34f801127811d479e384e725514c9bb"></a><!-- doxytag: member="PetscMatTools::TurnOffVariableAllocationError" ref="ae34f801127811d479e384e725514c9bb" args="(Mat matrix)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::TurnOffVariableAllocationError </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&nbsp;</td>
          <td class="paramname"> <em>matrix</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Tells PETSc to set MAT_NEW_NONZERO_ALLOCATION_ERR to false.</p>
<p>This should be called immediately after <a class="el" href="classPetscTools.html#ad6d7a60499c5a6bd9c64eb35fffd3b06">PetscTools::SetupMat</a> and before any other operations on the matrix.</p>
<p>** Currently only used in PETSc 3.3 and later ** in PETSc 3.2 and earlier MAT_NEW_NONZERO_ALLOCATION_ERR defaults to false in PETSc 3.3 MAT_NEW_NONZERO_ALLOCATION_ERR defaults to true</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>matrix</em>&nbsp;</td><td>The matrix to set </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00407">407</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p>Referenced by <a class="el" href="AbstractExtendedBidomainSolver_8cpp_source.html#l00039">AbstractExtendedBidomainSolver&lt; ELEMENT_DIM, SPACE_DIM &gt;::InitialiseForSolve()</a>, and <a class="el" href="AbstractBidomainSolver_8cpp_source.html#l00043">AbstractBidomainSolver&lt; ELEMENT_DIM, SPACE_DIM &gt;::InitialiseForSolve()</a>.</p>

</div>
</div>
<a class="anchor" id="a18737a2adfa34aa5d7c9bec630c8a688"></a><!-- doxytag: member="PetscMatTools::Zero" ref="a18737a2adfa34aa5d7c9bec630c8a688" args="(Mat matrix)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::Zero </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&nbsp;</td>
          <td class="paramname"> <em>matrix</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Zero all entries of a matrix. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>matrix</em>&nbsp;</td><td>the matrix </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00284">284</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p>Referenced by <a class="el" href="IncompressibleNonlinearElasticitySolver_8cpp_source.html#l00052">IncompressibleNonlinearElasticitySolver&lt; DIM &gt;::AssembleSystem()</a>, <a class="el" href="CompressibleNonlinearElasticitySolver_8cpp_source.html#l00054">CompressibleNonlinearElasticitySolver&lt; DIM &gt;::AssembleSystem()</a>, <a class="el" href="AbstractFeVolumeIntegralAssembler_8hpp_source.html#l00255">AbstractFeVolumeIntegralAssembler&lt; ELEMENT_DIM, SPACE_DIM, PROBLEM_DIM, CAN_ASSEMBLE_VECTOR, CAN_ASSEMBLE_MATRIX, INTERPOLATION_LEVEL &gt;::DoAssemble()</a>, <a class="el" href="AbstractFeCableIntegralAssembler_8hpp_source.html#l00235">AbstractFeCableIntegralAssembler&lt; ELEMENT_DIM, SPACE_DIM, PROBLEM_DIM, CAN_ASSEMBLE_VECTOR, CAN_ASSEMBLE_MATRIX, INTERPOLATION_LEVEL &gt;::DoAssemble()</a>, <a class="el" href="AbstractContinuumMechanicsAssembler_8hpp_source.html#l00351">AbstractContinuumMechanicsAssembler&lt; DIM, CAN_ASSEMBLE_VECTOR, CAN_ASSEMBLE_MATRIX &gt;::DoAssemble()</a>, and <a class="el" href="LinearSystem_8cpp_source.html#l00398">LinearSystem::ZeroLhsMatrix()</a>.</p>

</div>
</div>
<a class="anchor" id="ac790257be5a8cc501376fef953a76cee"></a><!-- doxytag: member="PetscMatTools::ZeroColumn" ref="ac790257be5a8cc501376fef953a76cee" args="(Mat matrix, PetscInt col)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::ZeroColumn </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&nbsp;</td>
          <td class="paramname"> <em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPetscInt.html">PetscInt</a>&nbsp;</td>
          <td class="paramname"> <em>col</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Zero a column of a matrix.</p>
<p>Unfortunately there is no equivalent method in Petsc, so this has to be done carefully to ensure that the sparsity structure of the matrix is not broken. Only owned entries which are non-zero are zeroed.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>matrix</em>&nbsp;</td><td>the matrix </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>col</em>&nbsp;</td><td>the column index </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00248">248</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p>References <a class="el" href="PetscMatTools_8cpp_source.html#l00067">Finalise()</a>, <a class="el" href="PetscMatTools_8cpp_source.html#l00303">GetElement()</a>, and <a class="el" href="PetscMatTools_8cpp_source.html#l00298">GetOwnershipRange()</a>.</p>

<p>Referenced by <a class="el" href="LinearSystem_8cpp_source.html#l00388">LinearSystem::ZeroMatrixColumn()</a>.</p>

</div>
</div>
<a class="anchor" id="a742a2bec669f75b1067b282ce6cf3b11"></a><!-- doxytag: member="PetscMatTools::ZeroRowsAndColumnsWithValueOnDiagonal" ref="a742a2bec669f75b1067b282ce6cf3b11" args="(Mat matrix, std::vector&lt; unsigned &gt; rowColIndices, double diagonalValue)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::ZeroRowsAndColumnsWithValueOnDiagonal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&nbsp;</td>
          <td class="paramname"> <em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classunsigned.html">unsigned</a> &gt;&nbsp;</td>
          <td class="paramname"> <em>rowColIndices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdouble.html">double</a>&nbsp;</td>
          <td class="paramname"> <em>diagonalValue</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Zero several rows and columns of a matrix, putting a given value on the diagonal.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>matrix</em>&nbsp;</td><td>the matrix </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rowColIndices</em>&nbsp;</td><td>A list of indices. All the rows with these indices, and all the columns with these indices, will be zeroed. This vector is copied (ie not passed in by reference), as it will be sorted into ascending order </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>diagonalValue</em>&nbsp;</td><td>value to put in the diagonal entries (of the zeroed rows) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00184">184</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p>References <a class="el" href="PetscMatTools_8cpp_source.html#l00067">Finalise()</a>, <a class="el" href="PetscMatTools_8cpp_source.html#l00298">GetOwnershipRange()</a>, and <a class="el" href="PetscMatTools_8cpp_source.html#l00102">ZeroRowsWithValueOnDiagonal()</a>.</p>

<p>Referenced by <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00679">AbstractContinuumMechanicsSolver&lt; DIM &gt;::ApplyDirichletBoundaryConditions()</a>, and <a class="el" href="LinearSystem_8cpp_source.html#l00383">LinearSystem::ZeroMatrixRowsAndColumnsWithValueOnDiagonal()</a>.</p>

</div>
</div>
<a class="anchor" id="a5a68cf8b1e9a1630f54a60feb03084b9"></a><!-- doxytag: member="PetscMatTools::ZeroRowsWithValueOnDiagonal" ref="a5a68cf8b1e9a1630f54a60feb03084b9" args="(Mat matrix, std::vector&lt; unsigned &gt; &amp;rRows, double diagonalValue)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::ZeroRowsWithValueOnDiagonal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&nbsp;</td>
          <td class="paramname"> <em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classunsigned.html">unsigned</a> &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>rRows</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdouble.html">double</a>&nbsp;</td>
          <td class="paramname"> <em>diagonalValue</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Zero several rows of a matrix, putting a given value in the diagonal entries.</p>
<p>*Massively* less expensive than zeroing each matrix row individually</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>matrix</em>&nbsp;</td><td>the matrix </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rRows</em>&nbsp;</td><td>std::vector of rows to be zeroed </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>diagonalValue</em>&nbsp;</td><td>value to put in the diagonal entries (of the zeroed rows) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00102">102</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p>References <a class="el" href="PetscMatTools_8cpp_source.html#l00067">Finalise()</a>, and <a class="el" href="PetscTools_8hpp_source.html#l00080">PETSC_DESTROY_PARAM</a>.</p>

<p>Referenced by <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00679">AbstractContinuumMechanicsSolver&lt; DIM &gt;::ApplyDirichletBoundaryConditions()</a>, <a class="el" href="BoundaryConditionsContainerImplementation_8hpp_source.html#l00530">BoundaryConditionsContainer&lt; ELEMENT_DIM, SPACE_DIM, PROBLEM_DIM &gt;::ApplyDirichletToNonlinearJacobian()</a>, <a class="el" href="LinearSystem_8cpp_source.html#l00378">LinearSystem::ZeroMatrixRowsWithValueOnDiagonal()</a>, and <a class="el" href="PetscMatTools_8cpp_source.html#l00184">ZeroRowsAndColumnsWithValueOnDiagonal()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>linalg/src/<a class="el" href="PetscMatTools_8hpp_source.html">PetscMatTools.hpp</a></li>
<li>linalg/src/<a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a></li>
</ul>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.2 </small></address>
</body>
</html>
