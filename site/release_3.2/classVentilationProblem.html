<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Chaste: VentilationProblem Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.2 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="classes.html"><span>Class&nbsp;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>VentilationProblem Class Reference</h1><!-- doxytag: class="VentilationProblem" -->
<p><code>#include &lt;<a class="el" href="VentilationProblem_8hpp_source.html">VentilationProblem.hpp</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for VentilationProblem:</div>
<div class="dynsection">
<div class="center"><img src="classVentilationProblem__coll__graph.png" border="0" usemap="#VentilationProblem_coll__map" alt="Collaboration graph"/></div>
<map name="VentilationProblem_coll__map" id="VentilationProblem_coll__map">
<area shape="rect" id="node8" href="classTetrahedralMesh.html" title="{TetrahedralMesh\&lt; 1, 3 \&gt;\n|# mElementWeightedDirections\l# mElementJacobians\l# mElementInverseJacobians\l# mElementJacobianDeterminants\l# mBoundaryElementWeightedDirections\l# mBoundaryElementJacobianDeterminants\l|+ TetrahedralMesh()\l+ ConstructFromMeshReader()\l+ ReadNodesPerProcessorFile()\l+ CheckIsConforming()\l+ GetVolume()\l+ GetSurfaceArea()\l+ RefreshMesh()\l+ PermuteNodes()\l+ PermuteNodes()\l+ GetContainingElementIndexWithInitialGuess()\l+ GetNearestElementIndex()\l+ GetContainingElementIndices()\l+ Clear()\l+ CalculateBoundaryOfFlaggedRegion()\l+ GetAngleBetweenNodes()\l+ UnflagAllElements()\l+ FlagElementsNotContainingNodes()\l+ RefreshJacobianCachedData()\l+ GetJacobianForElement()\l+ GetInverseJacobianForElement()\l+ GetWeightedDirectionForElement()\l+ GetWeightedDirectionForBoundaryElement()\l+ EdgesBegin()\l+ EdgesEnd()\l# SolveNodeMapping()\l# SolveElementMapping()\l# SolveBoundaryElementMapping()\l# ExportToMesher()\l# ImportFromMesher()\l# InitialiseTriangulateIo()\l# FreeTriangulateIo()\l&#45; serialize()\l}" alt="" coords="910,3705,1214,4466"/><area shape="rect" id="node43" href="classTetrahedralMesh.html" title="{TetrahedralMesh\&lt; ELEMENT_DIM, SPACE_DIM \&gt;\n|# mElementWeightedDirections\l# mElementJacobians\l# mElementInverseJacobians\l# mElementJacobianDeterminants\l# mBoundaryElementWeightedDirections\l# mBoundaryElementJacobianDeterminants\l|+ TetrahedralMesh()\l+ ConstructFromMeshReader()\l+ ReadNodesPerProcessorFile()\l+ CheckIsConforming()\l+ GetVolume()\l+ GetSurfaceArea()\l+ RefreshMesh()\l+ PermuteNodes()\l+ PermuteNodes()\l+ GetContainingElementIndexWithInitialGuess()\l+ GetNearestElementIndex()\l+ GetContainingElementIndices()\l+ Clear()\l+ CalculateBoundaryOfFlaggedRegion()\l+ GetAngleBetweenNodes()\l+ UnflagAllElements()\l+ FlagElementsNotContainingNodes()\l+ RefreshJacobianCachedData()\l+ GetJacobianForElement()\l+ GetInverseJacobianForElement()\l+ GetWeightedDirectionForElement()\l+ GetWeightedDirectionForBoundaryElement()\l+ EdgesBegin()\l+ EdgesEnd()\l# SolveNodeMapping()\l# SolveElementMapping()\l# SolveBoundaryElementMapping()\l# ExportToMesher()\l# ImportFromMesher()\l# InitialiseTriangulateIo()\l# FreeTriangulateIo()\l&#45; serialize()\l}" alt="" coords="762,2857,1082,3618"/><area shape="rect" id="node10" href="classAbstractTetrahedralMesh.html" title="{AbstractTetrahedralMesh\&lt; ELEMENT_DIM, SPACE_DIM \&gt;\n|# mMeshIsLinear\l# mElements\l# mBoundaryElements\l|+ GetElementIteratorBegin()\l+ GetElementIteratorEnd()\l+ AbstractTetrahedralMesh()\l+ ~AbstractTetrahedralMesh()\l+ GetNumElements()\l+ GetNumLocalElements()\l+ GetNumBoundaryElements()\l+ GetNumLocalBoundaryElements()\l+ GetNumAllElements()\l+ GetNumAllBoundaryElements()\l+ GetNumCableElements()\l+ GetNumVertices()\l+ GetMaximumNodeIndex()\l+ GetElement()\l+ GetBoundaryElement()\l+ ConstructFromMeshReader()\l+ ConstructFromMesh()\l+ GetBoundaryElementIteratorBegin()\l+ GetBoundaryElementIteratorEnd()\l+ GetInverseJacobianForElement()\l+ GetWeightedDirectionForBoundaryElement()\l+ CheckOutwardNormals()\l+ ConstructLinearMesh()\l+ ConstructRectangularMesh()\l+ ConstructCuboid()\l+ ConstructRegularSlabMesh()\l+ CalculateDesignatedOwnershipOfBoundaryElement()\l+ CalculateDesignatedOwnershipOfElement()\l+ CalculateMaximumNodeConnectivityPerProcess()\l+ GetHaloNodeIndices()\l+ CalculateNodeExchange()\l+ CalculateMinMaxEdgeLengths()\l+ GetContainingElementIndex()\l+ GetNearestElementIndexFromTestElements()\l# SetElementOwnerships()\l&#45; SolveElementMapping()\l&#45; SolveBoundaryElementMapping()\l&#45; save()\l&#45; load()\l}" alt="" coords="333,1934,701,2770"/><area shape="rect" id="node12" href="classAbstractMesh.html" title="{AbstractMesh\&lt; ELEMENT_DIM, SPACE_DIM \&gt;\n|# mNodes\l# mBoundaryNodes\l# mpDistributedVectorFactory\l# mNodePermutation\l# mMeshFileBaseName\l# mMeshChangesDuringSimulation\l|+ GetNodeIteratorBegin()\l+ GetNodeIteratorEnd()\l+ AbstractMesh()\l+ ~AbstractMesh()\l+ GetNumNodes()\l+ GetNumBoundaryNodes()\l+ GetNumAllNodes()\l+ GetNumNodeAttributes()\l+ GetNode()\l+ GetNodeOrHaloNode()\l+ GetNodeFromPrePermutationIndex()\l+ ReadNodesPerProcessorFile()\l+ GetDistributedVectorFactory()\l+ SetDistributedVectorFactory()\l+ PermuteNodes()\l+ GetBoundaryNodeIteratorBegin()\l+ GetBoundaryNodeIteratorEnd()\l+ GetMeshFileBaseName()\l+ IsMeshOnDisk()\l+ rGetNodePermutation()\l+ GetVectorFromAtoB()\l+ GetDistanceBetweenNodes()\l+ GetWidth()\l+ CalculateBoundingBox()\l+ Scale()\l+ Translate()\l+ Translate()\l+ Rotate()\l+ Rotate()\l+ RotateX()\l+ RotateY()\l+ RotateZ()\l+ Rotate()\l+ RefreshMesh()\l+ IsMeshChanging()\l+ CalculateMaximumContainingElementsPerProcess()\l+ SetMeshHasChangedSinceLoading()\l# SetElementOwnerships()\l# CalculateBoundingBox()\l&#45; SolveNodeMapping()\l&#45; serialize()\l}" alt="" coords="653,937,999,1866"/><area shape="rect" id="node14" href="classboost_1_1noncopyable.html" title="{boost::noncopyable\n||}" alt="" coords="1081,490,1219,579"/><area shape="rect" id="node16" href="classDistributedVectorFactory.html" title="{DistributedVectorFactory\n|&#45; mLo\l&#45; mHi\l&#45; mProblemSize\l&#45; mNumProcs\l&#45; mPetscStatusKnown\l&#45; mGlobalLows\l&#45; mpOriginalFactory\l&#45; msCheckNumberOfProcessesOnLoad\l|+ DistributedVectorFactory()\l+ DistributedVectorFactory()\l+ DistributedVectorFactory()\l+ DistributedVectorFactory()\l+ ~DistributedVectorFactory()\l+ CreateVec()\l+ CreateVec()\l+ CreateDistributedVector()\l+ IsGlobalIndexLocal()\l+ GetLocalOwnership()\l+ GetHigh()\l+ GetLow()\l+ GetProblemSize()\l+ GetNumProcs()\l+ GetOriginalFactory()\l+ SetOriginalFactory()\l+ SetFromFactory()\l+ rGetGlobalLows()\l+ SetCheckNumberOfProcessesOnLoad()\l+ CheckNumberOfProcessesOnLoad()\l&#45; CheckForPetsc()\l&#45; CalculateOwnership()\l&#45; serialize()\l}" alt="" coords="1406,219,1678,850"/><area shape="rect" id="node21" href="classbool.html" title="{bool\n||}" alt="" coords="634,6,682,95"/><area shape="rect" id="node23" href="classunsigned.html" title="{unsigned\n||}" alt="" coords="1703,6,1781,95"/><area shape="rect" id="node50" href="classdouble.html" title="{double\n||}" alt="" coords="1289,4041,1350,4130"/><area shape="rect" id="node57" href="classMat.html" title="{Mat\n||}" alt="" coords="1681,4041,1723,4130"/><area shape="rect" id="node60" href="classVec.html" title="{Vec\n||}" alt="" coords="1871,4041,1917,4130"/></map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>

<p><a href="classVentilationProblem-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVentilationProblem.html#a9b1d5eefcc0db3b5f70a8976ef4c7392">VentilationProblem</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVentilationProblem.html#ab268a63d19ab3e9771024854bd61d8ab">VentilationProblem</a> (const std::string &amp;rMeshDirFilePath, <a class="el" href="classunsigned.html">unsigned</a> rootIndex=0u)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVentilationProblem.html#a72d36f8498f94a300c643cca38638398">~VentilationProblem</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVentilationProblem.html#a0fca592e5ce437e9fb467326f4fe9039">SetOutflowPressure</a> (<a class="el" href="classdouble.html">double</a> pressure)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVentilationProblem.html#a6b8b826c8c7a5061893f4f8a397b5629">SetConstantInflowPressures</a> (<a class="el" href="classdouble.html">double</a> pressure)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVentilationProblem.html#a8668f1e4c21743cf91f88843ec4e2526">SetConstantInflowFluxes</a> (<a class="el" href="classdouble.html">double</a> flux)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVentilationProblem.html#a904bcc258fdbb5996068220b4a46c0a4">SetPressureAtBoundaryNode</a> (const <a class="el" href="classNode.html">Node</a>&lt; 3 &gt; &amp;rNode, <a class="el" href="classdouble.html">double</a> pressure)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classdouble.html">double</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVentilationProblem.html#a99ed08aa8a578644e9fe35b5a1e9c4d4">GetPressureAtBoundaryNode</a> (const <a class="el" href="classNode.html">Node</a>&lt; 3 &gt; &amp;rNode)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classdouble.html">double</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVentilationProblem.html#a1d156c0ff2264247488779cbb835a242">GetFluxAtOutflow</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVentilationProblem.html#a4bd3a7c96c3df4b7acb85ad42451422d">SetFluxAtBoundaryNode</a> (const <a class="el" href="classNode.html">Node</a>&lt; 3 &gt; &amp;rNode, <a class="el" href="classdouble.html">double</a> flux)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVentilationProblem.html#ab6c015101d181cd3fd618f291ccfc793">Solve</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVentilationProblem.html#aef4d5a2b27f30b5d769670b4101a95c8">GetSolutionAsFluxesAndPressures</a> (std::vector&lt; <a class="el" href="classdouble.html">double</a> &gt; &amp;rFluxesOnEdges, std::vector&lt; <a class="el" href="classdouble.html">double</a> &gt; &amp;rPressuresOnNodes)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVentilationProblem.html#ae00a63388e5db9cd087d4e1c5a681a36">AddDataToVtk</a> (<a class="el" href="classVtkMeshWriter.html">VtkMeshWriter</a>&lt; 1, 3 &gt; &amp;rVtkWriter, const std::string &amp;rSuffix)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVentilationProblem.html#a357ef935c73b1b28db975a4ec1315e42">WriteVtk</a> (const std::string &amp;rDirName, const std::string &amp;rFileBaseName)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVentilationProblem.html#a91d4680c9504de81064a4b79373f8838">SetRadiusOnEdge</a> (<a class="el" href="classbool.html">bool</a> isOnEdges=true)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTetrahedralMesh.html">TetrahedralMesh</a>&lt; 1, 3 &gt; &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVentilationProblem.html#a5f22343db02978138a9c065ab10c3ec5">rGetMesh</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVentilationProblem.html#aa630a54c2f38ad1405de993a2ba0b2f5">Solve</a> (<a class="el" href="classTimeStepper.html">TimeStepper</a> &amp;rTimeStepper, void(*pBoundaryConditionFunction)(<a class="el" href="classVentilationProblem.html">VentilationProblem</a> *, <a class="el" href="classTimeStepper.html">TimeStepper</a> &amp;rTimeStepper, const <a class="el" href="classNode.html">Node</a>&lt; 3 &gt; &amp;), const std::string &amp;rDirName, const std::string &amp;rFileBaseName)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVentilationProblem.html#ab8163ab73a591f571cced49ccb6934fe">SolveProblemFromFile</a> (const std::string &amp;rInFilePath, const std::string &amp;rOutFileDir, const std::string &amp;rOutFileName)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classdouble.html">double</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVentilationProblem.html#a52c720a3fff056eabd35d5ca4f8a60ec">GetViscosity</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVentilationProblem.html#a21d3cb8736aa23cd9440eb92a570b2ae">SetViscosity</a> (<a class="el" href="classdouble.html">double</a> viscosity)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classdouble.html">double</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVentilationProblem.html#ac2792a1bab6f61df11dfcbbf9c75006a">GetDensity</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVentilationProblem.html#a019e5dc4146a71297414cf846b8553c4">SetDensity</a> (<a class="el" href="classdouble.html">double</a> density)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVentilationProblem.html#a5c5ef22db34c435722c6592cf5f31044">SetDynamicResistance</a> (<a class="el" href="classbool.html">bool</a> dynamicResistance=true)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classSwan2012AcinarUnit.html">Swan2012AcinarUnit</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVentilationProblem.html#a084b0c37091f27652ee51657da929e4c">GetAcinus</a> (const <a class="el" href="classNode.html">Node</a>&lt; 3 &gt; &amp;rNode)</td></tr>
<tr><td colspan="2"><h2>Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVentilationProblem.html#a2c575973b61836934107e9bf7b069ef7">SolveDirectFromFlux</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVentilationProblem.html#a9529133f6b281358f2456fdb3f4bb332">SetupIterativeSolver</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVentilationProblem.html#ae3f3ffd948e38306375ef81071ea3aae">SolveIterativelyFromPressure</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classdouble.html">double</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVentilationProblem.html#a28b35215ecc53d3607b3dee2afe77312">CalculateResistance</a> (<a class="el" href="classElement.html">Element</a>&lt; 1, 3 &gt; &amp;rElement, <a class="el" href="classbool.html">bool</a> usePedley=false, <a class="el" href="classdouble.html">double</a> flux=DBL_MAX)</td></tr>
<tr><td colspan="2"><h2>Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTetrahedralMesh.html">TetrahedralMesh</a>&lt; 1, 3 &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVentilationProblem.html#a38146569a445ada1f66525522f4a3d72">mMesh</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classunsigned.html">unsigned</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVentilationProblem.html#ad3a5bb97f2a693d4f6da00065aaca53b">mOutletNodeIndex</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVentilationProblem.html#ae21fc3761feb9208d0666904964b75cf">mDynamicResistance</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVentilationProblem.html#ae91e18e83b3826cd04c3382477503153">mRadiusOnEdge</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classdouble.html">double</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVentilationProblem.html#abd8e8f61905f489fb5d43a75797788f2">mViscosity</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classdouble.html">double</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVentilationProblem.html#a52bc930a7ca6a552b6cce4e2adc355dc">mDensity</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::map&lt; <a class="el" href="classunsigned.html">unsigned</a>, <br class="typebreak"/>
<a class="el" href="classSwan2012AcinarUnit.html">Swan2012AcinarUnit</a> * &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVentilationProblem.html#ae1bc7405949e6edc297fa0fa8eb2ca7c">mAcinarUnits</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classdouble.html">double</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVentilationProblem.html#a5e27482175fbf2f8e67482ff69d96a97">mFlux</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classdouble.html">double</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVentilationProblem.html#a111916474fd4d6b5964546fe05f6985b">mPressure</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::map&lt; <a class="el" href="classunsigned.html">unsigned</a>, <a class="el" href="classdouble.html">double</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVentilationProblem.html#a53ecea60b72aedec5b9e66290cec2753">mPressureCondition</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVentilationProblem.html#adb1f5846c4b030b619647fbbd2633bb6">mFluxGivenAtInflow</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMat.html">Mat</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVentilationProblem.html#a8c76fdf7a8b46d26f442532080f77a19">mTerminalInteractionMatrix</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::map&lt; <a class="el" href="classunsigned.html">unsigned</a>, <a class="el" href="classunsigned.html">unsigned</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVentilationProblem.html#a9c93247f566cf68625a459b8f07dc83b">mTerminalToNodeIndex</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::map&lt; <a class="el" href="classunsigned.html">unsigned</a>, <a class="el" href="classunsigned.html">unsigned</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVentilationProblem.html#aaed6278170538deb670547534cadd607">mTerminalToEdgeIndex</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classVec.html">Vec</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVentilationProblem.html#a232fe1388eac63d75a945d51c64caf16">mTerminalFluxChangeVector</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classVec.html">Vec</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVentilationProblem.html#a075d333725467d6471f3920e0c6b9fd6">mTerminalPressureChangeVector</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">KSP&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVentilationProblem.html#a1f4ac55af568a631b382237148a1e1a9">mTerminalKspSolver</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>A class for solving one-dimensional flow in pipe problems on branching trees.</p>
<p>At graph edges: each pipe models Poiseuille flow (flux is linearly proportional to the pressure drop) At graph nodes: the flux is balanced so that mass is conserved.</p>
<p>Works in 3D &lt;1,3&gt; Current functionality: pressure boundary conditions are set on each of the boundary nodes Solves for pressure at internal nodes and flux on edges </p>

<p>Definition at line <a class="el" href="VentilationProblem_8hpp_source.html#l00056">56</a> of file <a class="el" href="VentilationProblem_8hpp_source.html">VentilationProblem.hpp</a>.</p>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a9b1d5eefcc0db3b5f70a8976ef4c7392"></a><!-- doxytag: member="VentilationProblem::VentilationProblem" ref="a9b1d5eefcc0db3b5f70a8976ef4c7392" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VentilationProblem::VentilationProblem </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Default constructor Attempts to read all parameters from a hard-coded file Loads a mesh from file(s) Identifies the outlet node (a.k.a root of tree or the mouth end) A check is made that it is a boundary node. We could also check that on trees with more than one bifurcation there are no boundary nodes in its 2nd generation successors. Creates a linear system of the appropriate size to match the mesh </p>

</div>
</div>
<a class="anchor" id="ab268a63d19ab3e9771024854bd61d8ab"></a><!-- doxytag: member="VentilationProblem::VentilationProblem" ref="ab268a63d19ab3e9771024854bd61d8ab" args="(const std::string &amp;rMeshDirFilePath, unsigned rootIndex=0u)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VentilationProblem::VentilationProblem </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&nbsp;</td>
          <td class="paramname"> <em>rMeshDirFilePath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classunsigned.html">unsigned</a>&nbsp;</td>
          <td class="paramname"> <em>rootIndex</em> = <code>0u</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Constructor Loads a mesh from file(s) Identifies the outlet node (a.k.a root of tree or the mouth end) A check is made that it is a boundary node. We could also check that on trees with more than one bifurcation there are no boundary nodes in its 2nd generation successors. Creates a linear system of the appropriate size to match the mesh </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>rMeshDirFilePath</em>&nbsp;</td><td>the path and root name of the .node and .edge files for the mesh </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rootIndex</em>&nbsp;</td><td>the global index of the root/outlet node in the mesh (defaults to node zero). </td></tr>
  </table>
  </dd>
</dl>

<p><dl class="todo"><dt><b><a class="el" href="todo.html#_todo000222">Todo:</a></b></dt><dd>We need to do some parallel here in order to load balance </dd></dl>
</p>

<p>Definition at line <a class="el" href="VentilationProblem_8cpp_source.html#l00041">41</a> of file <a class="el" href="VentilationProblem_8cpp_source.html">VentilationProblem.cpp</a>.</p>

<p>References <a class="el" href="TetrahedralMesh_8cpp_source.html#l00068">TetrahedralMesh&lt; ELEMENT_DIM, SPACE_DIM &gt;::ConstructFromMeshReader()</a>, <a class="el" href="Exception_8hpp_source.html#l00143">EXCEPTION</a>, <a class="el" href="AbstractMesh_8cpp_source.html#l00165">AbstractMesh&lt; ELEMENT_DIM, SPACE_DIM &gt;::GetBoundaryNodeIteratorBegin()</a>, <a class="el" href="AbstractMesh_8cpp_source.html#l00171">AbstractMesh&lt; ELEMENT_DIM, SPACE_DIM &gt;::GetBoundaryNodeIteratorEnd()</a>, <a class="el" href="AbstractMesh_8cpp_source.html#l00093">AbstractMesh&lt; ELEMENT_DIM, SPACE_DIM &gt;::GetNode()</a>, <a class="el" href="AbstractTetrahedralMesh_8cpp_source.html#l00088">AbstractTetrahedralMesh&lt; ELEMENT_DIM, SPACE_DIM &gt;::GetNumElements()</a>, <a class="el" href="AbstractMesh_8cpp_source.html#l00066">AbstractMesh&lt; ELEMENT_DIM, SPACE_DIM &gt;::GetNumNodes()</a>, <a class="el" href="TetrahedralMesh_8cpp_source.html#l00845">TetrahedralMesh&lt; ELEMENT_DIM, SPACE_DIM &gt;::GetWeightedDirectionForElement()</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00085">mAcinarUnits</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00086">mFlux</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00059">mMesh</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00060">mOutletNodeIndex</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00087">mPressure</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00072">mViscosity</a>, <a class="el" href="Swan2012AcinarUnit_8cpp_source.html#l00090">Swan2012AcinarUnit::SetAirwayPressure()</a>, <a class="el" href="Swan2012AcinarUnit_8cpp_source.html#l00096">Swan2012AcinarUnit::SetPleuralPressure()</a>, <a class="el" href="Swan2012AcinarUnit_8cpp_source.html#l00112">Swan2012AcinarUnit::SetStretchRatio()</a>, <a class="el" href="Swan2012AcinarUnit_8cpp_source.html#l00102">Swan2012AcinarUnit::SetTerminalBronchioleResistance()</a>, and <a class="el" href="Swan2012AcinarUnit_8cpp_source.html#l00123">Swan2012AcinarUnit::SetUndeformedVolume()</a>.</p>

</div>
</div>
<a class="anchor" id="a72d36f8498f94a300c643cca38638398"></a><!-- doxytag: member="VentilationProblem::~VentilationProblem" ref="a72d36f8498f94a300c643cca38638398" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VentilationProblem::~VentilationProblem </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Destructor destroys the linear system </p>

<p>Definition at line <a class="el" href="VentilationProblem_8cpp_source.html#l00106">106</a> of file <a class="el" href="VentilationProblem_8cpp_source.html">VentilationProblem.cpp</a>.</p>

<p>References <a class="el" href="PetscTools_8hpp_source.html#l00349">PetscTools::Destroy()</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00085">mAcinarUnits</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00103">mTerminalFluxChangeVector</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00099">mTerminalInteractionMatrix</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00105">mTerminalKspSolver</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00104">mTerminalPressureChangeVector</a>, and <a class="el" href="PetscTools_8hpp_source.html#l00080">PETSC_DESTROY_PARAM</a>.</p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="ae00a63388e5db9cd087d4e1c5a681a36"></a><!-- doxytag: member="VentilationProblem::AddDataToVtk" ref="ae00a63388e5db9cd087d4e1c5a681a36" args="(VtkMeshWriter&lt; 1, 3 &gt; &amp;rVtkWriter, const std::string &amp;rSuffix)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void VentilationProblem::AddDataToVtk </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classVtkMeshWriter.html">VtkMeshWriter</a>&lt; 1, 3 &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>rVtkWriter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&nbsp;</td>
          <td class="paramname"> <em>rSuffix</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Add flux and pressure data to a <a class="el" href="classVtkMeshWriter.html">VtkMeshWriter</a>. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>rVtkWriter</em>&nbsp;</td><td>the mesh writer ready for the data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rSuffix</em>&nbsp;</td><td>Suffix with which to annotate e.g. pressure_001 </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="VentilationProblem_8cpp_source.html#l00522">522</a> of file <a class="el" href="VentilationProblem_8cpp_source.html">VentilationProblem.cpp</a>.</p>

<p>References <a class="el" href="VtkMeshWriter_8cpp_source.html#l00212">VtkMeshWriter&lt; ELEMENT_DIM, SPACE_DIM &gt;::AddCellData()</a>, <a class="el" href="VtkMeshWriter_8cpp_source.html#l00357">VtkMeshWriter&lt; ELEMENT_DIM, SPACE_DIM &gt;::AddPointData()</a>, <a class="el" href="AbstractMesh_8cpp_source.html#l00165">AbstractMesh&lt; ELEMENT_DIM, SPACE_DIM &gt;::GetBoundaryNodeIteratorBegin()</a>, <a class="el" href="AbstractMesh_8cpp_source.html#l00171">AbstractMesh&lt; ELEMENT_DIM, SPACE_DIM &gt;::GetBoundaryNodeIteratorEnd()</a>, <a class="el" href="AbstractMesh_8cpp_source.html#l00066">AbstractMesh&lt; ELEMENT_DIM, SPACE_DIM &gt;::GetNumNodes()</a>, <a class="el" href="VentilationProblem_8cpp_source.html#l00493">GetSolutionAsFluxesAndPressures()</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00085">mAcinarUnits</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00059">mMesh</a>, and <a class="el" href="VentilationProblem_8hpp_source.html#l00060">mOutletNodeIndex</a>.</p>

<p>Referenced by <a class="el" href="VentilationProblem_8cpp_source.html#l00550">Solve()</a>, and <a class="el" href="VentilationProblem_8cpp_source.html#l00514">WriteVtk()</a>.</p>

</div>
</div>
<a class="anchor" id="a28b35215ecc53d3607b3dee2afe77312"></a><!-- doxytag: member="VentilationProblem::CalculateResistance" ref="a28b35215ecc53d3607b3dee2afe77312" args="(Element&lt; 1, 3 &gt; &amp;rElement, bool usePedley=false, double flux=DBL_MAX)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classdouble.html">double</a> VentilationProblem::CalculateResistance </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classElement.html">Element</a>&lt; 1, 3 &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>rElement</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&nbsp;</td>
          <td class="paramname"> <em>usePedley</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdouble.html">double</a>&nbsp;</td>
          <td class="paramname"> <em>flux</em> = <code>DBL_MAX</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Get the resistance of an edge. This defaults to Poiseuille resistance (in which only the geometry is used. Otherwise, Pedley's correction is calculated, which requires a flux to be given.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>rElement</em>&nbsp;</td><td>The edge on which to perform this calculation </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>usePedley</em>&nbsp;</td><td>Whether to add Pedley's increasing correction term. Here the resistance increases which the sqrt of Reynold's number (dependent on flux). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>flux</em>&nbsp;</td><td>The flux in the edge (used for Pedley correction). </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the resistance of this element/edge </dd></dl>

<p>Definition at line <a class="el" href="VentilationProblem_8cpp_source.html#l00351">351</a> of file <a class="el" href="VentilationProblem_8cpp_source.html">VentilationProblem.cpp</a>.</p>

<p>References <a class="el" href="AbstractElement_8cpp_source.html#l00187">AbstractElement&lt; ELEMENT_DIM, SPACE_DIM &gt;::GetAttribute()</a>, <a class="el" href="AbstractElement_8cpp_source.html#l00139">AbstractElement&lt; ELEMENT_DIM, SPACE_DIM &gt;::GetIndex()</a>, <a class="el" href="AbstractElement_8cpp_source.html#l00114">AbstractElement&lt; ELEMENT_DIM, SPACE_DIM &gt;::GetNode()</a>, <a class="el" href="TetrahedralMesh_8cpp_source.html#l00845">TetrahedralMesh&lt; ELEMENT_DIM, SPACE_DIM &gt;::GetWeightedDirectionForElement()</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00083">mDensity</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00059">mMesh</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00062">mRadiusOnEdge</a>, and <a class="el" href="VentilationProblem_8hpp_source.html#l00072">mViscosity</a>.</p>

<p>Referenced by <a class="el" href="VentilationProblem_8cpp_source.html#l00162">SetupIterativeSolver()</a>, and <a class="el" href="VentilationProblem_8cpp_source.html#l00122">SolveDirectFromFlux()</a>.</p>

</div>
</div>
<a class="anchor" id="a084b0c37091f27652ee51657da929e4c"></a><!-- doxytag: member="VentilationProblem::GetAcinus" ref="a084b0c37091f27652ee51657da929e4c" args="(const Node&lt; 3 &gt; &amp;rNode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classSwan2012AcinarUnit.html">Swan2012AcinarUnit</a>* VentilationProblem::GetAcinus </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classNode.html">Node</a>&lt; 3 &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>rNode</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>rNode</em>&nbsp;</td><td>The node to get the acinus at. Must be a boundary node! </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The acinar unit at the given node. </dd></dl>

<p>Definition at line <a class="el" href="VentilationProblem_8hpp_source.html#l00339">339</a> of file <a class="el" href="VentilationProblem_8hpp_source.html">VentilationProblem.hpp</a>.</p>

<p>References <a class="el" href="Node_8cpp_source.html#l00154">Node&lt; SPACE_DIM &gt;::GetIndex()</a>, and <a class="el" href="VentilationProblem_8hpp_source.html#l00085">mAcinarUnits</a>.</p>

</div>
</div>
<a class="anchor" id="ac2792a1bab6f61df11dfcbbf9c75006a"></a><!-- doxytag: member="VentilationProblem::GetDensity" ref="ac2792a1bab6f61df11dfcbbf9c75006a" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classdouble.html">double</a> VentilationProblem::GetDensity </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="return"><dt><b>Returns:</b></dt><dd>the density in kg/(m^3) </dd></dl>

<p>Definition at line <a class="el" href="VentilationProblem_8hpp_source.html#l00314">314</a> of file <a class="el" href="VentilationProblem_8hpp_source.html">VentilationProblem.hpp</a>.</p>

<p>References <a class="el" href="VentilationProblem_8hpp_source.html#l00083">mDensity</a>.</p>

</div>
</div>
<a class="anchor" id="a1d156c0ff2264247488779cbb835a242"></a><!-- doxytag: member="VentilationProblem::GetFluxAtOutflow" ref="a1d156c0ff2264247488779cbb835a242" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classdouble.html">double</a> VentilationProblem::GetFluxAtOutflow </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Gets the most recent flux at the outflow/outlet (mouth) </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>The flux at outflow. </dd></dl>

<p>Definition at line <a class="el" href="VentilationProblem_8cpp_source.html#l00457">457</a> of file <a class="el" href="VentilationProblem_8cpp_source.html">VentilationProblem.cpp</a>.</p>

<p>References <a class="el" href="VentilationProblem_8hpp_source.html#l00086">mFlux</a>, and <a class="el" href="VentilationProblem_8hpp_source.html#l00060">mOutletNodeIndex</a>.</p>

</div>
</div>
<a class="anchor" id="a99ed08aa8a578644e9fe35b5a1e9c4d4"></a><!-- doxytag: member="VentilationProblem::GetPressureAtBoundaryNode" ref="a99ed08aa8a578644e9fe35b5a1e9c4d4" args="(const Node&lt; 3 &gt; &amp;rNode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classdouble.html">double</a> VentilationProblem::GetPressureAtBoundaryNode </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classNode.html">Node</a>&lt; 3 &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>rNode</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Gets the most recent pressure at a boundary node</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>rNode</em>&nbsp;</td><td>The node to get the pressure for. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The pressure at the node. </dd></dl>

<p>Definition at line <a class="el" href="VentilationProblem_8cpp_source.html#l00447">447</a> of file <a class="el" href="VentilationProblem_8cpp_source.html">VentilationProblem.cpp</a>.</p>

<p>References <a class="el" href="Node_8cpp_source.html#l00154">Node&lt; SPACE_DIM &gt;::GetIndex()</a>, and <a class="el" href="VentilationProblem_8hpp_source.html#l00087">mPressure</a>.</p>

</div>
</div>
<a class="anchor" id="aef4d5a2b27f30b5d769670b4101a95c8"></a><!-- doxytag: member="VentilationProblem::GetSolutionAsFluxesAndPressures" ref="aef4d5a2b27f30b5d769670b4101a95c8" args="(std::vector&lt; double &gt; &amp;rFluxesOnEdges, std::vector&lt; double &gt; &amp;rPressuresOnNodes)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void VentilationProblem::GetSolutionAsFluxesAndPressures </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classdouble.html">double</a> &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>rFluxesOnEdges</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classdouble.html">double</a> &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>rPressuresOnNodes</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>rFluxesOnEdges</em>&nbsp;</td><td>The fluxes ordered by edge index (this vector is resized) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rPressuresOnNodes</em>&nbsp;</td><td>The pressures ordered by node index (this vector is resized) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="VentilationProblem_8cpp_source.html#l00493">493</a> of file <a class="el" href="VentilationProblem_8cpp_source.html">VentilationProblem.cpp</a>.</p>

<p>References <a class="el" href="VentilationProblem_8hpp_source.html#l00086">mFlux</a>, and <a class="el" href="VentilationProblem_8hpp_source.html#l00087">mPressure</a>.</p>

<p>Referenced by <a class="el" href="VentilationProblem_8cpp_source.html#l00522">AddDataToVtk()</a>.</p>

</div>
</div>
<a class="anchor" id="a52c720a3fff056eabd35d5ca4f8a60ec"></a><!-- doxytag: member="VentilationProblem::GetViscosity" ref="a52c720a3fff056eabd35d5ca4f8a60ec" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classdouble.html">double</a> VentilationProblem::GetViscosity </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="return"><dt><b>Returns:</b></dt><dd>the viscosity in kg/(mm*sec) </dd></dl>

<p>Definition at line <a class="el" href="VentilationProblem_8hpp_source.html#l00298">298</a> of file <a class="el" href="VentilationProblem_8hpp_source.html">VentilationProblem.hpp</a>.</p>

<p>References <a class="el" href="VentilationProblem_8hpp_source.html#l00072">mViscosity</a>.</p>

</div>
</div>
<a class="anchor" id="a5f22343db02978138a9c065ab10c3ec5"></a><!-- doxytag: member="VentilationProblem::rGetMesh" ref="a5f22343db02978138a9c065ab10c3ec5" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTetrahedralMesh.html">TetrahedralMesh</a>&lt; 1, 3 &gt; &amp; VentilationProblem::rGetMesh </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="return"><dt><b>Returns:</b></dt><dd>reference to the mesh </dd></dl>

<p>Definition at line <a class="el" href="VentilationProblem_8cpp_source.html#l00506">506</a> of file <a class="el" href="VentilationProblem_8cpp_source.html">VentilationProblem.cpp</a>.</p>

<p>References <a class="el" href="VentilationProblem_8hpp_source.html#l00059">mMesh</a>.</p>

</div>
</div>
<a class="anchor" id="a8668f1e4c21743cf91f88843ec4e2526"></a><!-- doxytag: member="VentilationProblem::SetConstantInflowFluxes" ref="a8668f1e4c21743cf91f88843ec4e2526" args="(double flux)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void VentilationProblem::SetConstantInflowFluxes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classdouble.html">double</a>&nbsp;</td>
          <td class="paramname"> <em>flux</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Sets the flux at each inflow/leaf-edge of the tree Flux is "volumetric flow rate" </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>flux</em>&nbsp;</td><td>The flux value in (mm^3)/s </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="VentilationProblem_8cpp_source.html#l00422">422</a> of file <a class="el" href="VentilationProblem_8cpp_source.html">VentilationProblem.cpp</a>.</p>

<p>References <a class="el" href="AbstractMesh_8cpp_source.html#l00165">AbstractMesh&lt; ELEMENT_DIM, SPACE_DIM &gt;::GetBoundaryNodeIteratorBegin()</a>, <a class="el" href="AbstractMesh_8cpp_source.html#l00171">AbstractMesh&lt; ELEMENT_DIM, SPACE_DIM &gt;::GetBoundaryNodeIteratorEnd()</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00059">mMesh</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00060">mOutletNodeIndex</a>, and <a class="el" href="VentilationProblem_8cpp_source.html#l00462">SetFluxAtBoundaryNode()</a>.</p>

</div>
</div>
<a class="anchor" id="a6b8b826c8c7a5061893f4f8a397b5629"></a><!-- doxytag: member="VentilationProblem::SetConstantInflowPressures" ref="a6b8b826c8c7a5061893f4f8a397b5629" args="(double pressure)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void VentilationProblem::SetConstantInflowPressures </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classdouble.html">double</a>&nbsp;</td>
          <td class="paramname"> <em>pressure</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Sets the pressure at each inflow/leaf of the tree </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pressure</em>&nbsp;</td><td>The pressure value in Pascals </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="VentilationProblem_8cpp_source.html#l00408">408</a> of file <a class="el" href="VentilationProblem_8cpp_source.html">VentilationProblem.cpp</a>.</p>

<p>References <a class="el" href="AbstractMesh_8cpp_source.html#l00165">AbstractMesh&lt; ELEMENT_DIM, SPACE_DIM &gt;::GetBoundaryNodeIteratorBegin()</a>, <a class="el" href="AbstractMesh_8cpp_source.html#l00171">AbstractMesh&lt; ELEMENT_DIM, SPACE_DIM &gt;::GetBoundaryNodeIteratorEnd()</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00059">mMesh</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00060">mOutletNodeIndex</a>, and <a class="el" href="VentilationProblem_8cpp_source.html#l00435">SetPressureAtBoundaryNode()</a>.</p>

<p>Referenced by <a class="el" href="VentilationProblem_8cpp_source.html#l00596">SolveProblemFromFile()</a>.</p>

</div>
</div>
<a class="anchor" id="a019e5dc4146a71297414cf846b8553c4"></a><!-- doxytag: member="VentilationProblem::SetDensity" ref="a019e5dc4146a71297414cf846b8553c4" args="(double density)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void VentilationProblem::SetDensity </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classdouble.html">double</a>&nbsp;</td>
          <td class="paramname"> <em>density</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>density</em>&nbsp;</td><td>the density in kg/(m^3) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="VentilationProblem_8hpp_source.html#l00322">322</a> of file <a class="el" href="VentilationProblem_8hpp_source.html">VentilationProblem.hpp</a>.</p>

<p>References <a class="el" href="VentilationProblem_8hpp_source.html#l00083">mDensity</a>.</p>

<p>Referenced by <a class="el" href="VentilationProblem_8cpp_source.html#l00596">SolveProblemFromFile()</a>.</p>

</div>
</div>
<a class="anchor" id="a5c5ef22db34c435722c6592cf5f31044"></a><!-- doxytag: member="VentilationProblem::SetDynamicResistance" ref="a5c5ef22db34c435722c6592cf5f31044" args="(bool dynamicResistance=true)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void VentilationProblem::SetDynamicResistance </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&nbsp;</td>
          <td class="paramname"> <em>dynamicResistance</em> = <code>true</code></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>dynamicResistance</em>&nbsp;</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="VentilationProblem_8hpp_source.html#l00330">330</a> of file <a class="el" href="VentilationProblem_8hpp_source.html">VentilationProblem.hpp</a>.</p>

<p>References <a class="el" href="VentilationProblem_8hpp_source.html#l00061">mDynamicResistance</a>.</p>

</div>
</div>
<a class="anchor" id="a4bd3a7c96c3df4b7acb85ad42451422d"></a><!-- doxytag: member="VentilationProblem::SetFluxAtBoundaryNode" ref="a4bd3a7c96c3df4b7acb85ad42451422d" args="(const Node&lt; 3 &gt; &amp;rNode, double flux)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void VentilationProblem::SetFluxAtBoundaryNode </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classNode.html">Node</a>&lt; 3 &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>rNode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdouble.html">double</a>&nbsp;</td>
          <td class="paramname"> <em>flux</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Sets a Dirichlet flux boundary condition for a given node.</p>
<p>The given boundary condition will be applied at the next time step and persist through time unless overwritten.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>rNode</em>&nbsp;</td><td>The node to set the boundary condition for </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>flux</em>&nbsp;</td><td>The flux boundary condition in (mm^3)/s </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="VentilationProblem_8cpp_source.html#l00462">462</a> of file <a class="el" href="VentilationProblem_8cpp_source.html">VentilationProblem.cpp</a>.</p>

<p>References <a class="el" href="Node_8hpp_source.html#l00466">Node&lt; SPACE_DIM &gt;::ContainingElementsBegin()</a>, <a class="el" href="Exception_8hpp_source.html#l00143">EXCEPTION</a>, <a class="el" href="Node_8cpp_source.html#l00160">Node&lt; SPACE_DIM &gt;::IsBoundaryNode()</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00086">mFlux</a>, and <a class="el" href="VentilationProblem_8hpp_source.html#l00089">mFluxGivenAtInflow</a>.</p>

<p>Referenced by <a class="el" href="VentilationProblem_8cpp_source.html#l00422">SetConstantInflowFluxes()</a>.</p>

</div>
</div>
<a class="anchor" id="a0fca592e5ce437e9fb467326f4fe9039"></a><!-- doxytag: member="VentilationProblem::SetOutflowPressure" ref="a0fca592e5ce437e9fb467326f4fe9039" args="(double pressure)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void VentilationProblem::SetOutflowPressure </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classdouble.html">double</a>&nbsp;</td>
          <td class="paramname"> <em>pressure</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Sets the pressure at the outflow/root of the tree</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pressure</em>&nbsp;</td><td>The pressure value in Pascals </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="VentilationProblem_8cpp_source.html#l00402">402</a> of file <a class="el" href="VentilationProblem_8cpp_source.html">VentilationProblem.cpp</a>.</p>

<p>References <a class="el" href="AbstractMesh_8cpp_source.html#l00093">AbstractMesh&lt; ELEMENT_DIM, SPACE_DIM &gt;::GetNode()</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00059">mMesh</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00060">mOutletNodeIndex</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00087">mPressure</a>, and <a class="el" href="VentilationProblem_8cpp_source.html#l00435">SetPressureAtBoundaryNode()</a>.</p>

<p>Referenced by <a class="el" href="VentilationProblem_8cpp_source.html#l00596">SolveProblemFromFile()</a>.</p>

</div>
</div>
<a class="anchor" id="a904bcc258fdbb5996068220b4a46c0a4"></a><!-- doxytag: member="VentilationProblem::SetPressureAtBoundaryNode" ref="a904bcc258fdbb5996068220b4a46c0a4" args="(const Node&lt; 3 &gt; &amp;rNode, double pressure)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void VentilationProblem::SetPressureAtBoundaryNode </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classNode.html">Node</a>&lt; 3 &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>rNode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdouble.html">double</a>&nbsp;</td>
          <td class="paramname"> <em>pressure</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Sets a Dirichlet pressure boundary condition for a given node.</p>
<p>The given boundary condition will be applied at the next time step and persist through time unless overwritten.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>rNode</em>&nbsp;</td><td>The node to set the boundary condition for </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pressure</em>&nbsp;</td><td>The pressure boundary condition in Pascals </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="VentilationProblem_8cpp_source.html#l00435">435</a> of file <a class="el" href="VentilationProblem_8cpp_source.html">VentilationProblem.cpp</a>.</p>

<p>References <a class="el" href="Exception_8hpp_source.html#l00143">EXCEPTION</a>, <a class="el" href="Node_8cpp_source.html#l00154">Node&lt; SPACE_DIM &gt;::GetIndex()</a>, <a class="el" href="Node_8cpp_source.html#l00160">Node&lt; SPACE_DIM &gt;::IsBoundaryNode()</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00089">mFluxGivenAtInflow</a>, and <a class="el" href="VentilationProblem_8hpp_source.html#l00088">mPressureCondition</a>.</p>

<p>Referenced by <a class="el" href="VentilationProblem_8cpp_source.html#l00408">SetConstantInflowPressures()</a>, and <a class="el" href="VentilationProblem_8cpp_source.html#l00402">SetOutflowPressure()</a>.</p>

</div>
</div>
<a class="anchor" id="a91d4680c9504de81064a4b79373f8838"></a><!-- doxytag: member="VentilationProblem::SetRadiusOnEdge" ref="a91d4680c9504de81064a4b79373f8838" args="(bool isOnEdges=true)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void VentilationProblem::SetRadiusOnEdge </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&nbsp;</td>
          <td class="paramname"> <em>isOnEdges</em> = <code>true</code></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Used to set mRadiusOnEdge flag. This is false by default in the constructor (conic pipes with radius defined at nodes). When true pipes are cylindrical. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>isOnEdges</em>&nbsp;</td><td>The new value of mRadiusOnEdge </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="VentilationProblem_8cpp_source.html#l00501">501</a> of file <a class="el" href="VentilationProblem_8cpp_source.html">VentilationProblem.cpp</a>.</p>

<p>References <a class="el" href="VentilationProblem_8hpp_source.html#l00062">mRadiusOnEdge</a>.</p>

</div>
</div>
<a class="anchor" id="a9529133f6b281358f2456fdb3f4bb332"></a><!-- doxytag: member="VentilationProblem::SetupIterativeSolver" ref="a9529133f6b281358f2456fdb3f4bb332" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void VentilationProblem::SetupIterativeSolver </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Set up the PETSc machinery for solving the iterative problem: given pressure conditions at the terminals guess and refine flux conditions which match them.</p>
<p>This creates and fills a PETSc Mat. It also creates two PETSc Vecs and a KSP solver. </p>

<p><dl class="todo"><dt><b><a class="el" href="todo.html#_todo000223">Todo:</a></b></dt><dd>#2300 add to diagonals anyway </dd></dl>
</p>

<p>Definition at line <a class="el" href="VentilationProblem_8cpp_source.html#l00162">162</a> of file <a class="el" href="VentilationProblem_8cpp_source.html">VentilationProblem.cpp</a>.</p>

<p>References <a class="el" href="VentilationProblem_8cpp_source.html#l00351">CalculateResistance()</a>, <a class="el" href="Node_8hpp_source.html#l00466">Node&lt; SPACE_DIM &gt;::ContainingElementsBegin()</a>, <a class="el" href="Node_8hpp_source.html#l00474">Node&lt; SPACE_DIM &gt;::ContainingElementsEnd()</a>, <a class="el" href="PetscMatTools_8cpp_source.html#l00067">PetscMatTools::Finalise()</a>, <a class="el" href="AbstractMesh_8cpp_source.html#l00165">AbstractMesh&lt; ELEMENT_DIM, SPACE_DIM &gt;::GetBoundaryNodeIteratorBegin()</a>, <a class="el" href="AbstractMesh_8cpp_source.html#l00171">AbstractMesh&lt; ELEMENT_DIM, SPACE_DIM &gt;::GetBoundaryNodeIteratorEnd()</a>, <a class="el" href="AbstractTetrahedralMesh_8hpp_source.html#l00718">AbstractTetrahedralMesh&lt; ELEMENT_DIM, SPACE_DIM &gt;::GetElementIteratorBegin()</a>, <a class="el" href="AbstractTetrahedralMesh_8hpp_source.html#l00725">AbstractTetrahedralMesh&lt; ELEMENT_DIM, SPACE_DIM &gt;::GetElementIteratorEnd()</a>, <a class="el" href="AbstractMesh_8cpp_source.html#l00093">AbstractMesh&lt; ELEMENT_DIM, SPACE_DIM &gt;::GetNode()</a>, <a class="el" href="AbstractMesh_8cpp_source.html#l00072">AbstractMesh&lt; ELEMENT_DIM, SPACE_DIM &gt;::GetNumBoundaryNodes()</a>, <a class="el" href="AbstractTetrahedralMesh_8cpp_source.html#l00088">AbstractTetrahedralMesh&lt; ELEMENT_DIM, SPACE_DIM &gt;::GetNumElements()</a>, <a class="el" href="AbstractMesh_8cpp_source.html#l00066">AbstractMesh&lt; ELEMENT_DIM, SPACE_DIM &gt;::GetNumNodes()</a>, <a class="el" href="Node_8cpp_source.html#l00160">Node&lt; SPACE_DIM &gt;::IsBoundaryNode()</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00059">mMesh</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00060">mOutletNodeIndex</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00103">mTerminalFluxChangeVector</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00099">mTerminalInteractionMatrix</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00105">mTerminalKspSolver</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00104">mTerminalPressureChangeVector</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00101">mTerminalToEdgeIndex</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00100">mTerminalToNodeIndex</a>, and <a class="el" href="PetscMatTools_8cpp_source.html#l00321">PetscMatTools::SetOption()</a>.</p>

<p>Referenced by <a class="el" href="VentilationProblem_8cpp_source.html#l00237">SolveIterativelyFromPressure()</a>.</p>

</div>
</div>
<a class="anchor" id="a21d3cb8736aa23cd9440eb92a570b2ae"></a><!-- doxytag: member="VentilationProblem::SetViscosity" ref="a21d3cb8736aa23cd9440eb92a570b2ae" args="(double viscosity)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void VentilationProblem::SetViscosity </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classdouble.html">double</a>&nbsp;</td>
          <td class="paramname"> <em>viscosity</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>viscosity</em>&nbsp;</td><td>the viscosity in kg/(mm*sec) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="VentilationProblem_8hpp_source.html#l00306">306</a> of file <a class="el" href="VentilationProblem_8hpp_source.html">VentilationProblem.hpp</a>.</p>

<p>References <a class="el" href="VentilationProblem_8hpp_source.html#l00072">mViscosity</a>.</p>

<p>Referenced by <a class="el" href="VentilationProblem_8cpp_source.html#l00596">SolveProblemFromFile()</a>.</p>

</div>
</div>
<a class="anchor" id="aa630a54c2f38ad1405de993a2ba0b2f5"></a><!-- doxytag: member="VentilationProblem::Solve" ref="aa630a54c2f38ad1405de993a2ba0b2f5" args="(TimeStepper &amp;rTimeStepper, void(*pBoundaryConditionFunction)(VentilationProblem *, TimeStepper &amp;rTimeStepper, const Node&lt; 3 &gt; &amp;), const std::string &amp;rDirName, const std::string &amp;rFileBaseName)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void VentilationProblem::Solve </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTimeStepper.html">TimeStepper</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>rTimeStepper</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(<a class="el" href="classVentilationProblem.html">VentilationProblem</a> *, <a class="el" href="classTimeStepper.html">TimeStepper</a> &amp;rTimeStepper, const <a class="el" href="classNode.html">Node</a>&lt; 3 &gt; &amp;)&nbsp;</td>
          <td class="paramname"> <em>pBoundaryConditionFunction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&nbsp;</td>
          <td class="paramname"> <em>rDirName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&nbsp;</td>
          <td class="paramname"> <em>rFileBaseName</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Assemble the linear system by writing in * flux balance at the nodes * Poiseuille flow in the edges</p>
<p>Solve the linear system repeatedly </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>rTimeStepper</em>&nbsp;</td><td>The start, end and time-step </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pBoundaryConditionFunction</em>&nbsp;</td><td>setter </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rDirName</em>&nbsp;</td><td>A directory name relative to CHASTE_TEST_OUTPUT. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rFileBaseName</em>&nbsp;</td><td>The base name of the new VTK file. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="VentilationProblem_8cpp_source.html#l00550">550</a> of file <a class="el" href="VentilationProblem_8cpp_source.html">VentilationProblem.cpp</a>.</p>

<p>References <a class="el" href="VentilationProblem_8cpp_source.html#l00522">AddDataToVtk()</a>, <a class="el" href="TimeStepper_8cpp_source.html#l00123">TimeStepper::AdvanceOneTimeStep()</a>, <a class="el" href="AbstractMesh_8cpp_source.html#l00165">AbstractMesh&lt; ELEMENT_DIM, SPACE_DIM &gt;::GetBoundaryNodeIteratorBegin()</a>, <a class="el" href="AbstractMesh_8cpp_source.html#l00171">AbstractMesh&lt; ELEMENT_DIM, SPACE_DIM &gt;::GetBoundaryNodeIteratorEnd()</a>, <a class="el" href="TimeStepper_8cpp_source.html#l00175">TimeStepper::GetTotalTimeStepsTaken()</a>, <a class="el" href="TimeStepper_8cpp_source.html#l00165">TimeStepper::IsTimeAtEnd()</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00059">mMesh</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00060">mOutletNodeIndex</a>, <a class="el" href="VentilationProblem_8cpp_source.html#l00479">Solve()</a>, and <a class="el" href="VtkMeshWriter_8cpp_source.html#l00601">VtkMeshWriter&lt; ELEMENT_DIM, SPACE_DIM &gt;::WriteFilesUsingMesh()</a>.</p>

</div>
</div>
<a class="anchor" id="ab6c015101d181cd3fd618f291ccfc793"></a><!-- doxytag: member="VentilationProblem::Solve" ref="ab6c015101d181cd3fd618f291ccfc793" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void VentilationProblem::Solve </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Solve the linear system either * directly from fluxes * iteratively from pressures </p>

<p>Definition at line <a class="el" href="VentilationProblem_8cpp_source.html#l00479">479</a> of file <a class="el" href="VentilationProblem_8cpp_source.html">VentilationProblem.cpp</a>.</p>

<p>References <a class="el" href="VentilationProblem_8hpp_source.html#l00089">mFluxGivenAtInflow</a>, <a class="el" href="VentilationProblem_8cpp_source.html#l00122">SolveDirectFromFlux()</a>, and <a class="el" href="VentilationProblem_8cpp_source.html#l00237">SolveIterativelyFromPressure()</a>.</p>

<p>Referenced by <a class="el" href="VentilationProblem_8cpp_source.html#l00550">Solve()</a>, and <a class="el" href="VentilationProblem_8cpp_source.html#l00596">SolveProblemFromFile()</a>.</p>

</div>
</div>
<a class="anchor" id="a2c575973b61836934107e9bf7b069ef7"></a><!-- doxytag: member="VentilationProblem::SolveDirectFromFlux" ref="a2c575973b61836934107e9bf7b069ef7" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void VentilationProblem::SolveDirectFromFlux </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Use flux boundary conditions at leaves (and pressure condition at root) to perform a direct solve. This involves * solving directly for parent flux up the tree (using flux balance at each node) * solving for child pressure (using Poiseuille or Pedley resistance) down the tree </p>

<p>Definition at line <a class="el" href="VentilationProblem_8cpp_source.html#l00122">122</a> of file <a class="el" href="VentilationProblem_8cpp_source.html">VentilationProblem.cpp</a>.</p>

<p>References <a class="el" href="VentilationProblem_8cpp_source.html#l00351">CalculateResistance()</a>, <a class="el" href="Node_8hpp_source.html#l00466">Node&lt; SPACE_DIM &gt;::ContainingElementsBegin()</a>, <a class="el" href="Node_8hpp_source.html#l00474">Node&lt; SPACE_DIM &gt;::ContainingElementsEnd()</a>, <a class="el" href="AbstractTetrahedralMesh_8hpp_source.html#l00718">AbstractTetrahedralMesh&lt; ELEMENT_DIM, SPACE_DIM &gt;::GetElementIteratorBegin()</a>, <a class="el" href="AbstractTetrahedralMesh_8hpp_source.html#l00725">AbstractTetrahedralMesh&lt; ELEMENT_DIM, SPACE_DIM &gt;::GetElementIteratorEnd()</a>, <a class="el" href="AbstractMesh_8cpp_source.html#l00093">AbstractMesh&lt; ELEMENT_DIM, SPACE_DIM &gt;::GetNode()</a>, <a class="el" href="AbstractMesh_8cpp_source.html#l00066">AbstractMesh&lt; ELEMENT_DIM, SPACE_DIM &gt;::GetNumNodes()</a>, <a class="el" href="Node_8cpp_source.html#l00160">Node&lt; SPACE_DIM &gt;::IsBoundaryNode()</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00061">mDynamicResistance</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00086">mFlux</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00059">mMesh</a>, and <a class="el" href="VentilationProblem_8hpp_source.html#l00087">mPressure</a>.</p>

<p>Referenced by <a class="el" href="VentilationProblem_8cpp_source.html#l00479">Solve()</a>, and <a class="el" href="VentilationProblem_8cpp_source.html#l00237">SolveIterativelyFromPressure()</a>.</p>

</div>
</div>
<a class="anchor" id="ae3f3ffd948e38306375ef81071ea3aae"></a><!-- doxytag: member="VentilationProblem::SolveIterativelyFromPressure" ref="ae3f3ffd948e38306375ef81071ea3aae" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void VentilationProblem::SolveIterativelyFromPressure </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Use pressure boundary conditions at leaves (and pressure condition at root) to perform convert to flux boundary conditions (assuming Poiseuille flow) and then perform a direct solve with <a class="el" href="classVentilationProblem.html#a2c575973b61836934107e9bf7b069ef7">SolveDirectFromFlux()</a>. Note that pressure to flux conversion requires accumulation of the resistance down the tree since weighted_sum(resistance)*flux = delta pressure.</p>
<p>Note in the mDynamicResistance case we ignore dynamic resistance when setting up the weighted sum of resistances. However, since we use dynamic resistance in <a class="el" href="classVentilationProblem.html#a2c575973b61836934107e9bf7b069ef7">SolveDirectFromFlux()</a> the solution will converge to the one which uses dynamic resistance, despite the flux corrections being slightly off. </p>

<p>Definition at line <a class="el" href="VentilationProblem_8cpp_source.html#l00237">237</a> of file <a class="el" href="VentilationProblem_8cpp_source.html">VentilationProblem.cpp</a>.</p>

<p>References <a class="el" href="AbstractMesh_8cpp_source.html#l00072">AbstractMesh&lt; ELEMENT_DIM, SPACE_DIM &gt;::GetNumBoundaryNodes()</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00086">mFlux</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00059">mMesh</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00060">mOutletNodeIndex</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00087">mPressure</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00088">mPressureCondition</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00103">mTerminalFluxChangeVector</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00099">mTerminalInteractionMatrix</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00105">mTerminalKspSolver</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00104">mTerminalPressureChangeVector</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00101">mTerminalToEdgeIndex</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00100">mTerminalToNodeIndex</a>, <a class="el" href="Exception_8hpp_source.html#l00206">NEVER_REACHED</a>, <a class="el" href="VentilationProblem_8cpp_source.html#l00162">SetupIterativeSolver()</a>, and <a class="el" href="VentilationProblem_8cpp_source.html#l00122">SolveDirectFromFlux()</a>.</p>

<p>Referenced by <a class="el" href="VentilationProblem_8cpp_source.html#l00479">Solve()</a>.</p>

</div>
</div>
<a class="anchor" id="ab8163ab73a591f571cced49ccb6934fe"></a><!-- doxytag: member="VentilationProblem::SolveProblemFromFile" ref="ab8163ab73a591f571cced49ccb6934fe" args="(const std::string &amp;rInFilePath, const std::string &amp;rOutFileDir, const std::string &amp;rOutFileName)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void VentilationProblem::SolveProblemFromFile </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&nbsp;</td>
          <td class="paramname"> <em>rInFilePath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&nbsp;</td>
          <td class="paramname"> <em>rOutFileDir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&nbsp;</td>
          <td class="paramname"> <em>rOutFileName</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Read a problem definition from a file and use then solve that problem</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>rInFilePath</em>&nbsp;</td><td>Path to file which contains the problem definition </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rOutFileDir</em>&nbsp;</td><td>Path to folder for output (relative to CHASTE_TEST_OUTPUT) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rOutFileName</em>&nbsp;</td><td>Name for VTK output </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="VentilationProblem_8cpp_source.html#l00596">596</a> of file <a class="el" href="VentilationProblem_8cpp_source.html">VentilationProblem.cpp</a>.</p>

<p>References <a class="el" href="Exception_8hpp_source.html#l00143">EXCEPTION</a>, <a class="el" href="VentilationProblem_8cpp_source.html#l00408">SetConstantInflowPressures()</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00322">SetDensity()</a>, <a class="el" href="VentilationProblem_8cpp_source.html#l00402">SetOutflowPressure()</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00306">SetViscosity()</a>, <a class="el" href="VentilationProblem_8cpp_source.html#l00479">Solve()</a>, and <a class="el" href="VentilationProblem_8cpp_source.html#l00514">WriteVtk()</a>.</p>

</div>
</div>
<a class="anchor" id="a357ef935c73b1b28db975a4ec1315e42"></a><!-- doxytag: member="VentilationProblem::WriteVtk" ref="a357ef935c73b1b28db975a4ec1315e42" args="(const std::string &amp;rDirName, const std::string &amp;rFileBaseName)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void VentilationProblem::WriteVtk </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&nbsp;</td>
          <td class="paramname"> <em>rDirName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&nbsp;</td>
          <td class="paramname"> <em>rFileBaseName</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Output the solution to a Vtk file </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>rDirName</em>&nbsp;</td><td>A directory name relative to CHASTE_TEST_OUTPUT. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rFileBaseName</em>&nbsp;</td><td>The base name of the new VTK file. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="VentilationProblem_8cpp_source.html#l00514">514</a> of file <a class="el" href="VentilationProblem_8cpp_source.html">VentilationProblem.cpp</a>.</p>

<p>References <a class="el" href="VentilationProblem_8cpp_source.html#l00522">AddDataToVtk()</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00059">mMesh</a>, and <a class="el" href="VtkMeshWriter_8cpp_source.html#l00601">VtkMeshWriter&lt; ELEMENT_DIM, SPACE_DIM &gt;::WriteFilesUsingMesh()</a>.</p>

<p>Referenced by <a class="el" href="VentilationProblem_8cpp_source.html#l00596">SolveProblemFromFile()</a>.</p>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="ae1bc7405949e6edc297fa0fa8eb2ca7c"></a><!-- doxytag: member="VentilationProblem::mAcinarUnits" ref="ae1bc7405949e6edc297fa0fa8eb2ca7c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;<a class="el" href="classunsigned.html">unsigned</a>, <a class="el" href="classSwan2012AcinarUnit.html">Swan2012AcinarUnit</a>*&gt; <a class="el" href="classVentilationProblem.html#ae1bc7405949e6edc297fa0fa8eb2ca7c">VentilationProblem::mAcinarUnits</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>One acinar unit for each terminal node. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000224">Todo:</a></b></dt><dd>These will be abstract </dd></dl>

<p>Definition at line <a class="el" href="VentilationProblem_8hpp_source.html#l00085">85</a> of file <a class="el" href="VentilationProblem_8hpp_source.html">VentilationProblem.hpp</a>.</p>

<p>Referenced by <a class="el" href="VentilationProblem_8cpp_source.html#l00522">AddDataToVtk()</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00339">GetAcinus()</a>, <a class="el" href="VentilationProblem_8cpp_source.html#l00041">VentilationProblem()</a>, and <a class="el" href="VentilationProblem_8cpp_source.html#l00106">~VentilationProblem()</a>.</p>

</div>
</div>
<a class="anchor" id="a52bc930a7ca6a552b6cce4e2adc355dc"></a><!-- doxytag: member="VentilationProblem::mDensity" ref="a52bc930a7ca6a552b6cce4e2adc355dc" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classdouble.html">double</a> <a class="el" href="classVentilationProblem.html#a52bc930a7ca6a552b6cce4e2adc355dc">VentilationProblem::mDensity</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Density in kg/(mm^3). rho (for dry air) ~ 1.2041 kg/m^3 = 1.2e-9 kg/mm^3 Default to Swan (page 224) rho = 1.51e-6 g/mm^3 &lt;-- USED HERE = 1.51e-9 kg/mm^3 = 1.51e-6 kg/(m s^2) * s^2 / (mm)^2</p>
<ul>
<li>1.51e-6 Pa s^2 /mm^2 This is used in the dynamic (Pedley) resistance calculation </li>
</ul>

<p>Definition at line <a class="el" href="VentilationProblem_8hpp_source.html#l00083">83</a> of file <a class="el" href="VentilationProblem_8hpp_source.html">VentilationProblem.hpp</a>.</p>

<p>Referenced by <a class="el" href="VentilationProblem_8cpp_source.html#l00351">CalculateResistance()</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00314">GetDensity()</a>, and <a class="el" href="VentilationProblem_8hpp_source.html#l00322">SetDensity()</a>.</p>

</div>
</div>
<a class="anchor" id="ae21fc3761feb9208d0666904964b75cf"></a><!-- doxytag: member="VentilationProblem::mDynamicResistance" ref="ae21fc3761feb9208d0666904964b75cf" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> <a class="el" href="classVentilationProblem.html#ae21fc3761feb9208d0666904964b75cf">VentilationProblem::mDynamicResistance</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Use dynamic (flux related) resistance and a nonlinear solver </p>

<p>Definition at line <a class="el" href="VentilationProblem_8hpp_source.html#l00061">61</a> of file <a class="el" href="VentilationProblem_8hpp_source.html">VentilationProblem.hpp</a>.</p>

<p>Referenced by <a class="el" href="VentilationProblem_8hpp_source.html#l00330">SetDynamicResistance()</a>, and <a class="el" href="VentilationProblem_8cpp_source.html#l00122">SolveDirectFromFlux()</a>.</p>

</div>
</div>
<a class="anchor" id="a5e27482175fbf2f8e67482ff69d96a97"></a><!-- doxytag: member="VentilationProblem::mFlux" ref="a5e27482175fbf2f8e67482ff69d96a97" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="classdouble.html">double</a>&gt; <a class="el" href="classVentilationProblem.html#a5e27482175fbf2f8e67482ff69d96a97">VentilationProblem::mFlux</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Used to hold the flux solution (and boundary conditions) in edge index ordering </p>

<p>Definition at line <a class="el" href="VentilationProblem_8hpp_source.html#l00086">86</a> of file <a class="el" href="VentilationProblem_8hpp_source.html">VentilationProblem.hpp</a>.</p>

<p>Referenced by <a class="el" href="VentilationProblem_8cpp_source.html#l00457">GetFluxAtOutflow()</a>, <a class="el" href="VentilationProblem_8cpp_source.html#l00493">GetSolutionAsFluxesAndPressures()</a>, <a class="el" href="VentilationProblem_8cpp_source.html#l00462">SetFluxAtBoundaryNode()</a>, <a class="el" href="VentilationProblem_8cpp_source.html#l00122">SolveDirectFromFlux()</a>, <a class="el" href="VentilationProblem_8cpp_source.html#l00237">SolveIterativelyFromPressure()</a>, and <a class="el" href="VentilationProblem_8cpp_source.html#l00041">VentilationProblem()</a>.</p>

</div>
</div>
<a class="anchor" id="adb1f5846c4b030b619647fbbd2633bb6"></a><!-- doxytag: member="VentilationProblem::mFluxGivenAtInflow" ref="adb1f5846c4b030b619647fbbd2633bb6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> <a class="el" href="classVentilationProblem.html#adb1f5846c4b030b619647fbbd2633bb6">VentilationProblem::mFluxGivenAtInflow</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Used to switch solution methods. If the flux is given at the boundary then the entire system can be solved directly by back substitution. </p>

<p>Definition at line <a class="el" href="VentilationProblem_8hpp_source.html#l00089">89</a> of file <a class="el" href="VentilationProblem_8hpp_source.html">VentilationProblem.hpp</a>.</p>

<p>Referenced by <a class="el" href="VentilationProblem_8cpp_source.html#l00462">SetFluxAtBoundaryNode()</a>, <a class="el" href="VentilationProblem_8cpp_source.html#l00435">SetPressureAtBoundaryNode()</a>, and <a class="el" href="VentilationProblem_8cpp_source.html#l00479">Solve()</a>.</p>

</div>
</div>
<a class="anchor" id="a38146569a445ada1f66525522f4a3d72"></a><!-- doxytag: member="VentilationProblem::mMesh" ref="a38146569a445ada1f66525522f4a3d72" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTetrahedralMesh.html">TetrahedralMesh</a>&lt;1,3&gt; <a class="el" href="classVentilationProblem.html#a38146569a445ada1f66525522f4a3d72">VentilationProblem::mMesh</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The 1d in 3d branching tree mesh </p>

<p>Definition at line <a class="el" href="VentilationProblem_8hpp_source.html#l00059">59</a> of file <a class="el" href="VentilationProblem_8hpp_source.html">VentilationProblem.hpp</a>.</p>

<p>Referenced by <a class="el" href="VentilationProblem_8cpp_source.html#l00522">AddDataToVtk()</a>, <a class="el" href="VentilationProblem_8cpp_source.html#l00351">CalculateResistance()</a>, <a class="el" href="VentilationProblem_8cpp_source.html#l00506">rGetMesh()</a>, <a class="el" href="VentilationProblem_8cpp_source.html#l00422">SetConstantInflowFluxes()</a>, <a class="el" href="VentilationProblem_8cpp_source.html#l00408">SetConstantInflowPressures()</a>, <a class="el" href="VentilationProblem_8cpp_source.html#l00402">SetOutflowPressure()</a>, <a class="el" href="VentilationProblem_8cpp_source.html#l00162">SetupIterativeSolver()</a>, <a class="el" href="VentilationProblem_8cpp_source.html#l00550">Solve()</a>, <a class="el" href="VentilationProblem_8cpp_source.html#l00122">SolveDirectFromFlux()</a>, <a class="el" href="VentilationProblem_8cpp_source.html#l00237">SolveIterativelyFromPressure()</a>, <a class="el" href="VentilationProblem_8cpp_source.html#l00041">VentilationProblem()</a>, and <a class="el" href="VentilationProblem_8cpp_source.html#l00514">WriteVtk()</a>.</p>

</div>
</div>
<a class="anchor" id="ad3a5bb97f2a693d4f6da00065aaca53b"></a><!-- doxytag: member="VentilationProblem::mOutletNodeIndex" ref="ad3a5bb97f2a693d4f6da00065aaca53b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classunsigned.html">unsigned</a> <a class="el" href="classVentilationProblem.html#ad3a5bb97f2a693d4f6da00065aaca53b">VentilationProblem::mOutletNodeIndex</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The outlet node is the root of the branching tree structure </p>

<p>Definition at line <a class="el" href="VentilationProblem_8hpp_source.html#l00060">60</a> of file <a class="el" href="VentilationProblem_8hpp_source.html">VentilationProblem.hpp</a>.</p>

<p>Referenced by <a class="el" href="VentilationProblem_8cpp_source.html#l00522">AddDataToVtk()</a>, <a class="el" href="VentilationProblem_8cpp_source.html#l00457">GetFluxAtOutflow()</a>, <a class="el" href="VentilationProblem_8cpp_source.html#l00422">SetConstantInflowFluxes()</a>, <a class="el" href="VentilationProblem_8cpp_source.html#l00408">SetConstantInflowPressures()</a>, <a class="el" href="VentilationProblem_8cpp_source.html#l00402">SetOutflowPressure()</a>, <a class="el" href="VentilationProblem_8cpp_source.html#l00162">SetupIterativeSolver()</a>, <a class="el" href="VentilationProblem_8cpp_source.html#l00550">Solve()</a>, <a class="el" href="VentilationProblem_8cpp_source.html#l00237">SolveIterativelyFromPressure()</a>, and <a class="el" href="VentilationProblem_8cpp_source.html#l00041">VentilationProblem()</a>.</p>

</div>
</div>
<a class="anchor" id="a111916474fd4d6b5964546fe05f6985b"></a><!-- doxytag: member="VentilationProblem::mPressure" ref="a111916474fd4d6b5964546fe05f6985b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="classdouble.html">double</a>&gt; <a class="el" href="classVentilationProblem.html#a111916474fd4d6b5964546fe05f6985b">VentilationProblem::mPressure</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Used to hold the pressure solution (and outlet boundary pressure) in node index ordering). </p>

<p>Definition at line <a class="el" href="VentilationProblem_8hpp_source.html#l00087">87</a> of file <a class="el" href="VentilationProblem_8hpp_source.html">VentilationProblem.hpp</a>.</p>

<p>Referenced by <a class="el" href="VentilationProblem_8cpp_source.html#l00447">GetPressureAtBoundaryNode()</a>, <a class="el" href="VentilationProblem_8cpp_source.html#l00493">GetSolutionAsFluxesAndPressures()</a>, <a class="el" href="VentilationProblem_8cpp_source.html#l00402">SetOutflowPressure()</a>, <a class="el" href="VentilationProblem_8cpp_source.html#l00122">SolveDirectFromFlux()</a>, <a class="el" href="VentilationProblem_8cpp_source.html#l00237">SolveIterativelyFromPressure()</a>, and <a class="el" href="VentilationProblem_8cpp_source.html#l00041">VentilationProblem()</a>.</p>

</div>
</div>
<a class="anchor" id="a53ecea60b72aedec5b9e66290cec2753"></a><!-- doxytag: member="VentilationProblem::mPressureCondition" ref="a53ecea60b72aedec5b9e66290cec2753" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;<a class="el" href="classunsigned.html">unsigned</a>, <a class="el" href="classdouble.html">double</a>&gt; <a class="el" href="classVentilationProblem.html#a53ecea60b72aedec5b9e66290cec2753">VentilationProblem::mPressureCondition</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Pressure boundary conditions at terminal nodes. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000225">Todo:</a></b></dt><dd>This could be a vector and/or share a map with the acinar units. </dd></dl>

<p>Definition at line <a class="el" href="VentilationProblem_8hpp_source.html#l00088">88</a> of file <a class="el" href="VentilationProblem_8hpp_source.html">VentilationProblem.hpp</a>.</p>

<p>Referenced by <a class="el" href="VentilationProblem_8cpp_source.html#l00435">SetPressureAtBoundaryNode()</a>, and <a class="el" href="VentilationProblem_8cpp_source.html#l00237">SolveIterativelyFromPressure()</a>.</p>

</div>
</div>
<a class="anchor" id="ae91e18e83b3826cd04c3382477503153"></a><!-- doxytag: member="VentilationProblem::mRadiusOnEdge" ref="ae91e18e83b3826cd04c3382477503153" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> <a class="el" href="classVentilationProblem.html#ae91e18e83b3826cd04c3382477503153">VentilationProblem::mRadiusOnEdge</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>False by default (conical pipes with radius defined at nodes). When true pipes are cylindrical. </p>

<p>Definition at line <a class="el" href="VentilationProblem_8hpp_source.html#l00062">62</a> of file <a class="el" href="VentilationProblem_8hpp_source.html">VentilationProblem.hpp</a>.</p>

<p>Referenced by <a class="el" href="VentilationProblem_8cpp_source.html#l00351">CalculateResistance()</a>, and <a class="el" href="VentilationProblem_8cpp_source.html#l00501">SetRadiusOnEdge()</a>.</p>

</div>
</div>
<a class="anchor" id="a232fe1388eac63d75a945d51c64caf16"></a><!-- doxytag: member="VentilationProblem::mTerminalFluxChangeVector" ref="a232fe1388eac63d75a945d51c64caf16" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classVec.html">Vec</a> <a class="el" href="classVentilationProblem.html#a232fe1388eac63d75a945d51c64caf16">VentilationProblem::mTerminalFluxChangeVector</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Used as the output of the mTerminalInteractionMatrix terminal pressure to flux solver </p>

<p>Definition at line <a class="el" href="VentilationProblem_8hpp_source.html#l00103">103</a> of file <a class="el" href="VentilationProblem_8hpp_source.html">VentilationProblem.hpp</a>.</p>

<p>Referenced by <a class="el" href="VentilationProblem_8cpp_source.html#l00162">SetupIterativeSolver()</a>, <a class="el" href="VentilationProblem_8cpp_source.html#l00237">SolveIterativelyFromPressure()</a>, and <a class="el" href="VentilationProblem_8cpp_source.html#l00106">~VentilationProblem()</a>.</p>

</div>
</div>
<a class="anchor" id="a8c76fdf7a8b46d26f442532080f77a19"></a><!-- doxytag: member="VentilationProblem::mTerminalInteractionMatrix" ref="a8c76fdf7a8b46d26f442532080f77a19" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMat.html">Mat</a> <a class="el" href="classVentilationProblem.html#a8c76fdf7a8b46d26f442532080f77a19">VentilationProblem::mTerminalInteractionMatrix</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The symmetric matrix is an estimate of the dense matrix system which determines how flux changes at terminal nodes are reflected in pressure changes at terminals in the form P_{terminal} = A Q_{terminal}. Each entry in the dense matrix (for Poiseuille flow) is the sum of the resistances of all pipes which are common ancestors of a pair of terminals. In order to iteratively match pressure conditions we must invert this equation. </p>

<p>Definition at line <a class="el" href="VentilationProblem_8hpp_source.html#l00099">99</a> of file <a class="el" href="VentilationProblem_8hpp_source.html">VentilationProblem.hpp</a>.</p>

<p>Referenced by <a class="el" href="VentilationProblem_8cpp_source.html#l00162">SetupIterativeSolver()</a>, <a class="el" href="VentilationProblem_8cpp_source.html#l00237">SolveIterativelyFromPressure()</a>, and <a class="el" href="VentilationProblem_8cpp_source.html#l00106">~VentilationProblem()</a>.</p>

</div>
</div>
<a class="anchor" id="a1f4ac55af568a631b382237148a1e1a9"></a><!-- doxytag: member="VentilationProblem::mTerminalKspSolver" ref="a1f4ac55af568a631b382237148a1e1a9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">KSP <a class="el" href="classVentilationProblem.html#a1f4ac55af568a631b382237148a1e1a9">VentilationProblem::mTerminalKspSolver</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The linear solver for the mTerminalInteractionMatrix terminal pressure to flux solver </p>

<p>Definition at line <a class="el" href="VentilationProblem_8hpp_source.html#l00105">105</a> of file <a class="el" href="VentilationProblem_8hpp_source.html">VentilationProblem.hpp</a>.</p>

<p>Referenced by <a class="el" href="VentilationProblem_8cpp_source.html#l00162">SetupIterativeSolver()</a>, <a class="el" href="VentilationProblem_8cpp_source.html#l00237">SolveIterativelyFromPressure()</a>, and <a class="el" href="VentilationProblem_8cpp_source.html#l00106">~VentilationProblem()</a>.</p>

</div>
</div>
<a class="anchor" id="a075d333725467d6471f3920e0c6b9fd6"></a><!-- doxytag: member="VentilationProblem::mTerminalPressureChangeVector" ref="a075d333725467d6471f3920e0c6b9fd6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classVec.html">Vec</a> <a class="el" href="classVentilationProblem.html#a075d333725467d6471f3920e0c6b9fd6">VentilationProblem::mTerminalPressureChangeVector</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Used as the input of the mTerminalInteractionMatrix terminal pressure to flux solver </p>

<p>Definition at line <a class="el" href="VentilationProblem_8hpp_source.html#l00104">104</a> of file <a class="el" href="VentilationProblem_8hpp_source.html">VentilationProblem.hpp</a>.</p>

<p>Referenced by <a class="el" href="VentilationProblem_8cpp_source.html#l00162">SetupIterativeSolver()</a>, <a class="el" href="VentilationProblem_8cpp_source.html#l00237">SolveIterativelyFromPressure()</a>, and <a class="el" href="VentilationProblem_8cpp_source.html#l00106">~VentilationProblem()</a>.</p>

</div>
</div>
<a class="anchor" id="aaed6278170538deb670547534cadd607"></a><!-- doxytag: member="VentilationProblem::mTerminalToEdgeIndex" ref="aaed6278170538deb670547534cadd607" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;<a class="el" href="classunsigned.html">unsigned</a>, <a class="el" href="classunsigned.html">unsigned</a>&gt; <a class="el" href="classVentilationProblem.html#aaed6278170538deb670547534cadd607">VentilationProblem::mTerminalToEdgeIndex</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>A mapping from the indexing scheme used in the mTerminalInteractionMatrix to the full mesh element indexing </p>

<p>Definition at line <a class="el" href="VentilationProblem_8hpp_source.html#l00101">101</a> of file <a class="el" href="VentilationProblem_8hpp_source.html">VentilationProblem.hpp</a>.</p>

<p>Referenced by <a class="el" href="VentilationProblem_8cpp_source.html#l00162">SetupIterativeSolver()</a>, and <a class="el" href="VentilationProblem_8cpp_source.html#l00237">SolveIterativelyFromPressure()</a>.</p>

</div>
</div>
<a class="anchor" id="a9c93247f566cf68625a459b8f07dc83b"></a><!-- doxytag: member="VentilationProblem::mTerminalToNodeIndex" ref="a9c93247f566cf68625a459b8f07dc83b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;<a class="el" href="classunsigned.html">unsigned</a>, <a class="el" href="classunsigned.html">unsigned</a>&gt; <a class="el" href="classVentilationProblem.html#a9c93247f566cf68625a459b8f07dc83b">VentilationProblem::mTerminalToNodeIndex</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>A mapping from the indexing scheme used in the mTerminalInteractionMatrix to the full mesh node indexing </p>

<p>Definition at line <a class="el" href="VentilationProblem_8hpp_source.html#l00100">100</a> of file <a class="el" href="VentilationProblem_8hpp_source.html">VentilationProblem.hpp</a>.</p>

<p>Referenced by <a class="el" href="VentilationProblem_8cpp_source.html#l00162">SetupIterativeSolver()</a>, and <a class="el" href="VentilationProblem_8cpp_source.html#l00237">SolveIterativelyFromPressure()</a>.</p>

</div>
</div>
<a class="anchor" id="abd8e8f61905f489fb5d43a75797788f2"></a><!-- doxytag: member="VentilationProblem::mViscosity" ref="abd8e8f61905f489fb5d43a75797788f2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classdouble.html">double</a> <a class="el" href="classVentilationProblem.html#abd8e8f61905f489fb5d43a75797788f2">VentilationProblem::mViscosity</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>(Dynamic) viscosity in kg/(mm*second). Default to value from Swan et al. 2012. 10.1016/j.jtbi.2012.01.042 (page 224) mu = 1.92e-5 Pa*s &lt;-- USED HERE = 1.92e-5 kg/(m*s) = 1.92e-8 kg/(mm*s) or kPa.s Consider <a href="http://en.wikipedia.org/wiki/Viscosity#Air">http://en.wikipedia.org/wiki/Viscosity#Air</a> which gives mu = 1.81x10^(-5) kg/(m*s) -- 1.86x10^(-5) kg/(m*s) </p>

<p>Definition at line <a class="el" href="VentilationProblem_8hpp_source.html#l00072">72</a> of file <a class="el" href="VentilationProblem_8hpp_source.html">VentilationProblem.hpp</a>.</p>

<p>Referenced by <a class="el" href="VentilationProblem_8cpp_source.html#l00351">CalculateResistance()</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00298">GetViscosity()</a>, <a class="el" href="VentilationProblem_8hpp_source.html#l00306">SetViscosity()</a>, and <a class="el" href="VentilationProblem_8cpp_source.html#l00041">VentilationProblem()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>continuum_mechanics/src/ventilation/<a class="el" href="VentilationProblem_8hpp_source.html">VentilationProblem.hpp</a></li>
<li>continuum_mechanics/src/ventilation/<a class="el" href="VentilationProblem_8cpp_source.html">VentilationProblem.cpp</a></li>
</ul>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.2 </small></address>
</body>
</html>
