<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Chaste: AbstractCvodeSystem Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.2 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="classes.html"><span>Class&nbsp;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>AbstractCvodeSystem Class Reference</h1><!-- doxytag: class="AbstractCvodeSystem" --><!-- doxytag: inherits="AbstractParameterisedSystem&lt; N_Vector &gt;" -->
<p><code>#include &lt;<a class="el" href="AbstractCvodeSystem_8hpp_source.html">AbstractCvodeSystem.hpp</a>&gt;</code></p>

<p>Inherits <a class="el" href="classAbstractParameterisedSystem.html">AbstractParameterisedSystem&lt; N_Vector &gt;</a>.</p>

<p>Inherited by <a class="el" href="classAbstractCvodeCell.html">AbstractCvodeCell</a>.</p>
<div class="dynheader">
Collaboration diagram for AbstractCvodeSystem:</div>
<div class="dynsection">
<div class="center"><img src="classAbstractCvodeSystem__coll__graph.png" border="0" usemap="#AbstractCvodeSystem_coll__map" alt="Collaboration graph"/></div>
<map name="AbstractCvodeSystem_coll__map" id="AbstractCvodeSystem_coll__map">
<area shape="rect" id="node2" href="classAbstractParameterisedSystem.html" title="{AbstractParameterisedSystem\&lt; N_Vector \&gt;\n|# mStateVariables\l# mParameters\l|+ AbstractParameterisedSystem()\l+ rGetStateVariables()\l+ GetStateVariables()\l+ SetStateVariables()\l+ GetStateVariable()\l+ GetStateVariable()\l+ SetStateVariable()\l+ SetStateVariable()\l+ VerifyStateVariables()\l+ SetDefaultInitialConditions()\l+ SetDefaultInitialCondition()\l+ GetInitialConditions()\l+ ResetToInitialConditions()\l+ GetParameter()\l+ GetParameter()\l+ SetParameter()\l+ SetParameter()\l+ GetAnyVariable()\l+ GetAnyVariable()\l+ SetAnyVariable()\l+ SetAnyVariable()\l+ ComputeDerivedQuantities()\l+ ComputeDerivedQuantitiesFromCurrentState()\l# DumpState()\l# DumpState()\l# CheckParametersOnLoad()\l&#45; GetStateMessage()\l}" alt="" coords="184,1579,491,2173"/><area shape="rect" id="node4" href="classAbstractUntemplatedParameterisedSystem.html" title="{AbstractUntemplatedParameterisedSystem\n|# mNumberOfStateVariables\l# mpSystemInfo\l|+ AbstractUntemplatedParameterisedSystem()\l+ ~AbstractUntemplatedParameterisedSystem()\l+ GetSystemInformation()\l+ GetSystemName()\l+ GetNumberOfAttributes()\l+ HasAttribute()\l+ GetAttribute()\l+ GetNumberOfStateVariables()\l+ rGetStateVariableNames()\l+ rGetStateVariableUnits()\l+ GetStateVariableIndex()\l+ HasStateVariable()\l+ GetStateVariableUnits()\l+ ResetToInitialConditions()\l+ GetNumberOfParameters()\l+ rGetParameterNames()\l+ rGetParameterUnits()\l+ GetParameterIndex()\l+ HasParameter()\l+ GetParameterUnits()\l+ GetNumberOfDerivedQuantities()\l+ rGetDerivedQuantityNames()\l+ rGetDerivedQuantityUnits()\l+ GetDerivedQuantityIndex()\l+ HasDerivedQuantity()\l+ GetDerivedQuantityUnits()\l+ GetAnyVariableIndex()\l+ HasAnyVariable()\l+ GetAnyVariableUnits()\l+ GetAnyVariableUnits()\l}" alt="" coords="196,163,503,813"/><area shape="rect" id="node12" href="classAbstractParameterisedSystem.html" title="{AbstractParameterisedSystem\&lt; VECTOR \&gt;\n|# mStateVariables\l# mParameters\l|+ AbstractParameterisedSystem()\l+ rGetStateVariables()\l+ GetStateVariables()\l+ SetStateVariables()\l+ GetStateVariable()\l+ GetStateVariable()\l+ SetStateVariable()\l+ SetStateVariable()\l+ VerifyStateVariables()\l+ SetDefaultInitialConditions()\l+ SetDefaultInitialCondition()\l+ GetInitialConditions()\l+ ResetToInitialConditions()\l+ GetParameter()\l+ GetParameter()\l+ SetParameter()\l+ SetParameter()\l+ GetAnyVariable()\l+ GetAnyVariable()\l+ SetAnyVariable()\l+ SetAnyVariable()\l+ ComputeDerivedQuantities()\l+ ComputeDerivedQuantitiesFromCurrentState()\l# DumpState()\l# DumpState()\l# CheckParametersOnLoad()\l&#45; GetStateMessage()\l}" alt="" coords="5,899,312,1493"/><area shape="rect" id="node8" href="classunsigned.html" title="{unsigned\n||}" alt="" coords="415,6,492,95"/><area shape="rect" id="node10" href="classN__Vector.html" title="{N_Vector\n||}" alt="" coords="444,1151,519,1241"/><area shape="rect" id="node17" href="classdouble.html" title="{double\n||}" alt="" coords="679,1831,740,1921"/><area shape="rect" id="node20" href="classbool.html" title="{bool\n||}" alt="" coords="807,1831,855,1921"/></map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>

<p><a href="classAbstractCvodeSystem-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractCvodeSystem.html#a98f4dbff46f993d4fa5299bb1468cbc3">AbstractCvodeSystem</a> (<a class="el" href="classunsigned.html">unsigned</a> numberOfStateVariables)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractCvodeSystem.html#af9830f4dc6cc9311ece1aa15a18aa1e1">~AbstractCvodeSystem</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractCvodeSystem.html#ab4b9641b9d543471f3ea3dbaa4e78415">EvaluateYDerivatives</a> (realtype time, const <a class="el" href="classN__Vector.html">N_Vector</a> y, <a class="el" href="classN__Vector.html">N_Vector</a> ydot)=0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractCvodeSystem.html#a4aa40269eaa25c505442d5321f044c82">EvaluateAnalyticJacobian</a> (long int N, realtype time, <a class="el" href="classN__Vector.html">N_Vector</a> y, <a class="el" href="classN__Vector.html">N_Vector</a> ydot, CHASTE_CVODE_DENSE_MATRIX jacobian, <a class="el" href="classN__Vector.html">N_Vector</a> tmp1, <a class="el" href="classN__Vector.html">N_Vector</a> tmp2, <a class="el" href="classN__Vector.html">N_Vector</a> tmp3)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractCvodeSystem.html#a2e473ca68a669744e2badabd191f36b1">SetForceReset</a> (<a class="el" href="classbool.html">bool</a> autoReset)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractCvodeSystem.html#aef7dbe618444e8537d8bb88ece1c3eda">SetMinimalReset</a> (<a class="el" href="classbool.html">bool</a> minimalReset)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractCvodeSystem.html#a6fff0827b807e437c0343dc519cdaaee">ResetSolver</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classOdeSolution.html">OdeSolution</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractCvodeSystem.html#a9d579f823bf5126752ad022016dfc577">Solve</a> (realtype tStart, realtype tEnd, realtype maxDt, realtype tSamp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractCvodeSystem.html#a3174dd94d94a9c2fe474925206e0dd44">Solve</a> (realtype tStart, realtype tEnd, realtype maxDt)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractCvodeSystem.html#a8a45a359ba79e5f8c5ac7dda44799afd">SetMaxSteps</a> (long int numSteps)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">long int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractCvodeSystem.html#a73e508067b2b8651805a817bd304dcbc">GetMaxSteps</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractCvodeSystem.html#a000aac8a2e47ec9ddbb415172aed1c66">SetTolerances</a> (<a class="el" href="classdouble.html">double</a> relTol=1e-5, double absTol=1e-7)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classdouble.html">double</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractCvodeSystem.html#a59ea882a7744ee929be9ef003b8e87d1">GetRelativeTolerance</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classdouble.html">double</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractCvodeSystem.html#a990e545668fb4656ec18d460988997dc">GetAbsoluteTolerance</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classdouble.html">double</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractCvodeSystem.html#a5e3d7d69aa530572a423995264f148f6">GetLastStepSize</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractCvodeSystem.html#a1d8d14135c0a0ff36ce51da036254012">GetUseAnalyticJacobian</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractCvodeSystem.html#ab1b1d06d51df024a7f57a1715f74a4db">ForceUseOfNumericalJacobian</a> (<a class="el" href="classbool.html">bool</a> useNumericalJacobian=true)</td></tr>
<tr><td colspan="2"><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractCvodeSystem.html#aa886a4a733adc2e987bc92c283a9d9f6">Init</a> ()</td></tr>
<tr><td colspan="2"><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractCvodeSystem.html#a44e33dbbceed1d13cae9b975aac6f47a">mUseAnalyticJacobian</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classdouble.html">double</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractCvodeSystem.html#a2472c40e48441a69d47ec48764faa504">mRelTol</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classdouble.html">double</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractCvodeSystem.html#a5a3a741308325ad0fe14b035cfc428e5">mAbsTol</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractCvodeSystem.html#a42f3011fe33e360b80efd74aa855ddd4">mpCvodeMem</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">long int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractCvodeSystem.html#ac49e205b7faac1ed2da8e1a5b4c827d5">mMaxSteps</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classdouble.html">double</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractCvodeSystem.html#add9dc6d6cfc2afd1ccf64be2a66f0d2c">mLastInternalStepSize</a></td></tr>
<tr><td colspan="2"><h2>Private Member Functions</h2></td></tr>
<tr><td class="memTemplParams" colspan="2">template&lt;class Archive &gt; </td></tr>
<tr><td class="memTemplItemLeft" align="right" valign="top">void&nbsp;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classAbstractCvodeSystem.html#a4bdb75e3e15b59d55cc2cba55a9ddb46">save</a> (Archive &amp;archive, const <a class="el" href="classunsigned.html">unsigned</a> int version) const </td></tr>
<tr><td class="memTemplParams" colspan="2">template&lt;class Archive &gt; </td></tr>
<tr><td class="memTemplItemLeft" align="right" valign="top">void&nbsp;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classAbstractCvodeSystem.html#a63404de185d507d07306ab0ab00974e8">load</a> (Archive &amp;archive, const <a class="el" href="classunsigned.html">unsigned</a> int version)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractCvodeSystem.html#a51add75a4d081fb996d901719234b214">SetupCvode</a> (<a class="el" href="classN__Vector.html">N_Vector</a> initialConditions, realtype tStart, realtype maxDt)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractCvodeSystem.html#a7953af8cbc0215af4f171c381bbce936">RecordStoppingPoint</a> (<a class="el" href="classdouble.html">double</a> stopTime)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractCvodeSystem.html#afa2bb668aef63bbeaf8f763b42b06554">FreeCvodeMemory</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractCvodeSystem.html#a945898f7ea7e7198de5e954589ccdf5a">CvodeError</a> (int flag, const char *msg)</td></tr>
<tr><td colspan="2"><h2>Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classN__Vector.html">N_Vector</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractCvodeSystem.html#af9592769a9176c180ed737e537a66fbc">mLastSolutionState</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classdouble.html">double</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractCvodeSystem.html#ab7135b60313d405001d939a925c7943c">mLastSolutionTime</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractCvodeSystem.html#a437f174b7c0035e5f0a6367784bdec1f">mForceReset</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractCvodeSystem.html#aed4a5bf116657df41e5edf463d34faa1">mForceMinimalReset</a></td></tr>
<tr><td colspan="2"><h2>Friends</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad209dc01b10b28cd663c6e7ba3e1a49d"></a><!-- doxytag: member="AbstractCvodeSystem::TestAbstractCvodeSystem" ref="ad209dc01b10b28cd663c6e7ba3e1a49d" args="" -->
class&nbsp;</td><td class="memItemRight" valign="bottom"><b>TestAbstractCvodeSystem</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac98d07dd8f7b70e16ccb9a01abf56b9c"></a><!-- doxytag: member="AbstractCvodeSystem::boost::serialization::access" ref="ac98d07dd8f7b70e16ccb9a01abf56b9c" args="" -->
class&nbsp;</td><td class="memItemRight" valign="bottom"><b>boost::serialization::access</b></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Abstract OdeSystem class for Cvode systems (N_Vector instead of std::vector)</p>
<p>Sets up variables and functions for a general CVODE system.</p>
<p>ODE systems are specified primarily by the <a class="el" href="classAbstractCvodeSystem.html#ab4b9641b9d543471f3ea3dbaa4e78415">EvaluateYDerivatives()</a> method, which calculates the right-hand side of the system.</p>
<p>You can also specify an <a class="el" href="classAbstractCvodeSystem.html#a4aa40269eaa25c505442d5321f044c82">EvaluateAnalyticJacobian()</a> method which will allow CVODE to evaluate the Jacobian matrix precisely instead of using multiple calls to <a class="el" href="classAbstractCvodeSystem.html#ab4b9641b9d543471f3ea3dbaa4e78415">EvaluateYDerivatives()</a> to make an approximation to it. This generally provides extra accuracy and better convergence, and so gives a speed up for a given tolerance. Cardiac action potential model Jacobians are calculated automatically by PyCML (see python/pycml) via Maple for symbolic differentiation.</p>
<p>Instances can store their state internally in the mStateVariables vector in our base class <a class="el" href="classAbstractParameterisedSystem.html">AbstractParameterisedSystem</a> (see also <a class="el" href="classAbstractUntemplatedParameterisedSystem.html#acf645d5e9d13ee8ee81ace4ecaa8044d">GetNumberOfStateVariables()</a>, <a class="el" href="classAbstractParameterisedSystem.html#a1b7e8d45fc8bee37063942e4064215e9">SetStateVariables()</a> and <a class="el" href="classAbstractParameterisedSystem.html#ac48c1b6cea404aa468b05974af36e7b5">rGetStateVariables()</a>), although this is not essential - the vector may be empty, in which case <a class="el" href="classAbstractIvpOdeSolver.html#a728403e09c2e6e0b7389bf78378ee37a">AbstractIvpOdeSolver::SolveAndUpdateStateVariable</a> may not be used to solve the system.</p>
<p>CVODE systems may also have a vector of parameters, which can be accessed through the <a class="el" href="classAbstractParameterisedSystem.html#a00303806710d1dd2a0f40bc94526473d">GetParameter()</a> and <a class="el" href="classAbstractParameterisedSystem.html#ab0daccb001fc3765c83ec61ef7f74960">SetParameter()</a> methods of our base class.</p>
<p>Information about what the parameters and state variables represent is provided by a subclass of <a class="el" href="classAbstractOdeSystemInformation.html">AbstractOdeSystemInformation</a>. Various wrapper methods (e.g. <a class="el" href="classAbstractUntemplatedParameterisedSystem.html#a5de87e5bbb35fcf9c2fd1cfa71880b65">rGetStateVariableNames()</a>) are provided in our base class to access this information.</p>
<p>Also, subclasses may define a condition at which ODE solvers should stop prematurely. For this class CVODE solvers are being used, so CalculateRootFunction() should be used to detect the stopping time.</p>
<p>Note that the default tolerances for the solver are set by <a class="el" href="classAbstractCvodeSystem.html#a000aac8a2e47ec9ddbb415172aed1c66">SetTolerances()</a>, these can make quite a difference to the time it takes to solve the ODE system.</p>
<p>Repeated calls to Solve will no longer set up and delete CVODE memory, unless the following method is called:</p>
<p>SetForceReset(true) - reset each time <a class="el" href="classAbstractCvodeSystem.html#a9d579f823bf5126752ad022016dfc577">Solve()</a> is called</p>
<p>default - reset if state variables change, or we ask to solve from a different time than the last solve call finished.</p>
<p>SetMinimalReset(true) - ignore changes in state vars and just reset if the time is inconsistent. </p>

<p>Definition at line <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00119">119</a> of file <a class="el" href="AbstractCvodeSystem_8hpp_source.html">AbstractCvodeSystem.hpp</a>.</p>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a98f4dbff46f993d4fa5299bb1468cbc3"></a><!-- doxytag: member="AbstractCvodeSystem::AbstractCvodeSystem" ref="a98f4dbff46f993d4fa5299bb1468cbc3" args="(unsigned numberOfStateVariables)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AbstractCvodeSystem::AbstractCvodeSystem </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classunsigned.html">unsigned</a>&nbsp;</td>
          <td class="paramname"> <em>numberOfStateVariables</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Constructor.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>numberOfStateVariables</em>&nbsp;</td><td>the number of state variables in the ODE system </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00121">121</a> of file <a class="el" href="AbstractCvodeSystem_8cpp_source.html">AbstractCvodeSystem.cpp</a>.</p>

<p>References <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00294">SetTolerances()</a>.</p>

</div>
</div>
<a class="anchor" id="af9830f4dc6cc9311ece1aa15a18aa1e1"></a><!-- doxytag: member="AbstractCvodeSystem::~AbstractCvodeSystem" ref="af9830f4dc6cc9311ece1aa15a18aa1e1" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AbstractCvodeSystem::~AbstractCvodeSystem </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Virtual destructor since we have virtual methods. </p>

<p>Definition at line <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00153">153</a> of file <a class="el" href="AbstractCvodeSystem_8cpp_source.html">AbstractCvodeSystem.cpp</a>.</p>

<p>References <a class="el" href="VectorHelperFunctions_8hpp.html#a233c7de935da6e8c227738bb0a23c48a">DeleteVector()</a>, <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00441">FreeCvodeMemory()</a>, <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00229">mLastSolutionState</a>, <a class="el" href="AbstractParameterisedSystem_8hpp_source.html#l00074">AbstractParameterisedSystem&lt; N_Vector &gt;::mParameters</a>, and <a class="el" href="AbstractParameterisedSystem_8hpp_source.html#l00071">AbstractParameterisedSystem&lt; N_Vector &gt;::mStateVariables</a>.</p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a945898f7ea7e7198de5e954589ccdf5a"></a><!-- doxytag: member="AbstractCvodeSystem::CvodeError" ref="a945898f7ea7e7198de5e954589ccdf5a" args="(int flag, const char *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AbstractCvodeSystem::CvodeError </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>msg</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Report an error from CVODE.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>flag</em>&nbsp;</td><td>CVODE error code </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>msg</em>&nbsp;</td><td>Our description of the error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00451">451</a> of file <a class="el" href="AbstractCvodeSystem_8cpp_source.html">AbstractCvodeSystem.cpp</a>.</p>

<p>References <a class="el" href="Exception_8hpp_source.html#l00143">EXCEPTION</a>, <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00441">FreeCvodeMemory()</a>, and <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00252">mpCvodeMem</a>.</p>

<p>Referenced by <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00175">Solve()</a>.</p>

</div>
</div>
<a class="anchor" id="a4aa40269eaa25c505442d5321f044c82"></a><!-- doxytag: member="AbstractCvodeSystem::EvaluateAnalyticJacobian" ref="a4aa40269eaa25c505442d5321f044c82" args="(long int N, realtype time, N_Vector y, N_Vector ydot, CHASTE_CVODE_DENSE_MATRIX jacobian, N_Vector tmp1, N_Vector tmp2, N_Vector tmp3)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void AbstractCvodeSystem::EvaluateAnalyticJacobian </td>
          <td>(</td>
          <td class="paramtype">long int&nbsp;</td>
          <td class="paramname"> <em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">realtype&nbsp;</td>
          <td class="paramname"> <em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classN__Vector.html">N_Vector</a>&nbsp;</td>
          <td class="paramname"> <em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classN__Vector.html">N_Vector</a>&nbsp;</td>
          <td class="paramname"> <em>ydot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CHASTE_CVODE_DENSE_MATRIX&nbsp;</td>
          <td class="paramname"> <em>jacobian</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classN__Vector.html">N_Vector</a>&nbsp;</td>
          <td class="paramname"> <em>tmp1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classN__Vector.html">N_Vector</a>&nbsp;</td>
          <td class="paramname"> <em>tmp2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classN__Vector.html">N_Vector</a>&nbsp;</td>
          <td class="paramname"> <em>tmp3</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This method is called by AbstractCvodeSystemJacAdaptor method in the .cpp file.</p>
<p>It provides an interface between the methods different versions of CVODE are expecting and the Jacobians provided by Chaste CVODE systems.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>N</em>&nbsp;</td><td>the size of the ODE system </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>time</em>&nbsp;</td><td>the current time (used by ODE systems like y' = f(t,y) only I guess) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>y</em>&nbsp;</td><td>the current state variables y for y' = f(t,y) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ydot</em>&nbsp;</td><td>the current set of derivatives y' = f(t,y) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>jacobian</em>&nbsp;</td><td>a pointer to a jacobian, populated by this method. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>tmp1</em>&nbsp;</td><td>working memory of the correct size provided by CVODE for temporary calculations </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>tmp2</em>&nbsp;</td><td>working memory of the correct size provided by CVODE for temporary calculations </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>tmp3</em>&nbsp;</td><td>working memory of the correct size provided by CVODE for temporary calculations </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00311">311</a> of file <a class="el" href="AbstractCvodeSystem_8hpp_source.html">AbstractCvodeSystem.hpp</a>.</p>

<p>References <a class="el" href="Exception_8hpp_source.html#l00143">EXCEPTION</a>.</p>

</div>
</div>
<a class="anchor" id="ab4b9641b9d543471f3ea3dbaa4e78415"></a><!-- doxytag: member="AbstractCvodeSystem::EvaluateYDerivatives" ref="ab4b9641b9d543471f3ea3dbaa4e78415" args="(realtype time, const N_Vector y, N_Vector ydot)=0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void AbstractCvodeSystem::EvaluateYDerivatives </td>
          <td>(</td>
          <td class="paramtype">realtype&nbsp;</td>
          <td class="paramname"> <em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classN__Vector.html">N_Vector</a>&nbsp;</td>
          <td class="paramname"> <em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classN__Vector.html">N_Vector</a>&nbsp;</td>
          <td class="paramname"> <em>ydot</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Method to evaluate the derivatives of the system.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>time</em>&nbsp;</td><td>the current time </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>y</em>&nbsp;</td><td>the current values of the state variables </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ydot</em>&nbsp;</td><td>storage for the derivatives of the system; will be filled in on return </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ab1b1d06d51df024a7f57a1715f74a4db"></a><!-- doxytag: member="AbstractCvodeSystem::ForceUseOfNumericalJacobian" ref="ab1b1d06d51df024a7f57a1715f74a4db" args="(bool useNumericalJacobian=true)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AbstractCvodeSystem::ForceUseOfNumericalJacobian </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&nbsp;</td>
          <td class="paramname"> <em>useNumericalJacobian</em> = <code>true</code></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Force the use of a numerical Jacobian, even if an analytic form is provided. This is needed for a handful of troublesome models.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>useNumericalJacobian</em>&nbsp;</td><td>Whether to use a numerical instead of the analytic Jacobian. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00488">488</a> of file <a class="el" href="AbstractCvodeSystem_8cpp_source.html">AbstractCvodeSystem.cpp</a>.</p>

<p>References <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00441">FreeCvodeMemory()</a>, and <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00243">mUseAnalyticJacobian</a>.</p>

</div>
</div>
<a class="anchor" id="afa2bb668aef63bbeaf8f763b42b06554"></a><!-- doxytag: member="AbstractCvodeSystem::FreeCvodeMemory" ref="afa2bb668aef63bbeaf8f763b42b06554" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AbstractCvodeSystem::FreeCvodeMemory </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Free CVODE memory when finished with. </p>

<p>Definition at line <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00441">441</a> of file <a class="el" href="AbstractCvodeSystem_8cpp_source.html">AbstractCvodeSystem.cpp</a>.</p>

<p>References <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00252">mpCvodeMem</a>.</p>

<p>Referenced by <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00451">CvodeError()</a>, <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00488">ForceUseOfNumericalJacobian()</a>, and <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00153">~AbstractCvodeSystem()</a>.</p>

</div>
</div>
<a class="anchor" id="a990e545668fb4656ec18d460988997dc"></a><!-- doxytag: member="AbstractCvodeSystem::GetAbsoluteTolerance" ref="a990e545668fb4656ec18d460988997dc" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classdouble.html">double</a> AbstractCvodeSystem::GetAbsoluteTolerance </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="return"><dt><b>Returns:</b></dt><dd>the absolute tolerance. </dd></dl>

<p>Definition at line <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00306">306</a> of file <a class="el" href="AbstractCvodeSystem_8cpp_source.html">AbstractCvodeSystem.cpp</a>.</p>

<p>References <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00249">mAbsTol</a>.</p>

</div>
</div>
<a class="anchor" id="a5e3d7d69aa530572a423995264f148f6"></a><!-- doxytag: member="AbstractCvodeSystem::GetLastStepSize" ref="a5e3d7d69aa530572a423995264f148f6" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classdouble.html">double</a> AbstractCvodeSystem::GetLastStepSize </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="return"><dt><b>Returns:</b></dt><dd>the last step size used internally by CVODE in the last Solve call. </dd></dl>

<p>Definition at line <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00311">311</a> of file <a class="el" href="AbstractCvodeSystem_8cpp_source.html">AbstractCvodeSystem.cpp</a>.</p>

<p>References <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00261">mLastInternalStepSize</a>.</p>

</div>
</div>
<a class="anchor" id="a73e508067b2b8651805a817bd304dcbc"></a><!-- doxytag: member="AbstractCvodeSystem::GetMaxSteps" ref="a73e508067b2b8651805a817bd304dcbc" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long int AbstractCvodeSystem::GetMaxSteps </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="return"><dt><b>Returns:</b></dt><dd>the maximum number of steps to be taken by the solver in its attempt to reach the next output time. </dd></dl>

<p>Definition at line <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00289">289</a> of file <a class="el" href="AbstractCvodeSystem_8cpp_source.html">AbstractCvodeSystem.cpp</a>.</p>

<p>References <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00258">mMaxSteps</a>.</p>

</div>
</div>
<a class="anchor" id="a59ea882a7744ee929be9ef003b8e87d1"></a><!-- doxytag: member="AbstractCvodeSystem::GetRelativeTolerance" ref="a59ea882a7744ee929be9ef003b8e87d1" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classdouble.html">double</a> AbstractCvodeSystem::GetRelativeTolerance </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="return"><dt><b>Returns:</b></dt><dd>the relative tolerance. </dd></dl>

<p>Definition at line <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00301">301</a> of file <a class="el" href="AbstractCvodeSystem_8cpp_source.html">AbstractCvodeSystem.cpp</a>.</p>

<p>References <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00246">mRelTol</a>.</p>

</div>
</div>
<a class="anchor" id="a1d8d14135c0a0ff36ce51da036254012"></a><!-- doxytag: member="AbstractCvodeSystem::GetUseAnalyticJacobian" ref="a1d8d14135c0a0ff36ce51da036254012" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> AbstractCvodeSystem::GetUseAnalyticJacobian </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="return"><dt><b>Returns:</b></dt><dd>whether an analytic Jacobian is used (<a class="el" href="classAbstractCvodeSystem.html#a44e33dbbceed1d13cae9b975aac6f47a">mUseAnalyticJacobian</a>) </dd></dl>

<p>Definition at line <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00482">482</a> of file <a class="el" href="AbstractCvodeSystem_8cpp_source.html">AbstractCvodeSystem.cpp</a>.</p>

<p>References <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00243">mUseAnalyticJacobian</a>.</p>

</div>
</div>
<a class="anchor" id="aa886a4a733adc2e987bc92c283a9d9f6"></a><!-- doxytag: member="AbstractCvodeSystem::Init" ref="aa886a4a733adc2e987bc92c283a9d9f6" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AbstractCvodeSystem::Init </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><b>Must</b> be called by concrete subclass constructors to initialise the state variables, after setting <a class="el" href="classAbstractUntemplatedParameterisedSystem.html#a4a8be232c7430e902e7c6d876328093f">mpSystemInfo</a>. </p>

<p>Definition at line <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00141">141</a> of file <a class="el" href="AbstractCvodeSystem_8cpp_source.html">AbstractCvodeSystem.cpp</a>.</p>

<p>References <a class="el" href="VectorHelperFunctions_8hpp.html#a233c7de935da6e8c227738bb0a23c48a">DeleteVector()</a>, <a class="el" href="classAbstractParameterisedSystem.html#aab2096594a7bc52b1aa26fc620ada7ba">AbstractParameterisedSystem&lt; N_Vector &gt;::GetInitialConditions()</a>, <a class="el" href="AbstractParameterisedSystem_8hpp_source.html#l00074">AbstractParameterisedSystem&lt; N_Vector &gt;::mParameters</a>, <a class="el" href="AbstractParameterisedSystem_8hpp_source.html#l00071">AbstractParameterisedSystem&lt; N_Vector &gt;::mStateVariables</a>, and <a class="el" href="AbstractUntemplatedParameterisedSystem_8cpp_source.html#l00107">AbstractUntemplatedParameterisedSystem::rGetParameterNames()</a>.</p>

</div>
</div>
<a class="anchor" id="a63404de185d507d07306ab0ab00974e8"></a><!-- doxytag: member="AbstractCvodeSystem::load" ref="a63404de185d507d07306ab0ab00974e8" args="(Archive &amp;archive, const unsigned int version)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Archive &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void AbstractCvodeSystem::load </td>
          <td>(</td>
          <td class="paramtype">Archive &amp;&nbsp;</td>
          <td class="paramname"> <em>archive</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classunsigned.html">unsigned</a> int&nbsp;</td>
          <td class="paramname"> <em>version</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Archive the member variables.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>archive</em>&nbsp;</td><td>the archive </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>version</em>&nbsp;</td><td>the current version of this class </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00170">170</a> of file <a class="el" href="AbstractCvodeSystem_8hpp_source.html">AbstractCvodeSystem.hpp</a>.</p>

<p>References <a class="el" href="classAbstractParameterisedSystem.html#a8984986969f36555669503ef1228d10b">AbstractParameterisedSystem&lt; N_Vector &gt;::CheckParametersOnLoad()</a>, <a class="el" href="VectorHelperFunctions_8hpp.html#a097384bd66d3215cdaff6638fb7382d4">CopyFromStdVector()</a>, <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00249">mAbsTol</a>, <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00238">mForceMinimalReset</a>, <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00235">mForceReset</a>, <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00261">mLastInternalStepSize</a>, <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00232">mLastSolutionTime</a>, <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00258">mMaxSteps</a>, <a class="el" href="AbstractUntemplatedParameterisedSystem_8hpp_source.html#l00293">AbstractUntemplatedParameterisedSystem::mNumberOfStateVariables</a>, <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00246">mRelTol</a>, <a class="el" href="AbstractParameterisedSystem_8hpp_source.html#l00071">AbstractParameterisedSystem&lt; N_Vector &gt;::mStateVariables</a>, and <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00243">mUseAnalyticJacobian</a>.</p>

</div>
</div>
<a class="anchor" id="a7953af8cbc0215af4f171c381bbce936"></a><!-- doxytag: member="AbstractCvodeSystem::RecordStoppingPoint" ref="a7953af8cbc0215af4f171c381bbce936" args="(double stopTime)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AbstractCvodeSystem::RecordStoppingPoint </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classdouble.html">double</a>&nbsp;</td>
          <td class="paramname"> <em>stopTime</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Record where the last solve got to so we know whether to re-initialise. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>stopTime</em>&nbsp;</td><td>the finishing time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00420">420</a> of file <a class="el" href="AbstractCvodeSystem_8cpp_source.html">AbstractCvodeSystem.cpp</a>.</p>

<p>References <a class="el" href="VectorHelperFunctions_8hpp.html#a866d66f4e1de77ff853501b772024507">CreateVectorIfEmpty()</a>, <a class="el" href="AbstractUntemplatedParameterisedSystem_8cpp_source.html#l00068">AbstractUntemplatedParameterisedSystem::GetNumberOfStateVariables()</a>, <a class="el" href="VectorHelperFunctions_8hpp.html#aa25b501a804daddc58b5ce1bdc7d1697">GetVectorComponent()</a>, <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00235">mForceReset</a>, <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00229">mLastSolutionState</a>, <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00232">mLastSolutionTime</a>, <a class="el" href="AbstractParameterisedSystem_8hpp_source.html#l00071">AbstractParameterisedSystem&lt; N_Vector &gt;::mStateVariables</a>, and <a class="el" href="VectorHelperFunctions_8hpp.html#a308fdd8ee5cdfb9a13d1bf4742fbe176">SetVectorComponent()</a>.</p>

<p>Referenced by <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00175">Solve()</a>.</p>

</div>
</div>
<a class="anchor" id="a6fff0827b807e437c0343dc519cdaaee"></a><!-- doxytag: member="AbstractCvodeSystem::ResetSolver" ref="a6fff0827b807e437c0343dc519cdaaee" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AbstractCvodeSystem::ResetSolver </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Successive calls to Solve will attempt to intelligently determine whether to re-initialise the internal CVODE solver, or whether we are simply extending the previous solution forward in time. This mechanism compares the state vector to its previous value, and the start time to the end of the last solve, which captures most cases where re-initialisation is required. However, changes to the RHS function can also require this, and cannot be automatically detected. In such cases users must call this function to force re-initialisation. </p>

<p>Definition at line <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00335">335</a> of file <a class="el" href="AbstractCvodeSystem_8cpp_source.html">AbstractCvodeSystem.cpp</a>.</p>

<p>References <a class="el" href="VectorHelperFunctions_8hpp.html#a233c7de935da6e8c227738bb0a23c48a">DeleteVector()</a>, and <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00229">mLastSolutionState</a>.</p>

<p>Referenced by <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00316">SetForceReset()</a>, <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00294">SetTolerances()</a>, and <a class="el" href="AbstractCvodeCell_8cpp_source.html#l00134">AbstractCvodeCell::SetVoltageDerivativeToZero()</a>.</p>

</div>
</div>
<a class="anchor" id="a4bdb75e3e15b59d55cc2cba55a9ddb46"></a><!-- doxytag: member="AbstractCvodeSystem::save" ref="a4bdb75e3e15b59d55cc2cba55a9ddb46" args="(Archive &amp;archive, const unsigned int version) const " -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Archive &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void AbstractCvodeSystem::save </td>
          <td>(</td>
          <td class="paramtype">Archive &amp;&nbsp;</td>
          <td class="paramname"> <em>archive</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classunsigned.html">unsigned</a> int&nbsp;</td>
          <td class="paramname"> <em>version</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td> const<code> [inline, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Archive the member variables.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>archive</em>&nbsp;</td><td>the archive </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>version</em>&nbsp;</td><td>the current version of this class </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00132">132</a> of file <a class="el" href="AbstractCvodeSystem_8hpp_source.html">AbstractCvodeSystem.hpp</a>.</p>

<p>References <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00249">mAbsTol</a>, <a class="el" href="VectorHelperFunctions_8hpp_source.html#l00480">MakeStdVec()</a>, <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00238">mForceMinimalReset</a>, <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00235">mForceReset</a>, <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00261">mLastInternalStepSize</a>, <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00232">mLastSolutionTime</a>, <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00258">mMaxSteps</a>, <a class="el" href="AbstractUntemplatedParameterisedSystem_8hpp_source.html#l00293">AbstractUntemplatedParameterisedSystem::mNumberOfStateVariables</a>, <a class="el" href="AbstractParameterisedSystem_8hpp_source.html#l00074">AbstractParameterisedSystem&lt; N_Vector &gt;::mParameters</a>, <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00246">mRelTol</a>, <a class="el" href="AbstractParameterisedSystem_8hpp_source.html#l00071">AbstractParameterisedSystem&lt; N_Vector &gt;::mStateVariables</a>, <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00243">mUseAnalyticJacobian</a>, and <a class="el" href="AbstractUntemplatedParameterisedSystem_8cpp_source.html#l00107">AbstractUntemplatedParameterisedSystem::rGetParameterNames()</a>.</p>

</div>
</div>
<a class="anchor" id="a2e473ca68a669744e2badabd191f36b1"></a><!-- doxytag: member="AbstractCvodeSystem::SetForceReset" ref="a2e473ca68a669744e2badabd191f36b1" args="(bool autoReset)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AbstractCvodeSystem::SetForceReset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&nbsp;</td>
          <td class="paramname"> <em>autoReset</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Set whether to automatically re-initialise CVODE on every call to Solve, or whether to attempt to guess when re-initialisation is needed. For example it will re-initialise if the time changes, or any state variables change. You can safely change parameters between solve calls with or without resets.</p>
<p>See also ResetSolver and SetMinimalReset</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>autoReset</em>&nbsp;</td><td>whether to reset on every Solve </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00316">316</a> of file <a class="el" href="AbstractCvodeSystem_8cpp_source.html">AbstractCvodeSystem.cpp</a>.</p>

<p>References <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00235">mForceReset</a>, and <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00335">ResetSolver()</a>.</p>

<p>Referenced by <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00325">SetMinimalReset()</a>.</p>

</div>
</div>
<a class="anchor" id="a8a45a359ba79e5f8c5ac7dda44799afd"></a><!-- doxytag: member="AbstractCvodeSystem::SetMaxSteps" ref="a8a45a359ba79e5f8c5ac7dda44799afd" args="(long int numSteps)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AbstractCvodeSystem::SetMaxSteps </td>
          <td>(</td>
          <td class="paramtype">long int&nbsp;</td>
          <td class="paramname"> <em>numSteps</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Change the maximum number of steps to be taken by the solver in its attempt to reach the next output time. Default is 500 (set by CVODE).</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>numSteps</em>&nbsp;</td><td>new maximum </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00284">284</a> of file <a class="el" href="AbstractCvodeSystem_8cpp_source.html">AbstractCvodeSystem.cpp</a>.</p>

<p>References <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00258">mMaxSteps</a>.</p>

</div>
</div>
<a class="anchor" id="aef7dbe618444e8537d8bb88ece1c3eda"></a><!-- doxytag: member="AbstractCvodeSystem::SetMinimalReset" ref="aef7dbe618444e8537d8bb88ece1c3eda" args="(bool minimalReset)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AbstractCvodeSystem::SetMinimalReset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&nbsp;</td>
          <td class="paramname"> <em>minimalReset</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Set whether to reduce the checking done when guessing when re-initialisation is needed, so it ignores changes in the state variables. If call with true argument, will call SetForceReset(false). You can safely change parameters between solve calls with or without resets.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>minimalReset</em>&nbsp;</td><td>whether to avoid checking for changes in state variables </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00325">325</a> of file <a class="el" href="AbstractCvodeSystem_8cpp_source.html">AbstractCvodeSystem.cpp</a>.</p>

<p>References <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00238">mForceMinimalReset</a>, and <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00316">SetForceReset()</a>.</p>

</div>
</div>
<a class="anchor" id="a000aac8a2e47ec9ddbb415172aed1c66"></a><!-- doxytag: member="AbstractCvodeSystem::SetTolerances" ref="a000aac8a2e47ec9ddbb415172aed1c66" args="(double relTol=1e&#45;5, double absTol=1e&#45;7)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AbstractCvodeSystem::SetTolerances </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classdouble.html">double</a>&nbsp;</td>
          <td class="paramname"> <em>relTol</em> = <code>1e-5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdouble.html">double</a>&nbsp;</td>
          <td class="paramname"> <em>absTol</em> = <code>1e-7</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Set relative and absolute tolerances; both scalars. If no parameters are given, tolerances will be reset to default values.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>relTol</em>&nbsp;</td><td>the relative tolerance for the solver (defaults to 1e-5) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>absTol</em>&nbsp;</td><td>the absolute tolerance for the solver (defaults to 1e-7) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00294">294</a> of file <a class="el" href="AbstractCvodeSystem_8cpp_source.html">AbstractCvodeSystem.cpp</a>.</p>

<p>References <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00249">mAbsTol</a>, <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00246">mRelTol</a>, and <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00335">ResetSolver()</a>.</p>

<p>Referenced by <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00121">AbstractCvodeSystem()</a>.</p>

</div>
</div>
<a class="anchor" id="a51add75a4d081fb996d901719234b214"></a><!-- doxytag: member="AbstractCvodeSystem::SetupCvode" ref="a51add75a4d081fb996d901719234b214" args="(N_Vector initialConditions, realtype tStart, realtype maxDt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AbstractCvodeSystem::SetupCvode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classN__Vector.html">N_Vector</a>&nbsp;</td>
          <td class="paramname"> <em>initialConditions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">realtype&nbsp;</td>
          <td class="paramname"> <em>tStart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">realtype&nbsp;</td>
          <td class="paramname"> <em>maxDt</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Set up the CVODE data structures needed to solve the given system from a given point.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>initialConditions</em>&nbsp;</td><td>initial conditions </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>tStart</em>&nbsp;</td><td>start time of simulation </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>maxDt</em>&nbsp;</td><td>maximum time step to take </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00341">341</a> of file <a class="el" href="AbstractCvodeSystem_8cpp_source.html">AbstractCvodeSystem.cpp</a>.</p>

<p>References <a class="el" href="Exception_8hpp_source.html#l00143">EXCEPTION</a>, <a class="el" href="AbstractUntemplatedParameterisedSystem_8cpp_source.html#l00068">AbstractUntemplatedParameterisedSystem::GetNumberOfStateVariables()</a>, <a class="el" href="VectorHelperFunctions_8hpp.html#aa25b501a804daddc58b5ce1bdc7d1697">GetVectorComponent()</a>, <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00249">mAbsTol</a>, <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00238">mForceMinimalReset</a>, <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00235">mForceReset</a>, <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00229">mLastSolutionState</a>, <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00232">mLastSolutionTime</a>, <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00258">mMaxSteps</a>, <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00252">mpCvodeMem</a>, <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00246">mRelTol</a>, <a class="el" href="AbstractParameterisedSystem_8hpp_source.html#l00071">AbstractParameterisedSystem&lt; N_Vector &gt;::mStateVariables</a>, <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00243">mUseAnalyticJacobian</a>, and <a class="el" href="MathsCustomFunctions_8cpp_source.html#l00199">CompareDoubles::WithinAnyTolerance()</a>.</p>

<p>Referenced by <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00175">Solve()</a>.</p>

</div>
</div>
<a class="anchor" id="a3174dd94d94a9c2fe474925206e0dd44"></a><!-- doxytag: member="AbstractCvodeSystem::Solve" ref="a3174dd94d94a9c2fe474925206e0dd44" args="(realtype tStart, realtype tEnd, realtype maxDt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AbstractCvodeSystem::Solve </td>
          <td>(</td>
          <td class="paramtype">realtype&nbsp;</td>
          <td class="paramname"> <em>tStart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">realtype&nbsp;</td>
          <td class="paramname"> <em>tEnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">realtype&nbsp;</td>
          <td class="paramname"> <em>maxDt</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Simulate the cell, updating its internal state variables.</p>
<p>Uses the current values of the state variables at initial conditions. If the state variables have not been set (either by a prior solve, or a call to SetStateVariables) the initial conditions (given by GetInitialConditions) will be used.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>See also the ResetSolver method.</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>tStart</em>&nbsp;</td><td>start time of simulation </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>tEnd</em>&nbsp;</td><td>end time of simulation </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>maxDt</em>&nbsp;</td><td>maximum time step to be taken by the adaptive solver (set this appropriately to avoid missing a stimulus) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00231">231</a> of file <a class="el" href="AbstractCvodeSystem_8cpp_source.html">AbstractCvodeSystem.cpp</a>.</p>

<p>References <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00451">CvodeError()</a>, <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00261">mLastInternalStepSize</a>, <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00252">mpCvodeMem</a>, <a class="el" href="AbstractParameterisedSystem_8hpp_source.html#l00071">AbstractParameterisedSystem&lt; N_Vector &gt;::mStateVariables</a>, <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00420">RecordStoppingPoint()</a>, <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00341">SetupCvode()</a>, <a class="el" href="Exception_8hpp_source.html#l00216">UNUSED_OPT</a>, and <a class="el" href="AbstractParameterisedSystem_8hpp_source.html#l00183">AbstractParameterisedSystem&lt; N_Vector &gt;::VerifyStateVariables()</a>.</p>

</div>
</div>
<a class="anchor" id="a9d579f823bf5126752ad022016dfc577"></a><!-- doxytag: member="AbstractCvodeSystem::Solve" ref="a9d579f823bf5126752ad022016dfc577" args="(realtype tStart, realtype tEnd, realtype maxDt, realtype tSamp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classOdeSolution.html">OdeSolution</a> AbstractCvodeSystem::Solve </td>
          <td>(</td>
          <td class="paramtype">realtype&nbsp;</td>
          <td class="paramname"> <em>tStart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">realtype&nbsp;</td>
          <td class="paramname"> <em>tEnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">realtype&nbsp;</td>
          <td class="paramname"> <em>maxDt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">realtype&nbsp;</td>
          <td class="paramname"> <em>tSamp</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Simulate the cell, returning a sampling of the state variables.</p>
<p>Uses the current values of the state variables at initial conditions. If the state variables have not been set (either by a prior solve, or a call to SetStateVariables) the initial conditions (given by GetInitialConditions) will be used.</p>
<p>The final values of the state variables will also be stored in this object.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>See also the ResetSolver method.</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>tStart</em>&nbsp;</td><td>start time of simulation </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>tEnd</em>&nbsp;</td><td>end time of simulation </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>maxDt</em>&nbsp;</td><td>maximum time step to be taken by the adaptive solver (set this appropriately to avoid missing a stimulus) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>tSamp</em>&nbsp;</td><td>sampling interval at which to store results </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the solution object with results at each sampling step </dd></dl>

<p>Definition at line <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00175">175</a> of file <a class="el" href="AbstractCvodeSystem_8cpp_source.html">AbstractCvodeSystem.cpp</a>.</p>

<p>References <a class="el" href="TimeStepper_8cpp_source.html#l00123">TimeStepper::AdvanceOneTimeStep()</a>, <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00451">CvodeError()</a>, <a class="el" href="TimeStepper_8cpp_source.html#l00170">TimeStepper::EstimateTimeSteps()</a>, <a class="el" href="TimeStepper_8cpp_source.html#l00144">TimeStepper::GetNextTime()</a>, <a class="el" href="TimeStepper_8cpp_source.html#l00175">TimeStepper::GetTotalTimeStepsTaken()</a>, <a class="el" href="TimeStepper_8cpp_source.html#l00165">TimeStepper::IsTimeAtEnd()</a>, <a class="el" href="VectorHelperFunctions_8hpp_source.html#l00480">MakeStdVec()</a>, <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00261">mLastInternalStepSize</a>, <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00252">mpCvodeMem</a>, <a class="el" href="AbstractUntemplatedParameterisedSystem_8hpp_source.html#l00301">AbstractUntemplatedParameterisedSystem::mpSystemInfo</a>, <a class="el" href="AbstractParameterisedSystem_8hpp_source.html#l00071">AbstractParameterisedSystem&lt; N_Vector &gt;::mStateVariables</a>, <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00420">RecordStoppingPoint()</a>, <a class="el" href="OdeSolution_8cpp_source.html#l00122">OdeSolution::rGetSolutions()</a>, <a class="el" href="OdeSolution_8cpp_source.html#l00112">OdeSolution::rGetTimes()</a>, <a class="el" href="OdeSolution_8cpp_source.html#l00058">OdeSolution::SetNumberOfTimeSteps()</a>, <a class="el" href="OdeSolution_8cpp_source.html#l00066">OdeSolution::SetOdeSystemInformation()</a>, <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00341">SetupCvode()</a>, <a class="el" href="Exception_8hpp_source.html#l00216">UNUSED_OPT</a>, and <a class="el" href="AbstractParameterisedSystem_8hpp_source.html#l00183">AbstractParameterisedSystem&lt; N_Vector &gt;::VerifyStateVariables()</a>.</p>

<p>Referenced by <a class="el" href="AbstractCvodeCell_8cpp_source.html#l00102">AbstractCvodeCell::Compute()</a>, and <a class="el" href="AbstractCvodeCell_8cpp_source.html#l00093">AbstractCvodeCell::SolveAndUpdateState()</a>.</p>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a5a3a741308325ad0fe14b035cfc428e5"></a><!-- doxytag: member="AbstractCvodeSystem::mAbsTol" ref="a5a3a741308325ad0fe14b035cfc428e5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classdouble.html">double</a> <a class="el" href="classAbstractCvodeSystem.html#a5a3a741308325ad0fe14b035cfc428e5">AbstractCvodeSystem::mAbsTol</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Absolute tolerance for solver. </p>

<p>Definition at line <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00249">249</a> of file <a class="el" href="AbstractCvodeSystem_8hpp_source.html">AbstractCvodeSystem.hpp</a>.</p>

<p>Referenced by <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00306">GetAbsoluteTolerance()</a>, <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00170">load()</a>, <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00132">save()</a>, <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00294">SetTolerances()</a>, and <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00341">SetupCvode()</a>.</p>

</div>
</div>
<a class="anchor" id="aed4a5bf116657df41e5edf463d34faa1"></a><!-- doxytag: member="AbstractCvodeSystem::mForceMinimalReset" ref="aed4a5bf116657df41e5edf463d34faa1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> <a class="el" href="classAbstractCvodeSystem.html#aed4a5bf116657df41e5edf463d34faa1">AbstractCvodeSystem::mForceMinimalReset</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Whether to ignore changes in the state variables when deciding whether to reset. </p>

<p>Definition at line <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00238">238</a> of file <a class="el" href="AbstractCvodeSystem_8hpp_source.html">AbstractCvodeSystem.hpp</a>.</p>

<p>Referenced by <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00170">load()</a>, <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00132">save()</a>, <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00325">SetMinimalReset()</a>, and <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00341">SetupCvode()</a>.</p>

</div>
</div>
<a class="anchor" id="a437f174b7c0035e5f0a6367784bdec1f"></a><!-- doxytag: member="AbstractCvodeSystem::mForceReset" ref="a437f174b7c0035e5f0a6367784bdec1f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> <a class="el" href="classAbstractCvodeSystem.html#a437f174b7c0035e5f0a6367784bdec1f">AbstractCvodeSystem::mForceReset</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Whether to automatically reset CVODE on each Solve call. </p>

<p>Definition at line <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00235">235</a> of file <a class="el" href="AbstractCvodeSystem_8hpp_source.html">AbstractCvodeSystem.hpp</a>.</p>

<p>Referenced by <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00170">load()</a>, <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00420">RecordStoppingPoint()</a>, <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00132">save()</a>, <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00316">SetForceReset()</a>, and <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00341">SetupCvode()</a>.</p>

</div>
</div>
<a class="anchor" id="add9dc6d6cfc2afd1ccf64be2a66f0d2c"></a><!-- doxytag: member="AbstractCvodeSystem::mLastInternalStepSize" ref="add9dc6d6cfc2afd1ccf64be2a66f0d2c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classdouble.html">double</a> <a class="el" href="classAbstractCvodeSystem.html#add9dc6d6cfc2afd1ccf64be2a66f0d2c">AbstractCvodeSystem::mLastInternalStepSize</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The size of the previous timestep. </p>

<p>Definition at line <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00261">261</a> of file <a class="el" href="AbstractCvodeSystem_8hpp_source.html">AbstractCvodeSystem.hpp</a>.</p>

<p>Referenced by <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00311">GetLastStepSize()</a>, <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00170">load()</a>, <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00132">save()</a>, and <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00175">Solve()</a>.</p>

</div>
</div>
<a class="anchor" id="af9592769a9176c180ed737e537a66fbc"></a><!-- doxytag: member="AbstractCvodeSystem::mLastSolutionState" ref="af9592769a9176c180ed737e537a66fbc" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classN__Vector.html">N_Vector</a> <a class="el" href="classAbstractCvodeSystem.html#af9592769a9176c180ed737e537a66fbc">AbstractCvodeSystem::mLastSolutionState</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Remember where the last solve got to so we know whether to re-initialise. </p>

<p>Definition at line <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00229">229</a> of file <a class="el" href="AbstractCvodeSystem_8hpp_source.html">AbstractCvodeSystem.hpp</a>.</p>

<p>Referenced by <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00420">RecordStoppingPoint()</a>, <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00335">ResetSolver()</a>, <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00341">SetupCvode()</a>, and <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00153">~AbstractCvodeSystem()</a>.</p>

</div>
</div>
<a class="anchor" id="ab7135b60313d405001d939a925c7943c"></a><!-- doxytag: member="AbstractCvodeSystem::mLastSolutionTime" ref="ab7135b60313d405001d939a925c7943c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classdouble.html">double</a> <a class="el" href="classAbstractCvodeSystem.html#ab7135b60313d405001d939a925c7943c">AbstractCvodeSystem::mLastSolutionTime</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Remember where the last solve got to so we know whether to re-initialise. </p>

<p>Definition at line <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00232">232</a> of file <a class="el" href="AbstractCvodeSystem_8hpp_source.html">AbstractCvodeSystem.hpp</a>.</p>

<p>Referenced by <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00170">load()</a>, <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00420">RecordStoppingPoint()</a>, <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00132">save()</a>, and <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00341">SetupCvode()</a>.</p>

</div>
</div>
<a class="anchor" id="ac49e205b7faac1ed2da8e1a5b4c827d5"></a><!-- doxytag: member="AbstractCvodeSystem::mMaxSteps" ref="ac49e205b7faac1ed2da8e1a5b4c827d5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long int <a class="el" href="classAbstractCvodeSystem.html#ac49e205b7faac1ed2da8e1a5b4c827d5">AbstractCvodeSystem::mMaxSteps</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The maximum number of steps to be taken by the solver in its attempt to reach the next output time. </p>

<p>Definition at line <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00258">258</a> of file <a class="el" href="AbstractCvodeSystem_8hpp_source.html">AbstractCvodeSystem.hpp</a>.</p>

<p>Referenced by <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00289">GetMaxSteps()</a>, <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00170">load()</a>, <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00132">save()</a>, <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00284">SetMaxSteps()</a>, and <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00341">SetupCvode()</a>.</p>

</div>
</div>
<a class="anchor" id="a42f3011fe33e360b80efd74aa855ddd4"></a><!-- doxytag: member="AbstractCvodeSystem::mpCvodeMem" ref="a42f3011fe33e360b80efd74aa855ddd4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* <a class="el" href="classAbstractCvodeSystem.html#a42f3011fe33e360b80efd74aa855ddd4">AbstractCvodeSystem::mpCvodeMem</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>CVODE's internal data. </p>

<p>Definition at line <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00252">252</a> of file <a class="el" href="AbstractCvodeSystem_8hpp_source.html">AbstractCvodeSystem.hpp</a>.</p>

<p>Referenced by <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00451">CvodeError()</a>, <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00441">FreeCvodeMemory()</a>, <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00341">SetupCvode()</a>, and <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00175">Solve()</a>.</p>

</div>
</div>
<a class="anchor" id="a2472c40e48441a69d47ec48764faa504"></a><!-- doxytag: member="AbstractCvodeSystem::mRelTol" ref="a2472c40e48441a69d47ec48764faa504" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classdouble.html">double</a> <a class="el" href="classAbstractCvodeSystem.html#a2472c40e48441a69d47ec48764faa504">AbstractCvodeSystem::mRelTol</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Relative tolerance for solver. </p>

<p>Definition at line <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00246">246</a> of file <a class="el" href="AbstractCvodeSystem_8hpp_source.html">AbstractCvodeSystem.hpp</a>.</p>

<p>Referenced by <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00301">GetRelativeTolerance()</a>, <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00170">load()</a>, <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00132">save()</a>, <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00294">SetTolerances()</a>, and <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00341">SetupCvode()</a>.</p>

</div>
</div>
<a class="anchor" id="a44e33dbbceed1d13cae9b975aac6f47a"></a><!-- doxytag: member="AbstractCvodeSystem::mUseAnalyticJacobian" ref="a44e33dbbceed1d13cae9b975aac6f47a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> <a class="el" href="classAbstractCvodeSystem.html#a44e33dbbceed1d13cae9b975aac6f47a">AbstractCvodeSystem::mUseAnalyticJacobian</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Whether to use an analytic Jacobian. </p>

<p>Definition at line <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00243">243</a> of file <a class="el" href="AbstractCvodeSystem_8hpp_source.html">AbstractCvodeSystem.hpp</a>.</p>

<p>Referenced by <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00488">ForceUseOfNumericalJacobian()</a>, <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00482">GetUseAnalyticJacobian()</a>, <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00170">load()</a>, <a class="el" href="AbstractCvodeSystem_8hpp_source.html#l00132">save()</a>, and <a class="el" href="AbstractCvodeSystem_8cpp_source.html#l00341">SetupCvode()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>ode/src/common/<a class="el" href="AbstractCvodeSystem_8hpp_source.html">AbstractCvodeSystem.hpp</a></li>
<li>ode/src/common/<a class="el" href="AbstractCvodeSystem_8cpp_source.html">AbstractCvodeSystem.cpp</a></li>
</ul>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.2 </small></address>
</body>
</html>
