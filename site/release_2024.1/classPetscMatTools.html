<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Chaste: PetscMatTools Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="chaste-logo-60x60.jpg"/></td>
  <td id="projectalign">
   <div id="projectname">Chaste<span id="projectnumber">&#160;Release::2021.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classPetscMatTools.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="classPetscMatTools-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">PetscMatTools Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="PetscMatTools_8hpp_source.html">PetscMatTools.hpp</a>&gt;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Collaboration diagram for PetscMatTools:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="classPetscMatTools__coll__graph.svg" width="256" height="291"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:ad2991678b6341cb488fcf53bca9c7af1" id="r_ad2991678b6341cb488fcf53bca9c7af1"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#ad2991678b6341cb488fcf53bca9c7af1">SetElement</a> (<a class="el" href="classMat.html">Mat</a> matrix, <a class="el" href="classPetscInt.html">PetscInt</a> row, <a class="el" href="classPetscInt.html">PetscInt</a> col, <a class="el" href="classdouble.html">double</a> value)</td></tr>
<tr class="separator:ad2991678b6341cb488fcf53bca9c7af1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07f631eba92647e0f96eb9c007668b89" id="r_a07f631eba92647e0f96eb9c007668b89"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#a07f631eba92647e0f96eb9c007668b89">AddToElement</a> (<a class="el" href="classMat.html">Mat</a> matrix, <a class="el" href="classPetscInt.html">PetscInt</a> row, <a class="el" href="classPetscInt.html">PetscInt</a> col, <a class="el" href="classdouble.html">double</a> value)</td></tr>
<tr class="separator:a07f631eba92647e0f96eb9c007668b89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9717ce944536cda4afaac557aba7254" id="r_aa9717ce944536cda4afaac557aba7254"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#aa9717ce944536cda4afaac557aba7254">Finalise</a> (<a class="el" href="classMat.html">Mat</a> matrix)</td></tr>
<tr class="separator:aa9717ce944536cda4afaac557aba7254"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81ec00917b30dcf7da65791a05eb35ee" id="r_a81ec00917b30dcf7da65791a05eb35ee"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#a81ec00917b30dcf7da65791a05eb35ee">SwitchWriteMode</a> (<a class="el" href="classMat.html">Mat</a> matrix)</td></tr>
<tr class="separator:a81ec00917b30dcf7da65791a05eb35ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad78e39050573affee9679e2b5b2807fd" id="r_ad78e39050573affee9679e2b5b2807fd"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#ad78e39050573affee9679e2b5b2807fd">Display</a> (<a class="el" href="classMat.html">Mat</a> matrix)</td></tr>
<tr class="separator:ad78e39050573affee9679e2b5b2807fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4653d233e1382cf612d0cef06f43e630" id="r_a4653d233e1382cf612d0cef06f43e630"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#a4653d233e1382cf612d0cef06f43e630">SetRow</a> (<a class="el" href="classMat.html">Mat</a> matrix, <a class="el" href="classPetscInt.html">PetscInt</a> row, <a class="el" href="classdouble.html">double</a> value)</td></tr>
<tr class="separator:a4653d233e1382cf612d0cef06f43e630"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a68cf8b1e9a1630f54a60feb03084b9" id="r_a5a68cf8b1e9a1630f54a60feb03084b9"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#a5a68cf8b1e9a1630f54a60feb03084b9">ZeroRowsWithValueOnDiagonal</a> (<a class="el" href="classMat.html">Mat</a> matrix, std::vector&lt; <a class="el" href="classunsigned.html">unsigned</a> &gt; &amp;rRows, <a class="el" href="classdouble.html">double</a> diagonalValue)</td></tr>
<tr class="separator:a5a68cf8b1e9a1630f54a60feb03084b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a742a2bec669f75b1067b282ce6cf3b11" id="r_a742a2bec669f75b1067b282ce6cf3b11"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#a742a2bec669f75b1067b282ce6cf3b11">ZeroRowsAndColumnsWithValueOnDiagonal</a> (<a class="el" href="classMat.html">Mat</a> matrix, std::vector&lt; <a class="el" href="classunsigned.html">unsigned</a> &gt; rowColIndices, <a class="el" href="classdouble.html">double</a> diagonalValue)</td></tr>
<tr class="separator:a742a2bec669f75b1067b282ce6cf3b11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac790257be5a8cc501376fef953a76cee" id="r_ac790257be5a8cc501376fef953a76cee"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#ac790257be5a8cc501376fef953a76cee">ZeroColumn</a> (<a class="el" href="classMat.html">Mat</a> matrix, <a class="el" href="classPetscInt.html">PetscInt</a> col)</td></tr>
<tr class="separator:ac790257be5a8cc501376fef953a76cee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18737a2adfa34aa5d7c9bec630c8a688" id="r_a18737a2adfa34aa5d7c9bec630c8a688"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#a18737a2adfa34aa5d7c9bec630c8a688">Zero</a> (<a class="el" href="classMat.html">Mat</a> matrix)</td></tr>
<tr class="separator:a18737a2adfa34aa5d7c9bec630c8a688"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a871794b7b4edc05a98810c83a6e59f05" id="r_a871794b7b4edc05a98810c83a6e59f05"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#a871794b7b4edc05a98810c83a6e59f05">GetSize</a> (<a class="el" href="classMat.html">Mat</a> matrix)</td></tr>
<tr class="separator:a871794b7b4edc05a98810c83a6e59f05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a9a78b5ccdd2ac99a9e46f09de9e04e" id="r_a7a9a78b5ccdd2ac99a9e46f09de9e04e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#a7a9a78b5ccdd2ac99a9e46f09de9e04e">GetOwnershipRange</a> (<a class="el" href="classMat.html">Mat</a> matrix, <a class="el" href="classPetscInt.html">PetscInt</a> &amp;lo, <a class="el" href="classPetscInt.html">PetscInt</a> &amp;hi)</td></tr>
<tr class="separator:a7a9a78b5ccdd2ac99a9e46f09de9e04e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04bf4f209ef30a6118bba7c90279844a" id="r_a04bf4f209ef30a6118bba7c90279844a"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#a04bf4f209ef30a6118bba7c90279844a">GetElement</a> (<a class="el" href="classMat.html">Mat</a> matrix, <a class="el" href="classPetscInt.html">PetscInt</a> row, <a class="el" href="classPetscInt.html">PetscInt</a> col)</td></tr>
<tr class="separator:a04bf4f209ef30a6118bba7c90279844a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5aa09bdaed7d4372cab33f898c593399" id="r_a5aa09bdaed7d4372cab33f898c593399"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#a5aa09bdaed7d4372cab33f898c593399">SetOption</a> (<a class="el" href="classMat.html">Mat</a> matrix, MatOption option)</td></tr>
<tr class="separator:a5aa09bdaed7d4372cab33f898c593399"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a201396f082f8e0cb5b27cc4694f8d8" id="r_a8a201396f082f8e0cb5b27cc4694f8d8"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classVec.html">Vec</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#a8a201396f082f8e0cb5b27cc4694f8d8">GetMatrixRowDistributed</a> (<a class="el" href="classMat.html">Mat</a> matrix, <a class="el" href="classunsigned.html">unsigned</a> rowIndex)</td></tr>
<tr class="separator:a8a201396f082f8e0cb5b27cc4694f8d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5c7e184836edcfcacdf6f2af9bfb48a" id="r_ad5c7e184836edcfcacdf6f2af9bfb48a"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#ad5c7e184836edcfcacdf6f2af9bfb48a">CheckEquality</a> (const <a class="el" href="classMat.html">Mat</a> mat1, const <a class="el" href="classMat.html">Mat</a> mat2, <a class="el" href="classdouble.html">double</a> tol=1e-10)</td></tr>
<tr class="separator:ad5c7e184836edcfcacdf6f2af9bfb48a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ae709c830c74b78f9c6ec0c1e6ad49a" id="r_a6ae709c830c74b78f9c6ec0c1e6ad49a"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#a6ae709c830c74b78f9c6ec0c1e6ad49a">CheckSymmetry</a> (const <a class="el" href="classMat.html">Mat</a> matrix, <a class="el" href="classdouble.html">double</a> tol=1e-10)</td></tr>
<tr class="separator:a6ae709c830c74b78f9c6ec0c1e6ad49a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae34f801127811d479e384e725514c9bb" id="r_ae34f801127811d479e384e725514c9bb"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#ae34f801127811d479e384e725514c9bb">TurnOffVariableAllocationError</a> (<a class="el" href="classMat.html">Mat</a> matrix)</td></tr>
<tr class="separator:ae34f801127811d479e384e725514c9bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8563e1b557a0b0051e2659d186c2bddd" id="r_a8563e1b557a0b0051e2659d186c2bddd"><td class="memTemplParams" colspan="2">template&lt;size_t MATRIX_SIZE&gt; </td></tr>
<tr class="memitem:a8563e1b557a0b0051e2659d186c2bddd"><td class="memTemplItemLeft" align="right" valign="top">static void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#a8563e1b557a0b0051e2659d186c2bddd">AddMultipleValues</a> (<a class="el" href="classMat.html">Mat</a> matrix, <a class="el" href="classunsigned.html">unsigned</a> *matrixRowAndColIndices, c_matrix&lt; <a class="el" href="classdouble.html">double</a>, MATRIX_SIZE, MATRIX_SIZE &gt; &amp;rSmallMatrix)</td></tr>
<tr class="separator:a8563e1b557a0b0051e2659d186c2bddd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A collection of static methods for working with PETSc matrices. </p>

<p class="definition">Definition at line <a class="el" href="PetscMatTools_8hpp_source.html#l00048">48</a> of file <a class="el" href="PetscMatTools_8hpp_source.html">PetscMatTools.hpp</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a8563e1b557a0b0051e2659d186c2bddd" name="a8563e1b557a0b0051e2659d186c2bddd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8563e1b557a0b0051e2659d186c2bddd">&#9670;&#160;</a></span>AddMultipleValues()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;size_t MATRIX_SIZE&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void PetscMatTools::AddMultipleValues </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classunsigned.html">unsigned</a> *&#160;</td>
          <td class="paramname"><em>matrixRowAndColIndices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">c_matrix&lt; <a class="el" href="classdouble.html">double</a>, MATRIX_SIZE, MATRIX_SIZE &gt; &amp;&#160;</td>
          <td class="paramname"><em>rSmallMatrix</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Add multiple values to a matrix.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix</td><td>the matrix </td></tr>
    <tr><td class="paramname">matrixRowAndColIndices</td><td>mapping from index of the ublas matrix (see param below) to index of the PETSc matrix of this linear system </td></tr>
    <tr><td class="paramname">rSmallMatrix</td><td>Ublas matrix containing the values to be added</td></tr>
  </table>
  </dd>
</dl>
<p>N.B. Values which are not local (ie the row is not owned) will be skipped. </p>

<p class="definition">Definition at line <a class="el" href="PetscMatTools_8hpp_source.html#l00237">237</a> of file <a class="el" href="PetscMatTools_8hpp_source.html">PetscMatTools.hpp</a>.</p>

<p class="reference">References <a class="el" href="PetscMatTools_8cpp_source.html#l00305">GetOwnershipRange()</a>.</p>

<p class="reference">Referenced by <a class="el" href="LinearSystem_8hpp_source.html#l00540">LinearSystem::AddLhsMultipleValues()</a>.</p>

</div>
</div>
<a id="a07f631eba92647e0f96eb9c007668b89" name="a07f631eba92647e0f96eb9c007668b89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07f631eba92647e0f96eb9c007668b89">&#9670;&#160;</a></span>AddToElement()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::AddToElement </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPetscInt.html">PetscInt</a>&#160;</td>
          <td class="paramname"><em>row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPetscInt.html">PetscInt</a>&#160;</td>
          <td class="paramname"><em>col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdouble.html">double</a>&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Add the specified value to an entry of a matrix.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix</td><td>the matrix </td></tr>
    <tr><td class="paramname">row</td><td>the row index </td></tr>
    <tr><td class="paramname">col</td><td>the column index </td></tr>
    <tr><td class="paramname">value</td><td>the value for this entry </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00056">56</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p class="reference">References <a class="el" href="PetscMatTools_8cpp_source.html#l00305">GetOwnershipRange()</a>.</p>

<p class="reference">Referenced by <a class="el" href="LinearSystem_8cpp_source.html#l00315">LinearSystem::AddToMatrixElement()</a>, and <a class="el" href="NodeBasedCellPopulationWithBuskeUpdate_8cpp_source.html#l00057">NodeBasedCellPopulationWithBuskeUpdate&lt; DIM &gt;::UpdateNodeLocations()</a>.</p>

</div>
</div>
<a id="ad5c7e184836edcfcacdf6f2af9bfb48a" name="ad5c7e184836edcfcacdf6f2af9bfb48a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5c7e184836edcfcacdf6f2af9bfb48a">&#9670;&#160;</a></span>CheckEquality()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> PetscMatTools::CheckEquality </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMat.html">Mat</a>&#160;</td>
          <td class="paramname"><em>mat1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMat.html">Mat</a>&#160;</td>
          <td class="paramname"><em>mat2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdouble.html">double</a>&#160;</td>
          <td class="paramname"><em>tol</em> = <code>1e-10</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>true if two matrices are equal to within a given tolerance.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mat1</td><td>the first matrix </td></tr>
    <tr><td class="paramname">mat2</td><td>the second matrix </td></tr>
    <tr><td class="paramname">tol</td><td>the tolerance </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00378">378</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p class="reference">References <a class="el" href="PetscTools_8hpp_source.html#l00352">PetscTools::Destroy()</a>.</p>

<p class="reference">Referenced by <a class="el" href="PetscMatTools_8cpp_source.html#l00401">CheckSymmetry()</a>, and <a class="el" href="AbstractNonlinearAssemblerSolverHybrid_8hpp_source.html#l00443">AbstractNonlinearAssemblerSolverHybrid&lt; ELEMENT_DIM, SPACE_DIM, PROBLEM_DIM &gt;::VerifyJacobian()</a>.</p>

</div>
</div>
<a id="a6ae709c830c74b78f9c6ec0c1e6ad49a" name="a6ae709c830c74b78f9c6ec0c1e6ad49a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ae709c830c74b78f9c6ec0c1e6ad49a">&#9670;&#160;</a></span>CheckSymmetry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> PetscMatTools::CheckSymmetry </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMat.html">Mat</a>&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdouble.html">double</a>&#160;</td>
          <td class="paramname"><em>tol</em> = <code>1e-10</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>true if the matrix is symmetric Check whether a matrix is symmetric, to within a given tolerance, by checking if it is (approximately) equal to its transpose.</dd></dl>
<p>Note that while there is a PETSc method MatIsSymmetric, it won't work in parallel on some PETSc versions: "Matrix of type &lt;mpiaij&gt; does not support checking for symmetric!"</p>
<p>Also checking for exact equality of the transpose can break on 32bit systems.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix</td><td>the matrix to check </td></tr>
    <tr><td class="paramname">tol</td><td>the tolerance </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00401">401</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p class="reference">References <a class="el" href="PetscMatTools_8cpp_source.html#l00378">CheckEquality()</a>, and <a class="el" href="PetscTools_8hpp_source.html#l00352">PetscTools::Destroy()</a>.</p>

</div>
</div>
<a id="ad78e39050573affee9679e2b5b2807fd" name="ad78e39050573affee9679e2b5b2807fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad78e39050573affee9679e2b5b2807fd">&#9670;&#160;</a></span>Display()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::Display </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&#160;</td>
          <td class="paramname"><em>matrix</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Display a matrix.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix</td><td>the matrix </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00079">79</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="LinearSystem_8cpp_source.html#l00362">LinearSystem::DisplayMatrix()</a>.</p>

</div>
</div>
<a id="aa9717ce944536cda4afaac557aba7254" name="aa9717ce944536cda4afaac557aba7254"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9717ce944536cda4afaac557aba7254">&#9670;&#160;</a></span>Finalise()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::Finalise </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&#160;</td>
          <td class="paramname"><em>matrix</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Sets up the matrix ready for use, e.g. in solving a linear system. This is a wrapper to PETSc functions like MatAssemblyBegin(matrix, MAT_FINAL_ASSEMBLY). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix</td><td>the matrix </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00067">67</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00672">AbstractContinuumMechanicsSolver&lt; DIM &gt;::ApplyDirichletBoundaryConditions()</a>, <a class="el" href="BoundaryConditionsContainerImplementation_8hpp_source.html#l00522">BoundaryConditionsContainer&lt; ELEMENT_DIM, SPACE_DIM, PROBLEM_DIM &gt;::ApplyDirichletToNonlinearJacobian()</a>, <a class="el" href="StokesFlowSolver_8hpp_source.html#l00285">StokesFlowSolver&lt; DIM &gt;::AssembleSystem()</a>, <a class="el" href="AbstractNonlinearAssemblerSolverHybrid_8hpp_source.html#l00321">AbstractNonlinearAssemblerSolverHybrid&lt; ELEMENT_DIM, SPACE_DIM, PROBLEM_DIM &gt;::ComputeJacobian()</a>, <a class="el" href="AbstractNonlinearAssemblerSolverHybrid_8hpp_source.html#l00342">AbstractNonlinearAssemblerSolverHybrid&lt; ELEMENT_DIM, SPACE_DIM, PROBLEM_DIM &gt;::ComputeJacobianNumerically()</a>, <a class="el" href="LinearSystem_8cpp_source.html#l00332">LinearSystem::FinaliseLhsMatrix()</a>, <a class="el" href="LinearSystem_8cpp_source.html#l00342">LinearSystem::FinalisePrecondMatrix()</a>, <a class="el" href="AbstractNonlinearElasticitySolver_8hpp_source.html#l00843">AbstractNonlinearElasticitySolver&lt; DIM &gt;::FinishAssembleSystem()</a>, <a class="el" href="NodePartitioner_8cpp_source.html#l00071">NodePartitioner&lt; ELEMENT_DIM, SPACE_DIM &gt;::PetscMatrixPartitioning()</a>, <a class="el" href="BidomainSolver_8cpp_source.html#l00065">BidomainSolver&lt; ELEMENT_DIM, SPACE_DIM &gt;::SetupLinearSystem()</a>, <a class="el" href="ExtendedBidomainSolver_8cpp_source.html#l00064">ExtendedBidomainSolver&lt; ELEM_DIM, SPACE_DIM &gt;::SetupLinearSystem()</a>, <a class="el" href="MonodomainPurkinjeSolver_8cpp_source.html#l00044">MonodomainPurkinjeSolver&lt; ELEMENT_DIM, SPACE_DIM &gt;::SetupLinearSystem()</a>, <a class="el" href="MonodomainSolver_8cpp_source.html#l00042">MonodomainSolver&lt; ELEMENT_DIM, SPACE_DIM &gt;::SetupLinearSystem()</a>, <a class="el" href="OperatorSplittingMonodomainSolver_8cpp_source.html#l00040">OperatorSplittingMonodomainSolver&lt; ELEMENT_DIM, SPACE_DIM &gt;::SetupLinearSystem()</a>, <a class="el" href="NodeBasedCellPopulationWithBuskeUpdate_8cpp_source.html#l00057">NodeBasedCellPopulationWithBuskeUpdate&lt; DIM &gt;::UpdateNodeLocations()</a>, <a class="el" href="PetscMatTools_8cpp_source.html#l00255">ZeroColumn()</a>, <a class="el" href="PetscMatTools_8cpp_source.html#l00191">ZeroRowsAndColumnsWithValueOnDiagonal()</a>, and <a class="el" href="PetscMatTools_8cpp_source.html#l00109">ZeroRowsWithValueOnDiagonal()</a>.</p>

</div>
</div>
<a id="a04bf4f209ef30a6118bba7c90279844a" name="a04bf4f209ef30a6118bba7c90279844a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04bf4f209ef30a6118bba7c90279844a">&#9670;&#160;</a></span>GetElement()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classdouble.html">double</a> PetscMatTools::GetElement </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPetscInt.html">PetscInt</a>&#160;</td>
          <td class="paramname"><em>row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPetscInt.html">PetscInt</a>&#160;</td>
          <td class="paramname"><em>col</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>an element of a matrix. May only be called for elements you own.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix</td><td>the matrix </td></tr>
    <tr><td class="paramname">row</td><td>the row index </td></tr>
    <tr><td class="paramname">col</td><td>the column index </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00310">310</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p class="reference">References <a class="el" href="PetscMatTools_8cpp_source.html#l00305">GetOwnershipRange()</a>.</p>

<p class="reference">Referenced by <a class="el" href="LinearSystem_8cpp_source.html#l00489">LinearSystem::GetMatrixElement()</a>, and <a class="el" href="PetscMatTools_8cpp_source.html#l00255">ZeroColumn()</a>.</p>

</div>
</div>
<a id="a8a201396f082f8e0cb5b27cc4694f8d8" name="a8a201396f082f8e0cb5b27cc4694f8d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a201396f082f8e0cb5b27cc4694f8d8">&#9670;&#160;</a></span>GetMatrixRowDistributed()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classVec.html">Vec</a> PetscMatTools::GetMatrixRowDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classunsigned.html">unsigned</a>&#160;</td>
          <td class="paramname"><em>rowIndex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns the i-th row of the LHS matrix as a distributed PETSc Vec</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix</td><td>the matrix </td></tr>
    <tr><td class="paramname">rowIndex</td><td>the row index </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>rowIndex-th row of the matrix in distributed format </dd></dl>

<p class="definition">Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00337">337</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p class="reference">References <a class="el" href="PetscTools_8cpp_source.html#l00218">PetscTools::CreateVec()</a>, <a class="el" href="PetscMatTools_8cpp_source.html#l00305">GetOwnershipRange()</a>, and <a class="el" href="PetscMatTools_8cpp_source.html#l00296">GetSize()</a>.</p>

<p class="reference">Referenced by <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00672">AbstractContinuumMechanicsSolver&lt; DIM &gt;::ApplyDirichletBoundaryConditions()</a>, and <a class="el" href="LinearSystem_8cpp_source.html#l00377">LinearSystem::GetMatrixRowDistributed()</a>.</p>

</div>
</div>
<a id="a7a9a78b5ccdd2ac99a9e46f09de9e04e" name="a7a9a78b5ccdd2ac99a9e46f09de9e04e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a9a78b5ccdd2ac99a9e46f09de9e04e">&#9670;&#160;</a></span>GetOwnershipRange()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::GetOwnershipRange </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPetscInt.html">PetscInt</a> &amp;&#160;</td>
          <td class="paramname"><em>lo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPetscInt.html">PetscInt</a> &amp;&#160;</td>
          <td class="paramname"><em>hi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns this process's ownership range of the contents of the matrix via arguments.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix</td><td>the matrix </td></tr>
    <tr><td class="paramname">lo</td><td>lowest index owned by this process (returned) </td></tr>
    <tr><td class="paramname">hi</td><td>highest index owned by this process (returned) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00305">305</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="PetscMatTools_8hpp_source.html#l00237">AddMultipleValues()</a>, <a class="el" href="PetscMatTools_8cpp_source.html#l00056">AddToElement()</a>, <a class="el" href="PetscMatTools_8cpp_source.html#l00310">GetElement()</a>, <a class="el" href="PetscMatTools_8cpp_source.html#l00337">GetMatrixRowDistributed()</a>, <a class="el" href="PetscMatTools_8cpp_source.html#l00045">SetElement()</a>, <a class="el" href="PetscMatTools_8cpp_source.html#l00093">SetRow()</a>, <a class="el" href="PetscMatTools_8cpp_source.html#l00255">ZeroColumn()</a>, and <a class="el" href="PetscMatTools_8cpp_source.html#l00191">ZeroRowsAndColumnsWithValueOnDiagonal()</a>.</p>

</div>
</div>
<a id="a871794b7b4edc05a98810c83a6e59f05" name="a871794b7b4edc05a98810c83a6e59f05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a871794b7b4edc05a98810c83a6e59f05">&#9670;&#160;</a></span>GetSize()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classunsigned.html">unsigned</a> PetscMatTools::GetSize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&#160;</td>
          <td class="paramname"><em>matrix</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>the size of a matrix </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix</td><td>the matrix </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00296">296</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="AbstractContinuumMechanicsAssembler_8hpp_source.html#l00344">AbstractContinuumMechanicsAssembler&lt; DIM, CAN_ASSEMBLE_VECTOR, CAN_ASSEMBLE_MATRIX &gt;::DoAssemble()</a>, and <a class="el" href="PetscMatTools_8cpp_source.html#l00337">GetMatrixRowDistributed()</a>.</p>

</div>
</div>
<a id="ad2991678b6341cb488fcf53bca9c7af1" name="ad2991678b6341cb488fcf53bca9c7af1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2991678b6341cb488fcf53bca9c7af1">&#9670;&#160;</a></span>SetElement()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::SetElement </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPetscInt.html">PetscInt</a>&#160;</td>
          <td class="paramname"><em>row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPetscInt.html">PetscInt</a>&#160;</td>
          <td class="paramname"><em>col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdouble.html">double</a>&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Change one of the entries of a matrix to the specified value.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix</td><td>the matrix </td></tr>
    <tr><td class="paramname">row</td><td>the row index </td></tr>
    <tr><td class="paramname">col</td><td>the column index </td></tr>
    <tr><td class="paramname">value</td><td>the value for this entry </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00045">45</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p class="reference">References <a class="el" href="PetscMatTools_8cpp_source.html#l00305">GetOwnershipRange()</a>.</p>

<p class="reference">Referenced by <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00796">AbstractContinuumMechanicsSolver&lt; DIM &gt;::AddIdentityBlockForDummyPressureVariables()</a>, <a class="el" href="BoundaryConditionsContainerImplementation_8hpp_source.html#l00422">BoundaryConditionsContainer&lt; ELEMENT_DIM, SPACE_DIM, PROBLEM_DIM &gt;::ApplyPeriodicBcsToLinearProblem()</a>, <a class="el" href="AbstractNonlinearAssemblerSolverHybrid_8hpp_source.html#l00342">AbstractNonlinearAssemblerSolverHybrid&lt; ELEMENT_DIM, SPACE_DIM, PROBLEM_DIM &gt;::ComputeJacobianNumerically()</a>, <a class="el" href="AbstractBidomainSolver_8cpp_source.html#l00307">AbstractBidomainSolver&lt; ELEMENT_DIM, SPACE_DIM &gt;::FinaliseForBath()</a>, <a class="el" href="MonodomainPurkinjeSolver_8cpp_source.html#l00140">MonodomainPurkinjeSolver&lt; ELEMENT_DIM, SPACE_DIM &gt;::SetIdentityBlockToLhsMatrix()</a>, <a class="el" href="LinearSystem_8cpp_source.html#l00310">LinearSystem::SetMatrixElement()</a>, and <a class="el" href="PetscMatTools_8cpp_source.html#l00093">SetRow()</a>.</p>

</div>
</div>
<a id="a5aa09bdaed7d4372cab33f898c593399" name="a5aa09bdaed7d4372cab33f898c593399"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5aa09bdaed7d4372cab33f898c593399">&#9670;&#160;</a></span>SetOption()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::SetOption </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MatOption&#160;</td>
          <td class="paramname"><em>option</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Set a PETSc matrix option to be true, using the PETSc method MatSetOption.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix</td><td>the matrix for which to set the option </td></tr>
    <tr><td class="paramname">option</td><td>the option to set </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00328">328</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="LinearSystem_8cpp_source.html#l00544">LinearSystem::SetMatrixIsSymmetric()</a>.</p>

</div>
</div>
<a id="a4653d233e1382cf612d0cef06f43e630" name="a4653d233e1382cf612d0cef06f43e630"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4653d233e1382cf612d0cef06f43e630">&#9670;&#160;</a></span>SetRow()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::SetRow </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPetscInt.html">PetscInt</a>&#160;</td>
          <td class="paramname"><em>row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdouble.html">double</a>&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Set all entries in a given row of a matrix to a certain value. This must be called by the process who owns the row, (but other processors will treat it as a null-op)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix</td><td>the matrix </td></tr>
    <tr><td class="paramname">row</td><td>the row index </td></tr>
    <tr><td class="paramname">value</td><td>the value to set each entry in this row </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00093">93</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p class="reference">References <a class="el" href="PetscMatTools_8cpp_source.html#l00305">GetOwnershipRange()</a>, and <a class="el" href="PetscMatTools_8cpp_source.html#l00045">SetElement()</a>.</p>

<p class="reference">Referenced by <a class="el" href="LinearSystem_8cpp_source.html#l00372">LinearSystem::SetMatrixRow()</a>.</p>

</div>
</div>
<a id="a81ec00917b30dcf7da65791a05eb35ee" name="a81ec00917b30dcf7da65791a05eb35ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81ec00917b30dcf7da65791a05eb35ee">&#9670;&#160;</a></span>SwitchWriteMode()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::SwitchWriteMode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&#160;</td>
          <td class="paramname"><em>matrix</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This must be called if switching between inserting or adding values to the matrix, to ensure all processes are in sync. This is a wrapper to PETSc functions like MatAssemblyBegin(matrix, MAT_FLUSH_ASSEMBLY). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix</td><td>the matrix </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00073">73</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="StokesFlowSolver_8hpp_source.html#l00285">StokesFlowSolver&lt; DIM &gt;::AssembleSystem()</a>, <a class="el" href="IncompressibleNonlinearElasticitySolver_8cpp_source.html#l00052">IncompressibleNonlinearElasticitySolver&lt; DIM &gt;::AssembleSystem()</a>, <a class="el" href="AbstractNonlinearAssemblerSolverHybrid_8hpp_source.html#l00321">AbstractNonlinearAssemblerSolverHybrid&lt; ELEMENT_DIM, SPACE_DIM, PROBLEM_DIM &gt;::ComputeJacobian()</a>, <a class="el" href="AbstractNonlinearElasticitySolver_8hpp_source.html#l00843">AbstractNonlinearElasticitySolver&lt; DIM &gt;::FinishAssembleSystem()</a>, <a class="el" href="MonodomainPurkinjeSolver_8cpp_source.html#l00140">MonodomainPurkinjeSolver&lt; ELEMENT_DIM, SPACE_DIM &gt;::SetIdentityBlockToLhsMatrix()</a>, and <a class="el" href="LinearSystem_8cpp_source.html#l00337">LinearSystem::SwitchWriteModeLhsMatrix()</a>.</p>

</div>
</div>
<a id="ae34f801127811d479e384e725514c9bb" name="ae34f801127811d479e384e725514c9bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae34f801127811d479e384e725514c9bb">&#9670;&#160;</a></span>TurnOffVariableAllocationError()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::TurnOffVariableAllocationError </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&#160;</td>
          <td class="paramname"><em>matrix</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Tells PETSc to set MAT_NEW_NONZERO_ALLOCATION_ERR to false.</p>
<p>This should be called immediately after <a class="el" href="classPetscTools.html#ad6d7a60499c5a6bd9c64eb35fffd3b06">PetscTools::SetupMat</a> and before any other operations on the matrix.</p>
<p>** Currently only used in PETSc 3.3 and later ** in PETSc 3.2 and earlier MAT_NEW_NONZERO_ALLOCATION_ERR defaults to false in PETSc 3.3 MAT_NEW_NONZERO_ALLOCATION_ERR defaults to true</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix</td><td>The matrix to set </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00414">414</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="AbstractBidomainSolver_8cpp_source.html#l00043">AbstractBidomainSolver&lt; DIM, DIM &gt;::InitialiseForSolve()</a>, and <a class="el" href="AbstractExtendedBidomainSolver_8cpp_source.html#l00039">AbstractExtendedBidomainSolver&lt; ELEMENT_DIM, SPACE_DIM &gt;::InitialiseForSolve()</a>.</p>

</div>
</div>
<a id="a18737a2adfa34aa5d7c9bec630c8a688" name="a18737a2adfa34aa5d7c9bec630c8a688"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18737a2adfa34aa5d7c9bec630c8a688">&#9670;&#160;</a></span>Zero()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::Zero </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&#160;</td>
          <td class="paramname"><em>matrix</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Zero all entries of a matrix. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix</td><td>the matrix </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00291">291</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="CompressibleNonlinearElasticitySolver_8cpp_source.html#l00054">CompressibleNonlinearElasticitySolver&lt; DIM &gt;::AssembleSystem()</a>, <a class="el" href="IncompressibleNonlinearElasticitySolver_8cpp_source.html#l00052">IncompressibleNonlinearElasticitySolver&lt; DIM &gt;::AssembleSystem()</a>, <a class="el" href="AbstractContinuumMechanicsAssembler_8hpp_source.html#l00344">AbstractContinuumMechanicsAssembler&lt; DIM, CAN_ASSEMBLE_VECTOR, CAN_ASSEMBLE_MATRIX &gt;::DoAssemble()</a>, <a class="el" href="AbstractFeCableIntegralAssembler_8hpp_source.html#l00237">AbstractFeCableIntegralAssembler&lt; ELEMENT_DIM, SPACE_DIM, PROBLEM_DIM, CAN_ASSEMBLE_VECTOR, CAN_ASSEMBLE_MATRIX, INTERPOLATION_LEVEL &gt;::DoAssemble()</a>, <a class="el" href="AbstractFeVolumeIntegralAssembler_8hpp_source.html#l00257">AbstractFeVolumeIntegralAssembler&lt; ELEMENT_DIM, SPACE_DIM, PROBLEM_DIM, CAN_ASSEMBLE_VECTOR, CAN_ASSEMBLE_MATRIX, INTERPOLATION_LEVEL &gt;::DoAssemble()</a>, and <a class="el" href="LinearSystem_8cpp_source.html#l00402">LinearSystem::ZeroLhsMatrix()</a>.</p>

</div>
</div>
<a id="ac790257be5a8cc501376fef953a76cee" name="ac790257be5a8cc501376fef953a76cee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac790257be5a8cc501376fef953a76cee">&#9670;&#160;</a></span>ZeroColumn()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::ZeroColumn </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPetscInt.html">PetscInt</a>&#160;</td>
          <td class="paramname"><em>col</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Zero a column of a matrix.</p>
<p>Unfortunately there is no equivalent method in Petsc, so this has to be done carefully to ensure that the sparsity structure of the matrix is not broken. Only owned entries which are non-zero are zeroed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix</td><td>the matrix </td></tr>
    <tr><td class="paramname">col</td><td>the column index </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00255">255</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p class="reference">References <a class="el" href="PetscMatTools_8cpp_source.html#l00067">Finalise()</a>, <a class="el" href="PetscMatTools_8cpp_source.html#l00310">GetElement()</a>, and <a class="el" href="PetscMatTools_8cpp_source.html#l00305">GetOwnershipRange()</a>.</p>

<p class="reference">Referenced by <a class="el" href="LinearSystem_8cpp_source.html#l00392">LinearSystem::ZeroMatrixColumn()</a>.</p>

</div>
</div>
<a id="a742a2bec669f75b1067b282ce6cf3b11" name="a742a2bec669f75b1067b282ce6cf3b11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a742a2bec669f75b1067b282ce6cf3b11">&#9670;&#160;</a></span>ZeroRowsAndColumnsWithValueOnDiagonal()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::ZeroRowsAndColumnsWithValueOnDiagonal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classunsigned.html">unsigned</a> &gt;&#160;</td>
          <td class="paramname"><em>rowColIndices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdouble.html">double</a>&#160;</td>
          <td class="paramname"><em>diagonalValue</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Zero several rows and columns of a matrix, putting a given value on the diagonal.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix</td><td>the matrix </td></tr>
    <tr><td class="paramname">rowColIndices</td><td>A list of indices. All the rows with these indices, and all the columns with these indices, will be zeroed. This vector is copied (ie not passed in by reference), as it will be sorted into ascending order </td></tr>
    <tr><td class="paramname">diagonalValue</td><td>value to put in the diagonal entries (of the zeroed rows) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00191">191</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p class="reference">References <a class="el" href="PetscMatTools_8cpp_source.html#l00067">Finalise()</a>, <a class="el" href="PetscMatTools_8cpp_source.html#l00305">GetOwnershipRange()</a>, and <a class="el" href="PetscMatTools_8cpp_source.html#l00109">ZeroRowsWithValueOnDiagonal()</a>.</p>

<p class="reference">Referenced by <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00672">AbstractContinuumMechanicsSolver&lt; DIM &gt;::ApplyDirichletBoundaryConditions()</a>, and <a class="el" href="LinearSystem_8cpp_source.html#l00387">LinearSystem::ZeroMatrixRowsAndColumnsWithValueOnDiagonal()</a>.</p>

</div>
</div>
<a id="a5a68cf8b1e9a1630f54a60feb03084b9" name="a5a68cf8b1e9a1630f54a60feb03084b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a68cf8b1e9a1630f54a60feb03084b9">&#9670;&#160;</a></span>ZeroRowsWithValueOnDiagonal()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::ZeroRowsWithValueOnDiagonal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classunsigned.html">unsigned</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>rRows</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdouble.html">double</a>&#160;</td>
          <td class="paramname"><em>diagonalValue</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Zero several rows of a matrix, putting a given value in the diagonal entries.</p>
<p>*Massively* less expensive than zeroing each matrix row individually</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix</td><td>the matrix </td></tr>
    <tr><td class="paramname">rRows</td><td>std::vector of rows to be zeroed </td></tr>
    <tr><td class="paramname">diagonalValue</td><td>value to put in the diagonal entries (of the zeroed rows) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00109">109</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p class="reference">References <a class="el" href="PetscMatTools_8cpp_source.html#l00067">Finalise()</a>, and <a class="el" href="PetscTools_8hpp_source.html#l00070">PETSC_DESTROY_PARAM</a>.</p>

<p class="reference">Referenced by <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00672">AbstractContinuumMechanicsSolver&lt; DIM &gt;::ApplyDirichletBoundaryConditions()</a>, <a class="el" href="BoundaryConditionsContainerImplementation_8hpp_source.html#l00522">BoundaryConditionsContainer&lt; ELEMENT_DIM, SPACE_DIM, PROBLEM_DIM &gt;::ApplyDirichletToNonlinearJacobian()</a>, <a class="el" href="LinearSystem_8cpp_source.html#l00382">LinearSystem::ZeroMatrixRowsWithValueOnDiagonal()</a>, and <a class="el" href="PetscMatTools_8cpp_source.html#l00191">ZeroRowsAndColumnsWithValueOnDiagonal()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>linalg/src/<a class="el" href="PetscMatTools_8hpp_source.html">PetscMatTools.hpp</a></li>
<li>linalg/src/<a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classPetscMatTools.html">PetscMatTools</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
