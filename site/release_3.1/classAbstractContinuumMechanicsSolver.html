<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Chaste: AbstractContinuumMechanicsSolver&lt; DIM &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript">
$(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<script type="text/javascript">
function hasClass(ele,cls) {
  return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));
}

function addClass(ele,cls) {
  if (!this.hasClass(ele,cls)) ele.className += " "+cls;
}

function removeClass(ele,cls) {
  if (hasClass(ele,cls)) {
    var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');
    ele.className=ele.className.replace(reg,' ');
  }
}

function toggleVisibility(linkObj) {
 var base = linkObj.getAttribute('id');
 var summary = document.getElementById(base + '-summary');
 var content = document.getElementById(base + '-content');
 var trigger = document.getElementById(base + '-trigger');
 if ( hasClass(linkObj,'closed') ) {
   summary.style.display = 'none';
   content.style.display = 'block';
   trigger.src = 'open.png';
   removeClass(linkObj,'closed');
   addClass(linkObj,'opened');
 } else if ( hasClass(linkObj,'opened') ) {
   summary.style.display = 'block';
   content.style.display = 'none';
   trigger.src = 'closed.png';
   removeClass(linkObj,'opened');
   addClass(linkObj,'closed');
 }
 return false;
}
</script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Chaste&#160;<span id="projectnumber">Release::3.1</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('classAbstractContinuumMechanicsSolver.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a>  </div>
  <div class="headertitle">
<div class="title">AbstractContinuumMechanicsSolver&lt; DIM &gt; Class Template Reference</div>  </div>
</div>
<div class="contents">
<!-- doxytag: class="AbstractContinuumMechanicsSolver" -->
<p><code>#include &lt;<a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html">AbstractContinuumMechanicsSolver.hpp</a>&gt;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png"/> Inheritance diagram for AbstractContinuumMechanicsSolver&lt; DIM &gt;:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classAbstractContinuumMechanicsSolver__inherit__graph.png" border="0" usemap="#AbstractContinuumMechanicsSolver_3_01DIM_01_4_inherit__map" alt="Inheritance graph"/></div>
<map name="AbstractContinuumMechanicsSolver_3_01DIM_01_4_inherit__map" id="AbstractContinuumMechanicsSolver_3_01DIM_01_4_inherit__map">
<area shape="rect" href="classAbstractNonlinearElasticitySolver.html" title="{AbstractNonlinearElasticitySolver\&lt; DIM \&gt;\n|# mrProblemDefinition\l# mrJacobianMatrix\l# mChangeOfBasisMatrix\l# mKspAbsoluteTol\l# mWriteOutputEachNewtonIteration\l# dTdE\l# mNumNewtonIterations\l# mCurrentTime\l# mCheckedOutwardNormals\l# mUseSnesSolver\l# mLastDampingValue\l# mIncludeActiveTension\l# mSetComputeAverageStressPerElement\l# mAverageStressesPerElement\l# NUM_VERTICES_PER_ELEMENT\l# NUM_NODES_PER_ELEMENT\l# NUM_NODES_PER_BOUNDARY_ELEMENT\l# BOUNDARY_STENCIL_SIZE\l# MAX_NEWTON_ABS_TOL\l# MIN_NEWTON_ABS_TOL\l# NEWTON_REL_TOL\l|+ ComputeResidual()\l+ ComputeJacobian()\l+ AbstractNonlinearElasticitySolver()\l+ ~AbstractNonlinearElasticitySolver()\l+ Solve()\l+ SetIncludeActiveTension()\l+ GetNumNewtonIterations()\l+ SetWriteOutputEachNewtonIteration()\l+ SetKspAbsoluteTolerance()\l+ SetCurrentTime()\l+ CreateCmguiOutput()\l+ WriteCurrentDeformationGradients()\l+ SetComputeAverageStressPerElementDuringSolve()\l+ WriteCurrentAverageElementStresses()\l+ rGetSpatialSolution()\l+ rGetDeformedPosition()\l+ GetAverageStressPerElement()\l# AddStressToAverageStressPerElement()\l# SetKspSolverAndPcType()\l# AssembleSystem()\l# FinishAssembleSystem()\l# GetElementCentroidDeformationGradient()\l# AddActiveStressAndStressDerivative()\l# SetupChangeOfBasisMatrix()\l# AssembleOnBoundaryElement()\l# ShouldAssembleMatrixTermForPressureOnDeformedBc()\l# AssembleOnBoundaryElementForPressureOnDeformedBc()\l# ComputeResidualAndGetNorm()\l# CalculateResidualNorm()\l# VectorSum()\l# PrintLineSearchResult()\l# TakeNewtonStep()\l# UpdateSolutionUsingLineSearch()\l# PostNewtonStep()\l# SolveNonSnes()\l&#45; SolveSnes()\l}" alt="" coords="135,648,513,1666"/><area shape="rect" href="classStokesFlowSolver.html" title="{StokesFlowSolver\&lt; DIM \&gt;\n|&#45; mrProblemDefinition\l&#45; mpStokesFlowAssembler\l&#45; mpStokesFlowPreconditionerAssembler\l&#45; mpNeumannBcsAssembler\l&#45; mKspAbsoluteTol\l|+ StokesFlowSolver()\l+ ~StokesFlowSolver()\l+ Solve()\l+ SetKspAbsoluteTolerance()\l+ rGetSpatialSolution()\l+ rGetVelocities()\l&#45; AssembleSystem()\l}" alt="" coords="537,1030,799,1284"/><area shape="rect" href="classCompressibleNonlinearElasticitySolver.html" title="{CompressibleNonlinearElasticitySolver\&lt; DIM \&gt;\n|# NUM_NODES_PER_ELEMENT\l# NUM_VERTICES_PER_ELEMENT\l# NUM_NODES_PER_BOUNDARY_ELEMENT\l# STENCIL_SIZE\l# BOUNDARY_STENCIL_SIZE\l|+ CompressibleNonlinearElasticitySolver()\l+ ~CompressibleNonlinearElasticitySolver()\l# AssembleOnElement()\l# AssembleSystem()\l}" alt="" coords="5,1724,312,1926"/><area shape="rect" href="classIncompressibleNonlinearElasticitySolver.html" title="{IncompressibleNonlinearElasticitySolver\&lt; DIM \&gt;\n|# NUM_NODES_PER_ELEMENT\l# NUM_VERTICES_PER_ELEMENT\l# NUM_NODES_PER_BOUNDARY_ELEMENT\l# STENCIL_SIZE\l# BOUNDARY_STENCIL_SIZE\l|+ IncompressibleNonlinearElasticitySolver()\l+ ~IncompressibleNonlinearElasticitySolver()\l# AssembleOnElement()\l# FormInitialGuess()\l# AssembleSystem()\l}" alt="" coords="336,1716,643,1934"/></map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png"/> Collaboration diagram for AbstractContinuumMechanicsSolver&lt; DIM &gt;:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classAbstractContinuumMechanicsSolver__coll__graph.png" border="0" usemap="#AbstractContinuumMechanicsSolver_3_01DIM_01_4_coll__map" alt="Collaboration graph"/></div>
<map name="AbstractContinuumMechanicsSolver_3_01DIM_01_4_coll__map" id="AbstractContinuumMechanicsSolver_3_01DIM_01_4_coll__map">
<area shape="rect" href="classGaussianQuadratureRule.html" title="{GaussianQuadratureRule\&lt; DIM \&gt;\n|&#45; mNumQuadPoints\l&#45; mPoints\l&#45; mWeights\l|+ GaussianQuadratureRule()\l+ rGetQuadPoint()\l+ GetWeight()\l+ GetNumQuadPoints()\l}" alt="" coords="897,516,1113,684"/><area shape="rect" href="classGaussianQuadratureRule.html" title="{GaussianQuadratureRule\&lt; ELEMENT_DIM \&gt;\n|&#45; mNumQuadPoints\l&#45; mPoints\l&#45; mWeights\l|+ GaussianQuadratureRule()\l+ rGetQuadPoint()\l+ GetWeight()\l+ GetNumQuadPoints()\l+ GaussianQuadratureRule()\l+ GaussianQuadratureRule()\l+ GaussianQuadratureRule()\l}" alt="" coords="1207,155,1492,374"/><area shape="rect" href="classGaussianQuadratureRule.html" title="{GaussianQuadratureRule\&lt; DIM&#45;1 \&gt;\n|&#45; mNumQuadPoints\l&#45; mPoints\l&#45; mWeights\l|+ GaussianQuadratureRule()\l+ rGetQuadPoint()\l+ GetWeight()\l+ GetNumQuadPoints()\l}" alt="" coords="1137,516,1364,684"/><area shape="rect" href="classOutputFileHandler.html" title="{OutputFileHandler\n|+ SIG_FILE_NAME\l&#45; mDirectory\l|+ OutputFileHandler()\l+ OutputFileHandler()\l+ GetOutputDirectoryFullPath()\l+ SetArchiveDirectory()\l+ OpenOutputFile()\l+ OpenOutputFile()\l+ CopyFileTo()\l+ FindFile()\l+ GetChasteTestOutputDirectory()\l&#45; CommonConstructor()\l&#45; MakeFoldersAndReturnFullPath()\l&#45; AddTrailingSlash()\l}" alt="" coords="5,456,227,744"/><area shape="rect" href="classunsigned.html" title="{unsigned\n||}" alt="" coords="1705,7,1777,90"/><area shape="rect" href="classbool.html" title="{bool\n||}" alt="" coords="1983,559,2028,642"/><area shape="rect" href="classMat.html" title="{Mat\n||}" alt="" coords="2079,559,2121,642"/><area shape="rect" href="classVec.html" title="{Vec\n||}" alt="" coords="2228,559,2271,642"/></map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>

<p><a href="classAbstractContinuumMechanicsSolver-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractContinuumMechanicsSolver.html#a821f100fbdf73e65c04931db1035f2c3">AbstractContinuumMechanicsSolver</a> (<a class="el" href="classQuadraticMesh.html">QuadraticMesh</a>&lt; DIM &gt; &amp;rQuadMesh, <a class="el" href="classContinuumMechanicsProblemDefinition.html">ContinuumMechanicsProblemDefinition</a>&lt; DIM &gt; &amp;rProblemDefinition, std::string outputDirectory, CompressibilityType compressibilityType)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractContinuumMechanicsSolver.html#a4c8eff89ceb7a1e131db6e96ec219096">~AbstractContinuumMechanicsSolver</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractContinuumMechanicsSolver.html#a6d64855299b8c48bc1bea5aabdb242dc">WriteCurrentSpatialSolution</a> (std::string fileName, std::string fileExtension, int counterToAppend=-1)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractContinuumMechanicsSolver.html#a5bd73daf24062075d89121a79c0e7a67">WriteCurrentPressureSolution</a> (int counterToAppend=-1)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractContinuumMechanicsSolver.html#ab1af2777defeef5e80e4cae6ff712530">SetWriteOutput</a> (<a class="el" href="classbool.html">bool</a> writeOutput=true)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractContinuumMechanicsSolver.html#acd32a5e1bb931190063959f5a5bb040a">CreateVtkOutput</a> (std::string spatialSolutionName=&quot;Spatial solution&quot;)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classdouble.html">double</a> &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractContinuumMechanicsSolver.html#a3912adf9b0055f61d0ae06e9292cb3bf">rGetCurrentSolution</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual std::vector&lt; c_vector<br class="typebreak"/>
&lt; <a class="el" href="classdouble.html">double</a>, DIM &gt; &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractContinuumMechanicsSolver.html#ab3e22eb77e1f658cda9746f591e2eb4d">rGetSpatialSolution</a> ()=0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classdouble.html">double</a> &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractContinuumMechanicsSolver.html#a8bb5efbf95c5e0028020c89c2b19011b">rGetPressures</a> ()</td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractContinuumMechanicsSolver.html#a51efb6d651249387f4018b3bf1d12503">AllocateMatrixMemory</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractContinuumMechanicsSolver.html#aff2015aaee9ab29d54812ab7df52cdb0">ApplyDirichletBoundaryConditions</a> (ApplyDirichletBcsType type, <a class="el" href="classbool.html">bool</a> symmetricProblem)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractContinuumMechanicsSolver.html#a7ad4ea647ef9cc77a128654cd875bdc8">AddIdentityBlockForDummyPressureVariables</a> (ApplyDirichletBcsType type)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractContinuumMechanicsSolver.html#abbb4dc94a95d6082657868b7af88f473">RemovePressureDummyValuesThroughLinearInterpolation</a> ()</td></tr>
<tr><td colspan="2"><h2><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classQuadraticMesh.html">QuadraticMesh</a>&lt; DIM &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractContinuumMechanicsSolver.html#ad161db1fbd07f4e660889fa92ad96249">mrQuadMesh</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classContinuumMechanicsProblemDefinition.html">ContinuumMechanicsProblemDefinition</a><br class="typebreak"/>
&lt; DIM &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractContinuumMechanicsSolver.html#aa23997bc213ecd2b1e4addf4918ccb69">mrProblemDefinition</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractContinuumMechanicsSolver.html#abc23b0f9e5924809053943bae3424855">mWriteOutput</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractContinuumMechanicsSolver.html#aa441094aecb1dfe7f2d4df0ef078935e">mOutputDirectory</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classOutputFileHandler.html">OutputFileHandler</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractContinuumMechanicsSolver.html#a92326470870de16eee07d87b0b2337a3">mpOutputFileHandler</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::vector&lt; c_vector&lt; <a class="el" href="classdouble.html">double</a>, <br class="typebreak"/>
DIM &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractContinuumMechanicsSolver.html#a146debdc814c6699c268d293e18e3edc">mSpatialSolution</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classdouble.html">double</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractContinuumMechanicsSolver.html#a2e0009e406c9eb02b2947fb2bb9f6282">mPressureSolution</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classdouble.html">double</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractContinuumMechanicsSolver.html#a59782d56383f1d50a4cb4b1e5ce2adaa">mCurrentSolution</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classGaussianQuadratureRule.html">GaussianQuadratureRule</a>&lt; DIM &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractContinuumMechanicsSolver.html#a0750a5e0cc738284803323b59d26ee34">mpQuadratureRule</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classGaussianQuadratureRule.html">GaussianQuadratureRule</a>&lt; DIM-1 &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractContinuumMechanicsSolver.html#a46fd372999e615fa9cc9f4eabb7497aa">mpBoundaryQuadratureRule</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">CompressibilityType&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractContinuumMechanicsSolver.html#a2afa7e6f8eb5557e0eab1cbf5bab2c6d">mCompressibilityType</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractContinuumMechanicsSolver.html#af48614c6c4115f6166d262661268b373">mProblemDimension</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractContinuumMechanicsSolver.html#a3697ca8ca5b9136dafc039422aff1ad3">mNumDofs</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractContinuumMechanicsSolver.html#a1cea6be4ed0b2fdce673b3224fff9f06">mVerbose</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classVec.html">Vec</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractContinuumMechanicsSolver.html#a3053c8021a46b921b19452b9cda23a89">mResidualVector</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classVec.html">Vec</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractContinuumMechanicsSolver.html#a673e7f7845fbb7c2f80496de3b3d3755">mLinearSystemRhsVector</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMat.html">Mat</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractContinuumMechanicsSolver.html#aebea6311a32dac1a130d8cd29b983df1">mSystemLhsMatrix</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classVec.html">Vec</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractContinuumMechanicsSolver.html#adb91b467a7b9509bc710ca71ae17d578">mDirichletBoundaryConditionsVector</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMat.html">Mat</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAbstractContinuumMechanicsSolver.html#a079a32c41ef28c033e88e490f6ba9d7b">mPreconditionMatrix</a></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><h3>template&lt;unsigned DIM&gt;<br/>
class AbstractContinuumMechanicsSolver&lt; DIM &gt;</h3>

<p>General base class for continuum mechanics solvers. Deals with memory allocation, writing to file, applying boundary conditions, and adding an identity block (see below)</p>
<p>Note: the PROBLEM DIMENSION depends on DIM and whether a compressible or incompressible problem is being solved. (i) Compressible: mProblemDimension is set to DIM, and the ordering of the unknowns is, for 2D say: [U1 V1 U2 V2 .. Un Vn] (ii) Incompressible: Here we have spatial unknowns (at all nodes of the <a class="el" href="classQuadraticMesh.html">QuadraticMesh</a>) and pressure unknowns (only at the vertices, as linear bases are). We choose mProblemDim = DIM+1, use (for parallelisation reasons) the ordering [U1 V1 P1 , .. , Un Vn, Pn], introducing dummy variables for pressure unknowns at internal hences, with the equation Pi=0 at these nodes, hence the need for an identity block to be added the corresponding parts of the matrix. </p>

<p>Definition at line <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00082">82</a> of file <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html">AbstractContinuumMechanicsSolver.hpp</a>.</p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a821f100fbdf73e65c04931db1035f2c3"></a><!-- doxytag: member="AbstractContinuumMechanicsSolver::AbstractContinuumMechanicsSolver" ref="a821f100fbdf73e65c04931db1035f2c3" args="(QuadraticMesh&lt; DIM &gt; &amp;rQuadMesh, ContinuumMechanicsProblemDefinition&lt; DIM &gt; &amp;rProblemDefinition, std::string outputDirectory, CompressibilityType compressibilityType)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;unsigned DIM&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classAbstractContinuumMechanicsSolver.html">AbstractContinuumMechanicsSolver</a>&lt; DIM &gt;::<a class="el" href="classAbstractContinuumMechanicsSolver.html">AbstractContinuumMechanicsSolver</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classQuadraticMesh.html">QuadraticMesh</a>&lt; DIM &gt; &amp;&#160;</td>
          <td class="paramname"><em>rQuadMesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classContinuumMechanicsProblemDefinition.html">ContinuumMechanicsProblemDefinition</a>&lt; DIM &gt; &amp;&#160;</td>
          <td class="paramname"><em>rProblemDefinition</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>outputDirectory</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CompressibilityType&#160;</td>
          <td class="paramname"><em>compressibilityType</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Constructor </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">rQuadMesh</td><td>the mesh </td></tr>
    <tr><td class="paramname">rProblemDefinition</td><td>problem definition object </td></tr>
    <tr><td class="paramname">outputDirectory</td><td>output directory name </td></tr>
    <tr><td class="paramname">compressibilityType</td><td>'INCOMPRESSIBLE' or 'COMPRESSIBLE' </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00367">367</a> of file <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html">AbstractContinuumMechanicsSolver.hpp</a>.</p>

<p>References <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00810">AbstractContinuumMechanicsSolver&lt; DIM &gt;::AllocateMatrixMemory()</a>, <a class="el" href="CommandLineArguments_8cpp_source.html#l00049">CommandLineArguments::Instance()</a>, <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00130">AbstractContinuumMechanicsSolver&lt; DIM &gt;::mCompressibilityType</a>, <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00118">AbstractContinuumMechanicsSolver&lt; DIM &gt;::mCurrentSolution</a>, <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00145">AbstractContinuumMechanicsSolver&lt; DIM &gt;::mNumDofs</a>, <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00098">AbstractContinuumMechanicsSolver&lt; DIM &gt;::mOutputDirectory</a>, <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00124">AbstractContinuumMechanicsSolver&lt; DIM &gt;::mpBoundaryQuadratureRule</a>, <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00101">AbstractContinuumMechanicsSolver&lt; DIM &gt;::mpOutputFileHandler</a>, <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00121">AbstractContinuumMechanicsSolver&lt; DIM &gt;::mpQuadratureRule</a>, <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00140">AbstractContinuumMechanicsSolver&lt; DIM &gt;::mProblemDimension</a>, <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00092">AbstractContinuumMechanicsSolver&lt; DIM &gt;::mrProblemDefinition</a>, <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00089">AbstractContinuumMechanicsSolver&lt; DIM &gt;::mrQuadMesh</a>, <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00152">AbstractContinuumMechanicsSolver&lt; DIM &gt;::mVerbose</a>, <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00095">AbstractContinuumMechanicsSolver&lt; DIM &gt;::mWriteOutput</a>, and <a class="el" href="CommandLineArguments_8cpp_source.html#l00060">CommandLineArguments::OptionExists()</a>.</p>

</div>
</div>
<a class="anchor" id="a4c8eff89ceb7a1e131db6e96ec219096"></a><!-- doxytag: member="AbstractContinuumMechanicsSolver::~AbstractContinuumMechanicsSolver" ref="a4c8eff89ceb7a1e131db6e96ec219096" args="()" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;unsigned DIM&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classAbstractContinuumMechanicsSolver.html">AbstractContinuumMechanicsSolver</a>&lt; DIM &gt;::~<a class="el" href="classAbstractContinuumMechanicsSolver.html">AbstractContinuumMechanicsSolver</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Destructor </p>

<p>Definition at line <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00408">408</a> of file <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html">AbstractContinuumMechanicsSolver.hpp</a>.</p>

<p>References <a class="el" href="PetscTools_8hpp_source.html#l00303">PetscTools::Destroy()</a>.</p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a7ad4ea647ef9cc77a128654cd875bdc8"></a><!-- doxytag: member="AbstractContinuumMechanicsSolver::AddIdentityBlockForDummyPressureVariables" ref="a7ad4ea647ef9cc77a128654cd875bdc8" args="(ApplyDirichletBcsType type)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;unsigned DIM&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classAbstractContinuumMechanicsSolver.html">AbstractContinuumMechanicsSolver</a>&lt; DIM &gt;::AddIdentityBlockForDummyPressureVariables </td>
          <td>(</td>
          <td class="paramtype">ApplyDirichletBcsType&#160;</td>
          <td class="paramname"><em>type</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>For incompressible problems, we use the following ordering: [U0 V0 W0 P0 U1 V1 W1 P1 .. Un Vn Wn Pn] where (U V W) is the displacement, and P is the pressure. Therefore P is defined at every node; however for the solve, linear basis functions are used for the pressure, so pressure is solved for at each vertex, not at internal nodes (which are for quadratic basis functions).</p>
<p>The pressure variables for non-vertex nodes are therefore dummy variables. This method enforces the condition P_i=0, where i corresponds to a non-vertex node.</p>
<p>The first input parameter should be one of the following LINEAR_PROBLEM -- indicating the overall problem is linear, and in which case the matrix will be altered (1 on diagonal, zeros assumed on rest of row) and the rhs vector will be set to 0.</p>
<p>NONLINEAR_PROBLEM_APPLY_TO_RESIDUAL_ONLY -- indicating the overall problem is nonlinear and here only the residual vector will be altered (sets the residual value of the appropriate rows to P_i-0.0.</p>
<p>NONLINEAR_PROBLEM_APPLY_TO_EVERYTHING -- indicating the overall problem is nonlinear, and here, the residual vector will be altered, as will the matrix and RHS vector (see documentation on mResidualVector for why there is a separate residual vector and RHS vector).</p>
<p>Note the row (and columns) for the dummy variables are not explicitly zeroed, as they are assumed to be zero already - in a finite element assembly nothing will have been written to the rows or columns corresponding to dummy variables. Hence this method always maintains symmetry.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td>see above </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00776">776</a> of file <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html">AbstractContinuumMechanicsSolver.hpp</a>.</p>

<p>References <a class="el" href="PetscMatTools_8cpp_source.html#l00045">PetscMatTools::SetElement()</a>, and <a class="el" href="PetscVecTools_8cpp_source.html#l00054">PetscVecTools::SetElement()</a>.</p>

</div>
</div>
<a class="anchor" id="a51efb6d651249387f4018b3bf1d12503"></a><!-- doxytag: member="AbstractContinuumMechanicsSolver::AllocateMatrixMemory" ref="a51efb6d651249387f4018b3bf1d12503" args="()" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;unsigned DIM&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classAbstractContinuumMechanicsSolver.html">AbstractContinuumMechanicsSolver</a>&lt; DIM &gt;::AllocateMatrixMemory </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Allocates memory for the matrices and vectors </p>

<p><p>We want to allocate different numbers of non-zeros per row, which means <a class="el" href="classPetscTools.html#abfc713ac77586e5617313a7c2da89aaa">PetscTools::SetupMat</a> isn't that useful. We could call</p>
<p>but we would get warnings due to the lack allocation </p>
</p>

<p>Definition at line <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00810">810</a> of file <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html">AbstractContinuumMechanicsSolver.hpp</a>.</p>

<p>References <a class="el" href="PetscTools_8hpp_source.html#l00303">PetscTools::Destroy()</a>, <a class="el" href="PetscTools_8cpp_source.html#l00081">PetscTools::IsSequential()</a>, and <a class="el" href="PetscTools_8cpp_source.html#l00240">PetscTools::SetupMat()</a>.</p>

<p>Referenced by <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00367">AbstractContinuumMechanicsSolver&lt; DIM &gt;::AbstractContinuumMechanicsSolver()</a>.</p>

</div>
</div>
<a class="anchor" id="aff2015aaee9ab29d54812ab7df52cdb0"></a><!-- doxytag: member="AbstractContinuumMechanicsSolver::ApplyDirichletBoundaryConditions" ref="aff2015aaee9ab29d54812ab7df52cdb0" args="(ApplyDirichletBcsType type, bool symmetricProblem)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;unsigned DIM&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classAbstractContinuumMechanicsSolver.html">AbstractContinuumMechanicsSolver</a>&lt; DIM &gt;::ApplyDirichletBoundaryConditions </td>
          <td>(</td>
          <td class="paramtype">ApplyDirichletBcsType&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>symmetricProblem</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Apply the Dirichlet boundary conditions to the linear system.</p>
<p>The first input parameter should be one of the following LINEAR_PROBLEM -- indicating the overall problem is linear, and in which case the BCs will be applied to both the matrix and vector of the linear system</p>
<p>NONLINEAR_PROBLEM_APPLY_TO_RESIDUAL_ONLY -- indicating the overall problem is nonlinear and here only the residual vector will be altered (apply the Dirichlet boundary conditions to the residual vector involves setting appropriate components to the difference between the current value and the correct value).</p>
<p>NONLINEAR_PROBLEM_APPLY_TO_EVERYTHING -- indicating the overall problem is nonlinear, and here, the residual vector will be altered, as will the matrix and RHS vector (see documentation on mResidualVector for why there is a separate residual vector and RHS vector).</p>
<p>The second parameter should be true if the overall problem is symmetric, in which case boundary conditions will be applied keeping the matrix symmetric (if the matrix is being altered). See in-code comments for how this is done.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td>see above </td></tr>
    <tr><td class="paramname">symmetricProblem</td><td>see above </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00651">651</a> of file <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html">AbstractContinuumMechanicsSolver.hpp</a>.</p>

<p>References <a class="el" href="PetscVecTools_8cpp_source.html#l00118">PetscVecTools::AddScaledVector()</a>, <a class="el" href="PetscTools_8hpp_source.html#l00303">PetscTools::Destroy()</a>, <a class="el" href="PetscMatTools_8cpp_source.html#l00067">PetscMatTools::Finalise()</a>, <a class="el" href="PetscMatTools_8cpp_source.html#l00328">PetscMatTools::GetMatrixRowDistributed()</a>, <a class="el" href="PetscVecTools_8cpp_source.html#l00054">PetscVecTools::SetElement()</a>, <a class="el" href="PetscVecTools_8cpp_source.html#l00081">PetscVecTools::Zero()</a>, <a class="el" href="PetscMatTools_8cpp_source.html#l00182">PetscMatTools::ZeroRowsAndColumnsWithValueOnDiagonal()</a>, and <a class="el" href="PetscMatTools_8cpp_source.html#l00100">PetscMatTools::ZeroRowsWithValueOnDiagonal()</a>.</p>

</div>
</div>
<a class="anchor" id="acd32a5e1bb931190063959f5a5bb040a"></a><!-- doxytag: member="AbstractContinuumMechanicsSolver::CreateVtkOutput" ref="acd32a5e1bb931190063959f5a5bb040a" args="(std::string spatialSolutionName=&quot;Spatial solution&quot;)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;unsigned DIM&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classAbstractContinuumMechanicsSolver.html">AbstractContinuumMechanicsSolver</a>&lt; DIM &gt;::CreateVtkOutput </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>spatialSolutionName</em> = <code>&quot;Spatial&#160;solution&quot;</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Convert the output to vtk format (placed in a folder called vtk in the output directory). </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">spatialSolutionName</td><td>is used to identify the spatial solution as a velocity, displacement... </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00524">524</a> of file <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html">AbstractContinuumMechanicsSolver.hpp</a>.</p>

<p>References <a class="el" href="VtkMeshWriter_8cpp_source.html#l00196">VtkMeshWriter&lt; ELEMENT_DIM, SPACE_DIM &gt;::AddCellData()</a>, <a class="el" href="VtkMeshWriter_8cpp_source.html#l00269">VtkMeshWriter&lt; ELEMENT_DIM, SPACE_DIM &gt;::AddPointData()</a>, <a class="el" href="Exception_8hpp_source.html#l00143">EXCEPTION</a>, and <a class="el" href="VtkMeshWriter_8cpp_source.html#l00508">VtkMeshWriter&lt; ELEMENT_DIM, SPACE_DIM &gt;::WriteFilesUsingMesh()</a>.</p>

</div>
</div>
<a class="anchor" id="abbb4dc94a95d6082657868b7af88f473"></a><!-- doxytag: member="AbstractContinuumMechanicsSolver::RemovePressureDummyValuesThroughLinearInterpolation" ref="abbb4dc94a95d6082657868b7af88f473" args="()" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;unsigned DIM&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classAbstractContinuumMechanicsSolver.html">AbstractContinuumMechanicsSolver</a>&lt; DIM &gt;::RemovePressureDummyValuesThroughLinearInterpolation </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>For incompressible problems, we use the following ordering: [U0 V0 W0 P0 U1 V1 W1 P1 .. Un Vn Wn Pn] where (U V W) is the displacement, and P is the pressure. Therefore P is defined at every node; however for the solve, linear basis functions are used for the pressure, so pressure is solved for at each vertex, not at internal nodes (which are for quadratic basis functions).</p>
<p>The above method, <a class="el" href="classAbstractContinuumMechanicsSolver.html#a7ad4ea647ef9cc77a128654cd875bdc8">AddIdentityBlockForDummyPressureVariables()</a>, enforces the condition P_i=0, where i corresponds to a non-vertex node.</p>
<p>AFTER the solve, this method can be used to remove the dummy values, but looping over all edges, and linearly interpolating the pressure at the two vertices onto the internal node.</p>
<p>This method assumes each internal node is midway between the two vertices. </p>

<p>Definition at line <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00572">572</a> of file <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html">AbstractContinuumMechanicsSolver.hpp</a>.</p>

<p>References <a class="el" href="AbstractTetrahedralMesh_8hpp_source.html#l00671">AbstractTetrahedralMesh&lt; ELEMENT_DIM, SPACE_DIM &gt;::GetElementIteratorBegin()</a>.</p>

</div>
</div>
<a class="anchor" id="a3912adf9b0055f61d0ae06e9292cb3bf"></a><!-- doxytag: member="AbstractContinuumMechanicsSolver::rGetCurrentSolution" ref="a3912adf9b0055f61d0ae06e9292cb3bf" args="()" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;unsigned DIM&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="classdouble.html">double</a>&gt;&amp; <a class="el" href="classAbstractContinuumMechanicsSolver.html">AbstractContinuumMechanicsSolver</a>&lt; DIM &gt;::rGetCurrentSolution </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Get the current solution vector (advanced use only - for getting the deformed position use rGetDeformedPosition()). </p>

<p>Definition at line <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00342">342</a> of file <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html">AbstractContinuumMechanicsSolver.hpp</a>.</p>

<p>References <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00118">AbstractContinuumMechanicsSolver&lt; DIM &gt;::mCurrentSolution</a>.</p>

</div>
</div>
<a class="anchor" id="a8bb5efbf95c5e0028020c89c2b19011b"></a><!-- doxytag: member="AbstractContinuumMechanicsSolver::rGetPressures" ref="a8bb5efbf95c5e0028020c89c2b19011b" args="()" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;unsigned DIM&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="classdouble.html">double</a> &gt; &amp; <a class="el" href="classAbstractContinuumMechanicsSolver.html">AbstractContinuumMechanicsSolver</a>&lt; DIM &gt;::rGetPressures </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Get the pressure, for each NODE in the mesh. If the node is an internal node of the quadratic mesh the pressure is not computed at this node (as linear basis functions are used for the pressure, so pressures unknowns are only present at vertices), so a dummy pressure value of 0 is returned in this vector.</p>
<p>Only valid if mCompressibilityType==INCOMPRESSIBLE </p>

<p>Definition at line <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00556">556</a> of file <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html">AbstractContinuumMechanicsSolver.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="ab3e22eb77e1f658cda9746f591e2eb4d"></a><!-- doxytag: member="AbstractContinuumMechanicsSolver::rGetSpatialSolution" ref="ab3e22eb77e1f658cda9746f591e2eb4d" args="()=0" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;unsigned DIM&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">virtual std::vector&lt;c_vector&lt;<a class="el" href="classdouble.html">double</a>,DIM&gt; &gt;&amp; <a class="el" href="classAbstractContinuumMechanicsSolver.html">AbstractContinuumMechanicsSolver</a>&lt; DIM &gt;::rGetSpatialSolution </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Get the spatial solution. For solids problems this will be the deformed position, for fluids problems this will be the flow. </p>

<p>Implemented in <a class="el" href="classAbstractNonlinearElasticitySolver.html#a3384c95aee49de15d5f419c8abe0853a">AbstractNonlinearElasticitySolver&lt; DIM &gt;</a>, and <a class="el" href="classStokesFlowSolver.html#a42f8fd28ce98a8b5843ee11f97aa440f">StokesFlowSolver&lt; DIM &gt;</a>.</p>

</div>
</div>
<a class="anchor" id="ab1af2777defeef5e80e4cae6ff712530"></a><!-- doxytag: member="AbstractContinuumMechanicsSolver::SetWriteOutput" ref="ab1af2777defeef5e80e4cae6ff712530" args="(bool writeOutput=true)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;unsigned DIM&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classAbstractContinuumMechanicsSolver.html">AbstractContinuumMechanicsSolver</a>&lt; DIM &gt;::SetWriteOutput </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>writeOutput</em> = <code>true</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Set whether to write any output.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">writeOutput</td><td>(defaults to true) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00514">514</a> of file <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html">AbstractContinuumMechanicsSolver.hpp</a>.</p>

<p>References <a class="el" href="Exception_8hpp_source.html#l00143">EXCEPTION</a>.</p>

</div>
</div>
<a class="anchor" id="a5bd73daf24062075d89121a79c0e7a67"></a><!-- doxytag: member="AbstractContinuumMechanicsSolver::WriteCurrentPressureSolution" ref="a5bd73daf24062075d89121a79c0e7a67" args="(int counterToAppend=&#45;1)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;unsigned DIM&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classAbstractContinuumMechanicsSolver.html">AbstractContinuumMechanicsSolver</a>&lt; DIM &gt;::WriteCurrentPressureSolution </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>counterToAppend</em> = <code>-1</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Write the pressure solution. Only valid if mCompressibilityType==INCOMPRESSIBLE. Writes the pressure for ALL nodes on the mesh, including internal nodes (as these are not assumed to be have indices greater than vertex nodes). As linear basis functions are used for pressure, the pressure solution is only computed at the vertices, and pressure dummy variables are used at internal nodes, hence for each internal node, 0 will be written to file.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">counterToAppend</td><td>append a counter to the file name</td></tr>
  </table>
  </dd>
</dl>
<p><a class="el" href="classAbstractContinuumMechanicsSolver.html#a5bd73daf24062075d89121a79c0e7a67">WriteCurrentPressureSolution()</a> --&gt; file called "pressure.txt" WriteCurrentPressureSolution(3) --&gt; file called "pressure_3.txt" </p>

<p>Definition at line <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00478">478</a> of file <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html">AbstractContinuumMechanicsSolver.hpp</a>.</p>

<p>References <a class="el" href="PetscTools_8cpp_source.html#l00105">PetscTools::AmMaster()</a>, and <a class="el" href="PetscTools_8cpp_source.html#l00119">PetscTools::Barrier()</a>.</p>

</div>
</div>
<a class="anchor" id="a6d64855299b8c48bc1bea5aabdb242dc"></a><!-- doxytag: member="AbstractContinuumMechanicsSolver::WriteCurrentSpatialSolution" ref="a6d64855299b8c48bc1bea5aabdb242dc" args="(std::string fileName, std::string fileExtension, int counterToAppend=&#45;1)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;unsigned DIM&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classAbstractContinuumMechanicsSolver.html">AbstractContinuumMechanicsSolver</a>&lt; DIM &gt;::WriteCurrentSpatialSolution </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>fileName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>fileExtension</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>counterToAppend</em> = <code>-1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Write the spatial solution (deformed position if solids, flow if fluids) at the nodes</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">fileName</td><td>(stem) </td></tr>
    <tr><td class="paramname">fileExtension</td><td>to append at end. </td></tr>
    <tr><td class="paramname">counterToAppend</td><td>append a counter to the file name (defaults to nothing appended).</td></tr>
  </table>
  </dd>
</dl>
<p>For example: WriteCurrentSpatialSolution("solution","nodes") --&gt; file called "solution.nodes" WriteCurrentSpatialSolution("solution","nodes",3) --&gt; file called "solution_3.nodes" </p>

<p>Definition at line <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00436">436</a> of file <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html">AbstractContinuumMechanicsSolver.hpp</a>.</p>

<p>References <a class="el" href="PetscTools_8cpp_source.html#l00105">PetscTools::AmMaster()</a>, and <a class="el" href="PetscTools_8cpp_source.html#l00119">PetscTools::Barrier()</a>.</p>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a2afa7e6f8eb5557e0eab1cbf5bab2c6d"></a><!-- doxytag: member="AbstractContinuumMechanicsSolver::mCompressibilityType" ref="a2afa7e6f8eb5557e0eab1cbf5bab2c6d" args="" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;unsigned DIM&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">CompressibilityType <a class="el" href="classAbstractContinuumMechanicsSolver.html">AbstractContinuumMechanicsSolver</a>&lt; DIM &gt;::<a class="el" href="classAbstractContinuumMechanicsSolver.html#a2afa7e6f8eb5557e0eab1cbf5bab2c6d">mCompressibilityType</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This is equal to either COMPRESSIBLE or INCOMPRESSIBLE (see enumeration class) and is only used in computing mNumDofs and allocating matrix memory. </p>

<p>Definition at line <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00130">130</a> of file <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html">AbstractContinuumMechanicsSolver.hpp</a>.</p>

<p>Referenced by <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00367">AbstractContinuumMechanicsSolver&lt; DIM &gt;::AbstractContinuumMechanicsSolver()</a>.</p>

</div>
</div>
<a class="anchor" id="a59782d56383f1d50a4cb4b1e5ce2adaa"></a><!-- doxytag: member="AbstractContinuumMechanicsSolver::mCurrentSolution" ref="a59782d56383f1d50a4cb4b1e5ce2adaa" args="" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;unsigned DIM&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="classdouble.html">double</a>&gt; <a class="el" href="classAbstractContinuumMechanicsSolver.html">AbstractContinuumMechanicsSolver</a>&lt; DIM &gt;::<a class="el" href="classAbstractContinuumMechanicsSolver.html#a59782d56383f1d50a4cb4b1e5ce2adaa">mCurrentSolution</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The current solution, in the form (assuming 2d): Incompressible problem: [u1 v1 u2 v2 ... uN vN p1 p2 .. pM] Compressible problem: [u1 v1 u2 v2 ... uN vN] where there are N total nodes and M vertices. </p>

<p>Definition at line <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00118">118</a> of file <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html">AbstractContinuumMechanicsSolver.hpp</a>.</p>

<p>Referenced by <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00367">AbstractContinuumMechanicsSolver&lt; DIM &gt;::AbstractContinuumMechanicsSolver()</a>, and <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00342">AbstractContinuumMechanicsSolver&lt; DIM &gt;::rGetCurrentSolution()</a>.</p>

</div>
</div>
<a class="anchor" id="adb91b467a7b9509bc710ca71ae17d578"></a><!-- doxytag: member="AbstractContinuumMechanicsSolver::mDirichletBoundaryConditionsVector" ref="adb91b467a7b9509bc710ca71ae17d578" args="" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;unsigned DIM&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classVec.html">Vec</a> <a class="el" href="classAbstractContinuumMechanicsSolver.html">AbstractContinuumMechanicsSolver</a>&lt; DIM &gt;::<a class="el" href="classAbstractContinuumMechanicsSolver.html#adb91b467a7b9509bc710ca71ae17d578">mDirichletBoundaryConditionsVector</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Helper vector (see ApplyDirichletBoundaryConditions code). </p>

<p>Definition at line <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00189">189</a> of file <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html">AbstractContinuumMechanicsSolver.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a673e7f7845fbb7c2f80496de3b3d3755"></a><!-- doxytag: member="AbstractContinuumMechanicsSolver::mLinearSystemRhsVector" ref="a673e7f7845fbb7c2f80496de3b3d3755" args="" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;unsigned DIM&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classVec.html">Vec</a> <a class="el" href="classAbstractContinuumMechanicsSolver.html">AbstractContinuumMechanicsSolver</a>&lt; DIM &gt;::<a class="el" href="classAbstractContinuumMechanicsSolver.html#a673e7f7845fbb7c2f80496de3b3d3755">mLinearSystemRhsVector</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The RHS side in the linear system that is solved each Newton iteration. </p>

<p>Definition at line <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00179">179</a> of file <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html">AbstractContinuumMechanicsSolver.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a3697ca8ca5b9136dafc039422aff1ad3"></a><!-- doxytag: member="AbstractContinuumMechanicsSolver::mNumDofs" ref="a3697ca8ca5b9136dafc039422aff1ad3" args="" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;unsigned DIM&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classunsigned.html">unsigned</a> <a class="el" href="classAbstractContinuumMechanicsSolver.html">AbstractContinuumMechanicsSolver</a>&lt; DIM &gt;::<a class="el" href="classAbstractContinuumMechanicsSolver.html#a3697ca8ca5b9136dafc039422aff1ad3">mNumDofs</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Number of degrees of freedom (equal to mProblemDim*num_nodes) </p>

<p>Definition at line <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00145">145</a> of file <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html">AbstractContinuumMechanicsSolver.hpp</a>.</p>

<p>Referenced by <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00367">AbstractContinuumMechanicsSolver&lt; DIM &gt;::AbstractContinuumMechanicsSolver()</a>.</p>

</div>
</div>
<a class="anchor" id="aa441094aecb1dfe7f2d4df0ef078935e"></a><!-- doxytag: member="AbstractContinuumMechanicsSolver::mOutputDirectory" ref="aa441094aecb1dfe7f2d4df0ef078935e" args="" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;unsigned DIM&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::string <a class="el" href="classAbstractContinuumMechanicsSolver.html">AbstractContinuumMechanicsSolver</a>&lt; DIM &gt;::<a class="el" href="classAbstractContinuumMechanicsSolver.html#aa441094aecb1dfe7f2d4df0ef078935e">mOutputDirectory</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Where to write output, relative to CHASTE_TEST_OUTPUT. </p>

<p>Definition at line <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00098">98</a> of file <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html">AbstractContinuumMechanicsSolver.hpp</a>.</p>

<p>Referenced by <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00367">AbstractContinuumMechanicsSolver&lt; DIM &gt;::AbstractContinuumMechanicsSolver()</a>.</p>

</div>
</div>
<a class="anchor" id="a46fd372999e615fa9cc9f4eabb7497aa"></a><!-- doxytag: member="AbstractContinuumMechanicsSolver::mpBoundaryQuadratureRule" ref="a46fd372999e615fa9cc9f4eabb7497aa" args="" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;unsigned DIM&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classGaussianQuadratureRule.html">GaussianQuadratureRule</a>&lt;DIM-1&gt;* <a class="el" href="classAbstractContinuumMechanicsSolver.html">AbstractContinuumMechanicsSolver</a>&lt; DIM &gt;::<a class="el" href="classAbstractContinuumMechanicsSolver.html#a46fd372999e615fa9cc9f4eabb7497aa">mpBoundaryQuadratureRule</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Boundary Gaussian quadrature rule. </p>

<p>Definition at line <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00124">124</a> of file <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html">AbstractContinuumMechanicsSolver.hpp</a>.</p>

<p>Referenced by <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00367">AbstractContinuumMechanicsSolver&lt; DIM &gt;::AbstractContinuumMechanicsSolver()</a>.</p>

</div>
</div>
<a class="anchor" id="a92326470870de16eee07d87b0b2337a3"></a><!-- doxytag: member="AbstractContinuumMechanicsSolver::mpOutputFileHandler" ref="a92326470870de16eee07d87b0b2337a3" args="" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;unsigned DIM&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classOutputFileHandler.html">OutputFileHandler</a>* <a class="el" href="classAbstractContinuumMechanicsSolver.html">AbstractContinuumMechanicsSolver</a>&lt; DIM &gt;::<a class="el" href="classAbstractContinuumMechanicsSolver.html#a92326470870de16eee07d87b0b2337a3">mpOutputFileHandler</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Output file handler. </p>

<p>Definition at line <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00101">101</a> of file <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html">AbstractContinuumMechanicsSolver.hpp</a>.</p>

<p>Referenced by <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00367">AbstractContinuumMechanicsSolver&lt; DIM &gt;::AbstractContinuumMechanicsSolver()</a>.</p>

</div>
</div>
<a class="anchor" id="a0750a5e0cc738284803323b59d26ee34"></a><!-- doxytag: member="AbstractContinuumMechanicsSolver::mpQuadratureRule" ref="a0750a5e0cc738284803323b59d26ee34" args="" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;unsigned DIM&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classGaussianQuadratureRule.html">GaussianQuadratureRule</a>&lt;DIM&gt;* <a class="el" href="classAbstractContinuumMechanicsSolver.html">AbstractContinuumMechanicsSolver</a>&lt; DIM &gt;::<a class="el" href="classAbstractContinuumMechanicsSolver.html#a0750a5e0cc738284803323b59d26ee34">mpQuadratureRule</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Gaussian quadrature rule. </p>

<p>Definition at line <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00121">121</a> of file <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html">AbstractContinuumMechanicsSolver.hpp</a>.</p>

<p>Referenced by <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00367">AbstractContinuumMechanicsSolver&lt; DIM &gt;::AbstractContinuumMechanicsSolver()</a>.</p>

</div>
</div>
<a class="anchor" id="a079a32c41ef28c033e88e490f6ba9d7b"></a><!-- doxytag: member="AbstractContinuumMechanicsSolver::mPreconditionMatrix" ref="a079a32c41ef28c033e88e490f6ba9d7b" args="" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;unsigned DIM&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMat.html">Mat</a> <a class="el" href="classAbstractContinuumMechanicsSolver.html">AbstractContinuumMechanicsSolver</a>&lt; DIM &gt;::<a class="el" href="classAbstractContinuumMechanicsSolver.html#a079a32c41ef28c033e88e490f6ba9d7b">mPreconditionMatrix</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Precondition matrix for the linear system. </p>

<p>Definition at line <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00194">194</a> of file <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html">AbstractContinuumMechanicsSolver.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a2e0009e406c9eb02b2947fb2bb9f6282"></a><!-- doxytag: member="AbstractContinuumMechanicsSolver::mPressureSolution" ref="a2e0009e406c9eb02b2947fb2bb9f6282" args="" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;unsigned DIM&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="classdouble.html">double</a>&gt; <a class="el" href="classAbstractContinuumMechanicsSolver.html">AbstractContinuumMechanicsSolver</a>&lt; DIM &gt;::<a class="el" href="classAbstractContinuumMechanicsSolver.html#a2e0009e406c9eb02b2947fb2bb9f6282">mPressureSolution</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Pressures solution at each vertex of the mesh. Only valid if mCompressibilityType==INCOMPRESSIBLE. </p>

<p>Definition at line <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00109">109</a> of file <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html">AbstractContinuumMechanicsSolver.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="af48614c6c4115f6166d262661268b373"></a><!-- doxytag: member="AbstractContinuumMechanicsSolver::mProblemDimension" ref="af48614c6c4115f6166d262661268b373" args="" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;unsigned DIM&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classunsigned.html">unsigned</a> <a class="el" href="classAbstractContinuumMechanicsSolver.html">AbstractContinuumMechanicsSolver</a>&lt; DIM &gt;::<a class="el" href="classAbstractContinuumMechanicsSolver.html#af48614c6c4115f6166d262661268b373">mProblemDimension</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The problem dimension - the number of unknowns at each node. For compressible problems, where only the deformation/flow is computed at each node, this is equal to DIM For incompressible problems, where pressure is computed as well, this is equal to DIM+1 (there is a pressure variable defined even for internal nodes at which pressure is not computed, this is a dummy pressure variable -- done like this for parallelisation reasons. See above). </p>

<p>Definition at line <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00140">140</a> of file <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html">AbstractContinuumMechanicsSolver.hpp</a>.</p>

<p>Referenced by <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00367">AbstractContinuumMechanicsSolver&lt; DIM &gt;::AbstractContinuumMechanicsSolver()</a>.</p>

</div>
</div>
<a class="anchor" id="a3053c8021a46b921b19452b9cda23a89"></a><!-- doxytag: member="AbstractContinuumMechanicsSolver::mResidualVector" ref="a3053c8021a46b921b19452b9cda23a89" args="" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;unsigned DIM&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classVec.html">Vec</a> <a class="el" href="classAbstractContinuumMechanicsSolver.html">AbstractContinuumMechanicsSolver</a>&lt; DIM &gt;::<a class="el" href="classAbstractContinuumMechanicsSolver.html#a3053c8021a46b921b19452b9cda23a89">mResidualVector</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Residual vector nonlinear problems.</p>
<p>Since the residual in nonlinear problems is usually also the RHS vector in the linear system, it may seem unncessary to also have the member variable mLinearSystemRhsVector.</p>
<p>However: Newton's method is Ju = f, where J is the Jacobian, u the (negative of the) update and f the residual, but when applying Dirichlet boundary conditions in the compressible case, we alter the rows of the matrix and also alter the columns in order to maintain symmetry. This requires making further changes to the right-hand vector, meaning that it no longer properly represents the residual. Hence, we have to use two vectors.</p>
<p>Overall, this can be represents as</p>
<ul>
<li>compute residual f</li>
<li>compute Jacobian J</li>
<li>apply BCs to f.</li>
<li>alter the linear system from Ju=f to (J*)u=f* which enforces the dirichlet boundary conditions but enforces them symmetrically.</li>
</ul>
<p>mLinearSystemRhsVector below represents f*. </p>

<p>Definition at line <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00174">174</a> of file <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html">AbstractContinuumMechanicsSolver.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="aa23997bc213ecd2b1e4addf4918ccb69"></a><!-- doxytag: member="AbstractContinuumMechanicsSolver::mrProblemDefinition" ref="aa23997bc213ecd2b1e4addf4918ccb69" args="" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;unsigned DIM&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classContinuumMechanicsProblemDefinition.html">ContinuumMechanicsProblemDefinition</a>&lt;DIM&gt;&amp; <a class="el" href="classAbstractContinuumMechanicsSolver.html">AbstractContinuumMechanicsSolver</a>&lt; DIM &gt;::<a class="el" href="classAbstractContinuumMechanicsSolver.html#aa23997bc213ecd2b1e4addf4918ccb69">mrProblemDefinition</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Problem definition class - contains info on boundary conditions, etc </p>

<p>Reimplemented in <a class="el" href="classAbstractNonlinearElasticitySolver.html#afbbfaf0b66f0ad0528bff55c409595e7">AbstractNonlinearElasticitySolver&lt; DIM &gt;</a>, and <a class="el" href="classStokesFlowSolver.html#a05eb1bb898ec8323f078d96def810a67">StokesFlowSolver&lt; DIM &gt;</a>.</p>

<p>Definition at line <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00092">92</a> of file <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html">AbstractContinuumMechanicsSolver.hpp</a>.</p>

<p>Referenced by <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00367">AbstractContinuumMechanicsSolver&lt; DIM &gt;::AbstractContinuumMechanicsSolver()</a>.</p>

</div>
</div>
<a class="anchor" id="ad161db1fbd07f4e660889fa92ad96249"></a><!-- doxytag: member="AbstractContinuumMechanicsSolver::mrQuadMesh" ref="ad161db1fbd07f4e660889fa92ad96249" args="" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;unsigned DIM&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classQuadraticMesh.html">QuadraticMesh</a>&lt;DIM&gt;&amp; <a class="el" href="classAbstractContinuumMechanicsSolver.html">AbstractContinuumMechanicsSolver</a>&lt; DIM &gt;::<a class="el" href="classAbstractContinuumMechanicsSolver.html#ad161db1fbd07f4e660889fa92ad96249">mrQuadMesh</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The mesh to be solved on. Requires 6 nodes per triangle (or 10 per tetrahedron) as quadratic bases are used. </p>

<p>Definition at line <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00089">89</a> of file <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html">AbstractContinuumMechanicsSolver.hpp</a>.</p>

<p>Referenced by <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00367">AbstractContinuumMechanicsSolver&lt; DIM &gt;::AbstractContinuumMechanicsSolver()</a>, and <a class="el" href="StokesFlowSolver_8hpp_source.html#l00141">StokesFlowSolver&lt; DIM &gt;::StokesFlowSolver()</a>.</p>

</div>
</div>
<a class="anchor" id="a146debdc814c6699c268d293e18e3edc"></a><!-- doxytag: member="AbstractContinuumMechanicsSolver::mSpatialSolution" ref="a146debdc814c6699c268d293e18e3edc" args="" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;unsigned DIM&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;c_vector&lt;<a class="el" href="classdouble.html">double</a>,DIM&gt; &gt; <a class="el" href="classAbstractContinuumMechanicsSolver.html">AbstractContinuumMechanicsSolver</a>&lt; DIM &gt;::<a class="el" href="classAbstractContinuumMechanicsSolver.html#a146debdc814c6699c268d293e18e3edc">mSpatialSolution</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Spatial solution: For solids problems, mSpatialSolution[i](j) = x_j (new position) for node i. For fluids problems, mSpatialSolution[i](j) = u_j (flow) for node i. </p>

<p>Definition at line <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00106">106</a> of file <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html">AbstractContinuumMechanicsSolver.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="aebea6311a32dac1a130d8cd29b983df1"></a><!-- doxytag: member="AbstractContinuumMechanicsSolver::mSystemLhsMatrix" ref="aebea6311a32dac1a130d8cd29b983df1" args="" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;unsigned DIM&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMat.html">Mat</a> <a class="el" href="classAbstractContinuumMechanicsSolver.html">AbstractContinuumMechanicsSolver</a>&lt; DIM &gt;::<a class="el" href="classAbstractContinuumMechanicsSolver.html#aebea6311a32dac1a130d8cd29b983df1">mSystemLhsMatrix</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Jacobian matrix of the nonlinear system, LHS matrix for the linear system. </p>

<p>Definition at line <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00184">184</a> of file <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html">AbstractContinuumMechanicsSolver.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a1cea6be4ed0b2fdce673b3224fff9f06"></a><!-- doxytag: member="AbstractContinuumMechanicsSolver::mVerbose" ref="a1cea6be4ed0b2fdce673b3224fff9f06" args="" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;unsigned DIM&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> <a class="el" href="classAbstractContinuumMechanicsSolver.html">AbstractContinuumMechanicsSolver</a>&lt; DIM &gt;::<a class="el" href="classAbstractContinuumMechanicsSolver.html#a1cea6be4ed0b2fdce673b3224fff9f06">mVerbose</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>If SetVerboseDuringSolve() is called on the problem definition class, or the command line argument "-mech_verbose" or "-mech_very_verbose" is given, than this bool will be set to true and lots of details about each nonlinear solve (including timing breakdowns) will be printed out </p>

<p>Definition at line <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00152">152</a> of file <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html">AbstractContinuumMechanicsSolver.hpp</a>.</p>

<p>Referenced by <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00367">AbstractContinuumMechanicsSolver&lt; DIM &gt;::AbstractContinuumMechanicsSolver()</a>.</p>

</div>
</div>
<a class="anchor" id="abc23b0f9e5924809053943bae3424855"></a><!-- doxytag: member="AbstractContinuumMechanicsSolver::mWriteOutput" ref="abc23b0f9e5924809053943bae3424855" args="" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;unsigned DIM&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> <a class="el" href="classAbstractContinuumMechanicsSolver.html">AbstractContinuumMechanicsSolver</a>&lt; DIM &gt;::<a class="el" href="classAbstractContinuumMechanicsSolver.html#abc23b0f9e5924809053943bae3424855">mWriteOutput</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Whether to write any output. </p>

<p>Definition at line <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00095">95</a> of file <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html">AbstractContinuumMechanicsSolver.hpp</a>.</p>

<p>Referenced by <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00367">AbstractContinuumMechanicsSolver&lt; DIM &gt;::AbstractContinuumMechanicsSolver()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>continuum_mechanics/src/solver/<a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html">AbstractContinuumMechanicsSolver.hpp</a></li>
</ul>
</div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="classAbstractContinuumMechanicsSolver.html">AbstractContinuumMechanicsSolver</a>      </li>
      <li class="footer">Generated on Mon Nov 5 2012 12:47:34 for Chaste by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </li>
    </ul>
  </div>

</body>
</html>
