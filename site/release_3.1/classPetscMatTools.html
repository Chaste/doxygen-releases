<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Chaste: PetscMatTools Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript">
$(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<script type="text/javascript">
function hasClass(ele,cls) {
  return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));
}

function addClass(ele,cls) {
  if (!this.hasClass(ele,cls)) ele.className += " "+cls;
}

function removeClass(ele,cls) {
  if (hasClass(ele,cls)) {
    var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');
    ele.className=ele.className.replace(reg,' ');
  }
}

function toggleVisibility(linkObj) {
 var base = linkObj.getAttribute('id');
 var summary = document.getElementById(base + '-summary');
 var content = document.getElementById(base + '-content');
 var trigger = document.getElementById(base + '-trigger');
 if ( hasClass(linkObj,'closed') ) {
   summary.style.display = 'none';
   content.style.display = 'block';
   trigger.src = 'open.png';
   removeClass(linkObj,'closed');
   addClass(linkObj,'opened');
 } else if ( hasClass(linkObj,'opened') ) {
   summary.style.display = 'block';
   content.style.display = 'none';
   trigger.src = 'closed.png';
   removeClass(linkObj,'opened');
   addClass(linkObj,'closed');
 }
 return false;
}
</script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Chaste&#160;<span id="projectnumber">Release::3.1</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('classPetscMatTools.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-static-methods">Static Public Member Functions</a>  </div>
  <div class="headertitle">
<div class="title">PetscMatTools Class Reference</div>  </div>
</div>
<div class="contents">
<!-- doxytag: class="PetscMatTools" -->
<p><code>#include &lt;<a class="el" href="PetscMatTools_8hpp_source.html">PetscMatTools.hpp</a>&gt;</code></p>

<p><a href="classPetscMatTools-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#ad2991678b6341cb488fcf53bca9c7af1">SetElement</a> (<a class="el" href="classMat.html">Mat</a> matrix, <a class="el" href="classPetscInt.html">PetscInt</a> row, <a class="el" href="classPetscInt.html">PetscInt</a> col, <a class="el" href="classdouble.html">double</a> value)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#a07f631eba92647e0f96eb9c007668b89">AddToElement</a> (<a class="el" href="classMat.html">Mat</a> matrix, <a class="el" href="classPetscInt.html">PetscInt</a> row, <a class="el" href="classPetscInt.html">PetscInt</a> col, <a class="el" href="classdouble.html">double</a> value)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#aa9717ce944536cda4afaac557aba7254">Finalise</a> (<a class="el" href="classMat.html">Mat</a> matrix)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#a81ec00917b30dcf7da65791a05eb35ee">SwitchWriteMode</a> (<a class="el" href="classMat.html">Mat</a> matrix)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#ad78e39050573affee9679e2b5b2807fd">Display</a> (<a class="el" href="classMat.html">Mat</a> matrix)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#a4653d233e1382cf612d0cef06f43e630">SetRow</a> (<a class="el" href="classMat.html">Mat</a> matrix, <a class="el" href="classPetscInt.html">PetscInt</a> row, <a class="el" href="classdouble.html">double</a> value)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#a5a68cf8b1e9a1630f54a60feb03084b9">ZeroRowsWithValueOnDiagonal</a> (<a class="el" href="classMat.html">Mat</a> matrix, std::vector&lt; <a class="el" href="classunsigned.html">unsigned</a> &gt; &amp;rRows, <a class="el" href="classdouble.html">double</a> diagonalValue)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#a742a2bec669f75b1067b282ce6cf3b11">ZeroRowsAndColumnsWithValueOnDiagonal</a> (<a class="el" href="classMat.html">Mat</a> matrix, std::vector&lt; <a class="el" href="classunsigned.html">unsigned</a> &gt; rowColIndices, <a class="el" href="classdouble.html">double</a> diagonalValue)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#ac790257be5a8cc501376fef953a76cee">ZeroColumn</a> (<a class="el" href="classMat.html">Mat</a> matrix, <a class="el" href="classPetscInt.html">PetscInt</a> col)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#a18737a2adfa34aa5d7c9bec630c8a688">Zero</a> (<a class="el" href="classMat.html">Mat</a> matrix)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#a871794b7b4edc05a98810c83a6e59f05">GetSize</a> (<a class="el" href="classMat.html">Mat</a> matrix)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#a7a9a78b5ccdd2ac99a9e46f09de9e04e">GetOwnershipRange</a> (<a class="el" href="classMat.html">Mat</a> matrix, <a class="el" href="classPetscInt.html">PetscInt</a> &amp;lo, <a class="el" href="classPetscInt.html">PetscInt</a> &amp;hi)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#a04bf4f209ef30a6118bba7c90279844a">GetElement</a> (<a class="el" href="classMat.html">Mat</a> matrix, <a class="el" href="classPetscInt.html">PetscInt</a> row, <a class="el" href="classPetscInt.html">PetscInt</a> col)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#a5aa09bdaed7d4372cab33f898c593399">SetOption</a> (<a class="el" href="classMat.html">Mat</a> matrix, MatOption option)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classVec.html">Vec</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#a8a201396f082f8e0cb5b27cc4694f8d8">GetMatrixRowDistributed</a> (<a class="el" href="classMat.html">Mat</a> matrix, <a class="el" href="classunsigned.html">unsigned</a> rowIndex)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#ad5c7e184836edcfcacdf6f2af9bfb48a">CheckEquality</a> (const <a class="el" href="classMat.html">Mat</a> mat1, const <a class="el" href="classMat.html">Mat</a> mat2, <a class="el" href="classdouble.html">double</a> tol=1e-10)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#a6ae709c830c74b78f9c6ec0c1e6ad49a">CheckSymmetry</a> (const <a class="el" href="classMat.html">Mat</a> matrix, <a class="el" href="classdouble.html">double</a> tol=1e-10)</td></tr>
<tr><td class="memTemplParams" colspan="2">template&lt;size_t MATRIX_SIZE&gt; </td></tr>
<tr><td class="memTemplItemLeft" align="right" valign="top">static void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#ac2876ae775b40c4188e483c42aaf6017">AddMultipleValues</a> (<a class="el" href="classMat.html">Mat</a> matrix, <a class="el" href="classunsigned.html">unsigned</a> *matrixRowAndColIndices, c_matrix&lt; <a class="el" href="classdouble.html">double</a>, MATRIX_SIZE, MATRIX_SIZE &gt; &amp;rSmallMatrix)</td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>A collection of static methods for working with PETSc matrices. </p>

<p>Definition at line <a class="el" href="PetscMatTools_8hpp_source.html#l00048">48</a> of file <a class="el" href="PetscMatTools_8hpp_source.html">PetscMatTools.hpp</a>.</p>
</div><hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="ac2876ae775b40c4188e483c42aaf6017"></a><!-- doxytag: member="PetscMatTools::AddMultipleValues" ref="ac2876ae775b40c4188e483c42aaf6017" args="(Mat matrix, unsigned *matrixRowAndColIndices, c_matrix&lt; double, MATRIX_SIZE, MATRIX_SIZE &gt; &amp;rSmallMatrix)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;size_t MATRIX_SIZE&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">static void PetscMatTools::AddMultipleValues </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classunsigned.html">unsigned</a> *&#160;</td>
          <td class="paramname"><em>matrixRowAndColIndices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">c_matrix&lt; <a class="el" href="classdouble.html">double</a>, MATRIX_SIZE, MATRIX_SIZE &gt; &amp;&#160;</td>
          <td class="paramname"><em>rSmallMatrix</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Add multiple values to a matrix.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix</td><td>the matrix </td></tr>
    <tr><td class="paramname">matrixRowAndColIndices</td><td>mapping from index of the ublas matrix (see param below) to index of the PETSc matrix of this linear system </td></tr>
    <tr><td class="paramname">rSmallMatrix</td><td>Ublas matrix containing the values to be added</td></tr>
  </table>
  </dd>
</dl>
<p>N.B. Values which are not local (ie the row is not owned) will be skipped. </p>

<p>Definition at line <a class="el" href="PetscMatTools_8hpp_source.html#l00222">222</a> of file <a class="el" href="PetscMatTools_8hpp_source.html">PetscMatTools.hpp</a>.</p>

<p>References <a class="el" href="PetscMatTools_8cpp_source.html#l00296">GetOwnershipRange()</a>.</p>

<p>Referenced by <a class="el" href="LinearSystem_8hpp_source.html#l00536">LinearSystem::AddLhsMultipleValues()</a>.</p>

</div>
</div>
<a class="anchor" id="a07f631eba92647e0f96eb9c007668b89"></a><!-- doxytag: member="PetscMatTools::AddToElement" ref="a07f631eba92647e0f96eb9c007668b89" args="(Mat matrix, PetscInt row, PetscInt col, double value)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::AddToElement </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPetscInt.html">PetscInt</a>&#160;</td>
          <td class="paramname"><em>row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPetscInt.html">PetscInt</a>&#160;</td>
          <td class="paramname"><em>col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdouble.html">double</a>&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Add the specified value to an entry of a matrix.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix</td><td>the matrix </td></tr>
    <tr><td class="paramname">row</td><td>the row index </td></tr>
    <tr><td class="paramname">col</td><td>the column index </td></tr>
    <tr><td class="paramname">value</td><td>the value for this entry </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00056">56</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p>References <a class="el" href="PetscMatTools_8cpp_source.html#l00296">GetOwnershipRange()</a>.</p>

<p>Referenced by <a class="el" href="LinearSystem_8cpp_source.html#l00308">LinearSystem::AddToMatrixElement()</a>, and <a class="el" href="NodeBasedCellPopulationWithBuskeUpdate_8cpp_source.html#l00057">NodeBasedCellPopulationWithBuskeUpdate&lt; DIM &gt;::UpdateNodeLocations()</a>.</p>

</div>
</div>
<a class="anchor" id="ad5c7e184836edcfcacdf6f2af9bfb48a"></a><!-- doxytag: member="PetscMatTools::CheckEquality" ref="ad5c7e184836edcfcacdf6f2af9bfb48a" args="(const Mat mat1, const Mat mat2, double tol=1e&#45;10)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> PetscMatTools::CheckEquality </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMat.html">Mat</a>&#160;</td>
          <td class="paramname"><em>mat1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMat.html">Mat</a>&#160;</td>
          <td class="paramname"><em>mat2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdouble.html">double</a>&#160;</td>
          <td class="paramname"><em>tol</em> = <code>1e-10</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Check whether two matrices are equal to within a given tolerance.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">mat1</td><td>the first matrix </td></tr>
    <tr><td class="paramname">mat2</td><td>the second matrix </td></tr>
    <tr><td class="paramname">tol</td><td>the tolerance </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00369">369</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p>References <a class="el" href="PetscTools_8hpp_source.html#l00303">PetscTools::Destroy()</a>.</p>

<p>Referenced by <a class="el" href="PetscMatTools_8cpp_source.html#l00392">CheckSymmetry()</a>, and <a class="el" href="AbstractNonlinearAssemblerSolverHybrid_8hpp_source.html#l00414">AbstractNonlinearAssemblerSolverHybrid&lt; ELEMENT_DIM, SPACE_DIM, PROBLEM_DIM &gt;::VerifyJacobian()</a>.</p>

</div>
</div>
<a class="anchor" id="a6ae709c830c74b78f9c6ec0c1e6ad49a"></a><!-- doxytag: member="PetscMatTools::CheckSymmetry" ref="a6ae709c830c74b78f9c6ec0c1e6ad49a" args="(const Mat matrix, double tol=1e&#45;10)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> PetscMatTools::CheckSymmetry </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMat.html">Mat</a>&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdouble.html">double</a>&#160;</td>
          <td class="paramname"><em>tol</em> = <code>1e-10</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Check whether a matrix is symmetrix, to within a given tolerance, by checking if it is (approximately) equal to its transpose.</p>
<p>Note that while there is a PETSc method MatIsSymmetric, it won't work in parallel on some PETSc versions: "Matrix of type &lt;mpiaij&gt; does not support checking for symmetric!"</p>
<p>Also checking for exact equality of the transpose can break on 32bit systems.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix</td><td>the matrix to check </td></tr>
    <tr><td class="paramname">tol</td><td>the tolerance </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00392">392</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p>References <a class="el" href="PetscMatTools_8cpp_source.html#l00369">CheckEquality()</a>, and <a class="el" href="PetscTools_8hpp_source.html#l00303">PetscTools::Destroy()</a>.</p>

</div>
</div>
<a class="anchor" id="ad78e39050573affee9679e2b5b2807fd"></a><!-- doxytag: member="PetscMatTools::Display" ref="ad78e39050573affee9679e2b5b2807fd" args="(Mat matrix)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::Display </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&#160;</td>
          <td class="paramname"><em>matrix</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Display a matrix.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix</td><td>the matrix </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00079">79</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p>Referenced by <a class="el" href="LinearSystem_8cpp_source.html#l00355">LinearSystem::DisplayMatrix()</a>.</p>

</div>
</div>
<a class="anchor" id="aa9717ce944536cda4afaac557aba7254"></a><!-- doxytag: member="PetscMatTools::Finalise" ref="aa9717ce944536cda4afaac557aba7254" args="(Mat matrix)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::Finalise </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&#160;</td>
          <td class="paramname"><em>matrix</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Sets up the matrix ready for use, e.g. in solving a linear system. This is a wrapper to PETSc functions like MatAssemblyBegin(matrix, MAT_FINAL_ASSEMBLY). </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix</td><td>the matrix </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00067">67</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p>Referenced by <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00651">AbstractContinuumMechanicsSolver&lt; DIM &gt;::ApplyDirichletBoundaryConditions()</a>, <a class="el" href="BoundaryConditionsContainerImplementation_8hpp_source.html#l00531">BoundaryConditionsContainer&lt; ELEMENT_DIM, SPACE_DIM, PROBLEM_DIM &gt;::ApplyDirichletToNonlinearJacobian()</a>, <a class="el" href="StokesFlowSolver_8hpp_source.html#l00283">StokesFlowSolver&lt; DIM &gt;::AssembleSystem()</a>, <a class="el" href="AbstractNonlinearAssemblerSolverHybrid_8hpp_source.html#l00298">AbstractNonlinearAssemblerSolverHybrid&lt; ELEMENT_DIM, SPACE_DIM, PROBLEM_DIM &gt;::ComputeJacobian()</a>, <a class="el" href="AbstractNonlinearAssemblerSolverHybrid_8hpp_source.html#l00319">AbstractNonlinearAssemblerSolverHybrid&lt; ELEMENT_DIM, SPACE_DIM, PROBLEM_DIM &gt;::ComputeJacobianNumerically()</a>, <a class="el" href="LinearSystem_8cpp_source.html#l00325">LinearSystem::FinaliseLhsMatrix()</a>, <a class="el" href="LinearSystem_8cpp_source.html#l00335">LinearSystem::FinalisePrecondMatrix()</a>, <a class="el" href="AbstractNonlinearElasticitySolver_8hpp_source.html#l00701">AbstractNonlinearElasticitySolver&lt; DIM &gt;::FinishAssembleSystem()</a>, <a class="el" href="NodePartitioner_8cpp_source.html#l00211">NodePartitioner&lt; ELEMENT_DIM, SPACE_DIM &gt;::PetscMatrixPartitioning()</a>, <a class="el" href="OperatorSplittingMonodomainSolver_8cpp_source.html#l00040">OperatorSplittingMonodomainSolver&lt; ELEMENT_DIM, SPACE_DIM &gt;::SetupLinearSystem()</a>, <a class="el" href="MonodomainSolver_8cpp_source.html#l00042">MonodomainSolver&lt; ELEMENT_DIM, SPACE_DIM &gt;::SetupLinearSystem()</a>, <a class="el" href="ExtendedBidomainSolver_8cpp_source.html#l00065">ExtendedBidomainSolver&lt; ELEM_DIM, SPACE_DIM &gt;::SetupLinearSystem()</a>, <a class="el" href="BidomainSolver_8cpp_source.html#l00066">BidomainSolver&lt; ELEMENT_DIM, SPACE_DIM &gt;::SetupLinearSystem()</a>, <a class="el" href="NodeBasedCellPopulationWithBuskeUpdate_8cpp_source.html#l00057">NodeBasedCellPopulationWithBuskeUpdate&lt; DIM &gt;::UpdateNodeLocations()</a>, <a class="el" href="PetscMatTools_8cpp_source.html#l00246">ZeroColumn()</a>, <a class="el" href="PetscMatTools_8cpp_source.html#l00182">ZeroRowsAndColumnsWithValueOnDiagonal()</a>, and <a class="el" href="PetscMatTools_8cpp_source.html#l00100">ZeroRowsWithValueOnDiagonal()</a>.</p>

</div>
</div>
<a class="anchor" id="a04bf4f209ef30a6118bba7c90279844a"></a><!-- doxytag: member="PetscMatTools::GetElement" ref="a04bf4f209ef30a6118bba7c90279844a" args="(Mat matrix, PetscInt row, PetscInt col)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classdouble.html">double</a> PetscMatTools::GetElement </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPetscInt.html">PetscInt</a>&#160;</td>
          <td class="paramname"><em>row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPetscInt.html">PetscInt</a>&#160;</td>
          <td class="paramname"><em>col</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Return an element of a matrix. May only be called for elements you own.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix</td><td>the matrix </td></tr>
    <tr><td class="paramname">row</td><td>the row index </td></tr>
    <tr><td class="paramname">col</td><td>the column index </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00301">301</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p>References <a class="el" href="PetscMatTools_8cpp_source.html#l00296">GetOwnershipRange()</a>.</p>

<p>Referenced by <a class="el" href="LinearSystem_8cpp_source.html#l00471">LinearSystem::GetMatrixElement()</a>, and <a class="el" href="PetscMatTools_8cpp_source.html#l00246">ZeroColumn()</a>.</p>

</div>
</div>
<a class="anchor" id="a8a201396f082f8e0cb5b27cc4694f8d8"></a><!-- doxytag: member="PetscMatTools::GetMatrixRowDistributed" ref="a8a201396f082f8e0cb5b27cc4694f8d8" args="(Mat matrix, unsigned rowIndex)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classVec.html">Vec</a> PetscMatTools::GetMatrixRowDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classunsigned.html">unsigned</a>&#160;</td>
          <td class="paramname"><em>rowIndex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Returns the i-th row of the LHS matrix as a distributed PETSc Vec</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix</td><td>the matrix </td></tr>
    <tr><td class="paramname">rowIndex</td><td>the row index </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>rowIndex-th row of the matrix in distributed format </dd></dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00328">328</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p>References <a class="el" href="PetscTools_8cpp_source.html#l00186">PetscTools::CreateVec()</a>, <a class="el" href="PetscMatTools_8cpp_source.html#l00296">GetOwnershipRange()</a>, and <a class="el" href="PetscMatTools_8cpp_source.html#l00287">GetSize()</a>.</p>

<p>Referenced by <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00651">AbstractContinuumMechanicsSolver&lt; DIM &gt;::ApplyDirichletBoundaryConditions()</a>.</p>

</div>
</div>
<a class="anchor" id="a7a9a78b5ccdd2ac99a9e46f09de9e04e"></a><!-- doxytag: member="PetscMatTools::GetOwnershipRange" ref="a7a9a78b5ccdd2ac99a9e46f09de9e04e" args="(Mat matrix, PetscInt &amp;lo, PetscInt &amp;hi)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::GetOwnershipRange </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPetscInt.html">PetscInt</a> &amp;&#160;</td>
          <td class="paramname"><em>lo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPetscInt.html">PetscInt</a> &amp;&#160;</td>
          <td class="paramname"><em>hi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Get this process's ownership range of the contents of the system.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix</td><td>the matrix </td></tr>
    <tr><td class="paramname">lo</td><td>lowest index owned by this process </td></tr>
    <tr><td class="paramname">hi</td><td>highest index owned by this process </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00296">296</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p>Referenced by <a class="el" href="PetscMatTools_8hpp_source.html#l00222">AddMultipleValues()</a>, <a class="el" href="PetscMatTools_8cpp_source.html#l00056">AddToElement()</a>, <a class="el" href="PetscMatTools_8cpp_source.html#l00301">GetElement()</a>, <a class="el" href="PetscMatTools_8cpp_source.html#l00328">GetMatrixRowDistributed()</a>, <a class="el" href="PetscMatTools_8cpp_source.html#l00045">SetElement()</a>, <a class="el" href="PetscMatTools_8cpp_source.html#l00084">SetRow()</a>, <a class="el" href="PetscMatTools_8cpp_source.html#l00246">ZeroColumn()</a>, and <a class="el" href="PetscMatTools_8cpp_source.html#l00182">ZeroRowsAndColumnsWithValueOnDiagonal()</a>.</p>

</div>
</div>
<a class="anchor" id="a871794b7b4edc05a98810c83a6e59f05"></a><!-- doxytag: member="PetscMatTools::GetSize" ref="a871794b7b4edc05a98810c83a6e59f05" args="(Mat matrix)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classunsigned.html">unsigned</a> PetscMatTools::GetSize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&#160;</td>
          <td class="paramname"><em>matrix</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Get the size of a matrix </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix</td><td>the matrix </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00287">287</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p>Referenced by <a class="el" href="AbstractContinuumMechanicsAssembler_8hpp_source.html#l00332">AbstractContinuumMechanicsAssembler&lt; DIM, CAN_ASSEMBLE_VECTOR, CAN_ASSEMBLE_MATRIX &gt;::DoAssemble()</a>, and <a class="el" href="PetscMatTools_8cpp_source.html#l00328">GetMatrixRowDistributed()</a>.</p>

</div>
</div>
<a class="anchor" id="ad2991678b6341cb488fcf53bca9c7af1"></a><!-- doxytag: member="PetscMatTools::SetElement" ref="ad2991678b6341cb488fcf53bca9c7af1" args="(Mat matrix, PetscInt row, PetscInt col, double value)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::SetElement </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPetscInt.html">PetscInt</a>&#160;</td>
          <td class="paramname"><em>row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPetscInt.html">PetscInt</a>&#160;</td>
          <td class="paramname"><em>col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdouble.html">double</a>&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Change one of the entries of a matrix to the specified value.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix</td><td>the matrix </td></tr>
    <tr><td class="paramname">row</td><td>the row index </td></tr>
    <tr><td class="paramname">col</td><td>the column index </td></tr>
    <tr><td class="paramname">value</td><td>the value for this entry </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00045">45</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p>References <a class="el" href="PetscMatTools_8cpp_source.html#l00296">GetOwnershipRange()</a>.</p>

<p>Referenced by <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00776">AbstractContinuumMechanicsSolver&lt; DIM &gt;::AddIdentityBlockForDummyPressureVariables()</a>, <a class="el" href="BoundaryConditionsContainerImplementation_8hpp_source.html#l00427">BoundaryConditionsContainer&lt; ELEMENT_DIM, SPACE_DIM, PROBLEM_DIM &gt;::ApplyPeriodicBcsToLinearProblem()</a>, <a class="el" href="AbstractNonlinearAssemblerSolverHybrid_8hpp_source.html#l00319">AbstractNonlinearAssemblerSolverHybrid&lt; ELEMENT_DIM, SPACE_DIM, PROBLEM_DIM &gt;::ComputeJacobianNumerically()</a>, <a class="el" href="AbstractBidomainSolver_8cpp_source.html#l00336">AbstractBidomainSolver&lt; ELEMENT_DIM, SPACE_DIM &gt;::FinaliseForBath()</a>, <a class="el" href="LinearSystem_8cpp_source.html#l00303">LinearSystem::SetMatrixElement()</a>, and <a class="el" href="PetscMatTools_8cpp_source.html#l00084">SetRow()</a>.</p>

</div>
</div>
<a class="anchor" id="a5aa09bdaed7d4372cab33f898c593399"></a><!-- doxytag: member="PetscMatTools::SetOption" ref="a5aa09bdaed7d4372cab33f898c593399" args="(Mat matrix, MatOption option)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::SetOption </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MatOption&#160;</td>
          <td class="paramname"><em>option</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Set a PETSc matrix option to be true, using the PETSc method MatSetOption.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix</td><td>the matrix for which to set the option </td></tr>
    <tr><td class="paramname">option</td><td>the option to set </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00319">319</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p>Referenced by <a class="el" href="LinearSystem_8cpp_source.html#l00526">LinearSystem::SetMatrixIsSymmetric()</a>.</p>

</div>
</div>
<a class="anchor" id="a4653d233e1382cf612d0cef06f43e630"></a><!-- doxytag: member="PetscMatTools::SetRow" ref="a4653d233e1382cf612d0cef06f43e630" args="(Mat matrix, PetscInt row, double value)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::SetRow </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPetscInt.html">PetscInt</a>&#160;</td>
          <td class="paramname"><em>row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdouble.html">double</a>&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Set all entries in a given row of a matrix to a certain value. This must be called by the process who owns the row, (but other processors will treat it as a null-op</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix</td><td>the matrix </td></tr>
    <tr><td class="paramname">row</td><td>the row index </td></tr>
    <tr><td class="paramname">value</td><td>the value to set each entry in this row </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00084">84</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p>References <a class="el" href="PetscMatTools_8cpp_source.html#l00296">GetOwnershipRange()</a>, and <a class="el" href="PetscMatTools_8cpp_source.html#l00045">SetElement()</a>.</p>

<p>Referenced by <a class="el" href="LinearSystem_8cpp_source.html#l00365">LinearSystem::SetMatrixRow()</a>.</p>

</div>
</div>
<a class="anchor" id="a81ec00917b30dcf7da65791a05eb35ee"></a><!-- doxytag: member="PetscMatTools::SwitchWriteMode" ref="a81ec00917b30dcf7da65791a05eb35ee" args="(Mat matrix)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::SwitchWriteMode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&#160;</td>
          <td class="paramname"><em>matrix</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This must be called if switching between inserting or adding values to the matrix, to ensure all processes are in sync. This is a wrapper to PETSc functions like MatAssemblyBegin(matrix, MAT_FLUSH_ASSEMBLY). </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix</td><td>the matrix </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00073">73</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p>Referenced by <a class="el" href="StokesFlowSolver_8hpp_source.html#l00283">StokesFlowSolver&lt; DIM &gt;::AssembleSystem()</a>, <a class="el" href="IncompressibleNonlinearElasticitySolver_8cpp_source.html#l00052">IncompressibleNonlinearElasticitySolver&lt; DIM &gt;::AssembleSystem()</a>, <a class="el" href="AbstractNonlinearAssemblerSolverHybrid_8hpp_source.html#l00298">AbstractNonlinearAssemblerSolverHybrid&lt; ELEMENT_DIM, SPACE_DIM, PROBLEM_DIM &gt;::ComputeJacobian()</a>, <a class="el" href="AbstractNonlinearElasticitySolver_8hpp_source.html#l00701">AbstractNonlinearElasticitySolver&lt; DIM &gt;::FinishAssembleSystem()</a>, and <a class="el" href="LinearSystem_8cpp_source.html#l00330">LinearSystem::SwitchWriteModeLhsMatrix()</a>.</p>

</div>
</div>
<a class="anchor" id="a18737a2adfa34aa5d7c9bec630c8a688"></a><!-- doxytag: member="PetscMatTools::Zero" ref="a18737a2adfa34aa5d7c9bec630c8a688" args="(Mat matrix)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::Zero </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&#160;</td>
          <td class="paramname"><em>matrix</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Zero all entries of a matrix. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix</td><td>the matrix </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00282">282</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p>Referenced by <a class="el" href="IncompressibleNonlinearElasticitySolver_8cpp_source.html#l00052">IncompressibleNonlinearElasticitySolver&lt; DIM &gt;::AssembleSystem()</a>, <a class="el" href="CompressibleNonlinearElasticitySolver_8cpp_source.html#l00054">CompressibleNonlinearElasticitySolver&lt; DIM &gt;::AssembleSystem()</a>, <a class="el" href="AbstractFeVolumeIntegralAssembler_8hpp_source.html#l00256">AbstractFeVolumeIntegralAssembler&lt; ELEMENT_DIM, SPACE_DIM, PROBLEM_DIM, CAN_ASSEMBLE_VECTOR, CAN_ASSEMBLE_MATRIX, INTERPOLATION_LEVEL &gt;::DoAssemble()</a>, <a class="el" href="AbstractFeCableIntegralAssembler_8hpp_source.html#l00236">AbstractFeCableIntegralAssembler&lt; ELEMENT_DIM, SPACE_DIM, PROBLEM_DIM, CAN_ASSEMBLE_VECTOR, CAN_ASSEMBLE_MATRIX, INTERPOLATION_LEVEL &gt;::DoAssemble()</a>, <a class="el" href="AbstractContinuumMechanicsAssembler_8hpp_source.html#l00332">AbstractContinuumMechanicsAssembler&lt; DIM, CAN_ASSEMBLE_VECTOR, CAN_ASSEMBLE_MATRIX &gt;::DoAssemble()</a>, and <a class="el" href="LinearSystem_8cpp_source.html#l00395">LinearSystem::ZeroLhsMatrix()</a>.</p>

</div>
</div>
<a class="anchor" id="ac790257be5a8cc501376fef953a76cee"></a><!-- doxytag: member="PetscMatTools::ZeroColumn" ref="ac790257be5a8cc501376fef953a76cee" args="(Mat matrix, PetscInt col)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::ZeroColumn </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPetscInt.html">PetscInt</a>&#160;</td>
          <td class="paramname"><em>col</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Zero a column of a matrix.</p>
<p>Unfortunately there is no equivalent method in Petsc, so this has to be done carefully to ensure that the sparsity structure of the matrix is not broken. Only owned entries which are non-zero are zeroed.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix</td><td>the matrix </td></tr>
    <tr><td class="paramname">col</td><td>the column index </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00246">246</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p>References <a class="el" href="PetscMatTools_8cpp_source.html#l00067">Finalise()</a>, <a class="el" href="PetscMatTools_8cpp_source.html#l00301">GetElement()</a>, and <a class="el" href="PetscMatTools_8cpp_source.html#l00296">GetOwnershipRange()</a>.</p>

<p>Referenced by <a class="el" href="LinearSystem_8cpp_source.html#l00385">LinearSystem::ZeroMatrixColumn()</a>.</p>

</div>
</div>
<a class="anchor" id="a742a2bec669f75b1067b282ce6cf3b11"></a><!-- doxytag: member="PetscMatTools::ZeroRowsAndColumnsWithValueOnDiagonal" ref="a742a2bec669f75b1067b282ce6cf3b11" args="(Mat matrix, std::vector&lt; unsigned &gt; rowColIndices, double diagonalValue)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::ZeroRowsAndColumnsWithValueOnDiagonal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classunsigned.html">unsigned</a> &gt;&#160;</td>
          <td class="paramname"><em>rowColIndices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdouble.html">double</a>&#160;</td>
          <td class="paramname"><em>diagonalValue</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Zero several rows and columns of a matrix, putting a given value on the diagonal.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix</td><td>the matrix </td></tr>
    <tr><td class="paramname">rowColIndices</td><td>A list of indices. All the rows with these indices, and all the columns with these indices, will be zeroed. This vector is copied (ie not passed in by reference), as it will be sorted into ascending order </td></tr>
    <tr><td class="paramname">diagonalValue</td><td>value to put in the diagonal entries (of the zeroed rows) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00182">182</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p>References <a class="el" href="PetscMatTools_8cpp_source.html#l00067">Finalise()</a>, <a class="el" href="PetscMatTools_8cpp_source.html#l00296">GetOwnershipRange()</a>, and <a class="el" href="PetscMatTools_8cpp_source.html#l00100">ZeroRowsWithValueOnDiagonal()</a>.</p>

<p>Referenced by <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00651">AbstractContinuumMechanicsSolver&lt; DIM &gt;::ApplyDirichletBoundaryConditions()</a>, and <a class="el" href="LinearSystem_8cpp_source.html#l00380">LinearSystem::ZeroMatrixRowsAndColumnsWithValueOnDiagonal()</a>.</p>

</div>
</div>
<a class="anchor" id="a5a68cf8b1e9a1630f54a60feb03084b9"></a><!-- doxytag: member="PetscMatTools::ZeroRowsWithValueOnDiagonal" ref="a5a68cf8b1e9a1630f54a60feb03084b9" args="(Mat matrix, std::vector&lt; unsigned &gt; &amp;rRows, double diagonalValue)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::ZeroRowsWithValueOnDiagonal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMat.html">Mat</a>&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classunsigned.html">unsigned</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>rRows</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdouble.html">double</a>&#160;</td>
          <td class="paramname"><em>diagonalValue</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Zero several rows of a matrix, putting a given value in the diagonal entries.</p>
<p>*Massively* less expensive than zeroing each matrix row individually</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix</td><td>the matrix </td></tr>
    <tr><td class="paramname">rRows</td><td>std::vector of rows to be zeroed </td></tr>
    <tr><td class="paramname">diagonalValue</td><td>value to put in the diagonal entries (of the zeroed rows) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp_source.html#l00100">100</a> of file <a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a>.</p>

<p>References <a class="el" href="PetscMatTools_8cpp_source.html#l00067">Finalise()</a>, and <a class="el" href="PetscTools_8hpp_source.html#l00080">PETSC_DESTROY_PARAM</a>.</p>

<p>Referenced by <a class="el" href="AbstractContinuumMechanicsSolver_8hpp_source.html#l00651">AbstractContinuumMechanicsSolver&lt; DIM &gt;::ApplyDirichletBoundaryConditions()</a>, <a class="el" href="BoundaryConditionsContainerImplementation_8hpp_source.html#l00531">BoundaryConditionsContainer&lt; ELEMENT_DIM, SPACE_DIM, PROBLEM_DIM &gt;::ApplyDirichletToNonlinearJacobian()</a>, <a class="el" href="LinearSystem_8cpp_source.html#l00375">LinearSystem::ZeroMatrixRowsWithValueOnDiagonal()</a>, and <a class="el" href="PetscMatTools_8cpp_source.html#l00182">ZeroRowsAndColumnsWithValueOnDiagonal()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>linalg/src/<a class="el" href="PetscMatTools_8hpp_source.html">PetscMatTools.hpp</a></li>
<li>linalg/src/<a class="el" href="PetscMatTools_8cpp_source.html">PetscMatTools.cpp</a></li>
</ul>
</div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="classPetscMatTools.html">PetscMatTools</a>      </li>
      <li class="footer">Generated on Mon Nov 5 2012 12:47:37 for Chaste by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </li>
    </ul>
  </div>

</body>
</html>
