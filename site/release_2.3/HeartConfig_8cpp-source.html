<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Chaste: heart/src/problem/HeartConfig.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.5 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="classes.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_b99582df44f099643ba8b1fa1107172e.html">heart</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_9a734edecfe8480c80386866d71d1ce6.html">src</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_4cee18503219a53db1795594432a05b6.html">problem</a>
  </div>
</div>
</div>
<h1>HeartConfig.cpp</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"></span>
<a name="l00003"></a>00003 <span class="comment">Copyright (C) University of Oxford, 2005-2011</span>
<a name="l00004"></a>00004 <span class="comment"></span>
<a name="l00005"></a>00005 <span class="comment">University of Oxford means the Chancellor, Masters and Scholars of the</span>
<a name="l00006"></a>00006 <span class="comment">University of Oxford, having an administrative office at Wellington</span>
<a name="l00007"></a>00007 <span class="comment">Square, Oxford OX1 2JD, UK.</span>
<a name="l00008"></a>00008 <span class="comment"></span>
<a name="l00009"></a>00009 <span class="comment">This file is part of Chaste.</span>
<a name="l00010"></a>00010 <span class="comment"></span>
<a name="l00011"></a>00011 <span class="comment">Chaste is free software: you can redistribute it and/or modify it</span>
<a name="l00012"></a>00012 <span class="comment">under the terms of the GNU Lesser General Public License as published</span>
<a name="l00013"></a>00013 <span class="comment">by the Free Software Foundation, either version 2.1 of the License, or</span>
<a name="l00014"></a>00014 <span class="comment">(at your option) any later version.</span>
<a name="l00015"></a>00015 <span class="comment"></span>
<a name="l00016"></a>00016 <span class="comment">Chaste is distributed in the hope that it will be useful, but WITHOUT</span>
<a name="l00017"></a>00017 <span class="comment">ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or</span>
<a name="l00018"></a>00018 <span class="comment">FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser General Public</span>
<a name="l00019"></a>00019 <span class="comment">License for more details. The offer of Chaste under the terms of the</span>
<a name="l00020"></a>00020 <span class="comment">License is subject to the License being interpreted in accordance with</span>
<a name="l00021"></a>00021 <span class="comment">English Law and subject to any action against the University of Oxford</span>
<a name="l00022"></a>00022 <span class="comment">being under the jurisdiction of the English Courts.</span>
<a name="l00023"></a>00023 <span class="comment"></span>
<a name="l00024"></a>00024 <span class="comment">You should have received a copy of the GNU Lesser General Public License</span>
<a name="l00025"></a>00025 <span class="comment">along with Chaste. If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l00026"></a>00026 <span class="comment"></span>
<a name="l00027"></a>00027 <span class="comment">*/</span>
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 <span class="comment">// Work-around for newer Boost versions</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include "<a class="code" href="CheckpointArchiveTypesIfNeeded_8hpp.html">CheckpointArchiveTypesIfNeeded.hpp</a>"</span>
<a name="l00031"></a>00031 
<a name="l00032"></a>00032 <span class="preprocessor">#include "<a class="code" href="UblasCustomFunctions_8hpp.html">UblasCustomFunctions.hpp</a>"</span>
<a name="l00033"></a>00033 
<a name="l00034"></a>00034 <span class="preprocessor">#include "HeartConfig.hpp"</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include "OutputFileHandler.hpp"</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include "<a class="code" href="Exception_8hpp.html">Exception.hpp</a>"</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include "ChastePoint.hpp"</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include "Version.hpp"</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include "AbstractChasteRegion.hpp"</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include "HeartFileFinder.hpp"</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include "Warnings.hpp"</span>
<a name="l00042"></a>00042 
<a name="l00043"></a>00043 <span class="preprocessor">#include "HeartRegionCodes.hpp"</span>
<a name="l00044"></a>00044 
<a name="l00045"></a>00045 <span class="preprocessor">#include "SimpleStimulus.hpp"</span>
<a name="l00046"></a>00046 <span class="preprocessor">#include "RegularStimulus.hpp"</span>
<a name="l00047"></a>00047 
<a name="l00048"></a>00048 <span class="preprocessor">#include &lt;string&gt;</span>
<a name="l00049"></a>00049 <span class="preprocessor">#include &lt;istream&gt;</span>
<a name="l00050"></a>00050 <span class="preprocessor">#include &lt;fstream&gt;</span>
<a name="l00051"></a>00051 <span class="preprocessor">#include &lt;cassert&gt;</span>
<a name="l00052"></a>00052 <span class="preprocessor">#include &lt;map&gt;</span>
<a name="l00053"></a>00053 
<a name="l00054"></a>00054 <span class="preprocessor">#include "XmlTools.hpp"</span>
<a name="l00055"></a>00055 <span class="preprocessor">#include &lt;xsd/cxx/tree/exceptions.hxx&gt;</span>
<a name="l00056"></a>00056 <span class="keyword">using namespace </span>xsd::cxx::tree;
<a name="l00057"></a>00057 
<a name="l00058"></a>00058 <span class="comment">// Coping with changes to XSD interface</span>
<a name="l00059"></a>00059 <span class="preprocessor">#if (XSD_INT_VERSION &gt;= 3000000L)</span>
<a name="l00060"></a>00060 <span class="preprocessor"></span><span class="preprocessor">#define XSD_SEQUENCE_TYPE(base) base##_sequence</span>
<a name="l00061"></a>00061 <span class="preprocessor"></span><span class="preprocessor">#define XSD_ITERATOR_TYPE(base) base##_iterator</span>
<a name="l00062"></a>00062 <span class="preprocessor"></span><span class="preprocessor">#define XSD_NESTED_TYPE(t) t##_type</span>
<a name="l00063"></a>00063 <span class="preprocessor"></span><span class="preprocessor">#define XSD_ANON_TYPE(t1, t2) \</span>
<a name="l00064"></a>00064 <span class="preprocessor">    t1::t2##_type</span>
<a name="l00065"></a>00065 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00066"></a>00066 <span class="preprocessor"></span><span class="preprocessor">#define XSD_SEQUENCE_TYPE(base) base::container</span>
<a name="l00067"></a>00067 <span class="preprocessor"></span><span class="preprocessor">#define XSD_ITERATOR_TYPE(base) base::iterator</span>
<a name="l00068"></a>00068 <span class="preprocessor"></span><span class="preprocessor">#define XSD_NESTED_TYPE(t) t::type</span>
<a name="l00069"></a>00069 <span class="preprocessor"></span><span class="preprocessor">#define XSD_ANON_TYPE(t1, t2) \</span>
<a name="l00070"></a>00070 <span class="preprocessor">    t1::t2::_xsd_##t2##_::t2</span>
<a name="l00071"></a>00071 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00072"></a>00072 <span class="preprocessor"></span>
<a name="l00073"></a>00073 <span class="comment">// These are for convenience</span>
<a name="l00074"></a>00074 <span class="preprocessor">#define XSD_ANON_SEQUENCE_TYPE(t1, t2, t3) \</span>
<a name="l00075"></a>00075 <span class="preprocessor">    XSD_SEQUENCE_TYPE(XSD_ANON_TYPE(t1, t2)::t3)</span>
<a name="l00076"></a>00076 <span class="preprocessor"></span><span class="preprocessor">#define XSD_ANON_ITERATOR_TYPE(t1, t2, t3) \</span>
<a name="l00077"></a>00077 <span class="preprocessor">    XSD_ITERATOR_TYPE(XSD_ANON_TYPE(t1, t2)::t3)</span>
<a name="l00078"></a>00078 <span class="preprocessor"></span>
<a name="l00079"></a>00079 <span class="comment">// Newer versions don't allow you to set fixed attributes</span>
<a name="l00080"></a>00080 <span class="preprocessor">#if (XSD_INT_VERSION &gt;= 3020000L)</span>
<a name="l00081"></a>00081 <span class="preprocessor"></span><span class="preprocessor">#define XSD_CREATE_WITH_FIXED_ATTR(type, name, attr) \</span>
<a name="l00082"></a>00082 <span class="preprocessor">    type name</span>
<a name="l00083"></a>00083 <span class="preprocessor"></span><span class="preprocessor">#define XSD_CREATE_WITH_FIXED_ATTR1(type, name, arg1, attr) \</span>
<a name="l00084"></a>00084 <span class="preprocessor">    type name(arg1)</span>
<a name="l00085"></a>00085 <span class="preprocessor"></span><span class="preprocessor">#define XSD_CREATE_WITH_FIXED_ATTR2(type, name, arg1, arg2, attr) \</span>
<a name="l00086"></a>00086 <span class="preprocessor">    type name(arg1, arg2)</span>
<a name="l00087"></a>00087 <span class="preprocessor"></span><span class="preprocessor">#define XSD_CREATE_WITH_FIXED_ATTR3(type, name, arg1, arg2, arg3, attr) \</span>
<a name="l00088"></a>00088 <span class="preprocessor">    type name(arg1, arg2, arg3)</span>
<a name="l00089"></a>00089 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00090"></a>00090 <span class="preprocessor"></span><span class="preprocessor">#define XSD_CREATE_WITH_FIXED_ATTR(type, name, attr) \</span>
<a name="l00091"></a>00091 <span class="preprocessor">    type name(attr)</span>
<a name="l00092"></a>00092 <span class="preprocessor"></span><span class="preprocessor">#define XSD_CREATE_WITH_FIXED_ATTR1(type, name, arg1, attr) \</span>
<a name="l00093"></a>00093 <span class="preprocessor">    type name(arg1, attr)</span>
<a name="l00094"></a>00094 <span class="preprocessor"></span><span class="preprocessor">#define XSD_CREATE_WITH_FIXED_ATTR2(type, name, arg1, arg2, attr) \</span>
<a name="l00095"></a>00095 <span class="preprocessor">    type name(arg1, arg2, attr)</span>
<a name="l00096"></a>00096 <span class="preprocessor"></span><span class="preprocessor">#define XSD_CREATE_WITH_FIXED_ATTR3(type, name, arg1, arg2, arg3, attr) \</span>
<a name="l00097"></a>00097 <span class="preprocessor">    type name(arg1, arg2, arg3, attr)</span>
<a name="l00098"></a>00098 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00099"></a>00099 <span class="preprocessor"></span>
<a name="l00103"></a>00103 <span class="preprocessor">#define ENSURE_SECTION_PRESENT(location, type) \</span>
<a name="l00104"></a>00104 <span class="preprocessor">    if (!location.present())                   \</span>
<a name="l00105"></a>00105 <span class="preprocessor">    {                                          \</span>
<a name="l00106"></a>00106 <span class="preprocessor">        type empty_item;                       \</span>
<a name="l00107"></a>00107 <span class="preprocessor">        location.set(empty_item);              \</span>
<a name="l00108"></a>00108 <span class="preprocessor">    }</span>
<a name="l00109"></a>00109 <span class="preprocessor"></span>
<a name="l00110"></a>00110 
<a name="l00115"></a><a class="code" href="classXmlTransforms.html">00115</a> <span class="keyword">class </span><a class="code" href="classXmlTransforms.html">XmlTransforms</a>
<a name="l00116"></a>00116 {
<a name="l00117"></a>00117 <span class="keyword">public</span>:
<a name="l00125"></a>00125     <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classXmlTransforms.html#1e5bd50d05c32cf8257cacbb2b650bbd">TransformIonicModelDefinitions</a>(xercesc::DOMDocument* pDocument,
<a name="l00126"></a>00126                                                xercesc::DOMElement* pRootElement);
<a name="l00127"></a>00127 
<a name="l00136"></a>00136     <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classXmlTransforms.html#0213cbf8bed42fa7e3236fdf4376bf64">TransformArchiveDirectory</a>(xercesc::DOMDocument* pDocument,
<a name="l00137"></a>00137                                           xercesc::DOMElement* pRootElement);
<a name="l00138"></a>00138 
<a name="l00146"></a>00146     <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classXmlTransforms.html#b7c65c8fd2a2e9b07b70b7009df314ef">CheckForIluPreconditioner</a>(xercesc::DOMDocument* pDocument,
<a name="l00147"></a>00147                                           xercesc::DOMElement* pRootElement);
<a name="l00148"></a>00148 };
<a name="l00149"></a>00149 
<a name="l00150"></a>00150 <span class="comment">//</span>
<a name="l00151"></a>00151 <span class="comment">// Default settings</span>
<a name="l00152"></a>00152 <span class="comment">//</span>
<a name="l00153"></a>00153 <span class="preprocessor">#include "<a class="code" href="HeartConfigDefaults_8hpp.html">HeartConfigDefaults.hpp</a>"</span>
<a name="l00154"></a>00154 
<a name="l00155"></a>00155 <span class="comment">//</span>
<a name="l00156"></a>00156 <span class="comment">// Definition of static member variables</span>
<a name="l00157"></a>00157 <span class="comment">//</span>
<a name="l00158"></a>00158 std::auto_ptr&lt;HeartConfig&gt; <a class="code" href="classHeartConfig.html#1d700f703ffa3528790264535857411a">HeartConfig::mpInstance</a>;
<a name="l00159"></a>00159 
<a name="l00160"></a>00160 <span class="comment">//</span>
<a name="l00161"></a>00161 <span class="comment">// Methods</span>
<a name="l00162"></a>00162 <span class="comment">//</span>
<a name="l00163"></a>00163 
<a name="l00164"></a><a class="code" href="classHeartConfig.html#f8ab048189a76d46bbec0ff541449b89">00164</a> <a class="code" href="classHeartConfig.html">HeartConfig</a>* <a class="code" href="classHeartConfig.html#f8ab048189a76d46bbec0ff541449b89">HeartConfig::Instance</a>()
<a name="l00165"></a>00165 {
<a name="l00166"></a>00166     <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#1d700f703ffa3528790264535857411a">mpInstance</a>.get() == NULL)
<a name="l00167"></a>00167     {
<a name="l00168"></a>00168         <a class="code" href="classHeartConfig.html#1d700f703ffa3528790264535857411a">mpInstance</a>.reset(<span class="keyword">new</span> <a class="code" href="classHeartConfig.html">HeartConfig</a>);
<a name="l00169"></a>00169     }
<a name="l00170"></a>00170     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#1d700f703ffa3528790264535857411a">mpInstance</a>.get();
<a name="l00171"></a>00171 }
<a name="l00172"></a>00172 
<a name="l00173"></a><a class="code" href="classHeartConfig.html#2f629df484e2205be3f61af02d5144e3">00173</a> <a class="code" href="classHeartConfig.html#2f629df484e2205be3f61af02d5144e3">HeartConfig::HeartConfig</a>()
<a name="l00174"></a>00174     : <a class="code" href="classHeartConfig.html#8dec021b51fe856a7fa9f9f4efdb75bd">mUseMassLumping</a>(false),
<a name="l00175"></a>00175       <a class="code" href="classHeartConfig.html#c92f76dda02e32251cb54ab8db4e4731">mUseMassLumpingForPrecond</a>(false),
<a name="l00176"></a>00176       <a class="code" href="classHeartConfig.html#2b62de1b5893819e228fa281b33bcb7c">mUseFixedNumberIterations</a>(false),
<a name="l00177"></a>00177       <a class="code" href="classHeartConfig.html#88ce4e48dfccc4028c6b8718314f4f55">mEvaluateNumItsEveryNSolves</a>(UINT_MAX)
<a name="l00178"></a>00178 {
<a name="l00179"></a>00179     assert(<a class="code" href="classHeartConfig.html#1d700f703ffa3528790264535857411a">mpInstance</a>.get() == NULL);
<a name="l00180"></a>00180     <a class="code" href="classHeartConfig.html#39f79c982e9983fe8c2823d8de697d85">mUseFixedSchemaLocation</a> = <span class="keyword">true</span>;
<a name="l00181"></a>00181     <a class="code" href="classHeartConfig.html#92d7f06c5cf8caa9c8cf3f65ada9bb6b">SetDefaultSchemaLocations</a>();
<a name="l00182"></a>00182 
<a name="l00183"></a>00183     <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a> = <a class="code" href="HeartConfigDefaults_8hpp.html#851ccffc58ceb5f2628d473db9eded5a">CreateDefaultParameters</a>();
<a name="l00184"></a>00184     <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a> = <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>;
<a name="l00185"></a>00185     <span class="comment">//CheckTimeSteps(); // necessity of this line of code is not tested -- remove with caution!</span>
<a name="l00186"></a>00186 
<a name="l00187"></a>00187     <span class="comment">//initialise the member variable of the layers</span>
<a name="l00188"></a>00188     <a class="code" href="classHeartConfig.html#efbe15b3fd5d616d98a35dd172608529">mEpiFraction</a> = -1.0;
<a name="l00189"></a>00189     <a class="code" href="classHeartConfig.html#9c9f9fefab6c029324426098740b5bc4">mEndoFraction</a> =  -1.0;
<a name="l00190"></a>00190     <a class="code" href="classHeartConfig.html#5648845197c449e58c2c879f7422df3f">mMidFraction</a> = -1.0;
<a name="l00191"></a>00191     <a class="code" href="classHeartConfig.html#6ebec0d7deb03099ae581bca114147fb">mUserAskedForCellularTransmuralHeterogeneities</a>=<span class="keyword">false</span>;
<a name="l00192"></a>00192     <span class="comment">// initialise to senseless values (these should be only 0, 1 and 2)</span>
<a name="l00193"></a>00193     <span class="comment">// note: the 'minus 3' is for checking purposes as we need to add 0, 1 or 2 to this initial value</span>
<a name="l00194"></a>00194     <span class="comment">// and UINT_MAX+1 seems to be 0</span>
<a name="l00195"></a>00195     <a class="code" href="classHeartConfig.html#bfdca19b9fc56fe21ef23d2593cc022f">mIndexMid</a> = UINT_MAX-3u;
<a name="l00196"></a>00196     <a class="code" href="classHeartConfig.html#b24f553ab1e97d36b8467f7ca1bcf800">mIndexEpi</a> = UINT_MAX-3u;
<a name="l00197"></a>00197     <a class="code" href="classHeartConfig.html#4785f6ad1c60766c471bcb525eac02d3">mIndexEndo</a> = UINT_MAX-3u;
<a name="l00198"></a>00198 
<a name="l00199"></a>00199     <a class="code" href="classHeartConfig.html#e42bb9c3f734dfaa2247de53cf3543a1">mUseReactionDiffusionOperatorSplitting</a> = <span class="keyword">false</span>;
<a name="l00200"></a>00200 
<a name="l00202"></a>00202     <a class="code" href="classHeartConfig.html#c657f43ca4d92bfd3c5e2270e7470429">mTissueIdentifiers</a>.insert(0);
<a name="l00203"></a>00203     <a class="code" href="classHeartConfig.html#1471127f954fea7a8eb5811ec448f0cc">mBathIdentifiers</a>.insert(1);
<a name="l00204"></a>00204 }
<a name="l00205"></a>00205 
<a name="l00206"></a><a class="code" href="classHeartConfig.html#a43c19f27c6313368b04ceabcd502ae4">00206</a> <a class="code" href="classHeartConfig.html#a43c19f27c6313368b04ceabcd502ae4">HeartConfig::~HeartConfig</a>()
<a name="l00207"></a>00207 {
<a name="l00208"></a>00208 }
<a name="l00209"></a>00209 
<a name="l00210"></a><a class="code" href="classHeartConfig.html#380c38e127a3dcb18948bdc52d99259c">00210</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#380c38e127a3dcb18948bdc52d99259c">HeartConfig::SetDefaultsFile</a>(<span class="keyword">const</span> std::string&amp; rFileName)
<a name="l00211"></a>00211 {
<a name="l00212"></a>00212     <span class="keywordtype">bool</span> same_target = (<a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a> == <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>);
<a name="l00213"></a>00213 
<a name="l00214"></a>00214     <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a> = <a class="code" href="classHeartConfig.html#871a948c9d64ccfdecc2c3a1d47fb304">ReadFile</a>(rFileName);
<a name="l00215"></a>00215 
<a name="l00216"></a>00216     <span class="keywordflow">if</span> (same_target)
<a name="l00217"></a>00217     {
<a name="l00218"></a>00218         <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a> = <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>;
<a name="l00219"></a>00219     }
<a name="l00220"></a>00220     <a class="code" href="classHeartConfig.html#ef79708e5e663a9ea5ff236ecc0bbd85">CheckTimeSteps</a>();
<a name="l00221"></a>00221 }
<a name="l00222"></a>00222 
<a name="l00223"></a><a class="code" href="classHeartConfig.html#c432ab6bce14059d6e18e92dbec89b74">00223</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#c432ab6bce14059d6e18e92dbec89b74">HeartConfig::Write</a>(<span class="keywordtype">bool</span> useArchiveLocationInfo, std::string subfolderName)
<a name="l00224"></a>00224 {
<a name="l00225"></a>00225     <span class="comment">//Output file</span>
<a name="l00226"></a>00226     std::string output_dirname;
<a name="l00227"></a>00227     <span class="keywordflow">if</span> (useArchiveLocationInfo)
<a name="l00228"></a>00228     {
<a name="l00229"></a>00229         output_dirname = <a class="code" href="classArchiveLocationInfo.html#6700ec1ad13e77e795a8059f95006de5">ArchiveLocationInfo::GetArchiveDirectory</a>();
<a name="l00230"></a>00230     }
<a name="l00231"></a>00231     <span class="keywordflow">else</span>
<a name="l00232"></a>00232     {
<a name="l00233"></a>00233         <a class="code" href="classOutputFileHandler.html">OutputFileHandler</a> handler(<a class="code" href="classHeartConfig.html#d4f49a0c81a7463613fdde99fb56e224">GetOutputDirectory</a>() + <span class="stringliteral">"/"</span> + subfolderName, <span class="keyword">false</span>);
<a name="l00234"></a>00234         output_dirname = handler.<a class="code" href="classOutputFileHandler.html#b9c41bd287378a80f884d9860fb14f27">GetOutputDirectoryFullPath</a>();
<a name="l00235"></a>00235     }
<a name="l00236"></a>00236     <span class="keywordflow">if</span> (!<a class="code" href="classPetscTools.html#30cf1b3576c5dd99556f6b87a05be7cc">PetscTools::AmMaster</a>())
<a name="l00237"></a>00237     {
<a name="l00238"></a>00238         <span class="comment">//Only the master process is writing the configuration files</span>
<a name="l00239"></a>00239         <span class="keywordflow">return</span>;
<a name="l00240"></a>00240     }
<a name="l00241"></a>00241     out_stream p_defaults_file( <span class="keyword">new</span> std::ofstream( (output_dirname+<span class="stringliteral">"ChasteDefaults.xml"</span>).c_str() ) );
<a name="l00242"></a>00242     out_stream p_parameters_file( <span class="keyword">new</span> std::ofstream( (output_dirname+<span class="stringliteral">"ChasteParameters.xml"</span>).c_str() ) );
<a name="l00243"></a>00243 
<a name="l00244"></a>00244     <span class="keywordflow">if</span> (!p_defaults_file-&gt;is_open() || !p_parameters_file-&gt;is_open())
<a name="l00245"></a>00245     {
<a name="l00246"></a>00246         <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a>(<span class="stringliteral">"Could not open XML file in HeartConfig"</span>);
<a name="l00247"></a>00247     }
<a name="l00248"></a>00248 
<a name="l00249"></a>00249     <span class="comment">//Schema map</span>
<a name="l00250"></a>00250     <span class="comment">//Note - this location is relative to where we are storing the xml</span>
<a name="l00251"></a>00251     ::xml_schema::namespace_infomap map;
<a name="l00252"></a>00252     <span class="comment">// Release 1.1 (and earlier) didn't use a namespace</span>
<a name="l00253"></a>00253     map[<span class="stringliteral">""</span>].schema = <span class="stringliteral">"ChasteParameters_1_1.xsd"</span>;
<a name="l00254"></a>00254     <span class="comment">// Later releases use namespaces of the form https://chaste.comlab.ox.ac.uk/nss/parameters/N_M</span>
<a name="l00255"></a>00255     map[<span class="stringliteral">"cp20"</span>].name = <span class="stringliteral">"https://chaste.comlab.ox.ac.uk/nss/parameters/2_0"</span>;
<a name="l00256"></a>00256     map[<span class="stringliteral">"cp20"</span>].schema = <span class="stringliteral">"ChasteParameters_2_0.xsd"</span>;
<a name="l00257"></a>00257     map[<span class="stringliteral">"cp21"</span>].name = <span class="stringliteral">"https://chaste.comlab.ox.ac.uk/nss/parameters/2_1"</span>;
<a name="l00258"></a>00258     map[<span class="stringliteral">"cp21"</span>].schema = <span class="stringliteral">"ChasteParameters_2_1.xsd"</span>;
<a name="l00259"></a>00259     map[<span class="stringliteral">"cp22"</span>].name = <span class="stringliteral">"https://chaste.comlab.ox.ac.uk/nss/parameters/2_2"</span>;
<a name="l00260"></a>00260     map[<span class="stringliteral">"cp22"</span>].schema = <span class="stringliteral">"ChasteParameters_2_2.xsd"</span>;
<a name="l00261"></a>00261     <span class="comment">// We use 'cp' as prefix for the latest version to avoid having to change saved</span>
<a name="l00262"></a>00262     <span class="comment">// versions for comparison at every release.</span>
<a name="l00263"></a>00263     map[<span class="stringliteral">"cp"</span>].name = <span class="stringliteral">"https://chaste.comlab.ox.ac.uk/nss/parameters/2_3"</span>;
<a name="l00264"></a>00264     map[<span class="stringliteral">"cp"</span>].schema = <span class="stringliteral">"ChasteParameters_2_3.xsd"</span>;
<a name="l00265"></a>00265 
<a name="l00266"></a>00266     cp::ChasteParameters(*p_parameters_file, *<a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>, map);
<a name="l00267"></a>00267     cp::ChasteParameters(*p_defaults_file, *<a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>, map);
<a name="l00268"></a>00268 
<a name="l00269"></a>00269     <span class="comment">// If we're archiving, try to save a copy of the latest schema too</span>
<a name="l00270"></a>00270     <span class="keywordflow">if</span> (useArchiveLocationInfo)
<a name="l00271"></a>00271     {
<a name="l00272"></a>00272         <a class="code" href="classHeartConfig.html#37906194c947a2e92ea9c44775ef1b28">CopySchema</a>(output_dirname);
<a name="l00273"></a>00273     }
<a name="l00274"></a>00274 }
<a name="l00275"></a>00275 
<a name="l00276"></a><a class="code" href="classHeartConfig.html#37906194c947a2e92ea9c44775ef1b28">00276</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#37906194c947a2e92ea9c44775ef1b28">HeartConfig::CopySchema</a>(<span class="keyword">const</span> std::string&amp; rToDirectory)
<a name="l00277"></a>00277 {
<a name="l00278"></a>00278     <span class="keywordflow">if</span> (<a class="code" href="classPetscTools.html#30cf1b3576c5dd99556f6b87a05be7cc">PetscTools::AmMaster</a>())
<a name="l00279"></a>00279     {
<a name="l00280"></a>00280         std::string schema_name(<span class="stringliteral">"ChasteParameters_2_3.xsd"</span>);
<a name="l00281"></a>00281         <a class="code" href="classFileFinder.html">FileFinder</a> schema_location(<span class="stringliteral">"heart/src/io/"</span> + schema_name, <a class="code" href="structRelativeTo.html#71205f16f6ffbf2c354beb369d8b996c7d8d067a4ecd2bafa88912dbf8ac785b">RelativeTo::ChasteSourceRoot</a>);
<a name="l00282"></a>00282         <span class="keywordflow">if</span> (!schema_location.<a class="code" href="classFileFinder.html#7c9aafbfeaef61ba18becd61f58b01eb">Exists</a>())
<a name="l00283"></a>00283         {
<a name="l00284"></a>00284             <span class="comment">// Try a relative path instead</span>
<a name="l00285"></a>00285             schema_location.<a class="code" href="classFileFinder.html#d10aa6235c4c4fb24370d3f6675d4b8b">SetPath</a>(schema_name, <a class="code" href="structRelativeTo.html#71205f16f6ffbf2c354beb369d8b996cab109680c356ada0533fcc39ffcddb54">RelativeTo::CWD</a>);
<a name="l00286"></a>00286             <span class="keywordflow">if</span> (!schema_location.<a class="code" href="classFileFinder.html#7c9aafbfeaef61ba18becd61f58b01eb">Exists</a>())
<a name="l00287"></a>00287             {
<a name="l00288"></a>00288                 <span class="comment">// Warn the user</span>
<a name="l00289"></a>00289                 std::string message(<span class="stringliteral">"Unable to locate schema file "</span> + schema_name +
<a name="l00290"></a>00290                                     <span class="stringliteral">". You will need to ensure it is available when resuming from the checkpoint."</span>);
<a name="l00291"></a>00291                 WARN_ONCE_ONLY(message);
<a name="l00292"></a>00292             }
<a name="l00293"></a>00293         }
<a name="l00294"></a>00294         <span class="keywordflow">if</span> (schema_location.<a class="code" href="classFileFinder.html#7c9aafbfeaef61ba18becd61f58b01eb">Exists</a>())
<a name="l00295"></a>00295         {
<a name="l00296"></a>00296             <span class="comment">// Called by master only so use this instead of EXPECT0</span>
<a name="l00297"></a>00297             <a class="code" href="Exception_8hpp.html#a36e0f6757d2e1ba635c86a8c22d20fd">MPIABORTIFNON0</a>(system,(<span class="stringliteral">"cp "</span> + schema_location.<a class="code" href="classFileFinder.html#9e8f0117112b28a5f5812bd025001648">GetAbsolutePath</a>() + <span class="stringliteral">" "</span> + rToDirectory).c_str());
<a name="l00298"></a>00298         }
<a name="l00299"></a>00299     }
<a name="l00300"></a>00300 }
<a name="l00301"></a>00301 
<a name="l00302"></a><a class="code" href="classHeartConfig.html#92d7f06c5cf8caa9c8cf3f65ada9bb6b">00302</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#92d7f06c5cf8caa9c8cf3f65ada9bb6b">HeartConfig::SetDefaultSchemaLocations</a>()
<a name="l00303"></a>00303 {
<a name="l00304"></a>00304     <a class="code" href="classHeartConfig.html#0378789cef3d6ef3001bbb94e9e48798">mSchemaLocations</a>.clear();
<a name="l00305"></a>00305     <span class="comment">// Location of schemas in the source tree</span>
<a name="l00306"></a>00306     std::string root_dir = std::string(<a class="code" href="classChasteBuildInfo.html#b1d5cd2c8e4852a5b0ac4f525c1e2565">ChasteBuildInfo::GetRootDir</a>()) + <span class="stringliteral">"/heart/src/io/"</span>;
<a name="l00307"></a>00307     <span class="comment">// Release 1.1 (and earlier) didn't use a namespace</span>
<a name="l00308"></a>00308     <a class="code" href="classHeartConfig.html#0378789cef3d6ef3001bbb94e9e48798">mSchemaLocations</a>[<span class="stringliteral">""</span>] = root_dir + <span class="stringliteral">"ChasteParameters_1_1.xsd"</span>;
<a name="l00309"></a>00309     <span class="comment">// Later releases use namespaces of the form https://chaste.comlab.ox.ac.uk/nss/parameters/N_M</span>
<a name="l00310"></a>00310     <a class="code" href="classHeartConfig.html#0378789cef3d6ef3001bbb94e9e48798">mSchemaLocations</a>[<span class="stringliteral">"https://chaste.comlab.ox.ac.uk/nss/parameters/2_0"</span>] = root_dir + <span class="stringliteral">"ChasteParameters_2_0.xsd"</span>;
<a name="l00311"></a>00311     <a class="code" href="classHeartConfig.html#0378789cef3d6ef3001bbb94e9e48798">mSchemaLocations</a>[<span class="stringliteral">"https://chaste.comlab.ox.ac.uk/nss/parameters/2_1"</span>] = root_dir + <span class="stringliteral">"ChasteParameters_2_1.xsd"</span>;
<a name="l00312"></a>00312     <a class="code" href="classHeartConfig.html#0378789cef3d6ef3001bbb94e9e48798">mSchemaLocations</a>[<span class="stringliteral">"https://chaste.comlab.ox.ac.uk/nss/parameters/2_2"</span>] = root_dir + <span class="stringliteral">"ChasteParameters_2_2.xsd"</span>;
<a name="l00313"></a>00313     <a class="code" href="classHeartConfig.html#0378789cef3d6ef3001bbb94e9e48798">mSchemaLocations</a>[<span class="stringliteral">"https://chaste.comlab.ox.ac.uk/nss/parameters/2_3"</span>] = root_dir + <span class="stringliteral">"ChasteParameters_2_3.xsd"</span>;
<a name="l00314"></a>00314 }
<a name="l00315"></a>00315 
<a name="l00316"></a><a class="code" href="classHeartConfig.html#e3070b8f3e5f0c5d86ddb9e52b116de1">00316</a> <span class="keywordtype">unsigned</span> <a class="code" href="classHeartConfig.html#e3070b8f3e5f0c5d86ddb9e52b116de1">HeartConfig::GetVersionFromNamespace</a>(<span class="keyword">const</span> std::string&amp; rNamespaceUri)
<a name="l00317"></a>00317 {
<a name="l00318"></a>00318     <span class="keywordtype">unsigned</span> version_major = 0;
<a name="l00319"></a>00319     <span class="keywordtype">unsigned</span> version_minor = 0;
<a name="l00320"></a>00320     <span class="keywordflow">if</span> (rNamespaceUri == <span class="stringliteral">""</span>)
<a name="l00321"></a>00321     {
<a name="l00322"></a>00322         version_major = 1;
<a name="l00323"></a>00323         version_minor = 1;
<a name="l00324"></a>00324     }
<a name="l00325"></a>00325     <span class="keywordflow">else</span>
<a name="l00326"></a>00326     {
<a name="l00327"></a>00327         std::string uri_base(<span class="stringliteral">"https://chaste.comlab.ox.ac.uk/nss/parameters/"</span>);
<a name="l00328"></a>00328         <span class="keywordflow">if</span> (rNamespaceUri.substr(0, uri_base.length()) == uri_base)
<a name="l00329"></a>00329         {
<a name="l00330"></a>00330             std::istringstream version_string(rNamespaceUri.substr(uri_base.length()));
<a name="l00331"></a>00331             version_string &gt;&gt; version_major;
<a name="l00332"></a>00332             version_string.ignore(1);
<a name="l00333"></a>00333             version_string &gt;&gt; version_minor;
<a name="l00334"></a>00334             <span class="keywordflow">if</span> (version_string.fail())
<a name="l00335"></a>00335             {
<a name="l00336"></a>00336                 version_major = 0;
<a name="l00337"></a>00337                 version_minor = 0;
<a name="l00338"></a>00338             }
<a name="l00339"></a>00339         }
<a name="l00340"></a>00340     }
<a name="l00341"></a>00341 
<a name="l00342"></a>00342     <span class="keywordtype">unsigned</span> version = version_major * 1000 + version_minor;
<a name="l00343"></a>00343     <span class="keywordflow">if</span> (version == 0)
<a name="l00344"></a>00344     {
<a name="l00345"></a>00345         <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a>(rNamespaceUri + <span class="stringliteral">" is not a recognised Chaste parameters namespace."</span>);
<a name="l00346"></a>00346     }
<a name="l00347"></a>00347     <span class="keywordflow">return</span> version;
<a name="l00348"></a>00348 }
<a name="l00349"></a>00349 
<a name="l00350"></a><a class="code" href="classHeartConfig.html#6e38ef44c15a2d35c349cf323dca4fbb">00350</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#6e38ef44c15a2d35c349cf323dca4fbb">HeartConfig::SetFixedSchemaLocations</a>(<span class="keyword">const</span> <a class="code" href="classHeartConfig.html#068245b955a8ea88bcdfd793ec3327b0">SchemaLocationsMap</a>&amp; rSchemaLocations)
<a name="l00351"></a>00351 {
<a name="l00352"></a>00352     <a class="code" href="classHeartConfig.html#0378789cef3d6ef3001bbb94e9e48798">mSchemaLocations</a> = rSchemaLocations;
<a name="l00353"></a>00353     <a class="code" href="classHeartConfig.html#54b8f9c822ac30d9a22e6121f428658b">SetUseFixedSchemaLocation</a>(<span class="keyword">true</span>);
<a name="l00354"></a>00354 }
<a name="l00355"></a>00355 
<a name="l00356"></a><a class="code" href="classHeartConfig.html#54b8f9c822ac30d9a22e6121f428658b">00356</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#54b8f9c822ac30d9a22e6121f428658b">HeartConfig::SetUseFixedSchemaLocation</a>(<span class="keywordtype">bool</span> useFixedSchemaLocation)
<a name="l00357"></a>00357 {
<a name="l00358"></a>00358     <a class="code" href="classHeartConfig.html#39f79c982e9983fe8c2823d8de697d85">mUseFixedSchemaLocation</a> = useFixedSchemaLocation;
<a name="l00359"></a>00359 }
<a name="l00360"></a>00360 
<a name="l00361"></a><a class="code" href="classHeartConfig.html#871a948c9d64ccfdecc2c3a1d47fb304">00361</a> boost::shared_ptr&lt;cp::chaste_parameters_type&gt; <a class="code" href="classHeartConfig.html#871a948c9d64ccfdecc2c3a1d47fb304">HeartConfig::ReadFile</a>(<span class="keyword">const</span> std::string&amp; rFileName)
<a name="l00362"></a>00362 {
<a name="l00363"></a>00363     <span class="comment">// Determine whether to use the schema path given in the input XML, or our own schema</span>
<a name="l00364"></a>00364     ::xml_schema::properties props;
<a name="l00365"></a>00365     <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#39f79c982e9983fe8c2823d8de697d85">mUseFixedSchemaLocation</a>)
<a name="l00366"></a>00366     {
<a name="l00367"></a>00367         <span class="keywordflow">for</span> (SchemaLocationsMap::iterator it = <a class="code" href="classHeartConfig.html#0378789cef3d6ef3001bbb94e9e48798">mSchemaLocations</a>.begin();
<a name="l00368"></a>00368              it != <a class="code" href="classHeartConfig.html#0378789cef3d6ef3001bbb94e9e48798">mSchemaLocations</a>.end();
<a name="l00369"></a>00369              ++it)
<a name="l00370"></a>00370         {
<a name="l00371"></a>00371             <span class="keywordflow">if</span> (it-&gt;first == <span class="stringliteral">""</span>)
<a name="l00372"></a>00372             {
<a name="l00373"></a>00373                 props.no_namespace_schema_location(<a class="code" href="classXmlTools.html#2879fbd117ddd8bce46f2cdf7d039069">XmlTools::EscapeSpaces</a>(it-&gt;second));
<a name="l00374"></a>00374             }
<a name="l00375"></a>00375             <span class="keywordflow">else</span>
<a name="l00376"></a>00376             {
<a name="l00377"></a>00377                 props.schema_location(it-&gt;first, <a class="code" href="classXmlTools.html#2879fbd117ddd8bce46f2cdf7d039069">XmlTools::EscapeSpaces</a>(it-&gt;second));
<a name="l00378"></a>00378             }
<a name="l00379"></a>00379         }
<a name="l00380"></a>00380     }
<a name="l00381"></a>00381 
<a name="l00382"></a>00382     <span class="comment">// Get the parameters using the method 'ChasteParameters(rFileName)',</span>
<a name="l00383"></a>00383     <span class="comment">// which returns a std::auto_ptr. We convert to a shared_ptr for easier semantics.</span>
<a name="l00384"></a>00384     <span class="keywordflow">try</span>
<a name="l00385"></a>00385     {
<a name="l00386"></a>00386         <span class="comment">// Make sure Xerces finalization happens</span>
<a name="l00387"></a>00387         <a class="code" href="classXmlTools_1_1Finalizer.html">XmlTools::Finalizer</a> finalizer(<span class="keyword">false</span>);
<a name="l00388"></a>00388         <span class="comment">// Parse XML to DOM</span>
<a name="l00389"></a>00389         xsd::cxx::xml::dom::auto_ptr&lt;xercesc::DOMDocument&gt; p_doc = <a class="code" href="classXmlTools.html#3d80fbf15d0ef00b995dc6b48b8b1b35">XmlTools::ReadXmlFile</a>(rFileName, props);
<a name="l00390"></a>00390         <span class="comment">// Test the namespace on the root element</span>
<a name="l00391"></a>00391         xercesc::DOMElement* p_root_elt = p_doc-&gt;getDocumentElement();
<a name="l00392"></a>00392         std::string namespace_uri(X2C(p_root_elt-&gt;getNamespaceURI()));
<a name="l00393"></a>00393         <span class="keywordflow">switch</span> (<a class="code" href="classHeartConfig.html#e3070b8f3e5f0c5d86ddb9e52b116de1">GetVersionFromNamespace</a>(namespace_uri))
<a name="l00394"></a>00394         {
<a name="l00395"></a>00395             <span class="keywordflow">case</span> 1001: <span class="comment">// Release 1.1 and earlier</span>
<a name="l00396"></a>00396                 <a class="code" href="classXmlTransforms.html#1e5bd50d05c32cf8257cacbb2b650bbd">XmlTransforms::TransformIonicModelDefinitions</a>(p_doc.get(), p_root_elt);
<a name="l00397"></a>00397             <span class="keywordflow">case</span> 2000: <span class="comment">// Release 2.0</span>
<a name="l00398"></a>00398                 <a class="code" href="classXmlTransforms.html#0213cbf8bed42fa7e3236fdf4376bf64">XmlTransforms::TransformArchiveDirectory</a>(p_doc.get(), p_root_elt);
<a name="l00399"></a>00399                 <a class="code" href="classXmlTransforms.html#b7c65c8fd2a2e9b07b70b7009df314ef">XmlTransforms::CheckForIluPreconditioner</a>(p_doc.get(), p_root_elt);
<a name="l00400"></a>00400             <span class="keywordflow">case</span> 2001: <span class="comment">// Release 2.1</span>
<a name="l00401"></a>00401             <span class="keywordflow">case</span> 2002: <span class="comment">// Release 2.2</span>
<a name="l00402"></a>00402                 <a class="code" href="classXmlTools.html#09596c402a3cbd2e2405629efd2bbd63">XmlTools::SetNamespace</a>(p_doc.get(), p_root_elt, <span class="stringliteral">"https://chaste.comlab.ox.ac.uk/nss/parameters/2_3"</span>);
<a name="l00403"></a>00403             <span class="keywordflow">default</span>: <span class="comment">// Current release - nothing to do</span>
<a name="l00404"></a>00404                 <span class="keywordflow">break</span>;
<a name="l00405"></a>00405         }
<a name="l00406"></a>00406         <span class="comment">// Parse DOM to object model</span>
<a name="l00407"></a>00407         std::auto_ptr&lt;cp::chaste_parameters_type&gt; p_params(cp::ChasteParameters(*p_doc, ::xml_schema::flags::dont_initialize, props));
<a name="l00408"></a>00408         <span class="comment">// Get rid of the DOM stuff</span>
<a name="l00409"></a>00409         p_doc.reset();
<a name="l00410"></a>00410 
<a name="l00411"></a>00411         <span class="keywordflow">return</span> boost::shared_ptr&lt;cp::chaste_parameters_type&gt;(p_params);
<a name="l00412"></a>00412     }
<a name="l00413"></a>00413     <span class="keywordflow">catch</span> (<span class="keyword">const</span> xml_schema::exception&amp; e)
<a name="l00414"></a>00414     {
<a name="l00415"></a>00415         std::cerr &lt;&lt; e &lt;&lt; std::endl;
<a name="l00416"></a>00416         <span class="comment">// Make sure we don't store invalid parameters</span>
<a name="l00417"></a>00417         <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>.reset();
<a name="l00418"></a>00418         <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>.reset();
<a name="l00419"></a>00419         <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a>(<span class="stringliteral">"XML parsing error in configuration file: "</span> + rFileName);
<a name="l00420"></a>00420     }
<a name="l00421"></a>00421     <span class="keywordflow">catch</span> (...)
<a name="l00422"></a>00422     {
<a name="l00423"></a>00423         <span class="comment">// Make sure we don't store invalid parameters</span>
<a name="l00424"></a>00424         <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>.reset();
<a name="l00425"></a>00425         <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>.reset();
<a name="l00426"></a>00426         <span class="keywordflow">throw</span>;
<a name="l00427"></a>00427     }
<a name="l00428"></a>00428 }
<a name="l00429"></a>00429 
<a name="l00430"></a><a class="code" href="classHeartConfig.html#f6fed28371be1a69eefe2de666d44a87">00430</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#f6fed28371be1a69eefe2de666d44a87">HeartConfig::SetParametersFile</a>(<span class="keyword">const</span> std::string&amp; rFileName)
<a name="l00431"></a>00431 {
<a name="l00432"></a>00432     <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a> = <a class="code" href="classHeartConfig.html#871a948c9d64ccfdecc2c3a1d47fb304">ReadFile</a>(rFileName);
<a name="l00433"></a>00433 
<a name="l00434"></a>00434     <a class="code" href="classHeartConfig.html#ef79708e5e663a9ea5ff236ecc0bbd85">CheckTimeSteps</a>(); <span class="comment">// For consistency with SetDefaultsFile</span>
<a name="l00435"></a>00435 }
<a name="l00436"></a>00436 
<a name="l00437"></a>00437 
<a name="l00438"></a><a class="code" href="classHeartConfig.html#f4a13ca5317352be2869586bef3dbd8f">00438</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#f4a13ca5317352be2869586bef3dbd8f">HeartConfig::UpdateParametersFromResumeSimulation</a>(boost::shared_ptr&lt;cp::chaste_parameters_type&gt; pResumeParameters)
<a name="l00439"></a>00439 {
<a name="l00440"></a>00440     <span class="comment">// Check for user foolishness</span>
<a name="l00441"></a>00441     <span class="keywordflow">if</span> ( (pResumeParameters-&gt;ResumeSimulation()-&gt;SpaceDimension() != <a class="code" href="classHeartConfig.html#f8ab048189a76d46bbec0ff541449b89">HeartConfig::Instance</a>()-&gt;<a class="code" href="classHeartConfig.html#4170d162538ec096d7df103f5781a998">GetSpaceDimension</a>())
<a name="l00442"></a>00442          ||(pResumeParameters-&gt;ResumeSimulation()-&gt;Domain() != <a class="code" href="classHeartConfig.html#f8ab048189a76d46bbec0ff541449b89">HeartConfig::Instance</a>()-&gt;<a class="code" href="classHeartConfig.html#493a8d7316bd8e257459ec0372fd8706">GetDomain</a>()))
<a name="l00443"></a>00443     {
<a name="l00444"></a>00444         <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a>(<span class="stringliteral">"Problem type and space dimension should match when restarting a simulation."</span>);
<a name="l00445"></a>00445     }
<a name="l00446"></a>00446 
<a name="l00447"></a>00447     <span class="comment">// New simulation duration</span>
<a name="l00448"></a>00448     <a class="code" href="classHeartConfig.html#f8ab048189a76d46bbec0ff541449b89">HeartConfig::Instance</a>()-&gt;<a class="code" href="classHeartConfig.html#ad5f6297757ec9b088e6ef56b9a71686">SetSimulationDuration</a>(pResumeParameters-&gt;ResumeSimulation()-&gt;SimulationDuration());
<a name="l00449"></a>00449 
<a name="l00450"></a>00450     <span class="comment">// Stimulus definition.  For these we always replace any previous definitions (at least for now...)</span>
<a name="l00451"></a>00451     <span class="keywordflow">if</span> (pResumeParameters-&gt;ResumeSimulation()-&gt;Stimuli().present())
<a name="l00452"></a>00452     {
<a name="l00453"></a>00453         <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;Stimuli().set(pResumeParameters-&gt;ResumeSimulation()-&gt;Stimuli().get());
<a name="l00454"></a>00454     }
<a name="l00455"></a>00455 
<a name="l00456"></a>00456     <span class="comment">// Cell heterogeneities.  Note that while we copy the elements here, other code in CardiacSimulation actually updates</span>
<a name="l00457"></a>00457     <span class="comment">// the loaded simulation to take account of the new settings.</span>
<a name="l00458"></a>00458     <span class="keywordflow">if</span> (pResumeParameters-&gt;ResumeSimulation()-&gt;CellHeterogeneities().present())
<a name="l00459"></a>00459     {
<a name="l00460"></a>00460         <span class="keywordflow">if</span> (!<a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;CellHeterogeneities().present())
<a name="l00461"></a>00461         {
<a name="l00462"></a>00462             <span class="comment">// Original parameters had no heterogeneities, so just copy the whole element</span>
<a name="l00463"></a>00463             <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;CellHeterogeneities().set(pResumeParameters-&gt;ResumeSimulation()-&gt;CellHeterogeneities().get());
<a name="l00464"></a>00464         }
<a name="l00465"></a>00465         <span class="keywordflow">else</span>
<a name="l00466"></a>00466         {
<a name="l00467"></a>00467             <span class="comment">// Need to append the new heterogeneity defitions to the original sequence</span>
<a name="l00468"></a>00468             XSD_SEQUENCE_TYPE(cp::cell_heterogeneities_type::CellHeterogeneity)&amp;
<a name="l00469"></a>00469                 new_seq = pResumeParameters-&gt;ResumeSimulation()-&gt;CellHeterogeneities()-&gt;CellHeterogeneity();
<a name="l00470"></a>00470             XSD_SEQUENCE_TYPE(cp::cell_heterogeneities_type::CellHeterogeneity)&amp;
<a name="l00471"></a>00471                 orig_seq = <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;CellHeterogeneities()-&gt;CellHeterogeneity();
<a name="l00472"></a>00472             <span class="keywordflow">for</span> (XSD_ITERATOR_TYPE(cp::cell_heterogeneities_type::CellHeterogeneity) i = new_seq.begin();
<a name="l00473"></a>00473                  i != new_seq.end();
<a name="l00474"></a>00474                  ++i)
<a name="l00475"></a>00475             {
<a name="l00476"></a>00476                 orig_seq.push_back(*i);
<a name="l00477"></a>00477             }
<a name="l00478"></a>00478         }
<a name="l00479"></a>00479     }
<a name="l00480"></a>00480 
<a name="l00481"></a>00481     <span class="comment">// Whether to checkpoint the resumed simulation</span>
<a name="l00482"></a>00482     <span class="keywordflow">if</span> (pResumeParameters-&gt;ResumeSimulation()-&gt;CheckpointSimulation().present())
<a name="l00483"></a>00483     {
<a name="l00484"></a>00484         <a class="code" href="classHeartConfig.html#f8ab048189a76d46bbec0ff541449b89">HeartConfig::Instance</a>()-&gt;<a class="code" href="classHeartConfig.html#d7acbc17d4e8fbf7f3c8dcf17340afe4">SetCheckpointSimulation</a>(<span class="keyword">true</span>,
<a name="l00485"></a>00485                                                          pResumeParameters-&gt;ResumeSimulation()-&gt;CheckpointSimulation()-&gt;timestep(),
<a name="l00486"></a>00486                                                          pResumeParameters-&gt;ResumeSimulation()-&gt;CheckpointSimulation()-&gt;max_checkpoints_on_disk());
<a name="l00487"></a>00487     }
<a name="l00488"></a>00488 
<a name="l00489"></a>00489     <span class="comment">//Visualization parameters are compulsory</span>
<a name="l00490"></a>00490     <a class="code" href="classHeartConfig.html#f8ab048189a76d46bbec0ff541449b89">HeartConfig::Instance</a>()-&gt;<a class="code" href="classHeartConfig.html#f43426509538104d4a68b88328c470a6">SetVisualizeWithParallelVtk</a>(pResumeParameters-&gt;ResumeSimulation()-&gt;OutputVisualizer().parallel_vtk() == cp::yesno_type::yes);
<a name="l00491"></a>00491     <a class="code" href="classHeartConfig.html#f8ab048189a76d46bbec0ff541449b89">HeartConfig::Instance</a>()-&gt;<a class="code" href="classHeartConfig.html#a64153e80db50c971a58069dd3e1350e">SetVisualizeWithVtk</a>(pResumeParameters-&gt;ResumeSimulation()-&gt;OutputVisualizer().vtk() == cp::yesno_type::yes);
<a name="l00492"></a>00492     <a class="code" href="classHeartConfig.html#f8ab048189a76d46bbec0ff541449b89">HeartConfig::Instance</a>()-&gt;<a class="code" href="classHeartConfig.html#f1c744570c4f03ee01b52c62ca4ef40f">SetVisualizeWithCmgui</a>(pResumeParameters-&gt;ResumeSimulation()-&gt;OutputVisualizer().cmgui() == cp::yesno_type::yes);
<a name="l00493"></a>00493     <a class="code" href="classHeartConfig.html#f8ab048189a76d46bbec0ff541449b89">HeartConfig::Instance</a>()-&gt;<a class="code" href="classHeartConfig.html#7ef84b9090f708031aac64b7504742e0">SetVisualizeWithMeshalyzer</a>(pResumeParameters-&gt;ResumeSimulation()-&gt;OutputVisualizer().meshalyzer() == cp::yesno_type::yes);
<a name="l00494"></a>00494 
<a name="l00495"></a>00495     <span class="comment">// Numerical parameters may be overridden</span>
<a name="l00496"></a>00496     {
<a name="l00497"></a>00497         cp::numerical_type&amp; r_resume = pResumeParameters-&gt;Numerical();
<a name="l00498"></a>00498         cp::numerical_type&amp; r_user = <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical();
<a name="l00499"></a>00499         <span class="keywordflow">if</span> (r_resume.TimeSteps().present())
<a name="l00500"></a>00500         {
<a name="l00501"></a>00501             r_user.TimeSteps().set(r_resume.TimeSteps().get());
<a name="l00502"></a>00502         }
<a name="l00503"></a>00503         <span class="keywordflow">if</span> (r_resume.KSPTolerances().present())
<a name="l00504"></a>00504         {
<a name="l00505"></a>00505             r_user.KSPTolerances().set(r_resume.KSPTolerances().get());
<a name="l00506"></a>00506         }
<a name="l00507"></a>00507         <span class="keywordflow">if</span> (r_resume.KSPSolver().present())
<a name="l00508"></a>00508         {
<a name="l00509"></a>00509             r_user.KSPSolver().set(r_resume.KSPSolver().get());
<a name="l00510"></a>00510         }
<a name="l00511"></a>00511         <span class="keywordflow">if</span> (r_resume.KSPPreconditioner().present())
<a name="l00512"></a>00512         {
<a name="l00513"></a>00513             r_user.KSPPreconditioner().set(r_resume.KSPPreconditioner().get());
<a name="l00514"></a>00514         }
<a name="l00515"></a>00515         <span class="keywordflow">if</span> (r_resume.AdaptivityParameters().present())
<a name="l00516"></a>00516         {
<a name="l00517"></a>00517             r_user.AdaptivityParameters().set(r_resume.AdaptivityParameters().get());
<a name="l00518"></a>00518         }
<a name="l00519"></a>00519     }
<a name="l00520"></a>00520 
<a name="l00521"></a>00521     <span class="comment">// Post-processing parameters may be overridden</span>
<a name="l00522"></a>00522     <span class="keywordflow">if</span> (pResumeParameters-&gt;PostProcessing().present())
<a name="l00523"></a>00523     {
<a name="l00524"></a>00524         <a class="code" href="classHeartConfig.html#66b61cef16319298971d3961516229db">EnsurePostProcessingSectionPresent</a>();
<a name="l00525"></a>00525         cp::postprocessing_type&amp; r_resume = pResumeParameters-&gt;PostProcessing().get();
<a name="l00526"></a>00526         cp::postprocessing_type&amp; r_user = <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;PostProcessing().get();
<a name="l00527"></a>00527         <span class="keywordflow">if</span> (!r_resume.ActionPotentialDurationMap().empty())
<a name="l00528"></a>00528         {
<a name="l00529"></a>00529             r_user.ActionPotentialDurationMap() = r_resume.ActionPotentialDurationMap();
<a name="l00530"></a>00530         }
<a name="l00531"></a>00531         <span class="keywordflow">if</span> (!r_resume.UpstrokeTimeMap().empty())
<a name="l00532"></a>00532         {
<a name="l00533"></a>00533             r_user.UpstrokeTimeMap() = r_resume.UpstrokeTimeMap();
<a name="l00534"></a>00534         }
<a name="l00535"></a>00535         <span class="keywordflow">if</span> (!r_resume.MaxUpstrokeVelocityMap().empty())
<a name="l00536"></a>00536         {
<a name="l00537"></a>00537             r_user.MaxUpstrokeVelocityMap() = r_resume.MaxUpstrokeVelocityMap();
<a name="l00538"></a>00538         }
<a name="l00539"></a>00539         <span class="keywordflow">if</span> (!r_resume.ConductionVelocityMap().empty())
<a name="l00540"></a>00540         {
<a name="l00541"></a>00541             r_user.ConductionVelocityMap() = r_resume.ConductionVelocityMap();
<a name="l00542"></a>00542         }
<a name="l00543"></a>00543     }
<a name="l00544"></a>00544 }
<a name="l00545"></a>00545 
<a name="l00546"></a>00546 
<a name="l00547"></a><a class="code" href="classHeartConfig.html#e2378924829d86f77eb14c5fd0326e80">00547</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#e2378924829d86f77eb14c5fd0326e80">HeartConfig::Reset</a>()
<a name="l00548"></a>00548 {
<a name="l00549"></a>00549     <span class="comment">// Throw it away first, so that mpInstance is NULL when we...</span>
<a name="l00550"></a>00550     <a class="code" href="classHeartConfig.html#1d700f703ffa3528790264535857411a">mpInstance</a>.reset();
<a name="l00551"></a>00551     <span class="comment">// ...make a new one</span>
<a name="l00552"></a>00552     <a class="code" href="classHeartConfig.html#1d700f703ffa3528790264535857411a">mpInstance</a>.reset(<span class="keyword">new</span> <a class="code" href="classHeartConfig.html">HeartConfig</a>);
<a name="l00553"></a>00553 }
<a name="l00554"></a>00554 
<a name="l00555"></a><a class="code" href="classHeartConfig.html#894d374015f888c2111ec252134395fc">00555</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#894d374015f888c2111ec252134395fc">HeartConfig::IsSimulationDefined</a>()<span class="keyword"> const</span>
<a name="l00556"></a>00556 <span class="keyword"></span>{
<a name="l00557"></a>00557     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().present();
<a name="l00558"></a>00558 }
<a name="l00559"></a>00559 
<a name="l00560"></a><a class="code" href="classHeartConfig.html#67ec8f0a426a424b562ab106fb1fc144">00560</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#67ec8f0a426a424b562ab106fb1fc144">HeartConfig::IsSimulationResumed</a>()<span class="keyword"> const</span>
<a name="l00561"></a>00561 <span class="keyword"></span>{
<a name="l00562"></a>00562     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;ResumeSimulation().present();
<a name="l00563"></a>00563 }
<a name="l00564"></a>00564 
<a name="l00565"></a>00565 
<a name="l00566"></a>00566 <span class="keyword">template</span>&lt;<span class="keyword">class</span> TYPE&gt;
<a name="l00567"></a><a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">00567</a> TYPE* <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">HeartConfig::DecideLocation</a>(TYPE* ptr1, TYPE* ptr2, <span class="keyword">const</span> std::string&amp; nameParameter)<span class="keyword"> const</span>
<a name="l00568"></a>00568 <span class="keyword"></span>{
<a name="l00569"></a>00569     <span class="keywordflow">if</span> (ptr1-&gt;present())
<a name="l00570"></a>00570     {
<a name="l00571"></a>00571         <span class="keywordflow">return</span> ptr1;
<a name="l00572"></a>00572     }
<a name="l00573"></a>00573     <span class="keywordflow">if</span> (ptr2-&gt;present())
<a name="l00574"></a>00574     {
<a name="l00575"></a>00575         <span class="keywordflow">return</span> ptr2;
<a name="l00576"></a>00576     }
<a name="l00577"></a>00577 
<a name="l00578"></a>00578     <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a>(<span class="stringliteral">"No "</span> + nameParameter + <span class="stringliteral">" provided (neither default nor user defined)"</span>);
<a name="l00579"></a>00579 }
<a name="l00580"></a>00580 
<a name="l00581"></a><a class="code" href="classHeartConfig.html#ab7ea75d3f83c1202127db592d934532">00581</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#ab7ea75d3f83c1202127db592d934532">HeartConfig::CheckSimulationIsDefined</a>(std::string callingMethod)<span class="keyword"> const</span>
<a name="l00582"></a>00582 <span class="keyword"></span>{
<a name="l00583"></a>00583     <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#67ec8f0a426a424b562ab106fb1fc144">IsSimulationResumed</a>())
<a name="l00584"></a>00584     {
<a name="l00585"></a>00585         <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a>(callingMethod + <span class="stringliteral">" information is not available in a resumed simulation."</span>);
<a name="l00586"></a>00586     }
<a name="l00587"></a>00587 }
<a name="l00588"></a>00588 
<a name="l00589"></a><a class="code" href="classHeartConfig.html#2be3fdcc724c4a6609526b53f86d8c01">00589</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#2be3fdcc724c4a6609526b53f86d8c01">HeartConfig::CheckResumeSimulationIsDefined</a>(std::string callingMethod)<span class="keyword"> const</span>
<a name="l00590"></a>00590 <span class="keyword"></span>{
<a name="l00591"></a>00591     <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#894d374015f888c2111ec252134395fc">IsSimulationDefined</a>())
<a name="l00592"></a>00592     {
<a name="l00593"></a>00593         <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a>(callingMethod + <span class="stringliteral">" information is not available in a standard (non-resumed) simulation."</span>);
<a name="l00594"></a>00594     }
<a name="l00595"></a>00595 }
<a name="l00596"></a>00596 
<a name="l00597"></a><a class="code" href="classHeartConfig.html#4170d162538ec096d7df103f5781a998">00597</a> <span class="keywordtype">unsigned</span> <a class="code" href="classHeartConfig.html#4170d162538ec096d7df103f5781a998">HeartConfig::GetSpaceDimension</a>()<span class="keyword"> const</span>
<a name="l00598"></a>00598 <span class="keyword"></span>{
<a name="l00599"></a>00599     <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#894d374015f888c2111ec252134395fc">IsSimulationDefined</a>())
<a name="l00600"></a>00600     {
<a name="l00601"></a>00601         <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;SpaceDimension(),
<a name="l00602"></a>00602                                &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation()-&gt;SpaceDimension(),
<a name="l00603"></a>00603                                <span class="stringliteral">"SpaceDimension"</span>)-&gt;<span class="keyword">get</span>();
<a name="l00604"></a>00604     }
<a name="l00605"></a>00605     <span class="keywordflow">else</span>
<a name="l00606"></a>00606     {
<a name="l00607"></a>00607         <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;ResumeSimulation()-&gt;SpaceDimension();
<a name="l00608"></a>00608     }
<a name="l00609"></a>00609 }
<a name="l00610"></a>00610 
<a name="l00611"></a><a class="code" href="classHeartConfig.html#d3e460b2f9f263ec6ac04fda60197780">00611</a> <span class="keywordtype">double</span> <a class="code" href="classHeartConfig.html#d3e460b2f9f263ec6ac04fda60197780">HeartConfig::GetSimulationDuration</a>()<span class="keyword"> const</span>
<a name="l00612"></a>00612 <span class="keyword"></span>{
<a name="l00613"></a>00613     <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#894d374015f888c2111ec252134395fc">IsSimulationDefined</a>())
<a name="l00614"></a>00614     {
<a name="l00615"></a>00615         <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;SimulationDuration(),
<a name="l00616"></a>00616                                &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation()-&gt;SimulationDuration(),
<a name="l00617"></a>00617                                <span class="stringliteral">"Simulation/SimulationDuration"</span>)-&gt;<span class="keyword">get</span>();
<a name="l00618"></a>00618     }
<a name="l00619"></a>00619     <span class="keywordflow">else</span> <span class="comment">// IsSimulationResumed</span>
<a name="l00620"></a>00620     {
<a name="l00621"></a>00621         <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;ResumeSimulation()-&gt;SimulationDuration();
<a name="l00622"></a>00622     }
<a name="l00623"></a>00623 }
<a name="l00624"></a>00624 
<a name="l00625"></a><a class="code" href="classHeartConfig.html#493a8d7316bd8e257459ec0372fd8706">00625</a> cp::domain_type <a class="code" href="classHeartConfig.html#493a8d7316bd8e257459ec0372fd8706">HeartConfig::GetDomain</a>()<span class="keyword"> const</span>
<a name="l00626"></a>00626 <span class="keyword"></span>{
<a name="l00627"></a>00627     <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#894d374015f888c2111ec252134395fc">IsSimulationDefined</a>())
<a name="l00628"></a>00628     {
<a name="l00629"></a>00629         <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;Domain(),
<a name="l00630"></a>00630                                &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation()-&gt;Domain(),
<a name="l00631"></a>00631                                <span class="stringliteral">"Domain"</span>)-&gt;<span class="keyword">get</span>();
<a name="l00632"></a>00632     }
<a name="l00633"></a>00633     <span class="keywordflow">else</span>
<a name="l00634"></a>00634     {
<a name="l00635"></a>00635         <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;ResumeSimulation()-&gt;Domain();
<a name="l00636"></a>00636     }
<a name="l00637"></a>00637 }
<a name="l00638"></a>00638 
<a name="l00639"></a><a class="code" href="classHeartConfig.html#3b1e0fb27bd34fa487627bf80c2b9c57">00639</a> cp::ionic_model_selection_type <a class="code" href="classHeartConfig.html#3b1e0fb27bd34fa487627bf80c2b9c57">HeartConfig::GetDefaultIonicModel</a>()<span class="keyword"> const</span>
<a name="l00640"></a>00640 <span class="keyword"></span>{
<a name="l00641"></a>00641     <a class="code" href="classHeartConfig.html#ab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">"DefaultIonicModel"</span>);
<a name="l00642"></a>00642 
<a name="l00643"></a>00643     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;IonicModels(),
<a name="l00644"></a>00644                            &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation()-&gt;IonicModels(),
<a name="l00645"></a>00645                            <span class="stringliteral">"IonicModel"</span>)-&gt;<span class="keyword">get</span>().Default();
<a name="l00646"></a>00646 }
<a name="l00647"></a>00647 
<a name="l00648"></a>00648 <span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> DIM&gt;
<a name="l00649"></a><a class="code" href="classHeartConfig.html#4288665669f3eb349b84de0e1d95acdc">00649</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#4288665669f3eb349b84de0e1d95acdc">HeartConfig::GetIonicModelRegions</a>(std::vector&lt;boost::shared_ptr&lt;<a class="code" href="classAbstractChasteRegion.html">AbstractChasteRegion&lt;DIM&gt;</a> &gt; &gt;&amp; definedRegions,
<a name="l00650"></a>00650                                        std::vector&lt;cp::ionic_model_selection_type&gt;&amp; ionicModels)<span class="keyword"> const</span>
<a name="l00651"></a>00651 <span class="keyword"></span>{
<a name="l00652"></a>00652     <a class="code" href="classHeartConfig.html#ab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">"IonicModelRegions"</span>);
<a name="l00653"></a>00653     definedRegions.clear();
<a name="l00654"></a>00654     ionicModels.clear();
<a name="l00655"></a>00655 
<a name="l00656"></a>00656     XSD_SEQUENCE_TYPE(cp::ionic_models_type::Region)&amp;
<a name="l00657"></a>00657          regions = <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;IonicModels(),
<a name="l00658"></a>00658                                    &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation()-&gt;IonicModels(),
<a name="l00659"></a>00659                                    <span class="stringliteral">"IonicModel"</span>)-&gt;<span class="keyword">get</span>().Region();
<a name="l00660"></a>00660 
<a name="l00661"></a>00661     <span class="keywordflow">for</span> (XSD_ITERATOR_TYPE(cp::ionic_models_type::Region) i = regions.begin();
<a name="l00662"></a>00662          i != regions.end();
<a name="l00663"></a>00663          ++i)
<a name="l00664"></a>00664     {
<a name="l00665"></a>00665         cp::ionic_model_region_type ionic_model_region(*i);
<a name="l00666"></a>00666 
<a name="l00667"></a>00667         <span class="keywordflow">if</span> (ionic_model_region.Location().Cuboid().present() || ionic_model_region.Location().Ellipsoid().present())
<a name="l00668"></a>00668         {
<a name="l00669"></a>00669             <span class="keywordflow">if</span> (ionic_model_region.Location().Cuboid().present())
<a name="l00670"></a>00670             {
<a name="l00671"></a>00671                 cp::point_type point_a = ionic_model_region.Location().Cuboid()-&gt;LowerCoordinates();
<a name="l00672"></a>00672                 cp::point_type point_b = ionic_model_region.Location().Cuboid()-&gt;UpperCoordinates();
<a name="l00673"></a>00673 
<a name="l00674"></a>00674                 <span class="keywordflow">switch</span> (DIM)
<a name="l00675"></a>00675                 {
<a name="l00676"></a>00676                     <span class="keywordflow">case</span> 1:
<a name="l00677"></a>00677                     {
<a name="l00678"></a>00678                         <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_a ( point_a.x() );
<a name="l00679"></a>00679                         <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_b ( point_b.x() );
<a name="l00680"></a>00680                         definedRegions.push_back(boost::shared_ptr&lt;<a class="code" href="classAbstractChasteRegion.html">AbstractChasteRegion&lt;DIM&gt;</a> &gt;(<span class="keyword">new</span> <a class="code" href="classChasteCuboid.html">ChasteCuboid&lt;DIM&gt;</a>( chaste_point_a, chaste_point_b )));
<a name="l00681"></a>00681                         <span class="keywordflow">break</span>;
<a name="l00682"></a>00682                     }
<a name="l00683"></a>00683                     <span class="keywordflow">case</span> 2:
<a name="l00684"></a>00684                     {
<a name="l00685"></a>00685                         <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_a ( point_a.x(), point_a.y() );
<a name="l00686"></a>00686                         <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_b ( point_b.x(), point_b.y() );
<a name="l00687"></a>00687                         definedRegions.push_back(boost::shared_ptr&lt;<a class="code" href="classAbstractChasteRegion.html">AbstractChasteRegion&lt;DIM&gt;</a> &gt;(<span class="keyword">new</span> <a class="code" href="classChasteCuboid.html">ChasteCuboid&lt;DIM&gt;</a>( chaste_point_a, chaste_point_b )));
<a name="l00688"></a>00688                         <span class="keywordflow">break</span>;
<a name="l00689"></a>00689                     }
<a name="l00690"></a>00690                     <span class="keywordflow">case</span> 3:
<a name="l00691"></a>00691                     {
<a name="l00692"></a>00692                         <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_a ( point_a.x(), point_a.y(), point_a.z() );
<a name="l00693"></a>00693                         <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_b ( point_b.x(), point_b.y(), point_b.z() );
<a name="l00694"></a>00694                         definedRegions.push_back(boost::shared_ptr&lt;<a class="code" href="classAbstractChasteRegion.html">AbstractChasteRegion&lt;DIM&gt;</a> &gt;(<span class="keyword">new</span> <a class="code" href="classChasteCuboid.html">ChasteCuboid&lt;DIM&gt;</a>( chaste_point_a, chaste_point_b )) );
<a name="l00695"></a>00695                         <span class="keywordflow">break</span>;
<a name="l00696"></a>00696                     }
<a name="l00697"></a>00697                     <span class="keywordflow">default</span>:
<a name="l00698"></a>00698                         <a class="code" href="PetscTools_8hpp.html#e0019d0a062e0daca4aa9b982d8f6ac4">NEVER_REACHED</a>;
<a name="l00699"></a>00699                         <span class="keywordflow">break</span>;
<a name="l00700"></a>00700                 }
<a name="l00701"></a>00701             }
<a name="l00702"></a>00702             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ionic_model_region.Location().Ellipsoid().present())
<a name="l00703"></a>00703             {
<a name="l00704"></a>00704                 cp::point_type centre = ionic_model_region.Location().Ellipsoid()-&gt;Centre();
<a name="l00705"></a>00705                 cp::point_type radii  = ionic_model_region.Location().Ellipsoid()-&gt;Radii();
<a name="l00706"></a>00706                 <span class="keywordflow">switch</span> (DIM)
<a name="l00707"></a>00707                 {
<a name="l00708"></a>00708                     <span class="keywordflow">case</span> 1:
<a name="l00709"></a>00709                     {
<a name="l00710"></a>00710                         <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_a ( centre.x() );
<a name="l00711"></a>00711                         <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_b ( radii.x() );
<a name="l00712"></a>00712                         definedRegions.push_back(boost::shared_ptr&lt;<a class="code" href="classAbstractChasteRegion.html">AbstractChasteRegion&lt;DIM&gt;</a> &gt;(<span class="keyword">new</span> <a class="code" href="classChasteEllipsoid.html">ChasteEllipsoid&lt;DIM&gt;</a> ( chaste_point_a, chaste_point_b )) );
<a name="l00713"></a>00713                         <span class="keywordflow">break</span>;
<a name="l00714"></a>00714                     }
<a name="l00715"></a>00715                     <span class="keywordflow">case</span> 2:
<a name="l00716"></a>00716                     {
<a name="l00717"></a>00717                         <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_a ( centre.x(), centre.y() );
<a name="l00718"></a>00718                         <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_b ( radii.x(), radii.y() );
<a name="l00719"></a>00719                         definedRegions.push_back(boost::shared_ptr&lt;<a class="code" href="classAbstractChasteRegion.html">AbstractChasteRegion&lt;DIM&gt;</a> &gt;(<span class="keyword">new</span> <a class="code" href="classChasteEllipsoid.html">ChasteEllipsoid&lt;DIM&gt;</a> ( chaste_point_a, chaste_point_b )) );
<a name="l00720"></a>00720                         <span class="keywordflow">break</span>;
<a name="l00721"></a>00721                     }
<a name="l00722"></a>00722                     <span class="keywordflow">case</span> 3:
<a name="l00723"></a>00723                     {
<a name="l00724"></a>00724                         <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_a ( centre.x(), centre.y(), centre.z() );
<a name="l00725"></a>00725                         <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_b ( radii.x(), radii.y(), radii.z() );
<a name="l00726"></a>00726                         definedRegions.push_back(boost::shared_ptr&lt;<a class="code" href="classAbstractChasteRegion.html">AbstractChasteRegion&lt;DIM&gt;</a> &gt;(<span class="keyword">new</span> <a class="code" href="classChasteEllipsoid.html">ChasteEllipsoid&lt;DIM&gt;</a> ( chaste_point_a, chaste_point_b )) );
<a name="l00727"></a>00727                         <span class="keywordflow">break</span>;
<a name="l00728"></a>00728                     }
<a name="l00729"></a>00729                     <span class="keywordflow">default</span>:
<a name="l00730"></a>00730                     {
<a name="l00731"></a>00731                         <a class="code" href="PetscTools_8hpp.html#e0019d0a062e0daca4aa9b982d8f6ac4">NEVER_REACHED</a>;
<a name="l00732"></a>00732                         <span class="keywordflow">break</span>;
<a name="l00733"></a>00733                     }
<a name="l00734"></a>00734                 }
<a name="l00735"></a>00735             }
<a name="l00736"></a>00736             <span class="keywordflow">else</span>
<a name="l00737"></a>00737             {
<a name="l00738"></a>00738                 <a class="code" href="PetscTools_8hpp.html#e0019d0a062e0daca4aa9b982d8f6ac4">NEVER_REACHED</a>;
<a name="l00739"></a>00739             }
<a name="l00740"></a>00740 
<a name="l00741"></a>00741             ionicModels.push_back(ionic_model_region.IonicModel());
<a name="l00742"></a>00742         }
<a name="l00743"></a>00743         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ionic_model_region.Location().EpiLayer().present() || ionic_model_region.Location().MidLayer().present() || ionic_model_region.Location().EndoLayer().present() )
<a name="l00744"></a>00744         {
<a name="l00746"></a>00746             <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a>(<span class="stringliteral">"Definition of transmural layers is not yet supported for defining different ionic models, please use cuboids instead"</span>);
<a name="l00747"></a>00747         }
<a name="l00748"></a>00748         <span class="keywordflow">else</span>
<a name="l00749"></a>00749         {
<a name="l00750"></a>00750             <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a>(<span class="stringliteral">"Invalid region type for ionic model definition"</span>);
<a name="l00751"></a>00751         }
<a name="l00752"></a>00752     }
<a name="l00753"></a>00753 }
<a name="l00754"></a>00754 
<a name="l00755"></a>00755 
<a name="l00756"></a><a class="code" href="classHeartConfig.html#1f847d3789d27d2c4ac4adc8010fe311">00756</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#1f847d3789d27d2c4ac4adc8010fe311">HeartConfig::IsMeshProvided</a>()<span class="keyword"> const</span>
<a name="l00757"></a>00757 <span class="keyword"></span>{
<a name="l00758"></a>00758     <a class="code" href="classHeartConfig.html#ab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">"Mesh"</span>);
<a name="l00759"></a>00759 
<a name="l00760"></a>00760     <span class="keywordflow">try</span>
<a name="l00761"></a>00761     {
<a name="l00762"></a>00762         <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;Mesh(),
<a name="l00763"></a>00763                         &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation()-&gt;Mesh(),
<a name="l00764"></a>00764                         <span class="stringliteral">"Mesh"</span>);
<a name="l00765"></a>00765         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00766"></a>00766     }
<a name="l00767"></a>00767     <span class="keywordflow">catch</span> (<a class="code" href="classException.html">Exception</a>&amp; e)
<a name="l00768"></a>00768     {
<a name="l00769"></a>00769         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00770"></a>00770     }
<a name="l00771"></a>00771 }
<a name="l00772"></a>00772 
<a name="l00773"></a><a class="code" href="classHeartConfig.html#fba7fca19523a0e6a3c2037b165dba92">00773</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#fba7fca19523a0e6a3c2037b165dba92">HeartConfig::GetCreateMesh</a>()<span class="keyword"> const</span>
<a name="l00774"></a>00774 <span class="keyword"></span>{
<a name="l00775"></a>00775     <a class="code" href="classHeartConfig.html#ab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">"Mesh"</span>);
<a name="l00776"></a>00776 
<a name="l00777"></a>00777     cp::mesh_type mesh = <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;Mesh(),
<a name="l00778"></a>00778                                          &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation()-&gt;Mesh(),
<a name="l00779"></a>00779                                          <span class="stringliteral">"Mesh"</span>)-&gt;<span class="keyword">get</span>();
<a name="l00780"></a>00780 
<a name="l00781"></a>00781     <span class="keywordflow">return</span> (mesh.Slab().present() || mesh.Sheet().present() || mesh.Fibre().present());
<a name="l00782"></a>00782 }
<a name="l00783"></a>00783 
<a name="l00784"></a><a class="code" href="classHeartConfig.html#c5ed721756c4f02416abe35847591af3">00784</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#c5ed721756c4f02416abe35847591af3">HeartConfig::GetCreateSlab</a>()<span class="keyword"> const</span>
<a name="l00785"></a>00785 <span class="keyword"></span>{
<a name="l00786"></a>00786     <a class="code" href="classHeartConfig.html#ab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">"Mesh"</span>);
<a name="l00787"></a>00787 
<a name="l00788"></a>00788     cp::mesh_type mesh = <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;Mesh(),
<a name="l00789"></a>00789                                          &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation()-&gt;Mesh(),
<a name="l00790"></a>00790                                          <span class="stringliteral">"Mesh"</span>)-&gt;<span class="keyword">get</span>();
<a name="l00791"></a>00791 
<a name="l00792"></a>00792     <span class="keywordflow">return</span> (mesh.Slab().present());
<a name="l00793"></a>00793 }
<a name="l00794"></a>00794 
<a name="l00795"></a><a class="code" href="classHeartConfig.html#60ed4f42ad75ecb04db166120540f387">00795</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#60ed4f42ad75ecb04db166120540f387">HeartConfig::GetCreateSheet</a>()<span class="keyword"> const</span>
<a name="l00796"></a>00796 <span class="keyword"></span>{
<a name="l00797"></a>00797     <a class="code" href="classHeartConfig.html#ab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">"Mesh"</span>);
<a name="l00798"></a>00798 
<a name="l00799"></a>00799     cp::mesh_type mesh = <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;Mesh(),
<a name="l00800"></a>00800                                          &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation()-&gt;Mesh(),
<a name="l00801"></a>00801                                          <span class="stringliteral">"Mesh"</span>)-&gt;<span class="keyword">get</span>();
<a name="l00802"></a>00802 
<a name="l00803"></a>00803     <span class="keywordflow">return</span> (mesh.Sheet().present());
<a name="l00804"></a>00804 }
<a name="l00805"></a>00805 
<a name="l00806"></a><a class="code" href="classHeartConfig.html#bb6c5c1d7b12371e13c65db55e4d054c">00806</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#bb6c5c1d7b12371e13c65db55e4d054c">HeartConfig::GetCreateFibre</a>()<span class="keyword"> const</span>
<a name="l00807"></a>00807 <span class="keyword"></span>{
<a name="l00808"></a>00808     <a class="code" href="classHeartConfig.html#ab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">"Mesh"</span>);
<a name="l00809"></a>00809 
<a name="l00810"></a>00810     cp::mesh_type mesh = <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;Mesh(),
<a name="l00811"></a>00811                                          &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation()-&gt;Mesh(),
<a name="l00812"></a>00812                                          <span class="stringliteral">"Mesh"</span>)-&gt;<span class="keyword">get</span>();
<a name="l00813"></a>00813 
<a name="l00814"></a>00814     <span class="keywordflow">return</span> (mesh.Fibre().present());
<a name="l00815"></a>00815 }
<a name="l00816"></a>00816 
<a name="l00817"></a>00817 
<a name="l00818"></a><a class="code" href="classHeartConfig.html#9624dfc37c6c70cb92826ea3677bd905">00818</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#9624dfc37c6c70cb92826ea3677bd905">HeartConfig::GetLoadMesh</a>()<span class="keyword"> const</span>
<a name="l00819"></a>00819 <span class="keyword"></span>{
<a name="l00820"></a>00820     <a class="code" href="classHeartConfig.html#ab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">"Mesh"</span>);
<a name="l00821"></a>00821 
<a name="l00822"></a>00822     <span class="keywordflow">return</span> (<a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;Mesh(),
<a name="l00823"></a>00823                             &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation()-&gt;Mesh(),
<a name="l00824"></a>00824                             <span class="stringliteral">"Mesh"</span>)-&gt;<span class="keyword">get</span>().LoadMesh().present());
<a name="l00825"></a>00825 }
<a name="l00826"></a>00826 
<a name="l00827"></a><a class="code" href="classHeartConfig.html#ca214e0a3a7aefaa8694e602a6346dc7">00827</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#ca214e0a3a7aefaa8694e602a6346dc7">HeartConfig::GetSlabDimensions</a>(c_vector&lt;double, 3&gt;&amp; slabDimensions)<span class="keyword"> const</span>
<a name="l00828"></a>00828 <span class="keyword"></span>{
<a name="l00829"></a>00829     <a class="code" href="classHeartConfig.html#ab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">"Slab"</span>);
<a name="l00830"></a>00830 
<a name="l00831"></a>00831     <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#4170d162538ec096d7df103f5781a998">GetSpaceDimension</a>()!=3 || !<a class="code" href="classHeartConfig.html#c5ed721756c4f02416abe35847591af3">GetCreateSlab</a>())
<a name="l00832"></a>00832     {
<a name="l00833"></a>00833         <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a>(<span class="stringliteral">"Tissue slabs can only be defined in 3D"</span>);
<a name="l00834"></a>00834     }
<a name="l00835"></a>00835 
<a name="l00836"></a>00836     optional&lt;cp::slab_type, false&gt; slab_dimensions = <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;Mesh(),
<a name="l00837"></a>00837                                                                      &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation()-&gt;Mesh(),
<a name="l00838"></a>00838                                                                      <span class="stringliteral">"Slab"</span>)-&gt;<span class="keyword">get</span>().Slab();
<a name="l00839"></a>00839 
<a name="l00840"></a>00840     slabDimensions[0] = slab_dimensions-&gt;x();
<a name="l00841"></a>00841     slabDimensions[1] = slab_dimensions-&gt;y();
<a name="l00842"></a>00842     slabDimensions[2] = slab_dimensions-&gt;z();
<a name="l00843"></a>00843 }
<a name="l00844"></a>00844 
<a name="l00845"></a><a class="code" href="classHeartConfig.html#63918706b7ce417121fc7dc198f6ef94">00845</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#63918706b7ce417121fc7dc198f6ef94">HeartConfig::GetSheetDimensions</a>(c_vector&lt;double, 2&gt;&amp; sheetDimensions)<span class="keyword"> const</span>
<a name="l00846"></a>00846 <span class="keyword"></span>{
<a name="l00847"></a>00847     <a class="code" href="classHeartConfig.html#ab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">"Sheet"</span>);
<a name="l00848"></a>00848 
<a name="l00849"></a>00849     <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#4170d162538ec096d7df103f5781a998">GetSpaceDimension</a>()!=2 || !<a class="code" href="classHeartConfig.html#60ed4f42ad75ecb04db166120540f387">GetCreateSheet</a>())
<a name="l00850"></a>00850     {
<a name="l00851"></a>00851         <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a>(<span class="stringliteral">"Tissue sheets can only be defined in 2D"</span>);
<a name="l00852"></a>00852     }
<a name="l00853"></a>00853 
<a name="l00854"></a>00854     optional&lt;cp::sheet_type, false&gt; sheet_dimensions = <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;Mesh(),
<a name="l00855"></a>00855                                                                        &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation()-&gt;Mesh(),
<a name="l00856"></a>00856                                                                        <span class="stringliteral">"Sheet"</span>)-&gt;<span class="keyword">get</span>().Sheet();
<a name="l00857"></a>00857 
<a name="l00858"></a>00858     sheetDimensions[0] = sheet_dimensions-&gt;x();
<a name="l00859"></a>00859     sheetDimensions[1] = sheet_dimensions-&gt;y();
<a name="l00860"></a>00860 }
<a name="l00861"></a>00861 
<a name="l00862"></a><a class="code" href="classHeartConfig.html#0ee95147168ddacf8a17a92c17101ced">00862</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#0ee95147168ddacf8a17a92c17101ced">HeartConfig::GetFibreLength</a>(c_vector&lt;double, 1&gt;&amp; fibreLength)<span class="keyword"> const</span>
<a name="l00863"></a>00863 <span class="keyword"></span>{
<a name="l00864"></a>00864     <a class="code" href="classHeartConfig.html#ab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">"Fibre"</span>);
<a name="l00865"></a>00865 
<a name="l00866"></a>00866     <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#4170d162538ec096d7df103f5781a998">GetSpaceDimension</a>()!=1 || !<a class="code" href="classHeartConfig.html#bb6c5c1d7b12371e13c65db55e4d054c">GetCreateFibre</a>())
<a name="l00867"></a>00867     {
<a name="l00868"></a>00868         <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a>(<span class="stringliteral">"Tissue fibres can only be defined in 1D"</span>);
<a name="l00869"></a>00869     }
<a name="l00870"></a>00870 
<a name="l00871"></a>00871     optional&lt;cp::fibre_type, false&gt; fibre_length = <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;Mesh(),
<a name="l00872"></a>00872                                                                    &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation()-&gt;Mesh(),
<a name="l00873"></a>00873                                                                    <span class="stringliteral">"Fibre"</span>)-&gt;<span class="keyword">get</span>().Fibre();
<a name="l00874"></a>00874 
<a name="l00875"></a>00875     fibreLength[0] = fibre_length-&gt;x();
<a name="l00876"></a>00876 }
<a name="l00877"></a>00877 
<a name="l00878"></a><a class="code" href="classHeartConfig.html#3d0e9ad0966d4cee984223e904c68092">00878</a> <span class="keywordtype">double</span> <a class="code" href="classHeartConfig.html#3d0e9ad0966d4cee984223e904c68092">HeartConfig::GetInterNodeSpace</a>()<span class="keyword"> const</span>
<a name="l00879"></a>00879 <span class="keyword"></span>{
<a name="l00880"></a>00880     <a class="code" href="classHeartConfig.html#ab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">"InterNodeSpace"</span>);
<a name="l00881"></a>00881     assert(<a class="code" href="classHeartConfig.html#fba7fca19523a0e6a3c2037b165dba92">GetCreateMesh</a>());
<a name="l00882"></a>00882 
<a name="l00883"></a>00883     <span class="keywordflow">switch</span>(<a class="code" href="classHeartConfig.html#4170d162538ec096d7df103f5781a998">GetSpaceDimension</a>())
<a name="l00884"></a>00884     {
<a name="l00885"></a>00885         <span class="keywordflow">case</span> 3:
<a name="l00886"></a>00886             <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;Mesh(),
<a name="l00887"></a>00887                                    &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation()-&gt;Mesh(),
<a name="l00888"></a>00888                                    <span class="stringliteral">"Slab"</span>)-&gt;<span class="keyword">get</span>().Slab()-&gt;inter_node_space();
<a name="l00889"></a>00889             <span class="keywordflow">break</span>;
<a name="l00890"></a>00890         <span class="keywordflow">case</span> 2:
<a name="l00891"></a>00891             <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;Mesh(),
<a name="l00892"></a>00892                                    &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation()-&gt;Mesh(),
<a name="l00893"></a>00893                                    <span class="stringliteral">"Sheet"</span>)-&gt;<span class="keyword">get</span>().Sheet()-&gt;inter_node_space();
<a name="l00894"></a>00894             <span class="keywordflow">break</span>;
<a name="l00895"></a>00895         <span class="keywordflow">case</span> 1:
<a name="l00896"></a>00896             <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;Mesh(),
<a name="l00897"></a>00897                                    &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation()-&gt;Mesh(),
<a name="l00898"></a>00898                                    <span class="stringliteral">"Fibre"</span>)-&gt;<span class="keyword">get</span>().Fibre()-&gt;inter_node_space();
<a name="l00899"></a>00899             <span class="keywordflow">break</span>;
<a name="l00900"></a>00900         <span class="keywordflow">default</span>:
<a name="l00901"></a>00901             <a class="code" href="PetscTools_8hpp.html#e0019d0a062e0daca4aa9b982d8f6ac4">NEVER_REACHED</a>;
<a name="l00902"></a>00902 <span class="preprocessor">#define COVERAGE_IGNORE</span>
<a name="l00903"></a>00903 <span class="preprocessor"></span>            <span class="keywordflow">return</span> 0.0; <span class="comment">//To fool the compiler</span>
<a name="l00904"></a>00904 <span class="preprocessor">#undef COVERAGE_IGNORE</span>
<a name="l00905"></a>00905 <span class="preprocessor"></span>    }
<a name="l00906"></a>00906 }
<a name="l00907"></a>00907 
<a name="l00908"></a><a class="code" href="classHeartConfig.html#474d5fef81b34e7ecf4182008289b381">00908</a> std::string <a class="code" href="classHeartConfig.html#474d5fef81b34e7ecf4182008289b381">HeartConfig::GetMeshName</a>()<span class="keyword"> const</span>
<a name="l00909"></a>00909 <span class="keyword"></span>{
<a name="l00910"></a>00910     <a class="code" href="classHeartConfig.html#ab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">"LoadMesh"</span>);
<a name="l00911"></a>00911     assert(<a class="code" href="classHeartConfig.html#9624dfc37c6c70cb92826ea3677bd905">GetLoadMesh</a>());
<a name="l00912"></a>00912 
<a name="l00913"></a>00913     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;Mesh(),
<a name="l00914"></a>00914                            &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation()-&gt;Mesh(),
<a name="l00915"></a>00915                            <span class="stringliteral">"LoadMesh"</span>)-&gt;<span class="keyword">get</span>().LoadMesh()-&gt;name();
<a name="l00916"></a>00916 }
<a name="l00917"></a>00917 
<a name="l00918"></a><a class="code" href="classHeartConfig.html#40117fc56c45d408cdd57a1e3538b989">00918</a> cp::media_type <a class="code" href="classHeartConfig.html#40117fc56c45d408cdd57a1e3538b989">HeartConfig::GetConductivityMedia</a>()<span class="keyword"> const</span>
<a name="l00919"></a>00919 <span class="keyword"></span>{
<a name="l00920"></a>00920     <a class="code" href="classHeartConfig.html#ab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">"LoadMesh"</span>);
<a name="l00921"></a>00921     assert(<a class="code" href="classHeartConfig.html#9624dfc37c6c70cb92826ea3677bd905">GetLoadMesh</a>());
<a name="l00922"></a>00922 
<a name="l00923"></a>00923     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;Mesh(),
<a name="l00924"></a>00924                            &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation()-&gt;Mesh(),
<a name="l00925"></a>00925                            <span class="stringliteral">"LoadMesh"</span>)-&gt;<span class="keyword">get</span>().LoadMesh()-&gt;conductivity_media();
<a name="l00926"></a>00926 }
<a name="l00927"></a>00927 
<a name="l00928"></a>00928 <span class="keyword">template</span> &lt;<span class="keywordtype">unsigned</span> DIM&gt;
<a name="l00929"></a><a class="code" href="classHeartConfig.html#5584b49e988a0d0ee6190ee072fed88f">00929</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#5584b49e988a0d0ee6190ee072fed88f">HeartConfig::GetStimuli</a>(std::vector&lt;boost::shared_ptr&lt;AbstractStimulusFunction&gt; &gt;&amp; rStimuliApplied,
<a name="l00930"></a>00930                              std::vector&lt;boost::shared_ptr&lt;<a class="code" href="classAbstractChasteRegion.html">AbstractChasteRegion&lt;DIM&gt;</a> &gt; &gt;&amp; rStimulatedAreas)<span class="keyword"> const</span>
<a name="l00931"></a>00931 <span class="keyword"></span>{
<a name="l00932"></a>00932     <a class="code" href="classHeartConfig.html#ab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">"Stimuli"</span>);
<a name="l00933"></a>00933     XSD_SEQUENCE_TYPE(cp::stimuli_type::Stimulus) stimuli;
<a name="l00934"></a>00934 
<a name="l00935"></a>00935 
<a name="l00936"></a>00936     <span class="keywordflow">try</span>
<a name="l00937"></a>00937     {
<a name="l00938"></a>00938          stimuli = <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;Stimuli(),
<a name="l00939"></a>00939                                    &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation()-&gt;Stimuli(),
<a name="l00940"></a>00940                                    <span class="stringliteral">"Stimuli"</span>)-&gt;<span class="keyword">get</span>().Stimulus();
<a name="l00941"></a>00941     }
<a name="l00942"></a>00942     <span class="keywordflow">catch</span>(<a class="code" href="classException.html">Exception</a>&amp; e)
<a name="l00943"></a>00943     {
<a name="l00944"></a>00944         <span class="comment">// Finding no stimuli defined is allowed (although HeartConfigRelatedFactory does</span>
<a name="l00945"></a>00945         <span class="comment">// throw an exception is no stimuli and no electrodes)</span>
<a name="l00946"></a>00946         <span class="keywordflow">return</span>;
<a name="l00947"></a>00947     }
<a name="l00948"></a>00948 
<a name="l00949"></a>00949     <span class="keywordflow">for</span> (XSD_ITERATOR_TYPE(cp::stimuli_type::Stimulus) i = stimuli.begin();
<a name="l00950"></a>00950          i != stimuli.end();
<a name="l00951"></a>00951          ++i)
<a name="l00952"></a>00952     {
<a name="l00953"></a>00953         cp::stimulus_type stimulus(*i);
<a name="l00954"></a>00954         <span class="keywordflow">if</span> (stimulus.Location().Cuboid().present() || stimulus.Location().Ellipsoid().present())
<a name="l00955"></a>00955         {
<a name="l00956"></a>00956             boost::shared_ptr&lt;AbstractChasteRegion&lt;DIM&gt; &gt; area_ptr;
<a name="l00957"></a>00957             <span class="keywordflow">if</span> (stimulus.Location().Cuboid().present() )
<a name="l00958"></a>00958             {
<a name="l00959"></a>00959                 cp::point_type point_a = stimulus.Location().Cuboid()-&gt;LowerCoordinates();
<a name="l00960"></a>00960                 cp::point_type point_b = stimulus.Location().Cuboid()-&gt;UpperCoordinates();
<a name="l00961"></a>00961                 <span class="keywordflow">switch</span> (DIM)
<a name="l00962"></a>00962                 {
<a name="l00963"></a>00963                     <span class="keywordflow">case</span> 1:
<a name="l00964"></a>00964                     {
<a name="l00965"></a>00965                         <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_a ( point_a.x() );
<a name="l00966"></a>00966                         <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_b ( point_b.x() );
<a name="l00967"></a>00967                         area_ptr.reset(<span class="keyword">new</span> <a class="code" href="classChasteCuboid.html">ChasteCuboid&lt;DIM&gt;</a>( chaste_point_a, chaste_point_b ) );
<a name="l00968"></a>00968                         <span class="keywordflow">break</span>;
<a name="l00969"></a>00969                     }
<a name="l00970"></a>00970                     <span class="keywordflow">case</span> 2:
<a name="l00971"></a>00971                     {
<a name="l00972"></a>00972                         <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_a ( point_a.x(), point_a.y() );
<a name="l00973"></a>00973                         <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_b ( point_b.x(), point_b.y() );
<a name="l00974"></a>00974                         area_ptr.reset(<span class="keyword">new</span> <a class="code" href="classChasteCuboid.html">ChasteCuboid&lt;DIM&gt;</a>( chaste_point_a, chaste_point_b ) );
<a name="l00975"></a>00975                         <span class="keywordflow">break</span>;
<a name="l00976"></a>00976                     }
<a name="l00977"></a>00977                     <span class="keywordflow">case</span> 3:
<a name="l00978"></a>00978                     {
<a name="l00979"></a>00979                         <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_a ( point_a.x(), point_a.y(), point_a.z() );
<a name="l00980"></a>00980                         <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_b ( point_b.x(), point_b.y(), point_b.z() );
<a name="l00981"></a>00981                         area_ptr.reset(<span class="keyword">new</span> <a class="code" href="classChasteCuboid.html">ChasteCuboid&lt;DIM&gt;</a>( chaste_point_a, chaste_point_b ) );
<a name="l00982"></a>00982                         <span class="keywordflow">break</span>;
<a name="l00983"></a>00983                     }
<a name="l00984"></a>00984                     <span class="keywordflow">default</span>:
<a name="l00985"></a>00985                         <a class="code" href="PetscTools_8hpp.html#e0019d0a062e0daca4aa9b982d8f6ac4">NEVER_REACHED</a>;
<a name="l00986"></a>00986                         <span class="keywordflow">break</span>;
<a name="l00987"></a>00987                 }
<a name="l00988"></a>00988             }
<a name="l00989"></a>00989             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stimulus.Location().Ellipsoid().present())
<a name="l00990"></a>00990             {
<a name="l00991"></a>00991                 cp::point_type centre = stimulus.Location().Ellipsoid()-&gt;Centre();
<a name="l00992"></a>00992                 cp::point_type radii  = stimulus.Location().Ellipsoid()-&gt;Radii();
<a name="l00993"></a>00993                 <span class="keywordflow">switch</span> (DIM)
<a name="l00994"></a>00994                 {
<a name="l00995"></a>00995                     <span class="keywordflow">case</span> 1:
<a name="l00996"></a>00996                     {
<a name="l00997"></a>00997                         <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_a ( centre.x() );
<a name="l00998"></a>00998                         <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_b ( radii.x() );
<a name="l00999"></a>00999                         area_ptr.reset( <span class="keyword">new</span> <a class="code" href="classChasteEllipsoid.html">ChasteEllipsoid&lt;DIM&gt;</a> ( chaste_point_a, chaste_point_b ) );
<a name="l01000"></a>01000                         <span class="keywordflow">break</span>;
<a name="l01001"></a>01001                     }
<a name="l01002"></a>01002                     <span class="keywordflow">case</span> 2:
<a name="l01003"></a>01003                     {
<a name="l01004"></a>01004                         <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_a ( centre.x(), centre.y() );
<a name="l01005"></a>01005                         <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_b ( radii.x(), radii.y() );
<a name="l01006"></a>01006                         area_ptr.reset( <span class="keyword">new</span> <a class="code" href="classChasteEllipsoid.html">ChasteEllipsoid&lt;DIM&gt;</a> ( chaste_point_a, chaste_point_b ) );
<a name="l01007"></a>01007                         <span class="keywordflow">break</span>;
<a name="l01008"></a>01008                     }
<a name="l01009"></a>01009                     <span class="keywordflow">case</span> 3:
<a name="l01010"></a>01010                     {
<a name="l01011"></a>01011                         <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_a ( centre.x(), centre.y(), centre.z() );
<a name="l01012"></a>01012                         <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_b ( radii.x(), radii.y(), radii.z() );
<a name="l01013"></a>01013                         area_ptr.reset( <span class="keyword">new</span> <a class="code" href="classChasteEllipsoid.html">ChasteEllipsoid&lt;DIM&gt;</a> ( chaste_point_a, chaste_point_b ) );
<a name="l01014"></a>01014                         <span class="keywordflow">break</span>;
<a name="l01015"></a>01015                     }
<a name="l01016"></a>01016                     <span class="keywordflow">default</span>:
<a name="l01017"></a>01017                     {
<a name="l01018"></a>01018                         <a class="code" href="PetscTools_8hpp.html#e0019d0a062e0daca4aa9b982d8f6ac4">NEVER_REACHED</a>;
<a name="l01019"></a>01019                         <span class="keywordflow">break</span>;
<a name="l01020"></a>01020                     }
<a name="l01021"></a>01021                 }
<a name="l01022"></a>01022             }
<a name="l01023"></a>01023             rStimulatedAreas.push_back(area_ptr);
<a name="l01024"></a>01024 
<a name="l01025"></a>01025             boost::shared_ptr&lt;AbstractStimulusFunction&gt; stim;
<a name="l01026"></a>01026 
<a name="l01027"></a>01027             <span class="keywordflow">if</span> (stimulus.Period().present())
<a name="l01028"></a>01028             {
<a name="l01029"></a>01029                 <span class="keywordflow">if</span> (stimulus.StopTime().present())
<a name="l01030"></a>01030                 {
<a name="l01031"></a>01031                     stim.reset(<span class="keyword">new</span> <a class="code" href="classRegularStimulus.html">RegularStimulus</a>(stimulus.Strength(),
<a name="l01032"></a>01032                                                    stimulus.Duration(),
<a name="l01033"></a>01033                                                    stimulus.Period().get(),
<a name="l01034"></a>01034                                                    stimulus.Delay(),
<a name="l01035"></a>01035                                                    stimulus.StopTime().get()));
<a name="l01036"></a>01036                 }
<a name="l01037"></a>01037                 <span class="keywordflow">else</span>
<a name="l01038"></a>01038                 {
<a name="l01039"></a>01039                     stim.reset(<span class="keyword">new</span> <a class="code" href="classRegularStimulus.html">RegularStimulus</a>(stimulus.Strength(),
<a name="l01040"></a>01040                                                    stimulus.Duration(),
<a name="l01041"></a>01041                                                    stimulus.Period().get(),
<a name="l01042"></a>01042                                                    stimulus.Delay()));
<a name="l01043"></a>01043                 }
<a name="l01044"></a>01044 
<a name="l01045"></a>01045             }
<a name="l01046"></a>01046             <span class="keywordflow">else</span>
<a name="l01047"></a>01047             {
<a name="l01048"></a>01048                 <span class="keywordflow">if</span> (stimulus.StopTime().present())
<a name="l01049"></a>01049                 {
<a name="l01050"></a>01050                     <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a>(<span class="stringliteral">"Stop time can not be defined for SimpleStimulus. Use Duration instead."</span>);
<a name="l01051"></a>01051                 }
<a name="l01052"></a>01052 
<a name="l01053"></a>01053                 stim.reset(<span class="keyword">new</span> <a class="code" href="classSimpleStimulus.html">SimpleStimulus</a>(stimulus.Strength(),
<a name="l01054"></a>01054                                               stimulus.Duration(),
<a name="l01055"></a>01055                                               stimulus.Delay()));
<a name="l01056"></a>01056             }
<a name="l01057"></a>01057             rStimuliApplied.push_back( stim );
<a name="l01058"></a>01058         }
<a name="l01059"></a>01059         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(stimulus.Location().EpiLayer().present() || stimulus.Location().MidLayer().present() || stimulus.Location().EndoLayer().present() )
<a name="l01060"></a>01060         {
<a name="l01061"></a>01061             <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a>(<span class="stringliteral">"Definition of transmural layers is not yet supported for specifying stimulated areas, please use cuboids instead"</span>);
<a name="l01062"></a>01062         }
<a name="l01063"></a>01063         <span class="keywordflow">else</span>
<a name="l01064"></a>01064         {
<a name="l01065"></a>01065             <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a>(<span class="stringliteral">"Invalid region type for stimulus definition"</span>);
<a name="l01066"></a>01066         }
<a name="l01067"></a>01067     }
<a name="l01068"></a>01068 }
<a name="l01069"></a>01069 
<a name="l01070"></a>01070 
<a name="l01071"></a>01071 <span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> DIM&gt;
<a name="l01072"></a><a class="code" href="classHeartConfig.html#1d00319ba61b3e67401f7694b5dbbe61">01072</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#1d00319ba61b3e67401f7694b5dbbe61">HeartConfig::GetCellHeterogeneities</a>(std::vector&lt;boost::shared_ptr&lt;<a class="code" href="classAbstractChasteRegion.html">AbstractChasteRegion&lt;DIM&gt;</a> &gt; &gt;&amp; rCellHeterogeneityRegions,
<a name="l01073"></a>01073                                          std::vector&lt;double&gt;&amp; rScaleFactorGks,
<a name="l01074"></a>01074                                          std::vector&lt;double&gt;&amp; rScaleFactorIto,
<a name="l01075"></a>01075                                          std::vector&lt;double&gt;&amp; rScaleFactorGkr,
<a name="l01076"></a>01076                                          std::vector&lt;std::map&lt;std::string, double&gt; &gt;* pParameterSettings)
<a name="l01077"></a>01077 {
<a name="l01078"></a>01078     <a class="code" href="classHeartConfig.html#ab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">"CellHeterogeneities"</span>);
<a name="l01079"></a>01079     XSD_SEQUENCE_TYPE(cp::cell_heterogeneities_type::CellHeterogeneity) cell_heterogeneity;
<a name="l01080"></a>01080 
<a name="l01081"></a>01081     <span class="keywordflow">try</span>
<a name="l01082"></a>01082     {
<a name="l01083"></a>01083          cell_heterogeneity = <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;CellHeterogeneities(),
<a name="l01084"></a>01084                                               &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation()-&gt;CellHeterogeneities(),
<a name="l01085"></a>01085                                               <span class="stringliteral">"CellHeterogeneities"</span>)-&gt;<span class="keyword">get</span>().CellHeterogeneity();
<a name="l01086"></a>01086     }
<a name="l01087"></a>01087     <span class="keywordflow">catch</span>(<a class="code" href="classException.html">Exception</a>&amp; e)
<a name="l01088"></a>01088     {
<a name="l01089"></a>01089         <span class="comment">// finding no heterogeneities defined is allowed</span>
<a name="l01090"></a>01090         <span class="keywordflow">return</span>;
<a name="l01091"></a>01091     }
<a name="l01092"></a>01092 
<a name="l01093"></a>01093     <span class="keywordtype">bool</span> user_supplied_negative_value = <span class="keyword">false</span>;
<a name="l01094"></a>01094     <span class="keywordtype">bool</span> user_asking_for_transmural_layers = <span class="keyword">false</span>;
<a name="l01095"></a>01095     <span class="keywordtype">bool</span> user_asked_for_cuboids_or_ellipsoids = <span class="keyword">false</span>;
<a name="l01096"></a>01096     <span class="keywordtype">unsigned</span> counter_of_heterogeneities = 0;
<a name="l01097"></a>01097 
<a name="l01098"></a>01098     <span class="keywordflow">for</span> (XSD_ITERATOR_TYPE(cp::cell_heterogeneities_type::CellHeterogeneity) i = cell_heterogeneity.begin();
<a name="l01099"></a>01099          i != cell_heterogeneity.end();
<a name="l01100"></a>01100          ++i)
<a name="l01101"></a>01101     {
<a name="l01102"></a>01102         cp::cell_heterogeneity_type ht(*i);
<a name="l01103"></a>01103 
<a name="l01104"></a>01104 
<a name="l01105"></a>01105         <span class="keywordflow">if</span> (ht.Location().Cuboid().present())
<a name="l01106"></a>01106         {
<a name="l01107"></a>01107             user_asked_for_cuboids_or_ellipsoids = <span class="keyword">true</span>;
<a name="l01108"></a>01108             cp::point_type point_a = ht.Location().Cuboid()-&gt;LowerCoordinates();
<a name="l01109"></a>01109             cp::point_type point_b = ht.Location().Cuboid()-&gt;UpperCoordinates();
<a name="l01110"></a>01110 
<a name="l01111"></a>01111             <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_a ( point_a.x(), point_a.y(), point_a.z() );
<a name="l01112"></a>01112             <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_b ( point_b.x(), point_b.y(), point_b.z() );
<a name="l01113"></a>01113 
<a name="l01114"></a>01114             rCellHeterogeneityRegions.push_back(boost::shared_ptr&lt;<a class="code" href="classAbstractChasteRegion.html">AbstractChasteRegion&lt;DIM&gt;</a> &gt;(<span class="keyword">new</span> <a class="code" href="classChasteCuboid.html">ChasteCuboid&lt;DIM&gt;</a> ( chaste_point_a, chaste_point_b )) );
<a name="l01115"></a>01115         }
<a name="l01116"></a>01116         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ht.Location().Ellipsoid().present())
<a name="l01117"></a>01117         {
<a name="l01118"></a>01118             user_asked_for_cuboids_or_ellipsoids = <span class="keyword">true</span>;
<a name="l01119"></a>01119             cp::point_type centre = ht.Location().Ellipsoid()-&gt;Centre();
<a name="l01120"></a>01120             cp::point_type radii  = ht.Location().Ellipsoid()-&gt;Radii();
<a name="l01121"></a>01121 
<a name="l01122"></a>01122             <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_a ( centre.x(), centre.y(), centre.z() );
<a name="l01123"></a>01123             <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_b ( radii.x(), radii.y(), radii.z() );
<a name="l01124"></a>01124             rCellHeterogeneityRegions.push_back(boost::shared_ptr&lt;<a class="code" href="classAbstractChasteRegion.html">AbstractChasteRegion&lt;DIM&gt;</a> &gt;(<span class="keyword">new</span> <a class="code" href="classChasteEllipsoid.html">ChasteEllipsoid&lt;DIM&gt;</a> ( chaste_point_a, chaste_point_b )) );
<a name="l01125"></a>01125         }
<a name="l01126"></a>01126         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ht.Location().EpiLayer().present())
<a name="l01127"></a>01127         {
<a name="l01128"></a>01128             <a class="code" href="classHeartConfig.html#efbe15b3fd5d616d98a35dd172608529">mEpiFraction</a>  =  ht.Location().EpiLayer().get();
<a name="l01129"></a>01129 
<a name="l01130"></a>01130             user_asking_for_transmural_layers = <span class="keyword">true</span>;
<a name="l01131"></a>01131             <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#efbe15b3fd5d616d98a35dd172608529">mEpiFraction</a> &lt;0)
<a name="l01132"></a>01132             {
<a name="l01133"></a>01133                 user_supplied_negative_value=<span class="keyword">true</span>;
<a name="l01134"></a>01134             }
<a name="l01135"></a>01135             <a class="code" href="classHeartConfig.html#b24f553ab1e97d36b8467f7ca1bcf800">mIndexEpi</a> = counter_of_heterogeneities;
<a name="l01136"></a>01136         }
<a name="l01137"></a>01137         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ht.Location().EndoLayer().present())
<a name="l01138"></a>01138         {
<a name="l01139"></a>01139             <a class="code" href="classHeartConfig.html#9c9f9fefab6c029324426098740b5bc4">mEndoFraction</a>  =  ht.Location().EndoLayer().get();
<a name="l01140"></a>01140 
<a name="l01141"></a>01141             user_asking_for_transmural_layers = <span class="keyword">true</span>;
<a name="l01142"></a>01142             <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#9c9f9fefab6c029324426098740b5bc4">mEndoFraction</a> &lt;0)
<a name="l01143"></a>01143             {
<a name="l01144"></a>01144                 user_supplied_negative_value=<span class="keyword">true</span>;
<a name="l01145"></a>01145             }
<a name="l01146"></a>01146             <a class="code" href="classHeartConfig.html#4785f6ad1c60766c471bcb525eac02d3">mIndexEndo</a> = counter_of_heterogeneities;
<a name="l01147"></a>01147         }
<a name="l01148"></a>01148         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ht.Location().MidLayer().present())
<a name="l01149"></a>01149         {
<a name="l01150"></a>01150             <a class="code" href="classHeartConfig.html#5648845197c449e58c2c879f7422df3f">mMidFraction</a>  =  ht.Location().MidLayer().get();
<a name="l01151"></a>01151 
<a name="l01152"></a>01152             user_asking_for_transmural_layers = <span class="keyword">true</span>;
<a name="l01153"></a>01153             <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#5648845197c449e58c2c879f7422df3f">mMidFraction</a> &lt;0)
<a name="l01154"></a>01154             {
<a name="l01155"></a>01155                 user_supplied_negative_value=<span class="keyword">true</span>;
<a name="l01156"></a>01156             }
<a name="l01157"></a>01157             <a class="code" href="classHeartConfig.html#bfdca19b9fc56fe21ef23d2593cc022f">mIndexMid</a> =  counter_of_heterogeneities;
<a name="l01158"></a>01158         }
<a name="l01159"></a>01159         <span class="keywordflow">else</span>
<a name="l01160"></a>01160         {
<a name="l01161"></a>01161             <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a>(<span class="stringliteral">"Invalid region type for cell heterogeneity definition"</span>);
<a name="l01162"></a>01162         }
<a name="l01163"></a>01163 
<a name="l01164"></a>01164         <span class="comment">// Old scale factors</span>
<a name="l01165"></a>01165         rScaleFactorGks.push_back(ht.ScaleFactorGks().present() ? (double)ht.ScaleFactorGks().get() : 1.0);
<a name="l01166"></a>01166         rScaleFactorIto.push_back(ht.ScaleFactorIto().present() ? (double)ht.ScaleFactorIto().get() : 1.0);
<a name="l01167"></a>01167         rScaleFactorGkr.push_back(ht.ScaleFactorGkr().present() ? (double)ht.ScaleFactorGkr().get() : 1.0);
<a name="l01168"></a>01168 
<a name="l01169"></a>01169         <span class="comment">// Named parameters</span>
<a name="l01170"></a>01170         <span class="keywordflow">if</span> (pParameterSettings)
<a name="l01171"></a>01171         {
<a name="l01172"></a>01172             std::map&lt;std::string, double&gt; param_settings;
<a name="l01173"></a>01173             XSD_SEQUENCE_TYPE(cp::cell_heterogeneity_type::SetParameter)&amp; params = ht.SetParameter();
<a name="l01174"></a>01174             <span class="keywordflow">for</span> (XSD_ITERATOR_TYPE(cp::cell_heterogeneity_type::SetParameter) param_it = params.begin();
<a name="l01175"></a>01175                  param_it != params.end();
<a name="l01176"></a>01176                  ++param_it)
<a name="l01177"></a>01177             {
<a name="l01178"></a>01178                 cp::set_parameter_type param(*param_it);
<a name="l01179"></a>01179                 param_settings[param.name()] = param.value();
<a name="l01180"></a>01180             }
<a name="l01181"></a>01181             pParameterSettings-&gt;push_back(param_settings);
<a name="l01182"></a>01182         }
<a name="l01183"></a>01183 
<a name="l01184"></a>01184         counter_of_heterogeneities++;
<a name="l01185"></a>01185     }
<a name="l01186"></a>01186 
<a name="l01187"></a>01187     <span class="comment">//set the flag for request of transmural layers</span>
<a name="l01188"></a>01188     <a class="code" href="classHeartConfig.html#6ebec0d7deb03099ae581bca114147fb">mUserAskedForCellularTransmuralHeterogeneities</a> = user_asking_for_transmural_layers;
<a name="l01189"></a>01189 
<a name="l01190"></a>01190     <span class="keywordflow">if</span> ( <a class="code" href="classHeartConfig.html#6ebec0d7deb03099ae581bca114147fb">mUserAskedForCellularTransmuralHeterogeneities</a> )
<a name="l01191"></a>01191     {
<a name="l01192"></a>01192         <span class="comment">// cuboids/ellipsoids and layers at the same time are not yet supported</span>
<a name="l01193"></a>01193         <span class="keywordflow">if</span> (user_asked_for_cuboids_or_ellipsoids )
<a name="l01194"></a>01194         {
<a name="l01195"></a>01195             <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a> (<span class="stringliteral">"Specification of cellular heterogeneities by cuboids/ellipsoids and layers at the same time is not yet supported"</span>);
<a name="l01196"></a>01196         }
<a name="l01197"></a>01197 
<a name="l01198"></a>01198         <span class="comment">//check that the user supplied all three layers, the indexes should be 0, 1 and 2.</span>
<a name="l01199"></a>01199         <span class="comment">// As they are initialised to a higher value, if their summation is higher than 3,</span>
<a name="l01200"></a>01200         <span class="comment">// one (or more) is missing</span>
<a name="l01201"></a>01201         <span class="keywordflow">if</span> ((<a class="code" href="classHeartConfig.html#bfdca19b9fc56fe21ef23d2593cc022f">mIndexMid</a>+<a class="code" href="classHeartConfig.html#4785f6ad1c60766c471bcb525eac02d3">mIndexEndo</a>+<a class="code" href="classHeartConfig.html#b24f553ab1e97d36b8467f7ca1bcf800">mIndexEpi</a>) &gt; 3)
<a name="l01202"></a>01202         {
<a name="l01203"></a>01203             <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a> (<span class="stringliteral">"Three specifications of layers must be supplied"</span>);
<a name="l01204"></a>01204         }
<a name="l01205"></a>01205         <span class="keywordflow">if</span> (fabs((<a class="code" href="classHeartConfig.html#9c9f9fefab6c029324426098740b5bc4">mEndoFraction</a>+<a class="code" href="classHeartConfig.html#5648845197c449e58c2c879f7422df3f">mMidFraction</a>+<a class="code" href="classHeartConfig.html#efbe15b3fd5d616d98a35dd172608529">mEpiFraction</a>)-1)&gt;1e-2)
<a name="l01206"></a>01206         {
<a name="l01207"></a>01207             <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a> (<span class="stringliteral">"Summation of epicardial, midmyocardial and endocardial fractions should be 1"</span>);
<a name="l01208"></a>01208         }
<a name="l01209"></a>01209         <span class="keywordflow">if</span> (user_supplied_negative_value)
<a name="l01210"></a>01210         {
<a name="l01211"></a>01211            <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a> (<span class="stringliteral">"Fractions must be positive"</span>);
<a name="l01212"></a>01212         }
<a name="l01213"></a>01213     }
<a name="l01214"></a>01214 }
<a name="l01215"></a>01215 
<a name="l01216"></a><a class="code" href="classHeartConfig.html#05a43dba4479aecdba22e537105934ce">01216</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#05a43dba4479aecdba22e537105934ce">HeartConfig::AreCellularTransmuralHeterogeneitiesRequested</a>()
<a name="l01217"></a>01217 {
<a name="l01218"></a>01218     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#6ebec0d7deb03099ae581bca114147fb">mUserAskedForCellularTransmuralHeterogeneities</a>;
<a name="l01219"></a>01219 }
<a name="l01220"></a>01220 
<a name="l01221"></a><a class="code" href="classHeartConfig.html#c6a311736789413d8f0780f62ff53b41">01221</a> <span class="keywordtype">double</span> <a class="code" href="classHeartConfig.html#c6a311736789413d8f0780f62ff53b41">HeartConfig::GetEpiLayerFraction</a>()
<a name="l01222"></a>01222 {
<a name="l01223"></a>01223     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#efbe15b3fd5d616d98a35dd172608529">mEpiFraction</a>;
<a name="l01224"></a>01224 }
<a name="l01225"></a>01225 
<a name="l01226"></a><a class="code" href="classHeartConfig.html#b27a388cfb3df276617aaae504e7c602">01226</a> <span class="keywordtype">double</span> <a class="code" href="classHeartConfig.html#b27a388cfb3df276617aaae504e7c602">HeartConfig::GetEndoLayerFraction</a>()
<a name="l01227"></a>01227 {
<a name="l01228"></a>01228     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#9c9f9fefab6c029324426098740b5bc4">mEndoFraction</a>;
<a name="l01229"></a>01229 }
<a name="l01230"></a>01230 
<a name="l01231"></a><a class="code" href="classHeartConfig.html#40a8c0d11e49c75744f1f46ab350b938">01231</a> <span class="keywordtype">double</span> <a class="code" href="classHeartConfig.html#40a8c0d11e49c75744f1f46ab350b938">HeartConfig::GetMidLayerFraction</a>()
<a name="l01232"></a>01232 {
<a name="l01233"></a>01233     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#5648845197c449e58c2c879f7422df3f">mMidFraction</a>;
<a name="l01234"></a>01234 }
<a name="l01235"></a>01235 
<a name="l01236"></a><a class="code" href="classHeartConfig.html#983aa22ea5954f80e4554dedb39361a1">01236</a> <span class="keywordtype">unsigned</span> <a class="code" href="classHeartConfig.html#983aa22ea5954f80e4554dedb39361a1">HeartConfig::GetEpiLayerIndex</a>()
<a name="l01237"></a>01237 {
<a name="l01238"></a>01238     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#b24f553ab1e97d36b8467f7ca1bcf800">mIndexEpi</a>;
<a name="l01239"></a>01239 }
<a name="l01240"></a>01240 
<a name="l01241"></a><a class="code" href="classHeartConfig.html#c929ad5b6b509ffbb76853e5374df9f9">01241</a> <span class="keywordtype">unsigned</span> <a class="code" href="classHeartConfig.html#c929ad5b6b509ffbb76853e5374df9f9">HeartConfig::GetEndoLayerIndex</a>()
<a name="l01242"></a>01242 {
<a name="l01243"></a>01243     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#4785f6ad1c60766c471bcb525eac02d3">mIndexEndo</a>;
<a name="l01244"></a>01244 }
<a name="l01245"></a>01245 
<a name="l01246"></a><a class="code" href="classHeartConfig.html#79cca34d2513013d0367b703827302cb">01246</a> <span class="keywordtype">unsigned</span> <a class="code" href="classHeartConfig.html#79cca34d2513013d0367b703827302cb">HeartConfig::GetMidLayerIndex</a>()
<a name="l01247"></a>01247 {
<a name="l01248"></a>01248     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#bfdca19b9fc56fe21ef23d2593cc022f">mIndexMid</a>;
<a name="l01249"></a>01249 }
<a name="l01250"></a>01250 
<a name="l01251"></a><a class="code" href="classHeartConfig.html#bcf7598b37ec20f65a3033dafafff7dd">01251</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#bcf7598b37ec20f65a3033dafafff7dd">HeartConfig::GetConductivityHeterogeneitiesProvided</a>()<span class="keyword"> const</span>
<a name="l01252"></a>01252 <span class="keyword"></span>{
<a name="l01253"></a>01253     <a class="code" href="classHeartConfig.html#ab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">"ConductivityHeterogeneities"</span>);
<a name="l01254"></a>01254     <span class="keywordflow">try</span>
<a name="l01255"></a>01255     {
<a name="l01256"></a>01256         <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;ConductivityHeterogeneities(),
<a name="l01257"></a>01257                         &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation()-&gt;ConductivityHeterogeneities(),
<a name="l01258"></a>01258                         <span class="stringliteral">"ConductivityHeterogeneities"</span>);
<a name="l01259"></a>01259         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01260"></a>01260     }
<a name="l01261"></a>01261     <span class="keywordflow">catch</span> (<a class="code" href="classException.html">Exception</a>&amp; e)
<a name="l01262"></a>01262     {
<a name="l01263"></a>01263         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01264"></a>01264     }
<a name="l01265"></a>01265 }
<a name="l01266"></a>01266 
<a name="l01267"></a>01267 <span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> DIM&gt;
<a name="l01268"></a><a class="code" href="classHeartConfig.html#2e0c392c5a918fbf00b00c02d66f2ac0">01268</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#2e0c392c5a918fbf00b00c02d66f2ac0">HeartConfig::GetConductivityHeterogeneities</a>(
<a name="l01269"></a>01269         std::vector&lt;boost::shared_ptr&lt;<a class="code" href="classAbstractChasteRegion.html">AbstractChasteRegion&lt;DIM&gt;</a> &gt; &gt;&amp; conductivitiesHeterogeneityAreas,
<a name="l01270"></a>01270         std::vector&lt; c_vector&lt;double,3&gt; &gt;&amp; intraConductivities,
<a name="l01271"></a>01271         std::vector&lt; c_vector&lt;double,3&gt; &gt;&amp; extraConductivities)<span class="keyword"> const</span>
<a name="l01272"></a>01272 <span class="keyword"></span>{
<a name="l01273"></a>01273     <a class="code" href="classHeartConfig.html#ab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">"ConductivityHeterogeneities"</span>);
<a name="l01274"></a>01274     XSD_ANON_SEQUENCE_TYPE(cp::simulation_type, ConductivityHeterogeneities, ConductivityHeterogeneity)&amp;
<a name="l01275"></a>01275          conductivity_heterogeneity = <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;ConductivityHeterogeneities(),
<a name="l01276"></a>01276                                                       &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation()-&gt;ConductivityHeterogeneities(),
<a name="l01277"></a>01277                                                       <span class="stringliteral">"ConductivityHeterogeneities"</span>)-&gt;<span class="keyword">get</span>().ConductivityHeterogeneity();
<a name="l01278"></a>01278 
<a name="l01279"></a>01279     <span class="keywordflow">for</span> (XSD_ANON_ITERATOR_TYPE(cp::simulation_type, ConductivityHeterogeneities, ConductivityHeterogeneity) i = conductivity_heterogeneity.begin();
<a name="l01280"></a>01280          i != conductivity_heterogeneity.end();
<a name="l01281"></a>01281          ++i)
<a name="l01282"></a>01282     {
<a name="l01283"></a>01283         cp::conductivity_heterogeneity_type ht(*i);
<a name="l01284"></a>01284 
<a name="l01285"></a>01285         <span class="keywordflow">if</span> (ht.Location().Cuboid().present())
<a name="l01286"></a>01286         {
<a name="l01287"></a>01287             cp::point_type point_a = ht.Location().Cuboid()-&gt;LowerCoordinates();
<a name="l01288"></a>01288             cp::point_type point_b = ht.Location().Cuboid()-&gt;UpperCoordinates();
<a name="l01289"></a>01289             <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_a ( point_a.x(), point_a.y(), point_a.z() );
<a name="l01290"></a>01290             <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_b ( point_b.x(), point_b.y(), point_b.z() );
<a name="l01291"></a>01291             conductivitiesHeterogeneityAreas.push_back(boost::shared_ptr&lt;<a class="code" href="classAbstractChasteRegion.html">AbstractChasteRegion&lt;DIM&gt;</a> &gt;   (  <span class="keyword">new</span> <a class="code" href="classChasteCuboid.html">ChasteCuboid&lt;DIM&gt;</a> ( chaste_point_a, chaste_point_b )) );
<a name="l01292"></a>01292         }
<a name="l01293"></a>01293         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ht.Location().Ellipsoid().present())
<a name="l01294"></a>01294         {
<a name="l01295"></a>01295             cp::point_type centre = ht.Location().Ellipsoid()-&gt;Centre();
<a name="l01296"></a>01296             cp::point_type radii  = ht.Location().Ellipsoid()-&gt;Radii();
<a name="l01297"></a>01297             <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_a ( centre.x(), centre.y(), centre.z() );
<a name="l01298"></a>01298             <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_b ( radii.x(), radii.y(), radii.z() );
<a name="l01299"></a>01299             conductivitiesHeterogeneityAreas.push_back(boost::shared_ptr&lt;<a class="code" href="classAbstractChasteRegion.html">AbstractChasteRegion&lt;DIM&gt;</a> &gt;   (  <span class="keyword">new</span> <a class="code" href="classChasteEllipsoid.html">ChasteEllipsoid&lt;DIM&gt;</a> ( chaste_point_a, chaste_point_b )) );
<a name="l01300"></a>01300         }
<a name="l01301"></a>01301         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ht.Location().EpiLayer().present() || ht.Location().MidLayer().present() || ht.Location().EndoLayer().present() )
<a name="l01302"></a>01302         {
<a name="l01304"></a>01304             <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a>(<span class="stringliteral">"Definition of transmural layers is not allowed for conductivities heterogeneities, you may use fibre orientation support instead"</span>);
<a name="l01305"></a>01305         }
<a name="l01306"></a>01306         <span class="keywordflow">else</span>
<a name="l01307"></a>01307         {
<a name="l01308"></a>01308             <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a>(<span class="stringliteral">"Invalid region type for conductivity definition"</span>);
<a name="l01309"></a>01309         }
<a name="l01310"></a>01310 
<a name="l01311"></a>01311         <span class="keywordflow">if</span> (ht.IntracellularConductivities().present())
<a name="l01312"></a>01312         {
<a name="l01313"></a>01313             <span class="keywordtype">double</span> intra_x = ht.IntracellularConductivities()-&gt;longi();
<a name="l01314"></a>01314             <span class="keywordtype">double</span> intra_y = ht.IntracellularConductivities()-&gt;trans();
<a name="l01315"></a>01315             <span class="keywordtype">double</span> intra_z = ht.IntracellularConductivities()-&gt;normal();
<a name="l01316"></a>01316 
<a name="l01317"></a>01317             intraConductivities.push_back( Create_c_vector(intra_x, intra_y, intra_z) );
<a name="l01318"></a>01318         }
<a name="l01319"></a>01319         <span class="keywordflow">else</span>
<a name="l01320"></a>01320         {
<a name="l01321"></a>01321             c_vector&lt;double, 3&gt; intra_conductivities;
<a name="l01322"></a>01322             <a class="code" href="classHeartConfig.html#ca1345d62f0aa522f210815d812f4401">GetIntracellularConductivities</a>(intra_conductivities);
<a name="l01323"></a>01323             intraConductivities.push_back(intra_conductivities);
<a name="l01324"></a>01324         }
<a name="l01325"></a>01325 
<a name="l01326"></a>01326         <span class="keywordflow">if</span> (ht.ExtracellularConductivities().present())
<a name="l01327"></a>01327         {
<a name="l01328"></a>01328             <span class="keywordtype">double</span> extra_x = ht.ExtracellularConductivities()-&gt;longi();
<a name="l01329"></a>01329             <span class="keywordtype">double</span> extra_y = ht.ExtracellularConductivities()-&gt;trans();
<a name="l01330"></a>01330             <span class="keywordtype">double</span> extra_z = ht.ExtracellularConductivities()-&gt;normal();
<a name="l01331"></a>01331 
<a name="l01332"></a>01332             extraConductivities.push_back( Create_c_vector(extra_x, extra_y, extra_z) );
<a name="l01333"></a>01333         }
<a name="l01334"></a>01334         <span class="keywordflow">else</span>
<a name="l01335"></a>01335         {
<a name="l01336"></a>01336             c_vector&lt;double, 3&gt; extra_conductivities;
<a name="l01337"></a>01337             <a class="code" href="classHeartConfig.html#88855dbd26f93d53e1b754a1db38f792">GetExtracellularConductivities</a>(extra_conductivities);
<a name="l01338"></a>01338             extraConductivities.push_back(extra_conductivities);
<a name="l01339"></a>01339         }
<a name="l01340"></a>01340 
<a name="l01341"></a>01341     }
<a name="l01342"></a>01342 }
<a name="l01343"></a>01343 
<a name="l01344"></a><a class="code" href="classHeartConfig.html#d4f49a0c81a7463613fdde99fb56e224">01344</a> std::string <a class="code" href="classHeartConfig.html#d4f49a0c81a7463613fdde99fb56e224">HeartConfig::GetOutputDirectory</a>()<span class="keyword"> const</span>
<a name="l01345"></a>01345 <span class="keyword"></span>{
<a name="l01346"></a>01346     <a class="code" href="classHeartConfig.html#ab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">"Simulation/OutputDirectory"</span>);
<a name="l01347"></a>01347     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;OutputDirectory(),
<a name="l01348"></a>01348                            &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation()-&gt;OutputDirectory(),
<a name="l01349"></a>01349                            <span class="stringliteral">"Simulation/OutputDirectory"</span>)-&gt;<span class="keyword">get</span>();
<a name="l01350"></a>01350 }
<a name="l01351"></a>01351 
<a name="l01352"></a><a class="code" href="classHeartConfig.html#dc4a009d6fcd830191964ac40ec71889">01352</a> std::string <a class="code" href="classHeartConfig.html#dc4a009d6fcd830191964ac40ec71889">HeartConfig::GetOutputFilenamePrefix</a>()<span class="keyword"> const</span>
<a name="l01353"></a>01353 <span class="keyword"></span>{
<a name="l01354"></a>01354     <a class="code" href="classHeartConfig.html#ab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">"Simulation/OutputFilenamePrefix"</span>);
<a name="l01355"></a>01355     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;OutputFilenamePrefix(),
<a name="l01356"></a>01356                            &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation()-&gt;OutputFilenamePrefix(),
<a name="l01357"></a>01357                            <span class="stringliteral">"Simulation/OutputFilenamePrefix"</span>)-&gt;<span class="keyword">get</span>();
<a name="l01358"></a>01358 }
<a name="l01359"></a>01359 
<a name="l01360"></a><a class="code" href="classHeartConfig.html#076bbaf9d7412d31220dba3c574a2d86">01360</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#076bbaf9d7412d31220dba3c574a2d86">HeartConfig::GetOutputVariablesProvided</a>()<span class="keyword"> const</span>
<a name="l01361"></a>01361 <span class="keyword"></span>{
<a name="l01362"></a>01362     <a class="code" href="classHeartConfig.html#ab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">"OutputVariables"</span>);
<a name="l01363"></a>01363 
<a name="l01364"></a>01364     <span class="keywordflow">try</span>
<a name="l01365"></a>01365     {
<a name="l01366"></a>01366         <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;OutputVariables(),
<a name="l01367"></a>01367                         &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation()-&gt;OutputVariables(),
<a name="l01368"></a>01368                         <span class="stringliteral">"OutputVariables"</span>);
<a name="l01369"></a>01369         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01370"></a>01370     }
<a name="l01371"></a>01371     <span class="keywordflow">catch</span> (<a class="code" href="classException.html">Exception</a>&amp; e)
<a name="l01372"></a>01372     {
<a name="l01373"></a>01373         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01374"></a>01374     }
<a name="l01375"></a>01375 }
<a name="l01376"></a>01376 
<a name="l01377"></a><a class="code" href="classHeartConfig.html#cd23827b77524f32ee2e974fc38b5756">01377</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#cd23827b77524f32ee2e974fc38b5756">HeartConfig::GetOutputVariables</a>(std::vector&lt;std::string&gt;&amp; rOutputVariables)<span class="keyword"> const</span>
<a name="l01378"></a>01378 <span class="keyword"></span>{
<a name="l01379"></a>01379     <a class="code" href="classHeartConfig.html#ab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">"OutputVariables"</span>);
<a name="l01380"></a>01380     XSD_SEQUENCE_TYPE(cp::output_variables_type::Var)&amp;
<a name="l01381"></a>01381          output_variables = <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;OutputVariables(),
<a name="l01382"></a>01382                                             &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation()-&gt;OutputVariables(),
<a name="l01383"></a>01383                                             <span class="stringliteral">"OutputVariables"</span>)-&gt;<span class="keyword">get</span>().Var();
<a name="l01384"></a>01384     rOutputVariables.clear();
<a name="l01385"></a>01385 
<a name="l01386"></a>01386     <span class="keywordflow">for</span> (XSD_ITERATOR_TYPE(cp::output_variables_type::Var) i = output_variables.begin();
<a name="l01387"></a>01387          i != output_variables.end();
<a name="l01388"></a>01388          ++i)
<a name="l01389"></a>01389     {
<a name="l01390"></a>01390         cp::var_type&amp; r_var(*i);
<a name="l01391"></a>01391 
<a name="l01392"></a>01392         <span class="comment">// Add to outputVariables the string returned by var.name()</span>
<a name="l01393"></a>01393         rOutputVariables.push_back(r_var.name());
<a name="l01394"></a>01394     }
<a name="l01395"></a>01395 }
<a name="l01396"></a><a class="code" href="classHeartConfig.html#7593b5c221b39addad3c77cd74b0e132">01396</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#7593b5c221b39addad3c77cd74b0e132">HeartConfig::GetOutputUsingOriginalNodeOrdering</a>()
<a name="l01397"></a>01397 {
<a name="l01398"></a>01398     <span class="keywordflow">try</span>
<a name="l01399"></a>01399     {
<a name="l01400"></a>01400         <span class="keywordflow">return</span> (<a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>(&amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;OutputUsingOriginalNodeOrdering(),
<a name="l01401"></a>01401                                &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation()-&gt;OutputUsingOriginalNodeOrdering(),
<a name="l01402"></a>01402                               <span class="stringliteral">"OutputUsingOriginalNodeOrdering"</span>)-&gt;<span class="keyword">get</span>()  == cp::yesno_type::yes);
<a name="l01403"></a>01403     }
<a name="l01404"></a>01404     <span class="keywordflow">catch</span> (<a class="code" href="classException.html">Exception</a> &amp;e)
<a name="l01405"></a>01405     {
<a name="l01406"></a>01406         <span class="comment">//If it didn't exist, then we default to false</span>
<a name="l01407"></a>01407         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01408"></a>01408     }
<a name="l01409"></a>01409 }
<a name="l01410"></a>01410 
<a name="l01411"></a><a class="code" href="classHeartConfig.html#34e25b3a25618f0f8721c678e6b12f95">01411</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#34e25b3a25618f0f8721c678e6b12f95">HeartConfig::GetCheckpointSimulation</a>()<span class="keyword"> const</span>
<a name="l01412"></a>01412 <span class="keyword"></span>{
<a name="l01413"></a>01413     <span class="keywordflow">try</span>
<a name="l01414"></a>01414     {
<a name="l01415"></a>01415         <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#894d374015f888c2111ec252134395fc">IsSimulationDefined</a>())
<a name="l01416"></a>01416         {
<a name="l01417"></a>01417             <a class="code" href="classHeartConfig.html#ab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">"GetSaveSimulation"</span>);
<a name="l01418"></a>01418             <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;CheckpointSimulation(),
<a name="l01419"></a>01419                             &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation()-&gt;CheckpointSimulation(),
<a name="l01420"></a>01420                             <span class="stringliteral">"Simulation/SaveSimulation"</span>);
<a name="l01421"></a>01421         }
<a name="l01422"></a>01422         <span class="keywordflow">else</span> 
<a name="l01423"></a>01423         {
<a name="l01424"></a>01424             <a class="code" href="classHeartConfig.html#2be3fdcc724c4a6609526b53f86d8c01">CheckResumeSimulationIsDefined</a>(<span class="stringliteral">"GetSaveSimulation"</span>);
<a name="l01425"></a>01425             <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;ResumeSimulation()-&gt;CheckpointSimulation(),
<a name="l01426"></a>01426                             &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation()-&gt;CheckpointSimulation(),
<a name="l01427"></a>01427                             <span class="stringliteral">"ResumeSimulation/SaveSimulation"</span>);
<a name="l01428"></a>01428         }
<a name="l01429"></a>01429         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01430"></a>01430     }
<a name="l01431"></a>01431     <span class="keywordflow">catch</span> (<a class="code" href="classException.html">Exception</a>&amp; e)
<a name="l01432"></a>01432     {
<a name="l01433"></a>01433         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01434"></a>01434     }
<a name="l01435"></a>01435 }
<a name="l01436"></a>01436 
<a name="l01437"></a><a class="code" href="classHeartConfig.html#80bb45c8945a0a3b98b5a1151d79143a">01437</a> <span class="keywordtype">double</span> <a class="code" href="classHeartConfig.html#80bb45c8945a0a3b98b5a1151d79143a">HeartConfig::GetCheckpointTimestep</a>()<span class="keyword"> const</span>
<a name="l01438"></a>01438 <span class="keyword"></span>{
<a name="l01439"></a>01439     <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#894d374015f888c2111ec252134395fc">IsSimulationDefined</a>())
<a name="l01440"></a>01440     {
<a name="l01441"></a>01441         <a class="code" href="classHeartConfig.html#ab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">"GetSaveSimulation"</span>);
<a name="l01442"></a>01442         <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;CheckpointSimulation(),
<a name="l01443"></a>01443                         &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation()-&gt;CheckpointSimulation(),
<a name="l01444"></a>01444                         <span class="stringliteral">"Simulation/SaveSimulation"</span>)-&gt;<span class="keyword">get</span>().timestep();
<a name="l01445"></a>01445     }
<a name="l01446"></a>01446     <span class="keywordflow">else</span> 
<a name="l01447"></a>01447     {
<a name="l01448"></a>01448         <a class="code" href="classHeartConfig.html#2be3fdcc724c4a6609526b53f86d8c01">CheckResumeSimulationIsDefined</a>(<span class="stringliteral">"GetSaveSimulation"</span>);
<a name="l01449"></a>01449         <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;ResumeSimulation()-&gt;CheckpointSimulation(),
<a name="l01450"></a>01450                         &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation()-&gt;CheckpointSimulation(),
<a name="l01451"></a>01451                         <span class="stringliteral">"ResumeSimulation/SaveSimulation"</span>)-&gt;<span class="keyword">get</span>().timestep();
<a name="l01452"></a>01452     }
<a name="l01453"></a>01453 }
<a name="l01454"></a>01454 
<a name="l01455"></a><a class="code" href="classHeartConfig.html#d6f5c8169999d795e99f66befb962f0c">01455</a> <span class="keywordtype">unsigned</span> <a class="code" href="classHeartConfig.html#d6f5c8169999d795e99f66befb962f0c">HeartConfig::GetMaxCheckpointsOnDisk</a>()<span class="keyword"> const</span>
<a name="l01456"></a>01456 <span class="keyword"></span>{
<a name="l01457"></a>01457     <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#894d374015f888c2111ec252134395fc">IsSimulationDefined</a>())
<a name="l01458"></a>01458     {
<a name="l01459"></a>01459         <a class="code" href="classHeartConfig.html#ab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">"GetSaveSimulation"</span>);
<a name="l01460"></a>01460         <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;CheckpointSimulation(),
<a name="l01461"></a>01461                         &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation()-&gt;CheckpointSimulation(),
<a name="l01462"></a>01462                         <span class="stringliteral">"Simulation/SaveSimulation"</span>)-&gt;<span class="keyword">get</span>().max_checkpoints_on_disk();
<a name="l01463"></a>01463     }
<a name="l01464"></a>01464     <span class="keywordflow">else</span> 
<a name="l01465"></a>01465     {
<a name="l01466"></a>01466         <a class="code" href="classHeartConfig.html#2be3fdcc724c4a6609526b53f86d8c01">CheckResumeSimulationIsDefined</a>(<span class="stringliteral">"GetSaveSimulation"</span>);
<a name="l01467"></a>01467         <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;ResumeSimulation()-&gt;CheckpointSimulation(),
<a name="l01468"></a>01468                         &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation()-&gt;CheckpointSimulation(),
<a name="l01469"></a>01469                         <span class="stringliteral">"ResumeSimulation/SaveSimulation"</span>)-&gt;<span class="keyword">get</span>().max_checkpoints_on_disk();
<a name="l01470"></a>01470     }
<a name="l01471"></a>01471 }
<a name="l01472"></a>01472 
<a name="l01473"></a>01473 
<a name="l01474"></a><a class="code" href="classHeartConfig.html#a42aa4f087310c26972171ef1accb0ae">01474</a> <a class="code" href="classHeartFileFinder.html">HeartFileFinder</a> <a class="code" href="classHeartConfig.html#a42aa4f087310c26972171ef1accb0ae">HeartConfig::GetArchivedSimulationDir</a>()<span class="keyword"> const</span>
<a name="l01475"></a>01475 <span class="keyword"></span>{
<a name="l01476"></a>01476     <a class="code" href="classHeartConfig.html#2be3fdcc724c4a6609526b53f86d8c01">CheckResumeSimulationIsDefined</a>(<span class="stringliteral">"GetArchivedSimulationDir"</span>);
<a name="l01477"></a>01477 
<a name="l01478"></a>01478     <span class="keywordflow">return</span> <a class="code" href="classHeartFileFinder.html">HeartFileFinder</a>(<a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;ResumeSimulation()-&gt;ArchiveDirectory());
<a name="l01479"></a>01479 }
<a name="l01480"></a>01480 
<a name="l01481"></a>01481 
<a name="l01482"></a><a class="code" href="classHeartConfig.html#ca1345d62f0aa522f210815d812f4401">01482</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#ca1345d62f0aa522f210815d812f4401">HeartConfig::GetIntracellularConductivities</a>(c_vector&lt;double, 3&gt;&amp; intraConductivities)<span class="keyword"> const</span>
<a name="l01483"></a>01483 <span class="keyword"></span>{
<a name="l01484"></a>01484     optional&lt;cp::conductivities_type, false&gt;* intra_conductivities
<a name="l01485"></a>01485         = <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Physiological().IntracellularConductivities(),
<a name="l01486"></a>01486                           &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Physiological().IntracellularConductivities(),
<a name="l01487"></a>01487                           <span class="stringliteral">"IntracellularConductivities"</span>);
<a name="l01488"></a>01488     <span class="keywordtype">double</span> intra_x_cond = intra_conductivities-&gt;get().longi();
<a name="l01489"></a>01489     <span class="keywordtype">double</span> intra_y_cond = intra_conductivities-&gt;get().trans();
<a name="l01490"></a>01490     <span class="keywordtype">double</span> intra_z_cond = intra_conductivities-&gt;get().normal();;
<a name="l01491"></a>01491 
<a name="l01492"></a>01492     assert(intra_y_cond != DBL_MAX);
<a name="l01493"></a>01493     assert(intra_z_cond != DBL_MAX);
<a name="l01494"></a>01494 
<a name="l01495"></a>01495     intraConductivities[0] = intra_x_cond;
<a name="l01496"></a>01496     intraConductivities[1] = intra_y_cond;
<a name="l01497"></a>01497     intraConductivities[2] = intra_z_cond;
<a name="l01498"></a>01498 }
<a name="l01499"></a>01499 
<a name="l01500"></a><a class="code" href="classHeartConfig.html#2136658644fe12e309c2d7999e920095">01500</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#ca1345d62f0aa522f210815d812f4401">HeartConfig::GetIntracellularConductivities</a>(c_vector&lt;double, 2&gt;&amp; intraConductivities)<span class="keyword"> const</span>
<a name="l01501"></a>01501 <span class="keyword"></span>{
<a name="l01502"></a>01502     optional&lt;cp::conductivities_type, false&gt;* intra_conductivities
<a name="l01503"></a>01503         = <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Physiological().IntracellularConductivities(),
<a name="l01504"></a>01504                           &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Physiological().IntracellularConductivities(),
<a name="l01505"></a>01505                           <span class="stringliteral">"IntracellularConductivities"</span>);
<a name="l01506"></a>01506     <span class="keywordtype">double</span> intra_x_cond = intra_conductivities-&gt;get().longi();
<a name="l01507"></a>01507     <span class="keywordtype">double</span> intra_y_cond = intra_conductivities-&gt;get().trans();
<a name="l01508"></a>01508 
<a name="l01509"></a>01509     assert(intra_y_cond != DBL_MAX);
<a name="l01510"></a>01510 
<a name="l01511"></a>01511     intraConductivities[0] = intra_x_cond;
<a name="l01512"></a>01512     intraConductivities[1] = intra_y_cond;
<a name="l01513"></a>01513 }
<a name="l01514"></a>01514 
<a name="l01515"></a><a class="code" href="classHeartConfig.html#8f5ed5c4dd484ba715da9073495b0748">01515</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#ca1345d62f0aa522f210815d812f4401">HeartConfig::GetIntracellularConductivities</a>(c_vector&lt;double, 1&gt;&amp; intraConductivities)<span class="keyword"> const</span>
<a name="l01516"></a>01516 <span class="keyword"></span>{
<a name="l01517"></a>01517     optional&lt;cp::conductivities_type, false&gt;* intra_conductivities
<a name="l01518"></a>01518         = <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Physiological().IntracellularConductivities(),
<a name="l01519"></a>01519                           &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Physiological().IntracellularConductivities(),
<a name="l01520"></a>01520                           <span class="stringliteral">"IntracellularConductivities"</span>);
<a name="l01521"></a>01521     <span class="keywordtype">double</span> intra_x_cond = intra_conductivities-&gt;get().longi();
<a name="l01522"></a>01522 
<a name="l01523"></a>01523     intraConductivities[0] = intra_x_cond;
<a name="l01524"></a>01524 }
<a name="l01525"></a>01525 
<a name="l01526"></a><a class="code" href="classHeartConfig.html#88855dbd26f93d53e1b754a1db38f792">01526</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#88855dbd26f93d53e1b754a1db38f792">HeartConfig::GetExtracellularConductivities</a>(c_vector&lt;double, 3&gt;&amp; extraConductivities)<span class="keyword"> const</span>
<a name="l01527"></a>01527 <span class="keyword"></span>{
<a name="l01528"></a>01528     optional&lt;cp::conductivities_type, false&gt;* extra_conductivities
<a name="l01529"></a>01529         = <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Physiological().ExtracellularConductivities(),
<a name="l01530"></a>01530                           &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Physiological().ExtracellularConductivities(),
<a name="l01531"></a>01531                           <span class="stringliteral">"ExtracellularConductivities"</span>);
<a name="l01532"></a>01532     <span class="keywordtype">double</span> extra_x_cond = extra_conductivities-&gt;get().longi();
<a name="l01533"></a>01533     <span class="keywordtype">double</span> extra_y_cond = extra_conductivities-&gt;get().trans();
<a name="l01534"></a>01534     <span class="keywordtype">double</span> extra_z_cond = extra_conductivities-&gt;get().normal();;
<a name="l01535"></a>01535 
<a name="l01536"></a>01536     assert(extra_y_cond != DBL_MAX);
<a name="l01537"></a>01537     assert(extra_z_cond != DBL_MAX);
<a name="l01538"></a>01538 
<a name="l01539"></a>01539     extraConductivities[0] = extra_x_cond;
<a name="l01540"></a>01540     extraConductivities[1] = extra_y_cond;
<a name="l01541"></a>01541     extraConductivities[2] = extra_z_cond;
<a name="l01542"></a>01542 }
<a name="l01543"></a>01543 
<a name="l01544"></a><a class="code" href="classHeartConfig.html#2a2351eed4d2a4e0f17c854976901be2">01544</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#88855dbd26f93d53e1b754a1db38f792">HeartConfig::GetExtracellularConductivities</a>(c_vector&lt;double, 2&gt;&amp; extraConductivities)<span class="keyword"> const</span>
<a name="l01545"></a>01545 <span class="keyword"></span>{
<a name="l01546"></a>01546     optional&lt;cp::conductivities_type, false&gt;* extra_conductivities
<a name="l01547"></a>01547         = <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Physiological().ExtracellularConductivities(),
<a name="l01548"></a>01548                           &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Physiological().ExtracellularConductivities(),
<a name="l01549"></a>01549                           <span class="stringliteral">"ExtracellularConductivities"</span>);
<a name="l01550"></a>01550     <span class="keywordtype">double</span> extra_x_cond = extra_conductivities-&gt;get().longi();
<a name="l01551"></a>01551     <span class="keywordtype">double</span> extra_y_cond = extra_conductivities-&gt;get().trans();
<a name="l01552"></a>01552 
<a name="l01553"></a>01553     assert(extra_y_cond != DBL_MAX);
<a name="l01554"></a>01554 
<a name="l01555"></a>01555     extraConductivities[0] = extra_x_cond;
<a name="l01556"></a>01556     extraConductivities[1] = extra_y_cond;
<a name="l01557"></a>01557 }
<a name="l01558"></a>01558 
<a name="l01559"></a><a class="code" href="classHeartConfig.html#9b672856c90b4a742b0c285791f693a4">01559</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#88855dbd26f93d53e1b754a1db38f792">HeartConfig::GetExtracellularConductivities</a>(c_vector&lt;double, 1&gt;&amp; extraConductivities)<span class="keyword"> const</span>
<a name="l01560"></a>01560 <span class="keyword"></span>{
<a name="l01561"></a>01561     optional&lt;cp::conductivities_type, false&gt;* extra_conductivities
<a name="l01562"></a>01562         = <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Physiological().ExtracellularConductivities(),
<a name="l01563"></a>01563                           &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Physiological().ExtracellularConductivities(),
<a name="l01564"></a>01564                           <span class="stringliteral">"ExtracellularConductivities"</span>);
<a name="l01565"></a>01565     <span class="keywordtype">double</span> extra_x_cond = extra_conductivities-&gt;get().longi();
<a name="l01566"></a>01566 
<a name="l01567"></a>01567     extraConductivities[0] = extra_x_cond;
<a name="l01568"></a>01568 }
<a name="l01569"></a>01569 
<a name="l01570"></a><a class="code" href="classHeartConfig.html#a4da2f2d8f8a1893230e598e56c6ef04">01570</a> <span class="keywordtype">double</span> <a class="code" href="classHeartConfig.html#a4da2f2d8f8a1893230e598e56c6ef04">HeartConfig::GetBathConductivity</a>(<span class="keywordtype">unsigned</span> bathRegion)<span class="keyword"> const</span>
<a name="l01571"></a>01571 <span class="keyword"></span>{
<a name="l01572"></a>01572     <span class="comment">/*</span>
<a name="l01573"></a>01573 <span class="comment">     *  We have to consider three cases: The user asks for ...</span>
<a name="l01574"></a>01574 <span class="comment">     *    a) ... the default conductivity (bathRegion=UINT_MAX)</span>
<a name="l01575"></a>01575 <span class="comment">     *    b) ... the conductivity of region defined to be heterogeneous</span>
<a name="l01576"></a>01576 <span class="comment">     *    c) ... the conductivity of region NOT defined to be heterogeneous</span>
<a name="l01577"></a>01577 <span class="comment">     *</span>
<a name="l01578"></a>01578 <span class="comment">     *  a) and c) should return the same</span>
<a name="l01579"></a>01579 <span class="comment">     */</span>
<a name="l01580"></a>01580 
<a name="l01581"></a>01581     <span class="keywordflow">if</span> (bathRegion == UINT_MAX)
<a name="l01582"></a>01582     {
<a name="l01583"></a>01583         <span class="comment">/*bath conductivity mS/cm*/</span>
<a name="l01584"></a>01584         <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Physiological().BathConductivity(),
<a name="l01585"></a>01585                                &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Physiological().BathConductivity(),
<a name="l01586"></a>01586                                <span class="stringliteral">"BathConductivity"</span>)-&gt;<span class="keyword">get</span>();
<a name="l01587"></a>01587     }
<a name="l01588"></a>01588     <span class="keywordflow">else</span>
<a name="l01589"></a>01589     {
<a name="l01590"></a>01590         assert(<a class="code" href="classHeartRegionCode.html#ad3b24c50cea20f387e7bfeee6163560">HeartRegionCode::IsRegionBath</a>(bathRegion));
<a name="l01591"></a>01591 
<a name="l01592"></a>01592         std::map&lt;unsigned, double&gt;::const_iterator map_entry = <a class="code" href="classHeartConfig.html#5f7071e5af04a3024ef80365f8eb2780">mBathConductivities</a>.find(bathRegion);
<a name="l01593"></a>01593 
<a name="l01594"></a>01594         <span class="keywordflow">if</span> (map_entry != <a class="code" href="classHeartConfig.html#5f7071e5af04a3024ef80365f8eb2780">mBathConductivities</a>.end())
<a name="l01595"></a>01595         {
<a name="l01596"></a>01596             <span class="keywordflow">return</span> map_entry-&gt;second;
<a name="l01597"></a>01597         }
<a name="l01598"></a>01598         <span class="keywordflow">else</span>
<a name="l01599"></a>01599         {
<a name="l01600"></a>01600             <span class="comment">/*bath conductivity mS/cm*/</span>
<a name="l01601"></a>01601             <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Physiological().BathConductivity(),
<a name="l01602"></a>01602                                    &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Physiological().BathConductivity(),
<a name="l01603"></a>01603                                    <span class="stringliteral">"BathConductivity"</span>)-&gt;<span class="keyword">get</span>();
<a name="l01604"></a>01604         }
<a name="l01605"></a>01605     }
<a name="l01606"></a>01606 }
<a name="l01607"></a><a class="code" href="classHeartConfig.html#de67096f1d2d5559b29b340f259e7d64">01607</a> <span class="keyword">const</span> std::set&lt;unsigned&gt;&amp;  <a class="code" href="classHeartConfig.html#de67096f1d2d5559b29b340f259e7d64">HeartConfig::rGetTissueIdentifiers</a>()
<a name="l01608"></a>01608 {
<a name="l01609"></a>01609     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#c657f43ca4d92bfd3c5e2270e7470429">mTissueIdentifiers</a>;
<a name="l01610"></a>01610 }
<a name="l01611"></a>01611 
<a name="l01612"></a><a class="code" href="classHeartConfig.html#7b7439ea4c9beafbdc55c09e51d76819">01612</a> <span class="keyword">const</span> std::set&lt;unsigned&gt;&amp;  <a class="code" href="classHeartConfig.html#7b7439ea4c9beafbdc55c09e51d76819">HeartConfig::rGetBathIdentifiers</a>()
<a name="l01613"></a>01613 {
<a name="l01614"></a>01614     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#1471127f954fea7a8eb5811ec448f0cc">mBathIdentifiers</a>;
<a name="l01615"></a>01615 }
<a name="l01616"></a>01616 
<a name="l01617"></a><a class="code" href="classHeartConfig.html#28720983a8bcd68fd8dfc6ce247fd325">01617</a> <span class="keywordtype">double</span> <a class="code" href="classHeartConfig.html#28720983a8bcd68fd8dfc6ce247fd325">HeartConfig::GetSurfaceAreaToVolumeRatio</a>()<span class="keyword"> const</span>
<a name="l01618"></a>01618 <span class="keyword"></span>{
<a name="l01619"></a>01619     <span class="comment">/*surface area to volume ratio: 1/cm*/</span>
<a name="l01620"></a>01620     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Physiological().SurfaceAreaToVolumeRatio(),
<a name="l01621"></a>01621                            &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Physiological().SurfaceAreaToVolumeRatio(),
<a name="l01622"></a>01622                            <span class="stringliteral">"SurfaceAreaToVolumeRatio"</span>)-&gt;<span class="keyword">get</span>();
<a name="l01623"></a>01623 }
<a name="l01624"></a>01624 
<a name="l01625"></a><a class="code" href="classHeartConfig.html#7dd59bcef90ddadee3e7a10cbf64be1d">01625</a> <span class="keywordtype">double</span> <a class="code" href="classHeartConfig.html#7dd59bcef90ddadee3e7a10cbf64be1d">HeartConfig::GetCapacitance</a>()<span class="keyword"> const</span>
<a name="l01626"></a>01626 <span class="keyword"></span>{
<a name="l01627"></a>01627     <span class="comment">//         capacitance                 : uF/cm^2</span>
<a name="l01628"></a>01628     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Physiological().Capacitance(),
<a name="l01629"></a>01629                            &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Physiological().Capacitance(),
<a name="l01630"></a>01630                            <span class="stringliteral">"Capacitance"</span>)-&gt;<span class="keyword">get</span>();
<a name="l01631"></a>01631 }
<a name="l01632"></a>01632 
<a name="l01633"></a><a class="code" href="classHeartConfig.html#383ab1c116a88ecd3f973ef371a2c8d9">01633</a> <span class="keywordtype">double</span> <a class="code" href="classHeartConfig.html#383ab1c116a88ecd3f973ef371a2c8d9">HeartConfig::GetOdeTimeStep</a>()<span class="keyword"> const</span>
<a name="l01634"></a>01634 <span class="keyword"></span>{
<a name="l01635"></a>01635     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().TimeSteps(),
<a name="l01636"></a>01636                            &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Numerical().TimeSteps(),
<a name="l01637"></a>01637                            <span class="stringliteral">"ode TimeStep"</span>)-&gt;<span class="keyword">get</span>().ode();
<a name="l01638"></a>01638 }
<a name="l01639"></a>01639 
<a name="l01640"></a><a class="code" href="classHeartConfig.html#c20bbc4140281b206a260a82cb59ab0f">01640</a> <span class="keywordtype">double</span> <a class="code" href="classHeartConfig.html#c20bbc4140281b206a260a82cb59ab0f">HeartConfig::GetPdeTimeStep</a>()<span class="keyword"> const</span>
<a name="l01641"></a>01641 <span class="keyword"></span>{
<a name="l01642"></a>01642     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().TimeSteps(),
<a name="l01643"></a>01643                            &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Numerical().TimeSteps(),
<a name="l01644"></a>01644                            <span class="stringliteral">"pde TimeStep"</span>)-&gt;<span class="keyword">get</span>().pde();
<a name="l01645"></a>01645 }
<a name="l01646"></a>01646 
<a name="l01647"></a><a class="code" href="classHeartConfig.html#33ae21f4b16476aa5cb975a455c5ba19">01647</a> <span class="keywordtype">double</span> <a class="code" href="classHeartConfig.html#33ae21f4b16476aa5cb975a455c5ba19">HeartConfig::GetPrintingTimeStep</a>()<span class="keyword"> const</span>
<a name="l01648"></a>01648 <span class="keyword"></span>{
<a name="l01649"></a>01649     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().TimeSteps(),
<a name="l01650"></a>01650                            &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Numerical().TimeSteps(),
<a name="l01651"></a>01651                            <span class="stringliteral">"printing TimeStep"</span>)-&gt;<span class="keyword">get</span>().printing();
<a name="l01652"></a>01652 }
<a name="l01653"></a>01653 
<a name="l01654"></a><a class="code" href="classHeartConfig.html#efd1b52bc3570c91aeb5c30793f8fb09">01654</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#efd1b52bc3570c91aeb5c30793f8fb09">HeartConfig::GetUseAbsoluteTolerance</a>()<span class="keyword"> const</span>
<a name="l01655"></a>01655 <span class="keyword"></span>{
<a name="l01656"></a>01656     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().KSPTolerances(),
<a name="l01657"></a>01657                             &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Numerical().KSPTolerances(),
<a name="l01658"></a>01658                             <span class="stringliteral">"KSPTolerances"</span>)-&gt;<span class="keyword">get</span>().KSPAbsolute().present();
<a name="l01659"></a>01659 }
<a name="l01660"></a>01660 
<a name="l01661"></a><a class="code" href="classHeartConfig.html#45eb855112098fbd11eeafa696af3865">01661</a> <span class="keywordtype">double</span> <a class="code" href="classHeartConfig.html#45eb855112098fbd11eeafa696af3865">HeartConfig::GetAbsoluteTolerance</a>()<span class="keyword"> const</span>
<a name="l01662"></a>01662 <span class="keyword"></span>{
<a name="l01663"></a>01663     <span class="keywordflow">if</span> (!<a class="code" href="classHeartConfig.html#efd1b52bc3570c91aeb5c30793f8fb09">GetUseAbsoluteTolerance</a>())
<a name="l01664"></a>01664     {
<a name="l01665"></a>01665         <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a>(<span class="stringliteral">"Absolute tolerance is not set in Chaste parameters"</span>);
<a name="l01666"></a>01666     }
<a name="l01667"></a>01667     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().KSPTolerances(),
<a name="l01668"></a>01668                            &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Numerical().KSPTolerances(),
<a name="l01669"></a>01669                            <span class="stringliteral">"KSPTolerances"</span>)-&gt;<span class="keyword">get</span>().KSPAbsolute().get();
<a name="l01670"></a>01670 }
<a name="l01671"></a>01671 
<a name="l01672"></a><a class="code" href="classHeartConfig.html#38875e6f770ba53ed2fe1bcb91d12a61">01672</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#38875e6f770ba53ed2fe1bcb91d12a61">HeartConfig::GetUseRelativeTolerance</a>()<span class="keyword"> const</span>
<a name="l01673"></a>01673 <span class="keyword"></span>{
<a name="l01674"></a>01674      <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().KSPTolerances(),
<a name="l01675"></a>01675                             &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Numerical().KSPTolerances(),
<a name="l01676"></a>01676                             <span class="stringliteral">"KSPTolerances"</span>)-&gt;<span class="keyword">get</span>().KSPRelative().present();
<a name="l01677"></a>01677 }
<a name="l01678"></a>01678 
<a name="l01679"></a><a class="code" href="classHeartConfig.html#1ea656c2fb65c0bfd25fbc162202fa1a">01679</a> <span class="keywordtype">double</span> <a class="code" href="classHeartConfig.html#1ea656c2fb65c0bfd25fbc162202fa1a">HeartConfig::GetRelativeTolerance</a>()<span class="keyword"> const</span>
<a name="l01680"></a>01680 <span class="keyword"></span>{
<a name="l01681"></a>01681     <span class="keywordflow">if</span> (!<a class="code" href="classHeartConfig.html#38875e6f770ba53ed2fe1bcb91d12a61">GetUseRelativeTolerance</a>())
<a name="l01682"></a>01682     {
<a name="l01683"></a>01683         <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a>(<span class="stringliteral">"Relative tolerance is not set in Chaste parameters"</span>);
<a name="l01684"></a>01684     }
<a name="l01685"></a>01685     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().KSPTolerances(),
<a name="l01686"></a>01686                            &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Numerical().KSPTolerances(),
<a name="l01687"></a>01687                            <span class="stringliteral">"KSPTolerances"</span>)-&gt;<span class="keyword">get</span>().KSPRelative().get();
<a name="l01688"></a>01688 }
<a name="l01689"></a>01689 
<a name="l01690"></a><a class="code" href="classHeartConfig.html#c50d7e66e3a6127cf337d2f65638ad6b">01690</a> <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="classHeartConfig.html#c50d7e66e3a6127cf337d2f65638ad6b">HeartConfig::GetKSPSolver</a>()<span class="keyword"> const</span>
<a name="l01691"></a>01691 <span class="keyword"></span>{
<a name="l01692"></a>01692     <span class="keywordflow">switch</span> ( <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().KSPSolver(),
<a name="l01693"></a>01693                              &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Numerical().KSPSolver(),
<a name="l01694"></a>01694                             <span class="stringliteral">"KSPSolver"</span>)-&gt;<span class="keyword">get</span>() )
<a name="l01695"></a>01695     {
<a name="l01696"></a>01696         <span class="keywordflow">case</span> cp::ksp_solver_type::gmres :
<a name="l01697"></a>01697             <span class="keywordflow">return</span> <span class="stringliteral">"gmres"</span>;
<a name="l01698"></a>01698         <span class="keywordflow">case</span> cp::ksp_solver_type::cg :
<a name="l01699"></a>01699             <span class="keywordflow">return</span> <span class="stringliteral">"cg"</span>;
<a name="l01700"></a>01700         <span class="keywordflow">case</span> cp::ksp_solver_type::symmlq :
<a name="l01701"></a>01701             <span class="keywordflow">return</span> <span class="stringliteral">"symmlq"</span>;
<a name="l01702"></a>01702         <span class="keywordflow">case</span> cp::ksp_solver_type::chebychev :
<a name="l01703"></a>01703             <span class="keywordflow">return</span> <span class="stringliteral">"chebychev"</span>;
<a name="l01704"></a>01704     }
<a name="l01705"></a>01705 <span class="preprocessor">#define COVERAGE_IGNORE</span>
<a name="l01706"></a>01706 <span class="preprocessor"></span>    <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a>(<span class="stringliteral">"Unknown ksp solver"</span>);
<a name="l01707"></a>01707 <span class="preprocessor">#undef COVERAGE_IGNORE</span>
<a name="l01708"></a>01708 <span class="preprocessor"></span>}
<a name="l01709"></a>01709 
<a name="l01710"></a><a class="code" href="classHeartConfig.html#c6d76aa8808fba0fa0da55d6b5749c22">01710</a> <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="classHeartConfig.html#c6d76aa8808fba0fa0da55d6b5749c22">HeartConfig::GetKSPPreconditioner</a>()<span class="keyword"> const</span>
<a name="l01711"></a>01711 <span class="keyword"></span>{
<a name="l01712"></a>01712     <span class="keywordflow">switch</span> ( <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().KSPPreconditioner(),
<a name="l01713"></a>01713                              &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Numerical().KSPPreconditioner(),
<a name="l01714"></a>01714                              <span class="stringliteral">"KSPPreconditioner"</span>)-&gt;<span class="keyword">get</span>() )
<a name="l01715"></a>01715     {
<a name="l01716"></a>01716         <span class="keywordflow">case</span> cp::ksp_preconditioner_type::jacobi :
<a name="l01717"></a>01717             <span class="keywordflow">return</span> <span class="stringliteral">"jacobi"</span>;
<a name="l01718"></a>01718         <span class="keywordflow">case</span> cp::ksp_preconditioner_type::bjacobi :
<a name="l01719"></a>01719             <span class="keywordflow">return</span> <span class="stringliteral">"bjacobi"</span>;
<a name="l01720"></a>01720         <span class="keywordflow">case</span> cp::ksp_preconditioner_type::hypre :
<a name="l01721"></a>01721             <span class="keywordflow">return</span> <span class="stringliteral">"hypre"</span>;
<a name="l01722"></a>01722         <span class="keywordflow">case</span> cp::ksp_preconditioner_type::ml :
<a name="l01723"></a>01723             <span class="keywordflow">return</span> <span class="stringliteral">"ml"</span>;
<a name="l01724"></a>01724         <span class="keywordflow">case</span> cp::ksp_preconditioner_type::spai :
<a name="l01725"></a>01725             <span class="keywordflow">return</span> <span class="stringliteral">"spai"</span>;
<a name="l01726"></a>01726         <span class="keywordflow">case</span> cp::ksp_preconditioner_type::blockdiagonal :
<a name="l01727"></a>01727             <span class="keywordflow">return</span> <span class="stringliteral">"blockdiagonal"</span>;
<a name="l01728"></a>01728         <span class="keywordflow">case</span> cp::ksp_preconditioner_type::ldufactorisation :
<a name="l01729"></a>01729             <span class="keywordflow">return</span> <span class="stringliteral">"ldufactorisation"</span>;
<a name="l01730"></a>01730         <span class="keywordflow">case</span> cp::ksp_preconditioner_type::twolevelsblockdiagonal :
<a name="l01731"></a>01731             <span class="keywordflow">return</span> <span class="stringliteral">"twolevelsblockdiagonal"</span>;
<a name="l01732"></a>01732         <span class="keywordflow">case</span> cp::ksp_preconditioner_type::none :
<a name="l01733"></a>01733             <span class="keywordflow">return</span> <span class="stringliteral">"none"</span>;
<a name="l01734"></a>01734 
<a name="l01735"></a>01735     }
<a name="l01736"></a>01736 <span class="preprocessor">#define COVERAGE_IGNORE</span>
<a name="l01737"></a>01737 <span class="preprocessor"></span>    <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a>(<span class="stringliteral">"Unknown ksp preconditioner"</span>);
<a name="l01738"></a>01738 <span class="preprocessor">#undef COVERAGE_IGNORE</span>
<a name="l01739"></a>01739 <span class="preprocessor"></span>}
<a name="l01740"></a>01740 
<a name="l01741"></a><a class="code" href="classHeartConfig.html#df19fd38950e460486b977973b2ca3a9">01741</a> <a class="code" href="structDistributedTetrahedralMeshPartitionType.html#0db0b35cb269eb0e00b9f124fbc28e45">DistributedTetrahedralMeshPartitionType::type</a> <a class="code" href="classHeartConfig.html#df19fd38950e460486b977973b2ca3a9">HeartConfig::GetMeshPartitioning</a>()<span class="keyword"> const</span>
<a name="l01742"></a>01742 <span class="keyword"></span>{
<a name="l01743"></a>01743     <span class="keywordflow">switch</span> ( <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().MeshPartitioning(),
<a name="l01744"></a>01744                              &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Numerical().MeshPartitioning(),
<a name="l01745"></a>01745                              <span class="stringliteral">"MeshPartitioning"</span>)-&gt;<span class="keyword">get</span>() )
<a name="l01746"></a>01746     {
<a name="l01747"></a>01747         <span class="keywordflow">case</span> cp::mesh_partitioning_type::dumb :
<a name="l01748"></a>01748             <span class="keywordflow">return</span> DistributedTetrahedralMeshPartitionType::DUMB;
<a name="l01749"></a>01749         <span class="keywordflow">case</span> cp::mesh_partitioning_type::metis :
<a name="l01750"></a>01750             <span class="keywordflow">return</span> DistributedTetrahedralMeshPartitionType::METIS_LIBRARY;
<a name="l01751"></a>01751         <span class="keywordflow">case</span> cp::mesh_partitioning_type::parmetis :
<a name="l01752"></a>01752             <span class="keywordflow">return</span> DistributedTetrahedralMeshPartitionType::PARMETIS_LIBRARY;
<a name="l01753"></a>01753         <span class="keywordflow">case</span> cp::mesh_partitioning_type::petsc :
<a name="l01754"></a>01754             <span class="keywordflow">return</span> DistributedTetrahedralMeshPartitionType::PETSC_MAT_PARTITION;
<a name="l01755"></a>01755     }
<a name="l01756"></a>01756 <span class="preprocessor">#define COVERAGE_IGNORE</span>
<a name="l01757"></a>01757 <span class="preprocessor"></span>    <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a>(<span class="stringliteral">"Unknown mesh partitioning type"</span>);
<a name="l01758"></a>01758 <span class="preprocessor">#undef COVERAGE_IGNORE</span>
<a name="l01759"></a>01759 <span class="preprocessor"></span>}
<a name="l01760"></a>01760 
<a name="l01761"></a><a class="code" href="classHeartConfig.html#facc6a848f43660c4cccfd9b66cc0df2">01761</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#facc6a848f43660c4cccfd9b66cc0df2">HeartConfig::IsAdaptivityParametersPresent</a>()<span class="keyword"> const</span>
<a name="l01762"></a>01762 <span class="keyword"></span>{
<a name="l01763"></a>01763     <span class="keywordflow">try</span>
<a name="l01764"></a>01764     {
<a name="l01765"></a>01765         <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().AdaptivityParameters(),
<a name="l01766"></a>01766                         &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Numerical().AdaptivityParameters(),
<a name="l01767"></a>01767                         <span class="stringliteral">"AdaptivityParameters"</span>)-&gt;present();
<a name="l01768"></a>01768         <span class="comment">//If there's a section</span>
<a name="l01769"></a>01769         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01770"></a>01770     }
<a name="l01771"></a>01771     <span class="keywordflow">catch</span> (<a class="code" href="classException.html">Exception</a> &amp;e)
<a name="l01772"></a>01772     {
<a name="l01773"></a>01773         <span class="comment">//No section</span>
<a name="l01774"></a>01774         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01775"></a>01775     }
<a name="l01776"></a>01776 }
<a name="l01777"></a>01777 
<a name="l01778"></a><a class="code" href="classHeartConfig.html#10bc06efde462cf251767739cd1b69ac">01778</a> <span class="keywordtype">double</span> <a class="code" href="classHeartConfig.html#10bc06efde462cf251767739cd1b69ac">HeartConfig::GetTargetErrorForAdaptivity</a>()<span class="keyword"> const</span>
<a name="l01779"></a>01779 <span class="keyword"></span>{
<a name="l01780"></a>01780     <span class="keywordflow">if</span> ( <a class="code" href="classHeartConfig.html#facc6a848f43660c4cccfd9b66cc0df2">IsAdaptivityParametersPresent</a>() )
<a name="l01781"></a>01781     {
<a name="l01782"></a>01782         <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().AdaptivityParameters(),
<a name="l01783"></a>01783                                &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Numerical().AdaptivityParameters(),
<a name="l01784"></a>01784                                <span class="stringliteral">"TargetError"</span>)-&gt;<span class="keyword">get</span>().target_error();
<a name="l01785"></a>01785     }
<a name="l01786"></a>01786     <span class="keywordflow">else</span>
<a name="l01787"></a>01787     {
<a name="l01788"></a>01788         <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a>(<span class="stringliteral">"Adaptivity parameters have not been set"</span>);
<a name="l01789"></a>01789     }
<a name="l01790"></a>01790 }
<a name="l01791"></a>01791 
<a name="l01792"></a><a class="code" href="classHeartConfig.html#66fc480d24bc9f8535c89cccd989f9af">01792</a> <span class="keywordtype">double</span> <a class="code" href="classHeartConfig.html#66fc480d24bc9f8535c89cccd989f9af">HeartConfig::GetSigmaForAdaptivity</a>()<span class="keyword"> const</span>
<a name="l01793"></a>01793 <span class="keyword"></span>{
<a name="l01794"></a>01794     <span class="keywordflow">if</span> ( <a class="code" href="classHeartConfig.html#facc6a848f43660c4cccfd9b66cc0df2">IsAdaptivityParametersPresent</a>() )
<a name="l01795"></a>01795     {
<a name="l01796"></a>01796         <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().AdaptivityParameters(),
<a name="l01797"></a>01797                                &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Numerical().AdaptivityParameters(),
<a name="l01798"></a>01798                                <span class="stringliteral">"TargetError"</span>)-&gt;<span class="keyword">get</span>().sigma();
<a name="l01799"></a>01799     }
<a name="l01800"></a>01800     <span class="keywordflow">else</span>
<a name="l01801"></a>01801     {
<a name="l01802"></a>01802         <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a>(<span class="stringliteral">"Adaptivity parameters have not been set"</span>);
<a name="l01803"></a>01803     }
<a name="l01804"></a>01804 }
<a name="l01805"></a>01805 
<a name="l01806"></a><a class="code" href="classHeartConfig.html#89155d1726cbe35f76ade0648e769a4d">01806</a> <span class="keywordtype">double</span> <a class="code" href="classHeartConfig.html#89155d1726cbe35f76ade0648e769a4d">HeartConfig::GetMaxEdgeLengthForAdaptivity</a>()<span class="keyword"> const</span>
<a name="l01807"></a>01807 <span class="keyword"></span>{
<a name="l01808"></a>01808     <span class="keywordflow">if</span> ( <a class="code" href="classHeartConfig.html#facc6a848f43660c4cccfd9b66cc0df2">IsAdaptivityParametersPresent</a>() )
<a name="l01809"></a>01809     {
<a name="l01810"></a>01810     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().AdaptivityParameters(),
<a name="l01811"></a>01811                            &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Numerical().AdaptivityParameters(),
<a name="l01812"></a>01812                            <span class="stringliteral">"TargetError"</span>)-&gt;<span class="keyword">get</span>().max_edge_length();
<a name="l01813"></a>01813     }
<a name="l01814"></a>01814     <span class="keywordflow">else</span>
<a name="l01815"></a>01815     {
<a name="l01816"></a>01816         <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a>(<span class="stringliteral">"Adaptivity parameters have not been set"</span>);
<a name="l01817"></a>01817     }
<a name="l01818"></a>01818 }
<a name="l01819"></a>01819 
<a name="l01820"></a><a class="code" href="classHeartConfig.html#dcae58747ee8057177bc063ce4b9cc3b">01820</a> <span class="keywordtype">double</span> <a class="code" href="classHeartConfig.html#dcae58747ee8057177bc063ce4b9cc3b">HeartConfig::GetMinEdgeLengthForAdaptivity</a>()<span class="keyword"> const</span>
<a name="l01821"></a>01821 <span class="keyword"></span>{
<a name="l01822"></a>01822     <span class="keywordflow">if</span> ( <a class="code" href="classHeartConfig.html#facc6a848f43660c4cccfd9b66cc0df2">IsAdaptivityParametersPresent</a>() )
<a name="l01823"></a>01823     {
<a name="l01824"></a>01824         <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().AdaptivityParameters(),
<a name="l01825"></a>01825                                &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Numerical().AdaptivityParameters(),
<a name="l01826"></a>01826                                <span class="stringliteral">"TargetError"</span>)-&gt;<span class="keyword">get</span>().min_edge_length();
<a name="l01827"></a>01827     }
<a name="l01828"></a>01828     <span class="keywordflow">else</span>
<a name="l01829"></a>01829     {
<a name="l01830"></a>01830         <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a>(<span class="stringliteral">"Adaptivity parameters have not been set"</span>);
<a name="l01831"></a>01831     }
<a name="l01832"></a>01832 }
<a name="l01833"></a>01833 
<a name="l01834"></a><a class="code" href="classHeartConfig.html#a5bca3744b53e11ec99ad2f3dc259600">01834</a> <span class="keywordtype">double</span> <a class="code" href="classHeartConfig.html#a5bca3744b53e11ec99ad2f3dc259600">HeartConfig::GetGradationForAdaptivity</a>()<span class="keyword"> const</span>
<a name="l01835"></a>01835 <span class="keyword"></span>{
<a name="l01836"></a>01836     <span class="keywordflow">if</span> ( <a class="code" href="classHeartConfig.html#facc6a848f43660c4cccfd9b66cc0df2">IsAdaptivityParametersPresent</a>() )
<a name="l01837"></a>01837     {
<a name="l01838"></a>01838         <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().AdaptivityParameters(),
<a name="l01839"></a>01839                                &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Numerical().AdaptivityParameters(),
<a name="l01840"></a>01840                                <span class="stringliteral">"TargetError"</span>)-&gt;<span class="keyword">get</span>().gradation();
<a name="l01841"></a>01841     }
<a name="l01842"></a>01842     <span class="keywordflow">else</span>
<a name="l01843"></a>01843     {
<a name="l01844"></a>01844         <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a>(<span class="stringliteral">"Adaptivity parameters have not been set"</span>);
<a name="l01845"></a>01845     }
<a name="l01846"></a>01846 }
<a name="l01847"></a>01847 
<a name="l01848"></a><a class="code" href="classHeartConfig.html#4e47a91fa230dda4fb4a708b546c5c2e">01848</a> <span class="keywordtype">unsigned</span> <a class="code" href="classHeartConfig.html#4e47a91fa230dda4fb4a708b546c5c2e">HeartConfig::GetMaxNodesForAdaptivity</a>()<span class="keyword"> const</span>
<a name="l01849"></a>01849 <span class="keyword"></span>{
<a name="l01850"></a>01850     <span class="keywordflow">if</span> ( <a class="code" href="classHeartConfig.html#facc6a848f43660c4cccfd9b66cc0df2">IsAdaptivityParametersPresent</a>() )
<a name="l01851"></a>01851     {
<a name="l01852"></a>01852         <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().AdaptivityParameters(),
<a name="l01853"></a>01853                                &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Numerical().AdaptivityParameters(),
<a name="l01854"></a>01854                                <span class="stringliteral">"TargetError"</span>)-&gt;<span class="keyword">get</span>().max_nodes();
<a name="l01855"></a>01855     }
<a name="l01856"></a>01856     <span class="keywordflow">else</span>
<a name="l01857"></a>01857     {
<a name="l01858"></a>01858         <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a>(<span class="stringliteral">"Adaptivity parameters have not been set"</span>);
<a name="l01859"></a>01859     }
<a name="l01860"></a>01860 }
<a name="l01861"></a>01861 
<a name="l01862"></a><a class="code" href="classHeartConfig.html#2dd2113b9c0b0ec6e1f86de50727cbf2">01862</a> <span class="keywordtype">unsigned</span> <a class="code" href="classHeartConfig.html#2dd2113b9c0b0ec6e1f86de50727cbf2">HeartConfig::GetNumberOfAdaptiveSweeps</a>()<span class="keyword"> const</span>
<a name="l01863"></a>01863 <span class="keyword"></span>{
<a name="l01864"></a>01864     <span class="keywordflow">if</span> ( <a class="code" href="classHeartConfig.html#facc6a848f43660c4cccfd9b66cc0df2">IsAdaptivityParametersPresent</a>() )
<a name="l01865"></a>01865     {
<a name="l01866"></a>01866         <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().AdaptivityParameters(),
<a name="l01867"></a>01867                                &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Numerical().AdaptivityParameters(),
<a name="l01868"></a>01868                                <span class="stringliteral">"TargetError"</span>)-&gt;<span class="keyword">get</span>().num_sweeps();
<a name="l01869"></a>01869     }
<a name="l01870"></a>01870     <span class="keywordflow">else</span>
<a name="l01871"></a>01871     {
<a name="l01872"></a>01872         <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a>(<span class="stringliteral">"Adaptivity parameters have not been set"</span>);
<a name="l01873"></a>01873     }
<a name="l01874"></a>01874 }
<a name="l01875"></a>01875 
<a name="l01876"></a>01876 <span class="comment">/*</span>
<a name="l01877"></a>01877 <span class="comment"> * PostProcessing</span>
<a name="l01878"></a>01878 <span class="comment"> */</span>
<a name="l01879"></a>01879 
<a name="l01880"></a><a class="code" href="classHeartConfig.html#1a13023d984e6bcab3faa854847654ce">01880</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#1a13023d984e6bcab3faa854847654ce">HeartConfig::IsPostProcessingSectionPresent</a>()<span class="keyword"> const</span>
<a name="l01881"></a>01881 <span class="keyword"></span>{
<a name="l01882"></a>01882     <span class="keywordflow">try</span>
<a name="l01883"></a>01883     {
<a name="l01884"></a>01884         <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;PostProcessing(),
<a name="l01885"></a>01885                         &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;PostProcessing(),
<a name="l01886"></a>01886                         <span class="stringliteral">"PostProcessing"</span>)-&gt;present();
<a name="l01887"></a>01887         <span class="comment">//If there's a section</span>
<a name="l01888"></a>01888         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01889"></a>01889     }
<a name="l01890"></a>01890     <span class="keywordflow">catch</span> (<a class="code" href="classException.html">Exception</a> &amp;e)
<a name="l01891"></a>01891     {
<a name="l01892"></a>01892         <span class="comment">//No section</span>
<a name="l01893"></a>01893         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01894"></a>01894     }
<a name="l01895"></a>01895 }
<a name="l01896"></a>01896 
<a name="l01897"></a><a class="code" href="classHeartConfig.html#66b61cef16319298971d3961516229db">01897</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#66b61cef16319298971d3961516229db">HeartConfig::EnsurePostProcessingSectionPresent</a>()
<a name="l01898"></a>01898 {
<a name="l01899"></a>01899     ENSURE_SECTION_PRESENT(<a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;PostProcessing(), cp::postprocessing_type);
<a name="l01900"></a>01900 }
<a name="l01901"></a>01901 
<a name="l01902"></a><a class="code" href="classHeartConfig.html#a82a9d7071771f54527f2d749f428247">01902</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#a82a9d7071771f54527f2d749f428247">HeartConfig::IsPostProcessingRequested</a>()<span class="keyword"> const</span>
<a name="l01903"></a>01903 <span class="keyword"></span>{
<a name="l01904"></a>01904     <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#1a13023d984e6bcab3faa854847654ce">IsPostProcessingSectionPresent</a>() == <span class="keyword">false</span>)
<a name="l01905"></a>01905     {
<a name="l01906"></a>01906         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01907"></a>01907     }
<a name="l01908"></a>01908     <span class="keywordflow">else</span>
<a name="l01909"></a>01909     {
<a name="l01910"></a>01910         <span class="keywordflow">return</span>(<a class="code" href="classHeartConfig.html#d6f240f8dc2d4158afa69fd3a7da9a15">IsApdMapsRequested</a>() ||
<a name="l01911"></a>01911                <a class="code" href="classHeartConfig.html#38b9c3b57116747edcf71fd6d78029d5">IsUpstrokeTimeMapsRequested</a>() ||
<a name="l01912"></a>01912                <a class="code" href="classHeartConfig.html#b8fa3c6d5dfada90205d5a6458d56d30">IsMaxUpstrokeVelocityMapRequested</a>() ||
<a name="l01913"></a>01913                <a class="code" href="classHeartConfig.html#e842eee4b5d015df2d193d11857efb91">IsConductionVelocityMapsRequested</a>() ||
<a name="l01914"></a>01914                <a class="code" href="classHeartConfig.html#d88df76b31578cd3c311465294c5dafa">IsAnyNodalTimeTraceRequested</a>()||
<a name="l01915"></a>01915                <a class="code" href="classHeartConfig.html#7700d433bf452eeb7074894bf298f944">IsPseudoEcgCalculationRequested</a>());
<a name="l01916"></a>01916     }
<a name="l01917"></a>01917 }
<a name="l01918"></a><a class="code" href="classHeartConfig.html#d6f240f8dc2d4158afa69fd3a7da9a15">01918</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#d6f240f8dc2d4158afa69fd3a7da9a15">HeartConfig::IsApdMapsRequested</a>()<span class="keyword"> const</span>
<a name="l01919"></a>01919 <span class="keyword"></span>{
<a name="l01920"></a>01920     assert(<a class="code" href="classHeartConfig.html#1a13023d984e6bcab3faa854847654ce">IsPostProcessingSectionPresent</a>());
<a name="l01921"></a>01921 
<a name="l01922"></a>01922     XSD_SEQUENCE_TYPE(cp::postprocessing_type::ActionPotentialDurationMap)&amp;
<a name="l01923"></a>01923         apd_maps = <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;PostProcessing(),
<a name="l01924"></a>01924                                    &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;PostProcessing(),
<a name="l01925"></a>01925                                    <span class="stringliteral">"ActionPotentialDurationMap"</span>)-&gt;<span class="keyword">get</span>().ActionPotentialDurationMap();
<a name="l01926"></a>01926     <span class="keywordflow">return</span> (apd_maps.begin() != apd_maps.end());
<a name="l01927"></a>01927 }
<a name="l01928"></a>01928 
<a name="l01929"></a><a class="code" href="classHeartConfig.html#be0cb02e588ffafe5a957f8dd7b062e5">01929</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#be0cb02e588ffafe5a957f8dd7b062e5">HeartConfig::GetApdMaps</a>(std::vector&lt;std::pair&lt;double,double&gt; &gt;&amp; apd_maps)<span class="keyword"> const</span>
<a name="l01930"></a>01930 <span class="keyword"></span>{
<a name="l01931"></a>01931     assert(<a class="code" href="classHeartConfig.html#d6f240f8dc2d4158afa69fd3a7da9a15">IsApdMapsRequested</a>());
<a name="l01932"></a>01932     apd_maps.clear();
<a name="l01933"></a>01933 
<a name="l01934"></a>01934     XSD_SEQUENCE_TYPE(cp::postprocessing_type::ActionPotentialDurationMap)&amp;
<a name="l01935"></a>01935         apd_maps_sequence = <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;PostProcessing(),
<a name="l01936"></a>01936                                             &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;PostProcessing(),
<a name="l01937"></a>01937                                             <span class="stringliteral">"ActionPotentialDurationMap"</span>)-&gt;<span class="keyword">get</span>().ActionPotentialDurationMap();
<a name="l01938"></a>01938 
<a name="l01939"></a>01939     <span class="keywordflow">for</span> (XSD_ITERATOR_TYPE(cp::postprocessing_type::ActionPotentialDurationMap) i = apd_maps_sequence.begin();
<a name="l01940"></a>01940          i != apd_maps_sequence.end();
<a name="l01941"></a>01941          ++i)
<a name="l01942"></a>01942     {
<a name="l01943"></a>01943         std::pair&lt;double,double&gt; map(i-&gt;repolarisation_percentage(),i-&gt;threshold());
<a name="l01944"></a>01944 
<a name="l01945"></a>01945         apd_maps.push_back(map);
<a name="l01946"></a>01946     }
<a name="l01947"></a>01947 }
<a name="l01948"></a>01948 
<a name="l01949"></a><a class="code" href="classHeartConfig.html#38b9c3b57116747edcf71fd6d78029d5">01949</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#38b9c3b57116747edcf71fd6d78029d5">HeartConfig::IsUpstrokeTimeMapsRequested</a>()<span class="keyword"> const</span>
<a name="l01950"></a>01950 <span class="keyword"></span>{
<a name="l01951"></a>01951     assert(<a class="code" href="classHeartConfig.html#1a13023d984e6bcab3faa854847654ce">IsPostProcessingSectionPresent</a>());
<a name="l01952"></a>01952 
<a name="l01953"></a>01953     XSD_SEQUENCE_TYPE(cp::postprocessing_type::UpstrokeTimeMap)&amp;
<a name="l01954"></a>01954         upstroke_map = <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;PostProcessing(),
<a name="l01955"></a>01955                                        &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;PostProcessing(),
<a name="l01956"></a>01956                                        <span class="stringliteral">"UpstrokeTimeMap"</span>)-&gt;<span class="keyword">get</span>().UpstrokeTimeMap();
<a name="l01957"></a>01957     <span class="keywordflow">return</span> (upstroke_map.begin() != upstroke_map.end());
<a name="l01958"></a>01958 }
<a name="l01959"></a><a class="code" href="classHeartConfig.html#62bf3cc55cf750ade86634a067a2879d">01959</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#62bf3cc55cf750ade86634a067a2879d">HeartConfig::GetUpstrokeTimeMaps</a> (std::vector&lt;double&gt;&amp; upstroke_time_maps)<span class="keyword"> const</span>
<a name="l01960"></a>01960 <span class="keyword"></span>{
<a name="l01961"></a>01961     assert(<a class="code" href="classHeartConfig.html#38b9c3b57116747edcf71fd6d78029d5">IsUpstrokeTimeMapsRequested</a>());
<a name="l01962"></a>01962     assert(upstroke_time_maps.size() == 0);
<a name="l01963"></a>01963 
<a name="l01964"></a>01964     XSD_SEQUENCE_TYPE(cp::postprocessing_type::UpstrokeTimeMap)&amp;
<a name="l01965"></a>01965         upstroke_maps_sequence = <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;PostProcessing(),
<a name="l01966"></a>01966                                                  &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;PostProcessing(),
<a name="l01967"></a>01967                                                  <span class="stringliteral">"UpstrokeTimeMap"</span>)-&gt;<span class="keyword">get</span>().UpstrokeTimeMap();
<a name="l01968"></a>01968 
<a name="l01969"></a>01969     <span class="keywordflow">for</span> (XSD_ITERATOR_TYPE(cp::postprocessing_type::UpstrokeTimeMap) i = upstroke_maps_sequence.begin();
<a name="l01970"></a>01970          i != upstroke_maps_sequence.end();
<a name="l01971"></a>01971          ++i)
<a name="l01972"></a>01972     {
<a name="l01973"></a>01973         upstroke_time_maps.push_back(i-&gt;threshold());
<a name="l01974"></a>01974     }
<a name="l01975"></a>01975 }
<a name="l01976"></a>01976 
<a name="l01977"></a><a class="code" href="classHeartConfig.html#b8fa3c6d5dfada90205d5a6458d56d30">01977</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#b8fa3c6d5dfada90205d5a6458d56d30">HeartConfig::IsMaxUpstrokeVelocityMapRequested</a>()<span class="keyword"> const</span>
<a name="l01978"></a>01978 <span class="keyword"></span>{
<a name="l01979"></a>01979     assert(<a class="code" href="classHeartConfig.html#1a13023d984e6bcab3faa854847654ce">IsPostProcessingSectionPresent</a>());
<a name="l01980"></a>01980 
<a name="l01981"></a>01981     XSD_SEQUENCE_TYPE(cp::postprocessing_type::MaxUpstrokeVelocityMap)&amp;
<a name="l01982"></a>01982         max_upstroke_velocity_map = <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;PostProcessing(),
<a name="l01983"></a>01983                                                     &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;PostProcessing(),
<a name="l01984"></a>01984                                                     <span class="stringliteral">"MaxUpstrokeVelocityMap"</span>)-&gt;<span class="keyword">get</span>().MaxUpstrokeVelocityMap();
<a name="l01985"></a>01985 
<a name="l01986"></a>01986     <span class="keywordflow">return</span> (max_upstroke_velocity_map.begin() != max_upstroke_velocity_map.end());
<a name="l01987"></a>01987 }
<a name="l01988"></a>01988 
<a name="l01989"></a><a class="code" href="classHeartConfig.html#c7932ae837fc69987edcf13c9b0b8b63">01989</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#c7932ae837fc69987edcf13c9b0b8b63">HeartConfig::GetMaxUpstrokeVelocityMaps</a>(std::vector&lt;double&gt;&amp; upstroke_velocity_maps)<span class="keyword"> const</span>
<a name="l01990"></a>01990 <span class="keyword"></span>{
<a name="l01991"></a>01991     assert(<a class="code" href="classHeartConfig.html#b8fa3c6d5dfada90205d5a6458d56d30">IsMaxUpstrokeVelocityMapRequested</a>());
<a name="l01992"></a>01992     assert(upstroke_velocity_maps.size() == 0);
<a name="l01993"></a>01993 
<a name="l01994"></a>01994     XSD_SEQUENCE_TYPE(cp::postprocessing_type::MaxUpstrokeVelocityMap)&amp;
<a name="l01995"></a>01995         max_upstroke_velocity_maps_sequence = <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;PostProcessing(),
<a name="l01996"></a>01996                                                               &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;PostProcessing(),
<a name="l01997"></a>01997                                                               <span class="stringliteral">"MaxUpstrokeVelocityMap"</span>)-&gt;<span class="keyword">get</span>().MaxUpstrokeVelocityMap();
<a name="l01998"></a>01998 
<a name="l01999"></a>01999     <span class="keywordflow">for</span> (XSD_ITERATOR_TYPE(cp::postprocessing_type::MaxUpstrokeVelocityMap) i = max_upstroke_velocity_maps_sequence.begin();
<a name="l02000"></a>02000          i != max_upstroke_velocity_maps_sequence.end();
<a name="l02001"></a>02001          ++i)
<a name="l02002"></a>02002     {
<a name="l02003"></a>02003         upstroke_velocity_maps.push_back(i-&gt;threshold());
<a name="l02004"></a>02004     }
<a name="l02005"></a>02005 }
<a name="l02006"></a>02006 
<a name="l02007"></a><a class="code" href="classHeartConfig.html#e842eee4b5d015df2d193d11857efb91">02007</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#e842eee4b5d015df2d193d11857efb91">HeartConfig::IsConductionVelocityMapsRequested</a>()<span class="keyword"> const</span>
<a name="l02008"></a>02008 <span class="keyword"></span>{
<a name="l02009"></a>02009     assert(<a class="code" href="classHeartConfig.html#1a13023d984e6bcab3faa854847654ce">IsPostProcessingSectionPresent</a>());
<a name="l02010"></a>02010 
<a name="l02011"></a>02011     XSD_SEQUENCE_TYPE(cp::postprocessing_type::ConductionVelocityMap)&amp;
<a name="l02012"></a>02012         cond_vel_maps = <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;PostProcessing(),
<a name="l02013"></a>02013                                         &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;PostProcessing(),
<a name="l02014"></a>02014                                         <span class="stringliteral">"ConductionVelocityMap"</span>)-&gt;<span class="keyword">get</span>().ConductionVelocityMap();
<a name="l02015"></a>02015     <span class="keywordflow">return</span> (cond_vel_maps.begin() != cond_vel_maps.end());
<a name="l02016"></a>02016 }
<a name="l02017"></a>02017 
<a name="l02018"></a><a class="code" href="classHeartConfig.html#24b7f74f55bac1bf28db2f9292df9048">02018</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#24b7f74f55bac1bf28db2f9292df9048">HeartConfig::GetConductionVelocityMaps</a>(std::vector&lt;unsigned&gt;&amp; conduction_velocity_maps)<span class="keyword"> const</span>
<a name="l02019"></a>02019 <span class="keyword"></span>{
<a name="l02020"></a>02020     assert(<a class="code" href="classHeartConfig.html#e842eee4b5d015df2d193d11857efb91">IsConductionVelocityMapsRequested</a>());
<a name="l02021"></a>02021     assert(conduction_velocity_maps.size() == 0);
<a name="l02022"></a>02022 
<a name="l02023"></a>02023     XSD_SEQUENCE_TYPE(cp::postprocessing_type::ConductionVelocityMap)&amp;
<a name="l02024"></a>02024         cond_vel_maps_sequence = <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;PostProcessing(),
<a name="l02025"></a>02025                                                  &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;PostProcessing(),
<a name="l02026"></a>02026                                                  <span class="stringliteral">"ConductionVelocityMap"</span>)-&gt;<span class="keyword">get</span>().ConductionVelocityMap();
<a name="l02027"></a>02027 
<a name="l02028"></a>02028     <span class="keywordflow">for</span> (XSD_ITERATOR_TYPE(cp::postprocessing_type::ConductionVelocityMap) i = cond_vel_maps_sequence.begin();
<a name="l02029"></a>02029          i != cond_vel_maps_sequence.end();
<a name="l02030"></a>02030          ++i)
<a name="l02031"></a>02031     {
<a name="l02032"></a>02032         conduction_velocity_maps.push_back(i-&gt;origin_node());
<a name="l02033"></a>02033     }
<a name="l02034"></a>02034 }
<a name="l02035"></a>02035 
<a name="l02036"></a><a class="code" href="classHeartConfig.html#d88df76b31578cd3c311465294c5dafa">02036</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#d88df76b31578cd3c311465294c5dafa">HeartConfig::IsAnyNodalTimeTraceRequested</a>()<span class="keyword"> const</span>
<a name="l02037"></a>02037 <span class="keyword"></span>{
<a name="l02038"></a>02038     assert(<a class="code" href="classHeartConfig.html#1a13023d984e6bcab3faa854847654ce">IsPostProcessingSectionPresent</a>());
<a name="l02039"></a>02039 
<a name="l02040"></a>02040     XSD_SEQUENCE_TYPE(cp::postprocessing_type::TimeTraceAtNode)&amp;
<a name="l02041"></a>02041         requested_nodes = <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;PostProcessing(),
<a name="l02042"></a>02042                                         &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;PostProcessing(),
<a name="l02043"></a>02043                                         <span class="stringliteral">"TimeTraceAtNode"</span>)-&gt;<span class="keyword">get</span>().TimeTraceAtNode();
<a name="l02044"></a>02044     <span class="keywordflow">return</span> (requested_nodes.begin() != requested_nodes.end());
<a name="l02045"></a>02045 }
<a name="l02046"></a>02046 
<a name="l02047"></a><a class="code" href="classHeartConfig.html#8b7c2468f9eea50704aac2c5193b7226">02047</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#8b7c2468f9eea50704aac2c5193b7226">HeartConfig::GetNodalTimeTraceRequested</a>(std::vector&lt;unsigned&gt;&amp; rRequestedNodes)<span class="keyword"> const</span>
<a name="l02048"></a>02048 <span class="keyword"></span>{
<a name="l02049"></a>02049     assert(<a class="code" href="classHeartConfig.html#d88df76b31578cd3c311465294c5dafa">IsAnyNodalTimeTraceRequested</a>());
<a name="l02050"></a>02050     assert(rRequestedNodes.size() == 0);
<a name="l02051"></a>02051 
<a name="l02052"></a>02052     XSD_SEQUENCE_TYPE(cp::postprocessing_type::TimeTraceAtNode)&amp;
<a name="l02053"></a>02053         req_nodes = <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;PostProcessing(),
<a name="l02054"></a>02054                                           &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;PostProcessing(),
<a name="l02055"></a>02055                                           <span class="stringliteral">"TimeTraceAtNode"</span>)-&gt;<span class="keyword">get</span>().TimeTraceAtNode();
<a name="l02056"></a>02056 
<a name="l02057"></a>02057     <span class="keywordflow">for</span> (XSD_ITERATOR_TYPE(cp::postprocessing_type::TimeTraceAtNode) i = req_nodes.begin();
<a name="l02058"></a>02058          i != req_nodes.end();
<a name="l02059"></a>02059          ++i)
<a name="l02060"></a>02060     {
<a name="l02061"></a>02061         rRequestedNodes.push_back(i-&gt;node_number());
<a name="l02062"></a>02062     }
<a name="l02063"></a>02063 }
<a name="l02064"></a>02064 
<a name="l02065"></a>02065 
<a name="l02066"></a><a class="code" href="classHeartConfig.html#7700d433bf452eeb7074894bf298f944">02066</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#7700d433bf452eeb7074894bf298f944">HeartConfig::IsPseudoEcgCalculationRequested</a>()<span class="keyword"> const</span>
<a name="l02067"></a>02067 <span class="keyword"></span>{
<a name="l02068"></a>02068     assert(<a class="code" href="classHeartConfig.html#1a13023d984e6bcab3faa854847654ce">IsPostProcessingSectionPresent</a>());
<a name="l02069"></a>02069 
<a name="l02070"></a>02070     XSD_SEQUENCE_TYPE(cp::postprocessing_type::PseudoEcgElectrodePosition)&amp;
<a name="l02071"></a>02071         electrodes = <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;PostProcessing(),
<a name="l02072"></a>02072                                      &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;PostProcessing(),
<a name="l02073"></a>02073                                      <span class="stringliteral">"PseudoEcgElectrodePosition"</span>)-&gt;<span class="keyword">get</span>().PseudoEcgElectrodePosition();
<a name="l02074"></a>02074     <span class="keywordflow">return</span> (electrodes.begin() != electrodes.end());
<a name="l02075"></a>02075 }
<a name="l02076"></a>02076 
<a name="l02077"></a>02077 <span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> SPACE_DIM&gt;
<a name="l02078"></a><a class="code" href="classHeartConfig.html#28e2c87ca9ef53288b40a12e724b01a5">02078</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#28e2c87ca9ef53288b40a12e724b01a5">HeartConfig::GetPseudoEcgElectrodePositions</a>(std::vector&lt;<a class="code" href="classChastePoint.html">ChastePoint&lt;SPACE_DIM&gt;</a> &gt;&amp; rPseudoEcgElectrodePositions)<span class="keyword"> const</span>
<a name="l02079"></a>02079 <span class="keyword"></span>{
<a name="l02080"></a>02080     rPseudoEcgElectrodePositions.clear();
<a name="l02081"></a>02081     XSD_SEQUENCE_TYPE(cp::postprocessing_type::PseudoEcgElectrodePosition)&amp;
<a name="l02082"></a>02082         electrodes = <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;PostProcessing(),
<a name="l02083"></a>02083                                      &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;PostProcessing(),
<a name="l02084"></a>02084                                      <span class="stringliteral">"PseudoEcgElectrodePosition"</span>)-&gt;<span class="keyword">get</span>().PseudoEcgElectrodePosition();
<a name="l02085"></a>02085     <span class="keywordflow">for</span> (XSD_ITERATOR_TYPE(cp::postprocessing_type::PseudoEcgElectrodePosition) i = electrodes.begin();
<a name="l02086"></a>02086          i != electrodes.end();
<a name="l02087"></a>02087          ++i)
<a name="l02088"></a>02088     {
<a name="l02089"></a>02089         rPseudoEcgElectrodePositions.push_back(<a class="code" href="classChastePoint.html">ChastePoint&lt;SPACE_DIM&gt;</a>(i-&gt;x(), i-&gt;y(), i-&gt;z()));
<a name="l02090"></a>02090     }
<a name="l02091"></a>02091 }
<a name="l02092"></a>02092 
<a name="l02093"></a>02093 
<a name="l02094"></a>02094 <span class="comment">/*</span>
<a name="l02095"></a>02095 <span class="comment"> * Output visualization</span>
<a name="l02096"></a>02096 <span class="comment"> */</span>
<a name="l02097"></a>02097 
<a name="l02098"></a><a class="code" href="classHeartConfig.html#3010845819f8f64a7d98f5fa022ea094">02098</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#3010845819f8f64a7d98f5fa022ea094">HeartConfig::IsOutputVisualizerPresent</a>()<span class="keyword"> const</span>
<a name="l02099"></a>02099 <span class="keyword"></span>{
<a name="l02100"></a>02100     <a class="code" href="classHeartConfig.html#ab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">"OutputVisualizer"</span>);
<a name="l02101"></a>02101 
<a name="l02102"></a>02102     <span class="keywordflow">try</span>
<a name="l02103"></a>02103     {
<a name="l02104"></a>02104         <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;OutputVisualizer(),
<a name="l02105"></a>02105                         &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation()-&gt;OutputVisualizer(),
<a name="l02106"></a>02106                         <span class="stringliteral">"OutputVisualizer"</span>)-&gt;present();
<a name="l02107"></a>02107         <span class="comment">// If there's an element</span>
<a name="l02108"></a>02108         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l02109"></a>02109     }
<a name="l02110"></a>02110     <span class="keywordflow">catch</span> (<a class="code" href="classException.html">Exception</a> &amp;e)
<a name="l02111"></a>02111     {
<a name="l02112"></a>02112         <span class="comment">// No element</span>
<a name="l02113"></a>02113         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02114"></a>02114     }
<a name="l02115"></a>02115 }
<a name="l02116"></a>02116 
<a name="l02117"></a><a class="code" href="classHeartConfig.html#5a6cd032e69ae941458277195ee966a2">02117</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#5a6cd032e69ae941458277195ee966a2">HeartConfig::GetVisualizeWithMeshalyzer</a>()<span class="keyword"> const</span>
<a name="l02118"></a>02118 <span class="keyword"></span>{
<a name="l02119"></a>02119     <span class="keywordflow">if</span> (!<a class="code" href="classHeartConfig.html#3010845819f8f64a7d98f5fa022ea094">IsOutputVisualizerPresent</a>())
<a name="l02120"></a>02120     {
<a name="l02121"></a>02121         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l02122"></a>02122     }
<a name="l02123"></a>02123     <span class="keywordflow">else</span>
<a name="l02124"></a>02124     {
<a name="l02125"></a>02125         <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;OutputVisualizer(),
<a name="l02126"></a>02126                                &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation()-&gt;OutputVisualizer(),
<a name="l02127"></a>02127                                <span class="stringliteral">"OutputVisualizer"</span>)-&gt;<span class="keyword">get</span>().meshalyzer() == cp::yesno_type::yes;
<a name="l02128"></a>02128     }
<a name="l02129"></a>02129 }
<a name="l02130"></a>02130 
<a name="l02131"></a><a class="code" href="classHeartConfig.html#6d9e677168ec7c1de59d35254bb71faa">02131</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#6d9e677168ec7c1de59d35254bb71faa">HeartConfig::GetVisualizeWithCmgui</a>()<span class="keyword"> const</span>
<a name="l02132"></a>02132 <span class="keyword"></span>{
<a name="l02133"></a>02133     <span class="keywordflow">if</span> (!<a class="code" href="classHeartConfig.html#3010845819f8f64a7d98f5fa022ea094">IsOutputVisualizerPresent</a>())
<a name="l02134"></a>02134     {
<a name="l02135"></a>02135         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02136"></a>02136     }
<a name="l02137"></a>02137     <span class="keywordflow">else</span>
<a name="l02138"></a>02138     {
<a name="l02139"></a>02139         <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;OutputVisualizer(),
<a name="l02140"></a>02140                                &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation()-&gt;OutputVisualizer(),
<a name="l02141"></a>02141                                <span class="stringliteral">"OutputVisualizer"</span>)-&gt;<span class="keyword">get</span>().cmgui() == cp::yesno_type::yes;
<a name="l02142"></a>02142     }
<a name="l02143"></a>02143 }
<a name="l02144"></a>02144 
<a name="l02145"></a><a class="code" href="classHeartConfig.html#ce22a245e446f9170c36261ee807c80f">02145</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#ce22a245e446f9170c36261ee807c80f">HeartConfig::GetVisualizeWithParallelVtk</a>()<span class="keyword"> const</span>
<a name="l02146"></a>02146 <span class="keyword"></span>{
<a name="l02147"></a>02147     <span class="keywordflow">if</span> (!<a class="code" href="classHeartConfig.html#3010845819f8f64a7d98f5fa022ea094">IsOutputVisualizerPresent</a>())
<a name="l02148"></a>02148     {
<a name="l02149"></a>02149         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02150"></a>02150     }
<a name="l02151"></a>02151     <span class="keywordflow">else</span>
<a name="l02152"></a>02152     {
<a name="l02153"></a>02153         <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;OutputVisualizer(),
<a name="l02154"></a>02154                                &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation()-&gt;OutputVisualizer(),
<a name="l02155"></a>02155                                <span class="stringliteral">"OutputVisualizer"</span>)-&gt;<span class="keyword">get</span>().parallel_vtk() == cp::yesno_type::yes;
<a name="l02156"></a>02156     }
<a name="l02157"></a>02157 }
<a name="l02158"></a>02158 
<a name="l02159"></a><a class="code" href="classHeartConfig.html#ee1957a338ff90ace79271fda5cd3798">02159</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#ee1957a338ff90ace79271fda5cd3798">HeartConfig::GetVisualizeWithVtk</a>()<span class="keyword"> const</span>
<a name="l02160"></a>02160 <span class="keyword"></span>{
<a name="l02161"></a>02161     <span class="keywordflow">if</span> (!<a class="code" href="classHeartConfig.html#3010845819f8f64a7d98f5fa022ea094">IsOutputVisualizerPresent</a>())
<a name="l02162"></a>02162     {
<a name="l02163"></a>02163         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02164"></a>02164     }
<a name="l02165"></a>02165     <span class="keywordflow">else</span>
<a name="l02166"></a>02166     {
<a name="l02167"></a>02167         <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;OutputVisualizer(),
<a name="l02168"></a>02168                                &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation()-&gt;OutputVisualizer(),
<a name="l02169"></a>02169                                <span class="stringliteral">"OutputVisualizer"</span>)-&gt;<span class="keyword">get</span>().vtk() == cp::yesno_type::yes;
<a name="l02170"></a>02170     }
<a name="l02171"></a>02171 }
<a name="l02172"></a>02172 
<a name="l02173"></a><a class="code" href="classHeartConfig.html#e8af113affbf405e11b536a995bb8530">02173</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#e8af113affbf405e11b536a995bb8530">HeartConfig::IsElectrodesPresent</a>()<span class="keyword"> const</span>
<a name="l02174"></a>02174 <span class="keyword"></span>{
<a name="l02175"></a>02175     <span class="keywordflow">try</span>
<a name="l02176"></a>02176     {
<a name="l02177"></a>02177         <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;Electrodes(),
<a name="l02178"></a>02178                         &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation()-&gt;Electrodes(),
<a name="l02179"></a>02179                         <span class="stringliteral">"Electrodes"</span>)-&gt;present();
<a name="l02180"></a>02180         <span class="comment">//If there's a section</span>
<a name="l02181"></a>02181         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l02182"></a>02182     }
<a name="l02183"></a>02183     <span class="keywordflow">catch</span> (<a class="code" href="classException.html">Exception</a> &amp;e)
<a name="l02184"></a>02184     {
<a name="l02185"></a>02185         <span class="comment">//No section</span>
<a name="l02186"></a>02186         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02187"></a>02187     }
<a name="l02188"></a>02188 }
<a name="l02189"></a>02189 
<a name="l02190"></a>02190 <span class="comment">/*</span>
<a name="l02191"></a>02191 <span class="comment"> *  Set methods</span>
<a name="l02192"></a>02192 <span class="comment"> */</span>
<a name="l02193"></a><a class="code" href="classHeartConfig.html#81e1ccab8ab0b3fa759f781a9690e42e">02193</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#81e1ccab8ab0b3fa759f781a9690e42e">HeartConfig::SetSpaceDimension</a>(<span class="keywordtype">unsigned</span> spaceDimension)
<a name="l02194"></a>02194 {
<a name="l02195"></a>02195     <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;SpaceDimension().set(spaceDimension);
<a name="l02196"></a>02196 }
<a name="l02197"></a>02197 
<a name="l02198"></a><a class="code" href="classHeartConfig.html#ad5f6297757ec9b088e6ef56b9a71686">02198</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#ad5f6297757ec9b088e6ef56b9a71686">HeartConfig::SetSimulationDuration</a>(<span class="keywordtype">double</span> simulationDuration)
<a name="l02199"></a>02199 {
<a name="l02200"></a>02200     XSD_CREATE_WITH_FIXED_ATTR1(cp::time_type, time, simulationDuration, <span class="stringliteral">"ms"</span>);
<a name="l02201"></a>02201     <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;SimulationDuration().set(time);
<a name="l02202"></a>02202 }
<a name="l02203"></a>02203 
<a name="l02204"></a><a class="code" href="classHeartConfig.html#6b0caf98b061c8f132b17d272fc6da2d">02204</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#6b0caf98b061c8f132b17d272fc6da2d">HeartConfig::SetDomain</a>(<span class="keyword">const</span> cp::domain_type&amp; rDomain)
<a name="l02205"></a>02205 {
<a name="l02206"></a>02206     <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;Domain().set(rDomain);
<a name="l02207"></a>02207 }
<a name="l02208"></a>02208 
<a name="l02209"></a><a class="code" href="classHeartConfig.html#315563a68be5dd8d00824a2b556239d8">02209</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#315563a68be5dd8d00824a2b556239d8">HeartConfig::SetDefaultIonicModel</a>(<span class="keyword">const</span> cp::ionic_models_available_type&amp; rIonicModel)
<a name="l02210"></a>02210 {
<a name="l02211"></a>02211     cp::ionic_model_selection_type ionic_model;
<a name="l02212"></a>02212     ionic_model.Hardcoded(rIonicModel);
<a name="l02213"></a>02213     cp::ionic_models_type container(ionic_model);
<a name="l02214"></a>02214     <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;IonicModels().set(container);
<a name="l02215"></a>02215 }
<a name="l02216"></a>02216 
<a name="l02217"></a><a class="code" href="classHeartConfig.html#81d05b3efe45ab56d22b304bbee0be38">02217</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#81d05b3efe45ab56d22b304bbee0be38">HeartConfig::SetSlabDimensions</a>(<span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y, <span class="keywordtype">double</span> z, <span class="keywordtype">double</span> inter_node_space)
<a name="l02218"></a>02218 {
<a name="l02219"></a>02219     <span class="keywordflow">if</span> ( ! <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;Mesh().present())
<a name="l02220"></a>02220     {
<a name="l02221"></a>02221         XSD_CREATE_WITH_FIXED_ATTR(cp::mesh_type, mesh_to_load, <span class="stringliteral">"cm"</span>);
<a name="l02222"></a>02222         <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;Mesh().set(mesh_to_load);
<a name="l02223"></a>02223     }
<a name="l02224"></a>02224 
<a name="l02225"></a>02225     cp::slab_type slab_definition(x, y, z, inter_node_space);
<a name="l02226"></a>02226     <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;Mesh()-&gt;Slab().set(slab_definition);
<a name="l02227"></a>02227 }
<a name="l02228"></a>02228 
<a name="l02229"></a><a class="code" href="classHeartConfig.html#39e7189e1725e0e48fd38e4bc6e06a8e">02229</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#39e7189e1725e0e48fd38e4bc6e06a8e">HeartConfig::SetSheetDimensions</a>(<span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y, <span class="keywordtype">double</span> inter_node_space)
<a name="l02230"></a>02230 {
<a name="l02231"></a>02231     <span class="keywordflow">if</span> ( ! <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;Mesh().present())
<a name="l02232"></a>02232     {
<a name="l02233"></a>02233         XSD_CREATE_WITH_FIXED_ATTR(cp::mesh_type, mesh_to_load, <span class="stringliteral">"cm"</span>);
<a name="l02234"></a>02234         <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;Mesh().set(mesh_to_load);
<a name="l02235"></a>02235     }
<a name="l02236"></a>02236 
<a name="l02237"></a>02237     cp::sheet_type sheet_definition(x, y, inter_node_space);
<a name="l02238"></a>02238     <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;Mesh()-&gt;Sheet().set(sheet_definition);
<a name="l02239"></a>02239 }
<a name="l02240"></a>02240 
<a name="l02241"></a><a class="code" href="classHeartConfig.html#41771ff2cdb9689d5dff43036b8261ec">02241</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#41771ff2cdb9689d5dff43036b8261ec">HeartConfig::SetFibreLength</a>(<span class="keywordtype">double</span> x, <span class="keywordtype">double</span> inter_node_space)
<a name="l02242"></a>02242 {
<a name="l02243"></a>02243     <span class="keywordflow">if</span> ( ! <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;Mesh().present())
<a name="l02244"></a>02244     {
<a name="l02245"></a>02245         XSD_CREATE_WITH_FIXED_ATTR(cp::mesh_type, mesh_to_load, <span class="stringliteral">"cm"</span>);
<a name="l02246"></a>02246         <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;Mesh().set(mesh_to_load);
<a name="l02247"></a>02247     }
<a name="l02248"></a>02248 
<a name="l02249"></a>02249     cp::fibre_type fibre_definition(x, inter_node_space);
<a name="l02250"></a>02250     <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;Mesh()-&gt;Fibre().set(fibre_definition);
<a name="l02251"></a>02251 }
<a name="l02252"></a>02252 
<a name="l02253"></a><a class="code" href="classHeartConfig.html#dc7f04b8d3bdf6a734c45fd57ffbd16d">02253</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#dc7f04b8d3bdf6a734c45fd57ffbd16d">HeartConfig::SetMeshFileName</a>(std::string meshPrefix, cp::media_type fibreDefinition)
<a name="l02254"></a>02254 {
<a name="l02255"></a>02255     <span class="keywordflow">if</span> ( ! <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;Mesh().present())
<a name="l02256"></a>02256     {
<a name="l02257"></a>02257         XSD_CREATE_WITH_FIXED_ATTR(cp::mesh_type, mesh_to_load, <span class="stringliteral">"cm"</span>);
<a name="l02258"></a>02258         <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;Mesh().set(mesh_to_load);
<a name="l02259"></a>02259     }
<a name="l02260"></a>02260 
<a name="l02261"></a>02261     XSD_NESTED_TYPE(cp::mesh_type::LoadMesh) mesh_prefix(meshPrefix, fibreDefinition);
<a name="l02262"></a>02262     <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;Mesh()-&gt;LoadMesh().set(mesh_prefix);
<a name="l02263"></a>02263 }
<a name="l02264"></a>02264 
<a name="l02265"></a><a class="code" href="classHeartConfig.html#165a75e6d71355cfcea146b578a02969">02265</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#165a75e6d71355cfcea146b578a02969">HeartConfig::SetIonicModelRegions</a>(std::vector&lt;<a class="code" href="classChasteCuboid.html">ChasteCuboid&lt;3&gt;</a> &gt;&amp; rDefinedRegions,
<a name="l02266"></a>02266                                        std::vector&lt;cp::ionic_model_selection_type&gt;&amp; rIonicModels)<span class="keyword"> const</span>
<a name="l02267"></a>02267 <span class="keyword"></span>{
<a name="l02268"></a>02268     assert(rDefinedRegions.size() == rIonicModels.size());
<a name="l02269"></a>02269     <span class="comment">// You need to have defined a default model first...</span>
<a name="l02270"></a>02270     assert(<a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;IonicModels().present());
<a name="l02271"></a>02271     XSD_SEQUENCE_TYPE(cp::ionic_models_type::Region)&amp;
<a name="l02272"></a>02272         regions = <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;IonicModels()-&gt;Region();
<a name="l02273"></a>02273     regions.clear();
<a name="l02274"></a>02274     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> region_index=0; region_index&lt;rDefinedRegions.size(); region_index++)
<a name="l02275"></a>02275     {
<a name="l02276"></a>02276         cp::point_type point_a(rDefinedRegions[region_index].rGetLowerCorner()[0],
<a name="l02277"></a>02277                                rDefinedRegions[region_index].rGetLowerCorner()[1],
<a name="l02278"></a>02278                                rDefinedRegions[region_index].rGetLowerCorner()[2]);
<a name="l02279"></a>02279 
<a name="l02280"></a>02280         cp::point_type point_b(rDefinedRegions[region_index].rGetUpperCorner()[0],
<a name="l02281"></a>02281                                rDefinedRegions[region_index].rGetUpperCorner()[1],
<a name="l02282"></a>02282                                rDefinedRegions[region_index].rGetUpperCorner()[2]);
<a name="l02283"></a>02283 
<a name="l02284"></a>02284         XSD_CREATE_WITH_FIXED_ATTR(cp::location_type, locn, <span class="stringliteral">"cm"</span>);
<a name="l02285"></a>02285         locn.Cuboid().set(cp::box_type(point_a, point_b));
<a name="l02286"></a>02286 
<a name="l02287"></a>02287         cp::ionic_model_region_type region(rIonicModels[region_index], locn);
<a name="l02288"></a>02288         regions.push_back(region);
<a name="l02289"></a>02289     }
<a name="l02290"></a>02290 }
<a name="l02291"></a>02291 
<a name="l02292"></a><a class="code" href="classHeartConfig.html#b3abba4bb2e36fd4889984be4303a495">02292</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#b3abba4bb2e36fd4889984be4303a495">HeartConfig::SetConductivityHeterogeneities</a>(std::vector&lt;<a class="code" href="classChasteCuboid.html">ChasteCuboid&lt;3&gt;</a> &gt;&amp; conductivityAreas,
<a name="l02293"></a>02293         std::vector&lt; c_vector&lt;double,3&gt; &gt;&amp; intraConductivities,
<a name="l02294"></a>02294         std::vector&lt; c_vector&lt;double,3&gt; &gt;&amp; extraConductivities)
<a name="l02295"></a>02295 {
<a name="l02296"></a>02296     assert ( conductivityAreas.size() == intraConductivities.size() );
<a name="l02297"></a>02297     assert ( intraConductivities.size() == extraConductivities.size());
<a name="l02298"></a>02298 
<a name="l02299"></a>02299     XSD_ANON_SEQUENCE_TYPE(cp::simulation_type, ConductivityHeterogeneities, ConductivityHeterogeneity) heterogeneities_container;
<a name="l02300"></a>02300 
<a name="l02301"></a>02301     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> region_index=0; region_index&lt;conductivityAreas.size(); region_index++)
<a name="l02302"></a>02302     {
<a name="l02303"></a>02303         cp::point_type point_a(conductivityAreas[region_index].rGetLowerCorner()[0],
<a name="l02304"></a>02304                            conductivityAreas[region_index].rGetLowerCorner()[1],
<a name="l02305"></a>02305                            conductivityAreas[region_index].rGetLowerCorner()[2]);
<a name="l02306"></a>02306 
<a name="l02307"></a>02307         cp::point_type point_b(conductivityAreas[region_index].rGetUpperCorner()[0],
<a name="l02308"></a>02308                            conductivityAreas[region_index].rGetUpperCorner()[1],
<a name="l02309"></a>02309                            conductivityAreas[region_index].rGetUpperCorner()[2]);
<a name="l02310"></a>02310 
<a name="l02311"></a>02311         XSD_CREATE_WITH_FIXED_ATTR(cp::location_type, locn, <span class="stringliteral">"cm"</span>);
<a name="l02312"></a>02312         locn.Cuboid().set(cp::box_type(point_a, point_b));
<a name="l02313"></a>02313         cp::conductivity_heterogeneity_type ht(locn);
<a name="l02314"></a>02314 
<a name="l02315"></a>02315         XSD_CREATE_WITH_FIXED_ATTR3(cp::conductivities_type, intra,
<a name="l02316"></a>02316                                     intraConductivities[region_index][0],
<a name="l02317"></a>02317                                     intraConductivities[region_index][1],
<a name="l02318"></a>02318                                     intraConductivities[region_index][2],
<a name="l02319"></a>02319                                     <span class="stringliteral">"mS/cm"</span>);
<a name="l02320"></a>02320 
<a name="l02321"></a>02321         ht.IntracellularConductivities(intra);
<a name="l02322"></a>02322 
<a name="l02323"></a>02323         XSD_CREATE_WITH_FIXED_ATTR3(cp::conductivities_type, extra,
<a name="l02324"></a>02324                                     extraConductivities[region_index][0],
<a name="l02325"></a>02325                                     extraConductivities[region_index][1],
<a name="l02326"></a>02326                                     extraConductivities[region_index][2],
<a name="l02327"></a>02327                                     <span class="stringliteral">"mS/cm"</span>);
<a name="l02328"></a>02328 
<a name="l02329"></a>02329         ht.ExtracellularConductivities(extra);
<a name="l02330"></a>02330 
<a name="l02331"></a>02331         heterogeneities_container.push_back(ht);
<a name="l02332"></a>02332     }
<a name="l02333"></a>02333 
<a name="l02334"></a>02334     XSD_ANON_TYPE(cp::simulation_type, ConductivityHeterogeneities) heterogeneities_object;
<a name="l02335"></a>02335     heterogeneities_object.ConductivityHeterogeneity(heterogeneities_container);
<a name="l02336"></a>02336 
<a name="l02337"></a>02337     <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;ConductivityHeterogeneities().set(heterogeneities_object);
<a name="l02338"></a>02338 }
<a name="l02339"></a>02339 
<a name="l02340"></a><a class="code" href="classHeartConfig.html#ac1eff1a30d848cd88767914c7c3c4da">02340</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#ac1eff1a30d848cd88767914c7c3c4da">HeartConfig::SetConductivityHeterogeneitiesEllipsoid</a>(std::vector&lt;<a class="code" href="classChasteEllipsoid.html">ChasteEllipsoid&lt;3&gt;</a> &gt;&amp; conductivityAreas,
<a name="l02341"></a>02341         std::vector&lt; c_vector&lt;double,3&gt; &gt;&amp; intraConductivities,
<a name="l02342"></a>02342         std::vector&lt; c_vector&lt;double,3&gt; &gt;&amp; extraConductivities)
<a name="l02343"></a>02343 {
<a name="l02344"></a>02344     assert ( conductivityAreas.size() == intraConductivities.size() );
<a name="l02345"></a>02345     assert ( intraConductivities.size() == extraConductivities.size());
<a name="l02346"></a>02346 
<a name="l02347"></a>02347     XSD_ANON_SEQUENCE_TYPE(cp::simulation_type, ConductivityHeterogeneities, ConductivityHeterogeneity) heterogeneities_container;
<a name="l02348"></a>02348 
<a name="l02349"></a>02349     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> region_index=0; region_index&lt;conductivityAreas.size(); region_index++)
<a name="l02350"></a>02350     {
<a name="l02351"></a>02351         cp::point_type centre(conductivityAreas[region_index].rGetCentre()[0],
<a name="l02352"></a>02352                               conductivityAreas[region_index].rGetCentre()[1],
<a name="l02353"></a>02353                               conductivityAreas[region_index].rGetCentre()[2]);
<a name="l02354"></a>02354 
<a name="l02355"></a>02355         cp::point_type radii(conductivityAreas[region_index].rGetRadii()[0],
<a name="l02356"></a>02356                              conductivityAreas[region_index].rGetRadii()[1],
<a name="l02357"></a>02357                              conductivityAreas[region_index].rGetRadii()[2]);
<a name="l02358"></a>02358 
<a name="l02359"></a>02359         XSD_CREATE_WITH_FIXED_ATTR(cp::location_type, locn, <span class="stringliteral">"cm"</span>);
<a name="l02360"></a>02360         locn.Ellipsoid().set(cp::ellipsoid_type(centre, radii));
<a name="l02361"></a>02361         cp::conductivity_heterogeneity_type ht(locn);
<a name="l02362"></a>02362 
<a name="l02363"></a>02363         XSD_CREATE_WITH_FIXED_ATTR3(cp::conductivities_type, intra,
<a name="l02364"></a>02364                                     intraConductivities[region_index][0],
<a name="l02365"></a>02365                                     intraConductivities[region_index][1],
<a name="l02366"></a>02366                                     intraConductivities[region_index][2],
<a name="l02367"></a>02367                                     <span class="stringliteral">"mS/cm"</span>);
<a name="l02368"></a>02368 
<a name="l02369"></a>02369         ht.IntracellularConductivities(intra);
<a name="l02370"></a>02370 
<a name="l02371"></a>02371         XSD_CREATE_WITH_FIXED_ATTR3(cp::conductivities_type, extra,
<a name="l02372"></a>02372                                     extraConductivities[region_index][0],
<a name="l02373"></a>02373                                     extraConductivities[region_index][1],
<a name="l02374"></a>02374                                     extraConductivities[region_index][2],
<a name="l02375"></a>02375                                     <span class="stringliteral">"mS/cm"</span>);
<a name="l02376"></a>02376 
<a name="l02377"></a>02377         ht.ExtracellularConductivities(extra);
<a name="l02378"></a>02378 
<a name="l02379"></a>02379         heterogeneities_container.push_back(ht);
<a name="l02380"></a>02380     }
<a name="l02381"></a>02381 
<a name="l02382"></a>02382     XSD_ANON_TYPE(cp::simulation_type, ConductivityHeterogeneities) heterogeneities_object;
<a name="l02383"></a>02383     heterogeneities_object.ConductivityHeterogeneity(heterogeneities_container);
<a name="l02384"></a>02384 
<a name="l02385"></a>02385     <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;ConductivityHeterogeneities().set(heterogeneities_object);
<a name="l02386"></a>02386 }
<a name="l02387"></a>02387 
<a name="l02388"></a><a class="code" href="classHeartConfig.html#5f5d3c0f60554e91bf3f670ff3d8720a">02388</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#5f5d3c0f60554e91bf3f670ff3d8720a">HeartConfig::SetOutputDirectory</a>(<span class="keyword">const</span> std::string&amp; rOutputDirectory)
<a name="l02389"></a>02389 {
<a name="l02390"></a>02390     <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;OutputDirectory().set(rOutputDirectory);
<a name="l02391"></a>02391 }
<a name="l02392"></a>02392 
<a name="l02393"></a><a class="code" href="classHeartConfig.html#d6379d55fd7badb2720eb3d6f4b98f3f">02393</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#d6379d55fd7badb2720eb3d6f4b98f3f">HeartConfig::SetOutputFilenamePrefix</a>(<span class="keyword">const</span> std::string&amp; rOutputFilenamePrefix)
<a name="l02394"></a>02394 {
<a name="l02395"></a>02395     <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;OutputFilenamePrefix().set(rOutputFilenamePrefix);
<a name="l02396"></a>02396 }
<a name="l02397"></a>02397 
<a name="l02398"></a><a class="code" href="classHeartConfig.html#b4327ce8948dfdc306daaa5b733d8b7a">02398</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#b4327ce8948dfdc306daaa5b733d8b7a">HeartConfig::SetOutputVariables</a>(<span class="keyword">const</span> std::vector&lt;std::string&gt;&amp; rOutputVariables)
<a name="l02399"></a>02399 {
<a name="l02400"></a>02400     <span class="keywordflow">if</span> ( ! <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;OutputVariables().present())
<a name="l02401"></a>02401     {
<a name="l02402"></a>02402         cp::output_variables_type variables_requested;
<a name="l02403"></a>02403         <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;OutputVariables().set(variables_requested);
<a name="l02404"></a>02404     }
<a name="l02405"></a>02405 
<a name="l02406"></a>02406     XSD_SEQUENCE_TYPE(cp::output_variables_type::Var)&amp;
<a name="l02407"></a>02407         var_type_sequence = <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;OutputVariables()-&gt;Var();
<a name="l02408"></a>02408     <span class="comment">//Erase or create a sequence</span>
<a name="l02409"></a>02409     var_type_sequence.clear();
<a name="l02410"></a>02410 
<a name="l02411"></a>02411     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0; i&lt;rOutputVariables.size(); i++)
<a name="l02412"></a>02412     {
<a name="l02413"></a>02413         cp::var_type temp(rOutputVariables[i]);
<a name="l02414"></a>02414         var_type_sequence.push_back(temp);
<a name="l02415"></a>02415     }
<a name="l02416"></a>02416 
<a name="l02417"></a>02417 <span class="comment">//    if (rOutputVariables.size() &gt; 0)</span>
<a name="l02418"></a>02418 <span class="comment">//    {</span>
<a name="l02419"></a>02419 <span class="comment">//        // Turn off Meshalyzer etc. output, to avoid errors</span>
<a name="l02420"></a>02420 <span class="comment">//        /// \todo #1502 is this no longer needed?</span>
<a name="l02421"></a>02421 <span class="comment">//        SetVisualizeWithMeshalyzer(false);</span>
<a name="l02422"></a>02422 <span class="comment">//        SetVisualizeWithCmgui(false);</span>
<a name="l02423"></a>02423 <span class="comment">//        SetVisualizeWithVtk(false);</span>
<a name="l02424"></a>02424 <span class="comment">//        SetVisualizeWithParallelVtk(false);</span>
<a name="l02425"></a>02425 <span class="comment">//    }</span>
<a name="l02426"></a>02426 }
<a name="l02427"></a>02427 
<a name="l02428"></a><a class="code" href="classHeartConfig.html#54fc7f20367a1fe629eb68b7fab40bf0">02428</a> <span class="keywordtype">void</span>  <a class="code" href="classHeartConfig.html#54fc7f20367a1fe629eb68b7fab40bf0">HeartConfig::SetOutputUsingOriginalNodeOrdering</a>(<span class="keywordtype">bool</span> useOriginal)
<a name="l02429"></a>02429 {
<a name="l02430"></a>02430     <span class="comment">//What if it doesn't exist?</span>
<a name="l02431"></a>02431     <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;OutputUsingOriginalNodeOrdering().set(useOriginal? cp::yesno_type::yes : cp::yesno_type::no);
<a name="l02432"></a>02432 }
<a name="l02433"></a>02433 
<a name="l02434"></a><a class="code" href="classHeartConfig.html#d7acbc17d4e8fbf7f3c8dcf17340afe4">02434</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#d7acbc17d4e8fbf7f3c8dcf17340afe4">HeartConfig::SetCheckpointSimulation</a>(<span class="keywordtype">bool</span> saveSimulation, <span class="keywordtype">double</span> checkpointTimestep, <span class="keywordtype">unsigned</span> maxCheckpointsOnDisk)
<a name="l02435"></a>02435 {
<a name="l02436"></a>02436     <span class="keywordflow">if</span> (saveSimulation)
<a name="l02437"></a>02437     {
<a name="l02438"></a>02438         <span class="comment">// Make sure values for the optional parameters have been provided</span>
<a name="l02439"></a>02439         assert(checkpointTimestep!=-1.0 &amp;&amp; maxCheckpointsOnDisk!=UINT_MAX);
<a name="l02440"></a>02440 
<a name="l02441"></a>02441         XSD_CREATE_WITH_FIXED_ATTR2(cp::simulation_type::XSD_NESTED_TYPE(CheckpointSimulation),
<a name="l02442"></a>02442                                     cs,
<a name="l02443"></a>02443                                     checkpointTimestep,
<a name="l02444"></a>02444                                     maxCheckpointsOnDisk,
<a name="l02445"></a>02445                                     <span class="stringliteral">"ms"</span>);
<a name="l02446"></a>02446         <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;CheckpointSimulation().set(cs);
<a name="l02447"></a>02447     }
<a name="l02448"></a>02448     <span class="keywordflow">else</span>
<a name="l02449"></a>02449     {
<a name="l02450"></a>02450         <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;CheckpointSimulation().reset();
<a name="l02451"></a>02451     }
<a name="l02452"></a>02452 
<a name="l02453"></a>02453     <a class="code" href="classHeartConfig.html#ef79708e5e663a9ea5ff236ecc0bbd85">CheckTimeSteps</a>();
<a name="l02454"></a>02454 }
<a name="l02455"></a>02455 
<a name="l02456"></a>02456 <span class="comment">// Physiological</span>
<a name="l02457"></a>02457 
<a name="l02458"></a><a class="code" href="classHeartConfig.html#0e141c92e1f34c89d3f397027fcbaf4f">02458</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#0e141c92e1f34c89d3f397027fcbaf4f">HeartConfig::SetIntracellularConductivities</a>(<span class="keyword">const</span> c_vector&lt;double, 3&gt;&amp; intraConductivities)
<a name="l02459"></a>02459 {
<a name="l02460"></a>02460     XSD_CREATE_WITH_FIXED_ATTR3(cp::conductivities_type, intra,
<a name="l02461"></a>02461                                 intraConductivities[0],
<a name="l02462"></a>02462                                 intraConductivities[1],
<a name="l02463"></a>02463                                 intraConductivities[2],
<a name="l02464"></a>02464                                 <span class="stringliteral">"mS/cm"</span>);
<a name="l02465"></a>02465 
<a name="l02466"></a>02466     <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Physiological().IntracellularConductivities().set(intra);
<a name="l02467"></a>02467 }
<a name="l02468"></a>02468 
<a name="l02469"></a><a class="code" href="classHeartConfig.html#8d50f87b6a8dda6a0ccde7d22f0f96ef">02469</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#0e141c92e1f34c89d3f397027fcbaf4f">HeartConfig::SetIntracellularConductivities</a>(<span class="keyword">const</span> c_vector&lt;double, 2&gt;&amp; intraConductivities)
<a name="l02470"></a>02470 {
<a name="l02471"></a>02471     XSD_CREATE_WITH_FIXED_ATTR3(cp::conductivities_type, intra,
<a name="l02472"></a>02472                                 intraConductivities[0],
<a name="l02473"></a>02473                                 intraConductivities[1],
<a name="l02474"></a>02474                                 0.0, <span class="stringliteral">"mS/cm"</span>);
<a name="l02475"></a>02475 
<a name="l02476"></a>02476     <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Physiological().IntracellularConductivities().set(intra);
<a name="l02477"></a>02477 }
<a name="l02478"></a>02478 
<a name="l02479"></a><a class="code" href="classHeartConfig.html#7f0f10e4ab23fca3436ee9aeb7a73d75">02479</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#0e141c92e1f34c89d3f397027fcbaf4f">HeartConfig::SetIntracellularConductivities</a>(<span class="keyword">const</span> c_vector&lt;double, 1&gt;&amp; intraConductivities)
<a name="l02480"></a>02480 {
<a name="l02481"></a>02481     XSD_CREATE_WITH_FIXED_ATTR3(cp::conductivities_type, intra,
<a name="l02482"></a>02482                                 intraConductivities[0],
<a name="l02483"></a>02483                                 0.0, 0.0, <span class="stringliteral">"mS/cm"</span>);
<a name="l02484"></a>02484 
<a name="l02485"></a>02485     <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Physiological().IntracellularConductivities().set(intra);
<a name="l02486"></a>02486 }
<a name="l02487"></a>02487 
<a name="l02488"></a><a class="code" href="classHeartConfig.html#a69b80a3c82b3a095a5a3decde05eaba">02488</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a69b80a3c82b3a095a5a3decde05eaba">HeartConfig::SetExtracellularConductivities</a>(<span class="keyword">const</span> c_vector&lt;double, 3&gt;&amp; extraConductivities)
<a name="l02489"></a>02489 {
<a name="l02490"></a>02490     XSD_CREATE_WITH_FIXED_ATTR3(cp::conductivities_type, extra,
<a name="l02491"></a>02491                                 extraConductivities[0],
<a name="l02492"></a>02492                                 extraConductivities[1],
<a name="l02493"></a>02493                                 extraConductivities[2],
<a name="l02494"></a>02494                                 <span class="stringliteral">"mS/cm"</span>);
<a name="l02495"></a>02495 
<a name="l02496"></a>02496     <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Physiological().ExtracellularConductivities().set(extra);
<a name="l02497"></a>02497 }
<a name="l02498"></a>02498 
<a name="l02499"></a><a class="code" href="classHeartConfig.html#5b786bc27fda207b790c0a09b0584f45">02499</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a69b80a3c82b3a095a5a3decde05eaba">HeartConfig::SetExtracellularConductivities</a>(<span class="keyword">const</span> c_vector&lt;double, 2&gt;&amp; extraConductivities)
<a name="l02500"></a>02500 {
<a name="l02501"></a>02501     XSD_CREATE_WITH_FIXED_ATTR3(cp::conductivities_type, extra,
<a name="l02502"></a>02502                                 extraConductivities[0],
<a name="l02503"></a>02503                                 extraConductivities[1],
<a name="l02504"></a>02504                                 0.0, <span class="stringliteral">"mS/cm"</span>);
<a name="l02505"></a>02505 
<a name="l02506"></a>02506     <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Physiological().ExtracellularConductivities().set(extra);
<a name="l02507"></a>02507 }
<a name="l02508"></a>02508 
<a name="l02509"></a><a class="code" href="classHeartConfig.html#d90b3240afadc81d15959825685bb16e">02509</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a69b80a3c82b3a095a5a3decde05eaba">HeartConfig::SetExtracellularConductivities</a>(<span class="keyword">const</span> c_vector&lt;double, 1&gt;&amp; extraConductivities)
<a name="l02510"></a>02510 {
<a name="l02511"></a>02511     XSD_CREATE_WITH_FIXED_ATTR3(cp::conductivities_type, extra,
<a name="l02512"></a>02512                                 extraConductivities[0],
<a name="l02513"></a>02513                                 0.0, 0.0, <span class="stringliteral">"mS/cm"</span>);
<a name="l02514"></a>02514 
<a name="l02515"></a>02515     <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Physiological().ExtracellularConductivities().set(extra);
<a name="l02516"></a>02516 }
<a name="l02517"></a>02517 
<a name="l02518"></a><a class="code" href="classHeartConfig.html#994cb2f7b3edc1c45ba43fc967a98a8a">02518</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#994cb2f7b3edc1c45ba43fc967a98a8a">HeartConfig::SetBathConductivity</a>(<span class="keywordtype">double</span> bathConductivity)
<a name="l02519"></a>02519 {
<a name="l02520"></a>02520     XSD_CREATE_WITH_FIXED_ATTR1(cp::conductivity_type, cond, bathConductivity, <span class="stringliteral">"mS/cm"</span>);
<a name="l02521"></a>02521     <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Physiological().BathConductivity().set(cond);
<a name="l02522"></a>02522 }
<a name="l02523"></a>02523 
<a name="l02524"></a><a class="code" href="classHeartConfig.html#1ed47d4bfc27b26595496006fd941463">02524</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#1ed47d4bfc27b26595496006fd941463">HeartConfig::SetBathMultipleConductivities</a>(std::map&lt;unsigned, double&gt; bathConductivities)
<a name="l02525"></a>02525 {
<a name="l02527"></a>02527     <a class="code" href="classHeartConfig.html#5f7071e5af04a3024ef80365f8eb2780">mBathConductivities</a> = bathConductivities;
<a name="l02528"></a>02528 }
<a name="l02529"></a>02529 
<a name="l02530"></a>02530 <span class="comment">//void HeartConfig::SetTissueIdentifiers(const std::set&lt;unsigned&gt;&amp; tissueIds)</span>
<a name="l02531"></a>02531 <span class="comment">//{</span>
<a name="l02532"></a>02532 <span class="comment">//    std::set&lt;unsigned&gt; empty_bath_identifiers;  //Too dangerous (see GetValidBathId)</span>
<a name="l02533"></a>02533 <span class="comment">//    SetTissueAndBathIdentifiers(tissueIds, mBathIdentifiers);</span>
<a name="l02534"></a>02534 <span class="comment">//}</span>
<a name="l02535"></a>02535 
<a name="l02536"></a><a class="code" href="classHeartConfig.html#30a5a763ea093dbd6e9bba7141455281">02536</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#30a5a763ea093dbd6e9bba7141455281">HeartConfig::SetTissueAndBathIdentifiers</a>(<span class="keyword">const</span> std::set&lt;unsigned&gt;&amp; tissueIds, <span class="keyword">const</span> std::set&lt;unsigned&gt;&amp; bathIds)
<a name="l02537"></a>02537 {
<a name="l02538"></a>02538     <span class="keywordflow">if</span> (tissueIds.empty() || bathIds.empty() )
<a name="l02539"></a>02539     {
<a name="l02540"></a>02540         <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a>(<span class="stringliteral">"Identifying set must be non-empty"</span>);
<a name="l02541"></a>02541     }
<a name="l02542"></a>02542     std::set&lt;unsigned&gt; shared_identifiers;
<a name="l02543"></a>02543     std::set_intersection(tissueIds.begin(),
<a name="l02544"></a>02544                           tissueIds.end(),
<a name="l02545"></a>02545                           bathIds.begin(),
<a name="l02546"></a>02546                           bathIds.end(),
<a name="l02547"></a>02547                           std::inserter(shared_identifiers, shared_identifiers.begin()));
<a name="l02548"></a>02548 
<a name="l02549"></a>02549     <span class="keywordflow">if</span> (!shared_identifiers.empty())
<a name="l02550"></a>02550     {
<a name="l02551"></a>02551         <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a>(<span class="stringliteral">"Tissue identifiers and bath identifiers overlap"</span>);
<a name="l02552"></a>02552     }
<a name="l02553"></a>02553     <a class="code" href="classHeartConfig.html#c657f43ca4d92bfd3c5e2270e7470429">mTissueIdentifiers</a>=tissueIds;
<a name="l02554"></a>02554     <a class="code" href="classHeartConfig.html#1471127f954fea7a8eb5811ec448f0cc">mBathIdentifiers</a>=bathIds;
<a name="l02555"></a>02555 }
<a name="l02556"></a>02556 
<a name="l02557"></a><a class="code" href="classHeartConfig.html#8a91b9567843043c5b9f1d05779816a9">02557</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#8a91b9567843043c5b9f1d05779816a9">HeartConfig::SetSurfaceAreaToVolumeRatio</a>(<span class="keywordtype">double</span> ratio)
<a name="l02558"></a>02558 {
<a name="l02559"></a>02559     XSD_CREATE_WITH_FIXED_ATTR1(cp::inverse_length_type, ratio_object, ratio, <span class="stringliteral">"1/cm"</span>);
<a name="l02560"></a>02560     <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Physiological().SurfaceAreaToVolumeRatio().set(ratio_object);
<a name="l02561"></a>02561 }
<a name="l02562"></a>02562 
<a name="l02563"></a><a class="code" href="classHeartConfig.html#aed8e9a14106071416be8e010fed3875">02563</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#aed8e9a14106071416be8e010fed3875">HeartConfig::SetCapacitance</a>(<span class="keywordtype">double</span> capacitance)
<a name="l02564"></a>02564 {
<a name="l02565"></a>02565     XSD_CREATE_WITH_FIXED_ATTR1(cp::capacitance_type, capacitance_object, capacitance, <span class="stringliteral">"uF/cm^2"</span>);
<a name="l02566"></a>02566     <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Physiological().Capacitance().set(capacitance_object);
<a name="l02567"></a>02567 }
<a name="l02568"></a>02568 
<a name="l02569"></a>02569 
<a name="l02570"></a>02570 <span class="comment">// Numerical</span>
<a name="l02571"></a><a class="code" href="classHeartConfig.html#fae11c8b1e28bbe357b62a6aff92ed26">02571</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#fae11c8b1e28bbe357b62a6aff92ed26">HeartConfig::SetOdePdeAndPrintingTimeSteps</a>(<span class="keywordtype">double</span> odeTimeStep, <span class="keywordtype">double</span> pdeTimeStep, <span class="keywordtype">double</span> printingTimeStep)
<a name="l02572"></a>02572 {
<a name="l02573"></a>02573     XSD_CREATE_WITH_FIXED_ATTR3(cp::time_steps_type, time_steps,
<a name="l02574"></a>02574                                 odeTimeStep, pdeTimeStep, printingTimeStep, <span class="stringliteral">"ms"</span>);
<a name="l02575"></a>02575     <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().TimeSteps().set(time_steps);
<a name="l02576"></a>02576     <a class="code" href="classHeartConfig.html#ef79708e5e663a9ea5ff236ecc0bbd85">CheckTimeSteps</a>();
<a name="l02577"></a>02577 }
<a name="l02578"></a>02578 
<a name="l02579"></a><a class="code" href="classHeartConfig.html#937009fb9049e72e963d21a9962d2d2f">02579</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#937009fb9049e72e963d21a9962d2d2f">HeartConfig::SetOdeTimeStep</a>(<span class="keywordtype">double</span> odeTimeStep)
<a name="l02580"></a>02580 {
<a name="l02581"></a>02581     <a class="code" href="classHeartConfig.html#fae11c8b1e28bbe357b62a6aff92ed26">SetOdePdeAndPrintingTimeSteps</a>(odeTimeStep, <a class="code" href="classHeartConfig.html#c20bbc4140281b206a260a82cb59ab0f">GetPdeTimeStep</a>(), <a class="code" href="classHeartConfig.html#33ae21f4b16476aa5cb975a455c5ba19">GetPrintingTimeStep</a>());
<a name="l02582"></a>02582 }
<a name="l02583"></a>02583 
<a name="l02584"></a><a class="code" href="classHeartConfig.html#7f6b79cb359a97a70ab489d6eebc3183">02584</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#7f6b79cb359a97a70ab489d6eebc3183">HeartConfig::SetPdeTimeStep</a>(<span class="keywordtype">double</span> pdeTimeStep)
<a name="l02585"></a>02585 {
<a name="l02586"></a>02586     <a class="code" href="classHeartConfig.html#fae11c8b1e28bbe357b62a6aff92ed26">SetOdePdeAndPrintingTimeSteps</a>(<a class="code" href="classHeartConfig.html#383ab1c116a88ecd3f973ef371a2c8d9">GetOdeTimeStep</a>(), pdeTimeStep, <a class="code" href="classHeartConfig.html#33ae21f4b16476aa5cb975a455c5ba19">GetPrintingTimeStep</a>());
<a name="l02587"></a>02587 }
<a name="l02588"></a>02588 
<a name="l02589"></a><a class="code" href="classHeartConfig.html#3b331a2888f584fdcf391e012bb36062">02589</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#3b331a2888f584fdcf391e012bb36062">HeartConfig::SetPrintingTimeStep</a>(<span class="keywordtype">double</span> printingTimeStep)
<a name="l02590"></a>02590 {
<a name="l02591"></a>02591     <a class="code" href="classHeartConfig.html#fae11c8b1e28bbe357b62a6aff92ed26">SetOdePdeAndPrintingTimeSteps</a>(<a class="code" href="classHeartConfig.html#383ab1c116a88ecd3f973ef371a2c8d9">GetOdeTimeStep</a>(), <a class="code" href="classHeartConfig.html#c20bbc4140281b206a260a82cb59ab0f">GetPdeTimeStep</a>(), printingTimeStep);
<a name="l02592"></a>02592 }
<a name="l02593"></a>02593 
<a name="l02594"></a><a class="code" href="classHeartConfig.html#ef79708e5e663a9ea5ff236ecc0bbd85">02594</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#ef79708e5e663a9ea5ff236ecc0bbd85">HeartConfig::CheckTimeSteps</a>()<span class="keyword"> const</span>
<a name="l02595"></a>02595 <span class="keyword"></span>{
<a name="l02596"></a>02596     <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#383ab1c116a88ecd3f973ef371a2c8d9">GetOdeTimeStep</a>() &lt;= 0)
<a name="l02597"></a>02597     {
<a name="l02598"></a>02598         <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a>(<span class="stringliteral">"Ode time-step should be positive"</span>);
<a name="l02599"></a>02599     }
<a name="l02600"></a>02600     <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#c20bbc4140281b206a260a82cb59ab0f">GetPdeTimeStep</a>() &lt;= 0)
<a name="l02601"></a>02601     {
<a name="l02602"></a>02602         <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a>(<span class="stringliteral">"Pde time-step should be positive"</span>);
<a name="l02603"></a>02603     }
<a name="l02604"></a>02604     <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#33ae21f4b16476aa5cb975a455c5ba19">GetPrintingTimeStep</a>() &lt;= 0.0)
<a name="l02605"></a>02605     {
<a name="l02606"></a>02606         <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a>(<span class="stringliteral">"Printing time-step should be positive"</span>);
<a name="l02607"></a>02607     }
<a name="l02608"></a>02608 
<a name="l02609"></a>02609     <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#c20bbc4140281b206a260a82cb59ab0f">GetPdeTimeStep</a>()&gt;<a class="code" href="classHeartConfig.html#33ae21f4b16476aa5cb975a455c5ba19">GetPrintingTimeStep</a>())
<a name="l02610"></a>02610     {
<a name="l02611"></a>02611         <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a>(<span class="stringliteral">"Printing time-step should not be smaller than PDE time-step"</span>);
<a name="l02612"></a>02612     }
<a name="l02613"></a>02613 
<a name="l02614"></a>02614     <span class="keywordflow">if</span> ( !Divides(<a class="code" href="classHeartConfig.html#c20bbc4140281b206a260a82cb59ab0f">GetPdeTimeStep</a>(), <a class="code" href="classHeartConfig.html#33ae21f4b16476aa5cb975a455c5ba19">GetPrintingTimeStep</a>()) )
<a name="l02615"></a>02615     {
<a name="l02616"></a>02616         <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a>(<span class="stringliteral">"Printing time-step should be a multiple of PDE time step"</span>);
<a name="l02617"></a>02617     }
<a name="l02618"></a>02618 
<a name="l02619"></a>02619     <span class="keywordflow">if</span> ( <a class="code" href="classHeartConfig.html#383ab1c116a88ecd3f973ef371a2c8d9">GetOdeTimeStep</a>() &gt; <a class="code" href="classHeartConfig.html#c20bbc4140281b206a260a82cb59ab0f">GetPdeTimeStep</a>() )
<a name="l02620"></a>02620     {
<a name="l02621"></a>02621         <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a>(<span class="stringliteral">"Ode time-step should not be greater than PDE time-step"</span>);
<a name="l02622"></a>02622     }
<a name="l02623"></a>02623 
<a name="l02624"></a>02624     <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#34e25b3a25618f0f8721c678e6b12f95">GetCheckpointSimulation</a>())
<a name="l02625"></a>02625     {
<a name="l02626"></a>02626         <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#80bb45c8945a0a3b98b5a1151d79143a">GetCheckpointTimestep</a>() &lt;= 0.0)
<a name="l02627"></a>02627         {
<a name="l02628"></a>02628             <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a>(<span class="stringliteral">"Checkpoint time-step should be positive"</span>);
<a name="l02629"></a>02629         }
<a name="l02630"></a>02630 
<a name="l02631"></a>02631         <span class="keywordflow">if</span> ( !Divides(<a class="code" href="classHeartConfig.html#33ae21f4b16476aa5cb975a455c5ba19">GetPrintingTimeStep</a>(), <a class="code" href="classHeartConfig.html#80bb45c8945a0a3b98b5a1151d79143a">GetCheckpointTimestep</a>()) )
<a name="l02632"></a>02632         {
<a name="l02633"></a>02633             <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a>(<span class="stringliteral">"Checkpoint time-step should be a multiple of printing time-step"</span>);
<a name="l02634"></a>02634         }
<a name="l02635"></a>02635     }
<a name="l02636"></a>02636 }
<a name="l02637"></a>02637 
<a name="l02638"></a>02638 
<a name="l02639"></a><a class="code" href="classHeartConfig.html#7af488fdbe5832371862ac122a174f2f">02639</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#7af488fdbe5832371862ac122a174f2f">HeartConfig::SetUseRelativeTolerance</a>(<span class="keywordtype">double</span> relativeTolerance)
<a name="l02640"></a>02640 {
<a name="l02641"></a>02641     ENSURE_SECTION_PRESENT(<a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().KSPTolerances(), cp::ksp_tolerances_type);
<a name="l02642"></a>02642     <span class="comment">//Remove any reference to tolerances is user parameters</span>
<a name="l02643"></a>02643     <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().KSPTolerances()-&gt;KSPAbsolute().reset();
<a name="l02644"></a>02644     <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().KSPTolerances()-&gt;KSPRelative().set(relativeTolerance);
<a name="l02645"></a>02645 }
<a name="l02646"></a>02646 
<a name="l02647"></a><a class="code" href="classHeartConfig.html#8d20fbbb42fd8f8d6afcc725f2b10acf">02647</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#8d20fbbb42fd8f8d6afcc725f2b10acf">HeartConfig::SetUseAbsoluteTolerance</a>(<span class="keywordtype">double</span> absoluteTolerance)
<a name="l02648"></a>02648 {
<a name="l02649"></a>02649     ENSURE_SECTION_PRESENT(<a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().KSPTolerances(), cp::ksp_tolerances_type);
<a name="l02650"></a>02650     <span class="comment">//Remove any reference to tolerances is user parameters</span>
<a name="l02651"></a>02651     <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().KSPTolerances()-&gt;KSPRelative().reset();
<a name="l02652"></a>02652     <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().KSPTolerances()-&gt;KSPAbsolute().set(absoluteTolerance);
<a name="l02653"></a>02653 }
<a name="l02654"></a>02654 
<a name="l02655"></a><a class="code" href="classHeartConfig.html#27906b4c0d83289b5779236fbcb27b4b">02655</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#27906b4c0d83289b5779236fbcb27b4b">HeartConfig::SetKSPSolver</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* kspSolver)
<a name="l02656"></a>02656 {
<a name="l02657"></a>02657     <span class="comment">/* Note that changes in these conditions need to be reflected in the Doxygen*/</span>
<a name="l02658"></a>02658     <span class="keywordflow">if</span> ( strcmp(kspSolver, <span class="stringliteral">"gmres"</span>) == 0)
<a name="l02659"></a>02659     {
<a name="l02660"></a>02660         <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().KSPSolver().set(cp::ksp_solver_type::gmres);
<a name="l02661"></a>02661         <span class="keywordflow">return</span>;
<a name="l02662"></a>02662     }
<a name="l02663"></a>02663     <span class="keywordflow">if</span> ( strcmp(kspSolver, <span class="stringliteral">"cg"</span>) == 0)
<a name="l02664"></a>02664     {
<a name="l02665"></a>02665         <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().KSPSolver().set(cp::ksp_solver_type::cg);
<a name="l02666"></a>02666         <span class="keywordflow">return</span>;
<a name="l02667"></a>02667     }
<a name="l02668"></a>02668     <span class="keywordflow">if</span> ( strcmp(kspSolver, <span class="stringliteral">"symmlq"</span>) == 0)
<a name="l02669"></a>02669     {
<a name="l02670"></a>02670         <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().KSPSolver().set(cp::ksp_solver_type::symmlq);
<a name="l02671"></a>02671         <span class="keywordflow">return</span>;
<a name="l02672"></a>02672     }
<a name="l02673"></a>02673     <span class="keywordflow">if</span> ( strcmp(kspSolver, <span class="stringliteral">"chebychev"</span>) == 0)
<a name="l02674"></a>02674     {
<a name="l02675"></a>02675         <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().KSPSolver().set(cp::ksp_solver_type::chebychev);
<a name="l02676"></a>02676         <span class="keywordflow">return</span>;
<a name="l02677"></a>02677     }
<a name="l02678"></a>02678 
<a name="l02679"></a>02679     <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a>(<span class="stringliteral">"Unknown solver type provided"</span>);
<a name="l02680"></a>02680 }
<a name="l02681"></a>02681 
<a name="l02682"></a><a class="code" href="classHeartConfig.html#913a9b2cab5c9223e61ec8033c60c20d">02682</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#913a9b2cab5c9223e61ec8033c60c20d">HeartConfig::SetKSPPreconditioner</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* kspPreconditioner)
<a name="l02683"></a>02683 {
<a name="l02684"></a>02684     <span class="comment">/* Note that changes in these conditions need to be reflected in the Doxygen*/</span>
<a name="l02685"></a>02685     <span class="keywordflow">if</span> ( strcmp(kspPreconditioner, <span class="stringliteral">"jacobi"</span>) == 0)
<a name="l02686"></a>02686     {
<a name="l02687"></a>02687         <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().KSPPreconditioner().set(cp::ksp_preconditioner_type::jacobi);
<a name="l02688"></a>02688         <span class="keywordflow">return</span>;
<a name="l02689"></a>02689     }
<a name="l02690"></a>02690     <span class="keywordflow">if</span> ( strcmp(kspPreconditioner, <span class="stringliteral">"bjacobi"</span>) == 0)
<a name="l02691"></a>02691     {
<a name="l02692"></a>02692         <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().KSPPreconditioner().set(cp::ksp_preconditioner_type::bjacobi);
<a name="l02693"></a>02693         <span class="keywordflow">return</span>;
<a name="l02694"></a>02694     }
<a name="l02695"></a>02695     <span class="keywordflow">if</span> ( strcmp(kspPreconditioner, <span class="stringliteral">"hypre"</span>) == 0)
<a name="l02696"></a>02696     {
<a name="l02697"></a>02697         <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().KSPPreconditioner().set(cp::ksp_preconditioner_type::hypre);
<a name="l02698"></a>02698         <span class="keywordflow">return</span>;
<a name="l02699"></a>02699     }
<a name="l02700"></a>02700     <span class="keywordflow">if</span> ( strcmp(kspPreconditioner, <span class="stringliteral">"ml"</span>) == 0)
<a name="l02701"></a>02701     {
<a name="l02702"></a>02702         <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().KSPPreconditioner().set(cp::ksp_preconditioner_type::ml);
<a name="l02703"></a>02703         <span class="keywordflow">return</span>;
<a name="l02704"></a>02704     }
<a name="l02705"></a>02705     <span class="keywordflow">if</span> ( strcmp(kspPreconditioner, <span class="stringliteral">"spai"</span>) == 0)
<a name="l02706"></a>02706     {
<a name="l02707"></a>02707         <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().KSPPreconditioner().set(cp::ksp_preconditioner_type::spai);
<a name="l02708"></a>02708         <span class="keywordflow">return</span>;
<a name="l02709"></a>02709     }
<a name="l02710"></a>02710     <span class="keywordflow">if</span> ( strcmp(kspPreconditioner, <span class="stringliteral">"twolevelsblockdiagonal"</span>) == 0)
<a name="l02711"></a>02711     {
<a name="l02712"></a>02712         <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().KSPPreconditioner().set(cp::ksp_preconditioner_type::twolevelsblockdiagonal);
<a name="l02713"></a>02713         <span class="keywordflow">return</span>;
<a name="l02714"></a>02714     }
<a name="l02715"></a>02715     <span class="keywordflow">if</span> ( strcmp(kspPreconditioner, <span class="stringliteral">"blockdiagonal"</span>) == 0)
<a name="l02716"></a>02716     {
<a name="l02717"></a>02717         <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().KSPPreconditioner().set(cp::ksp_preconditioner_type::blockdiagonal);
<a name="l02718"></a>02718         <span class="keywordflow">return</span>;
<a name="l02719"></a>02719     }
<a name="l02720"></a>02720     <span class="keywordflow">if</span> ( strcmp(kspPreconditioner, <span class="stringliteral">"ldufactorisation"</span>) == 0)
<a name="l02721"></a>02721     {
<a name="l02722"></a>02722         <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().KSPPreconditioner().set(cp::ksp_preconditioner_type::ldufactorisation);
<a name="l02723"></a>02723         <span class="keywordflow">return</span>;
<a name="l02724"></a>02724     }
<a name="l02725"></a>02725     <span class="keywordflow">if</span> ( strcmp(kspPreconditioner, <span class="stringliteral">"none"</span>) == 0)
<a name="l02726"></a>02726     {
<a name="l02727"></a>02727         <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().KSPPreconditioner().set(cp::ksp_preconditioner_type::none);
<a name="l02728"></a>02728         <span class="keywordflow">return</span>;
<a name="l02729"></a>02729     }
<a name="l02730"></a>02730 
<a name="l02731"></a>02731     <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a>(<span class="stringliteral">"Unknown preconditioner type provided"</span>);
<a name="l02732"></a>02732 }
<a name="l02733"></a>02733 
<a name="l02734"></a><a class="code" href="classHeartConfig.html#77b2a1b00344f7012ea8610d6315324c">02734</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#77b2a1b00344f7012ea8610d6315324c">HeartConfig::SetMeshPartitioning</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* meshPartioningMethod)
<a name="l02735"></a>02735 {
<a name="l02736"></a>02736     <span class="comment">/* Note that changes in these conditions need to be reflected in the Doxygen*/</span>
<a name="l02737"></a>02737     <span class="keywordflow">if</span> ( strcmp(meshPartioningMethod, <span class="stringliteral">"dumb"</span>) == 0)
<a name="l02738"></a>02738     {
<a name="l02739"></a>02739         <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().MeshPartitioning().set(cp::mesh_partitioning_type::dumb);
<a name="l02740"></a>02740         <span class="keywordflow">return</span>;
<a name="l02741"></a>02741     }
<a name="l02742"></a>02742     <span class="keywordflow">if</span> ( strcmp(meshPartioningMethod, <span class="stringliteral">"metis"</span>) == 0)
<a name="l02743"></a>02743     {
<a name="l02744"></a>02744         <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().MeshPartitioning().set(cp::mesh_partitioning_type::metis);
<a name="l02745"></a>02745         <span class="keywordflow">return</span>;
<a name="l02746"></a>02746     }
<a name="l02747"></a>02747     <span class="keywordflow">if</span> ( strcmp(meshPartioningMethod, <span class="stringliteral">"parmetis"</span>) == 0)
<a name="l02748"></a>02748     {
<a name="l02749"></a>02749         <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().MeshPartitioning().set(cp::mesh_partitioning_type::parmetis);
<a name="l02750"></a>02750         <span class="keywordflow">return</span>;
<a name="l02751"></a>02751     }
<a name="l02752"></a>02752     <span class="keywordflow">if</span> ( strcmp(meshPartioningMethod, <span class="stringliteral">"petsc"</span>) == 0)
<a name="l02753"></a>02753     {
<a name="l02754"></a>02754         <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().MeshPartitioning().set(cp::mesh_partitioning_type::petsc);
<a name="l02755"></a>02755         <span class="keywordflow">return</span>;
<a name="l02756"></a>02756     }
<a name="l02757"></a>02757 
<a name="l02758"></a>02758     <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a>(<span class="stringliteral">"Unknown mesh partitioning method provided"</span>);
<a name="l02759"></a>02759 }
<a name="l02760"></a>02760 
<a name="l02761"></a><a class="code" href="classHeartConfig.html#eaa1ff9d97c84353beaced74801b0677">02761</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#eaa1ff9d97c84353beaced74801b0677">HeartConfig::SetAdaptivityParameters</a>(<span class="keywordtype">double</span> targetError,
<a name="l02762"></a>02762                                           <span class="keywordtype">double</span> sigma,
<a name="l02763"></a>02763                                           <span class="keywordtype">double</span> maxEdgeLength,
<a name="l02764"></a>02764                                           <span class="keywordtype">double</span> minEdgeLength,
<a name="l02765"></a>02765                                           <span class="keywordtype">double</span> gradation,
<a name="l02766"></a>02766                                           <span class="keywordtype">unsigned</span> maxNodes,
<a name="l02767"></a>02767                                           <span class="keywordtype">unsigned</span> numSweeps )
<a name="l02768"></a>02768 {
<a name="l02769"></a>02769     <span class="keywordflow">if</span> ( maxEdgeLength &lt; minEdgeLength )
<a name="l02770"></a>02770     {
<a name="l02771"></a>02771         <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a>(<span class="stringliteral">"AdaptivityParameters: maxEdgeLength must be greater than minEdgeLength."</span>);
<a name="l02772"></a>02772     }
<a name="l02773"></a>02773 
<a name="l02774"></a>02774     cp::adaptivity_parameters_type element(targetError,
<a name="l02775"></a>02775                                            sigma,
<a name="l02776"></a>02776                                            maxEdgeLength,
<a name="l02777"></a>02777                                            minEdgeLength,
<a name="l02778"></a>02778                                            gradation,
<a name="l02779"></a>02779                                            maxNodes,
<a name="l02780"></a>02780                                            numSweeps );
<a name="l02781"></a>02781     <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().AdaptivityParameters().set(element);
<a name="l02782"></a>02782 
<a name="l02783"></a>02783     <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#facc6a848f43660c4cccfd9b66cc0df2">IsAdaptivityParametersPresent</a>())
<a name="l02784"></a>02784     {
<a name="l02785"></a>02785         <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().AdaptivityParameters()-&gt;target_error(targetError);
<a name="l02786"></a>02786         <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().AdaptivityParameters()-&gt;sigma(sigma);
<a name="l02787"></a>02787         <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().AdaptivityParameters()-&gt;max_edge_length(maxEdgeLength);
<a name="l02788"></a>02788         <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().AdaptivityParameters()-&gt;min_edge_length(minEdgeLength);
<a name="l02789"></a>02789         <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().AdaptivityParameters()-&gt;gradation(gradation);
<a name="l02790"></a>02790         <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().AdaptivityParameters()-&gt;max_nodes(maxNodes);
<a name="l02791"></a>02791         <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().AdaptivityParameters()-&gt;num_sweeps(numSweeps);
<a name="l02792"></a>02792     }
<a name="l02793"></a>02793 }
<a name="l02794"></a>02794 
<a name="l02795"></a><a class="code" href="classHeartConfig.html#f61472d0d68690001248a53021136ede">02795</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#f61472d0d68690001248a53021136ede">HeartConfig::SetTargetErrorForAdaptivity</a>(<span class="keywordtype">double</span> targetError)
<a name="l02796"></a>02796 {
<a name="l02797"></a>02797     <a class="code" href="classHeartConfig.html#eaa1ff9d97c84353beaced74801b0677">SetAdaptivityParameters</a>( targetError,
<a name="l02798"></a>02798                              <a class="code" href="classHeartConfig.html#66fc480d24bc9f8535c89cccd989f9af">GetSigmaForAdaptivity</a>(),
<a name="l02799"></a>02799                              <a class="code" href="classHeartConfig.html#89155d1726cbe35f76ade0648e769a4d">GetMaxEdgeLengthForAdaptivity</a>(),
<a name="l02800"></a>02800                              <a class="code" href="classHeartConfig.html#dcae58747ee8057177bc063ce4b9cc3b">GetMinEdgeLengthForAdaptivity</a>(),
<a name="l02801"></a>02801                              <a class="code" href="classHeartConfig.html#a5bca3744b53e11ec99ad2f3dc259600">GetGradationForAdaptivity</a>(),
<a name="l02802"></a>02802                              <a class="code" href="classHeartConfig.html#4e47a91fa230dda4fb4a708b546c5c2e">GetMaxNodesForAdaptivity</a>(),
<a name="l02803"></a>02803                              <a class="code" href="classHeartConfig.html#2dd2113b9c0b0ec6e1f86de50727cbf2">GetNumberOfAdaptiveSweeps</a>() );
<a name="l02804"></a>02804 }
<a name="l02805"></a>02805 
<a name="l02806"></a><a class="code" href="classHeartConfig.html#808a698e410f90ca8ba2672987a9251f">02806</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#808a698e410f90ca8ba2672987a9251f">HeartConfig::SetSigmaForAdaptivity</a>(<span class="keywordtype">double</span> sigma)
<a name="l02807"></a>02807 {
<a name="l02808"></a>02808     <a class="code" href="classHeartConfig.html#eaa1ff9d97c84353beaced74801b0677">SetAdaptivityParameters</a>( <a class="code" href="classHeartConfig.html#10bc06efde462cf251767739cd1b69ac">GetTargetErrorForAdaptivity</a>(),
<a name="l02809"></a>02809                              sigma,
<a name="l02810"></a>02810                              <a class="code" href="classHeartConfig.html#89155d1726cbe35f76ade0648e769a4d">GetMaxEdgeLengthForAdaptivity</a>(),
<a name="l02811"></a>02811                              <a class="code" href="classHeartConfig.html#dcae58747ee8057177bc063ce4b9cc3b">GetMinEdgeLengthForAdaptivity</a>(),
<a name="l02812"></a>02812                              <a class="code" href="classHeartConfig.html#a5bca3744b53e11ec99ad2f3dc259600">GetGradationForAdaptivity</a>(),
<a name="l02813"></a>02813                              <a class="code" href="classHeartConfig.html#4e47a91fa230dda4fb4a708b546c5c2e">GetMaxNodesForAdaptivity</a>(),
<a name="l02814"></a>02814                              <a class="code" href="classHeartConfig.html#2dd2113b9c0b0ec6e1f86de50727cbf2">GetNumberOfAdaptiveSweeps</a>() );
<a name="l02815"></a>02815 }
<a name="l02816"></a>02816 
<a name="l02817"></a><a class="code" href="classHeartConfig.html#69b52a18a321d7c42e03e25828fffd81">02817</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#69b52a18a321d7c42e03e25828fffd81">HeartConfig::SetMaxEdgeLengthForAdaptivity</a>(<span class="keywordtype">double</span> maxEdgeLength)
<a name="l02818"></a>02818 {
<a name="l02819"></a>02819     <a class="code" href="classHeartConfig.html#eaa1ff9d97c84353beaced74801b0677">SetAdaptivityParameters</a>( <a class="code" href="classHeartConfig.html#10bc06efde462cf251767739cd1b69ac">GetTargetErrorForAdaptivity</a>(),
<a name="l02820"></a>02820                              <a class="code" href="classHeartConfig.html#66fc480d24bc9f8535c89cccd989f9af">GetSigmaForAdaptivity</a>(),
<a name="l02821"></a>02821                              maxEdgeLength,
<a name="l02822"></a>02822                              <a class="code" href="classHeartConfig.html#dcae58747ee8057177bc063ce4b9cc3b">GetMinEdgeLengthForAdaptivity</a>(),
<a name="l02823"></a>02823                              <a class="code" href="classHeartConfig.html#a5bca3744b53e11ec99ad2f3dc259600">GetGradationForAdaptivity</a>(),
<a name="l02824"></a>02824                              <a class="code" href="classHeartConfig.html#4e47a91fa230dda4fb4a708b546c5c2e">GetMaxNodesForAdaptivity</a>(),
<a name="l02825"></a>02825                              <a class="code" href="classHeartConfig.html#2dd2113b9c0b0ec6e1f86de50727cbf2">GetNumberOfAdaptiveSweeps</a>() );
<a name="l02826"></a>02826 }
<a name="l02827"></a>02827 
<a name="l02828"></a><a class="code" href="classHeartConfig.html#db6d52afd86ecb6af18e8edbc90c4823">02828</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#db6d52afd86ecb6af18e8edbc90c4823">HeartConfig::SetMinEdgeLengthForAdaptivity</a>(<span class="keywordtype">double</span> minEdgeLength)
<a name="l02829"></a>02829 {
<a name="l02830"></a>02830     <a class="code" href="classHeartConfig.html#eaa1ff9d97c84353beaced74801b0677">SetAdaptivityParameters</a>( <a class="code" href="classHeartConfig.html#10bc06efde462cf251767739cd1b69ac">GetTargetErrorForAdaptivity</a>(),
<a name="l02831"></a>02831                              <a class="code" href="classHeartConfig.html#66fc480d24bc9f8535c89cccd989f9af">GetSigmaForAdaptivity</a>(),
<a name="l02832"></a>02832                              <a class="code" href="classHeartConfig.html#89155d1726cbe35f76ade0648e769a4d">GetMaxEdgeLengthForAdaptivity</a>(),
<a name="l02833"></a>02833                              minEdgeLength,
<a name="l02834"></a>02834                              <a class="code" href="classHeartConfig.html#a5bca3744b53e11ec99ad2f3dc259600">GetGradationForAdaptivity</a>(),
<a name="l02835"></a>02835                              <a class="code" href="classHeartConfig.html#4e47a91fa230dda4fb4a708b546c5c2e">GetMaxNodesForAdaptivity</a>(),
<a name="l02836"></a>02836                              <a class="code" href="classHeartConfig.html#2dd2113b9c0b0ec6e1f86de50727cbf2">GetNumberOfAdaptiveSweeps</a>() );
<a name="l02837"></a>02837 }
<a name="l02838"></a>02838 
<a name="l02839"></a><a class="code" href="classHeartConfig.html#f40cdcdc016ed78ab75eda3ba4aebbf6">02839</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#f40cdcdc016ed78ab75eda3ba4aebbf6">HeartConfig::SetGradationForAdaptivity</a>(<span class="keywordtype">double</span> gradation)
<a name="l02840"></a>02840 {
<a name="l02841"></a>02841     <a class="code" href="classHeartConfig.html#eaa1ff9d97c84353beaced74801b0677">SetAdaptivityParameters</a>( <a class="code" href="classHeartConfig.html#10bc06efde462cf251767739cd1b69ac">GetTargetErrorForAdaptivity</a>(),
<a name="l02842"></a>02842                              <a class="code" href="classHeartConfig.html#66fc480d24bc9f8535c89cccd989f9af">GetSigmaForAdaptivity</a>(),
<a name="l02843"></a>02843                              <a class="code" href="classHeartConfig.html#89155d1726cbe35f76ade0648e769a4d">GetMaxEdgeLengthForAdaptivity</a>(),
<a name="l02844"></a>02844                              <a class="code" href="classHeartConfig.html#dcae58747ee8057177bc063ce4b9cc3b">GetMinEdgeLengthForAdaptivity</a>(),
<a name="l02845"></a>02845                              gradation,
<a name="l02846"></a>02846                              <a class="code" href="classHeartConfig.html#4e47a91fa230dda4fb4a708b546c5c2e">GetMaxNodesForAdaptivity</a>(),
<a name="l02847"></a>02847                              <a class="code" href="classHeartConfig.html#2dd2113b9c0b0ec6e1f86de50727cbf2">GetNumberOfAdaptiveSweeps</a>() );
<a name="l02848"></a>02848 }
<a name="l02849"></a>02849 
<a name="l02850"></a><a class="code" href="classHeartConfig.html#1a6b85e059d5e25943122374e24021ce">02850</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#1a6b85e059d5e25943122374e24021ce">HeartConfig::SetMaxNodesForAdaptivity</a>(<span class="keywordtype">unsigned</span> maxNodes)
<a name="l02851"></a>02851 {
<a name="l02852"></a>02852     <a class="code" href="classHeartConfig.html#eaa1ff9d97c84353beaced74801b0677">SetAdaptivityParameters</a>( <a class="code" href="classHeartConfig.html#10bc06efde462cf251767739cd1b69ac">GetTargetErrorForAdaptivity</a>(),
<a name="l02853"></a>02853                              <a class="code" href="classHeartConfig.html#66fc480d24bc9f8535c89cccd989f9af">GetSigmaForAdaptivity</a>(),
<a name="l02854"></a>02854                              <a class="code" href="classHeartConfig.html#89155d1726cbe35f76ade0648e769a4d">GetMaxEdgeLengthForAdaptivity</a>(),
<a name="l02855"></a>02855                              <a class="code" href="classHeartConfig.html#dcae58747ee8057177bc063ce4b9cc3b">GetMinEdgeLengthForAdaptivity</a>(),
<a name="l02856"></a>02856                              <a class="code" href="classHeartConfig.html#a5bca3744b53e11ec99ad2f3dc259600">GetGradationForAdaptivity</a>(),
<a name="l02857"></a>02857                              maxNodes,
<a name="l02858"></a>02858                              <a class="code" href="classHeartConfig.html#2dd2113b9c0b0ec6e1f86de50727cbf2">GetNumberOfAdaptiveSweeps</a>() );
<a name="l02859"></a>02859 }
<a name="l02860"></a>02860 
<a name="l02861"></a><a class="code" href="classHeartConfig.html#6ea802a3b748b68e44d225437db5673c">02861</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#6ea802a3b748b68e44d225437db5673c">HeartConfig::SetNumberOfAdaptiveSweeps</a>(<span class="keywordtype">unsigned</span> numSweeps)
<a name="l02862"></a>02862 {
<a name="l02863"></a>02863     <a class="code" href="classHeartConfig.html#eaa1ff9d97c84353beaced74801b0677">SetAdaptivityParameters</a>( <a class="code" href="classHeartConfig.html#10bc06efde462cf251767739cd1b69ac">GetTargetErrorForAdaptivity</a>(),
<a name="l02864"></a>02864                              <a class="code" href="classHeartConfig.html#66fc480d24bc9f8535c89cccd989f9af">GetSigmaForAdaptivity</a>(),
<a name="l02865"></a>02865                              <a class="code" href="classHeartConfig.html#89155d1726cbe35f76ade0648e769a4d">GetMaxEdgeLengthForAdaptivity</a>(),
<a name="l02866"></a>02866                              <a class="code" href="classHeartConfig.html#dcae58747ee8057177bc063ce4b9cc3b">GetMinEdgeLengthForAdaptivity</a>(),
<a name="l02867"></a>02867                              <a class="code" href="classHeartConfig.html#a5bca3744b53e11ec99ad2f3dc259600">GetGradationForAdaptivity</a>(),
<a name="l02868"></a>02868                              <a class="code" href="classHeartConfig.html#4e47a91fa230dda4fb4a708b546c5c2e">GetMaxNodesForAdaptivity</a>(),
<a name="l02869"></a>02869                              numSweeps );
<a name="l02870"></a>02870 }
<a name="l02871"></a>02871 
<a name="l02872"></a><a class="code" href="classHeartConfig.html#46a0aee372225151c523f521b2e70354">02872</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#46a0aee372225151c523f521b2e70354">HeartConfig::SetApdMaps</a>(<span class="keyword">const</span> std::vector&lt;std::pair&lt;double,double&gt; &gt;&amp; apdMaps)
<a name="l02873"></a>02873 {
<a name="l02874"></a>02874     <a class="code" href="classHeartConfig.html#66b61cef16319298971d3961516229db">EnsurePostProcessingSectionPresent</a>();
<a name="l02875"></a>02875     XSD_SEQUENCE_TYPE(cp::postprocessing_type::ActionPotentialDurationMap)&amp; apd_maps_sequence
<a name="l02876"></a>02876         = <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;PostProcessing()-&gt;ActionPotentialDurationMap();
<a name="l02877"></a>02877     <span class="comment">//Erase or create a sequence</span>
<a name="l02878"></a>02878     apd_maps_sequence.clear();
<a name="l02879"></a>02879 
<a name="l02880"></a>02880     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0; i&lt;apdMaps.size(); i++)
<a name="l02881"></a>02881     {
<a name="l02882"></a>02882         XSD_CREATE_WITH_FIXED_ATTR2(cp::apd_map_type, temp,
<a name="l02883"></a>02883                                     apdMaps[i].first, apdMaps[i].second,
<a name="l02884"></a>02884                                     <span class="stringliteral">"mV"</span>);
<a name="l02885"></a>02885         apd_maps_sequence.push_back( temp);
<a name="l02886"></a>02886     }
<a name="l02887"></a>02887 }
<a name="l02888"></a>02888 
<a name="l02889"></a>02889 
<a name="l02890"></a><a class="code" href="classHeartConfig.html#44efaadc8d2d6d415bac30db41c10604">02890</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#44efaadc8d2d6d415bac30db41c10604">HeartConfig::SetUpstrokeTimeMaps</a> (std::vector&lt;double&gt;&amp; upstrokeTimeMaps)
<a name="l02891"></a>02891 {
<a name="l02892"></a>02892     <a class="code" href="classHeartConfig.html#66b61cef16319298971d3961516229db">EnsurePostProcessingSectionPresent</a>();
<a name="l02893"></a>02893     XSD_SEQUENCE_TYPE(cp::postprocessing_type::UpstrokeTimeMap)&amp; var_type_sequence
<a name="l02894"></a>02894         = <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;PostProcessing()-&gt;UpstrokeTimeMap();
<a name="l02895"></a>02895 
<a name="l02896"></a>02896     <span class="comment">//Erase or create a sequence</span>
<a name="l02897"></a>02897     var_type_sequence.clear();
<a name="l02898"></a>02898 
<a name="l02899"></a>02899     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0; i&lt;upstrokeTimeMaps.size(); i++)
<a name="l02900"></a>02900     {
<a name="l02901"></a>02901         XSD_CREATE_WITH_FIXED_ATTR1(cp::upstrokes_map_type, temp,
<a name="l02902"></a>02902                                     upstrokeTimeMaps[i],
<a name="l02903"></a>02903                                     <span class="stringliteral">"mV"</span>);
<a name="l02904"></a>02904         var_type_sequence.push_back(temp);
<a name="l02905"></a>02905     }
<a name="l02906"></a>02906 }
<a name="l02907"></a>02907 
<a name="l02908"></a><a class="code" href="classHeartConfig.html#16bdac7c8f00948b957b99d4c606bf80">02908</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#16bdac7c8f00948b957b99d4c606bf80">HeartConfig::SetMaxUpstrokeVelocityMaps</a> (std::vector&lt;double&gt;&amp; maxUpstrokeVelocityMaps)
<a name="l02909"></a>02909 {
<a name="l02910"></a>02910     <a class="code" href="classHeartConfig.html#66b61cef16319298971d3961516229db">EnsurePostProcessingSectionPresent</a>();
<a name="l02911"></a>02911     XSD_SEQUENCE_TYPE(cp::postprocessing_type::MaxUpstrokeVelocityMap)&amp; max_upstroke_velocity_maps_sequence
<a name="l02912"></a>02912         = <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;PostProcessing()-&gt;MaxUpstrokeVelocityMap();
<a name="l02913"></a>02913 
<a name="l02914"></a>02914     <span class="comment">//Erase or create a sequence</span>
<a name="l02915"></a>02915     max_upstroke_velocity_maps_sequence.clear();
<a name="l02916"></a>02916 
<a name="l02917"></a>02917     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0; i&lt;maxUpstrokeVelocityMaps.size(); i++)
<a name="l02918"></a>02918     {
<a name="l02919"></a>02919         XSD_CREATE_WITH_FIXED_ATTR1(cp::max_upstrokes_velocity_map_type, temp,
<a name="l02920"></a>02920                                     maxUpstrokeVelocityMaps[i],
<a name="l02921"></a>02921                                     <span class="stringliteral">"mV"</span>);
<a name="l02922"></a>02922 
<a name="l02923"></a>02923 
<a name="l02924"></a>02924         max_upstroke_velocity_maps_sequence.push_back(temp);
<a name="l02925"></a>02925     }
<a name="l02926"></a>02926 
<a name="l02927"></a>02927 }
<a name="l02928"></a>02928 
<a name="l02929"></a><a class="code" href="classHeartConfig.html#b109643161a85ddcbbe620065d14d186">02929</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#b109643161a85ddcbbe620065d14d186">HeartConfig::SetConductionVelocityMaps</a> (std::vector&lt;unsigned&gt;&amp; conductionVelocityMaps)
<a name="l02930"></a>02930 {
<a name="l02931"></a>02931     <a class="code" href="classHeartConfig.html#66b61cef16319298971d3961516229db">EnsurePostProcessingSectionPresent</a>();
<a name="l02932"></a>02932     XSD_SEQUENCE_TYPE(cp::postprocessing_type::ConductionVelocityMap)&amp; conduction_velocity_maps_sequence
<a name="l02933"></a>02933         = <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;PostProcessing()-&gt;ConductionVelocityMap();
<a name="l02934"></a>02934 
<a name="l02935"></a>02935     <span class="comment">//Erase or create a sequence</span>
<a name="l02936"></a>02936     conduction_velocity_maps_sequence.clear();
<a name="l02937"></a>02937 
<a name="l02938"></a>02938     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0; i&lt;conductionVelocityMaps.size(); i++)
<a name="l02939"></a>02939     {
<a name="l02940"></a>02940         cp::conduction_velocity_map_type temp(conductionVelocityMaps[i]);
<a name="l02941"></a>02941         conduction_velocity_maps_sequence.push_back(temp);
<a name="l02942"></a>02942     }
<a name="l02943"></a>02943 }
<a name="l02944"></a>02944 
<a name="l02945"></a><a class="code" href="classHeartConfig.html#039813d26b718f5811ed09da0dda0306">02945</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#039813d26b718f5811ed09da0dda0306">HeartConfig::SetRequestedNodalTimeTraces</a> (std::vector&lt;unsigned&gt;&amp; requestedNodes)
<a name="l02946"></a>02946 {
<a name="l02947"></a>02947     <a class="code" href="classHeartConfig.html#66b61cef16319298971d3961516229db">EnsurePostProcessingSectionPresent</a>();
<a name="l02948"></a>02948     XSD_SEQUENCE_TYPE(cp::postprocessing_type::TimeTraceAtNode)&amp; requested_nodes_sequence
<a name="l02949"></a>02949         = <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;PostProcessing()-&gt;TimeTraceAtNode();
<a name="l02950"></a>02950 
<a name="l02951"></a>02951     <span class="comment">//Erase or create a sequence</span>
<a name="l02952"></a>02952     requested_nodes_sequence.clear();
<a name="l02953"></a>02953 
<a name="l02954"></a>02954     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0; i&lt;requestedNodes.size(); i++)
<a name="l02955"></a>02955     {
<a name="l02956"></a>02956         cp::node_number_type temp(requestedNodes[i]);
<a name="l02957"></a>02957         requested_nodes_sequence.push_back(temp);
<a name="l02958"></a>02958     }
<a name="l02959"></a>02959 }
<a name="l02960"></a>02960 
<a name="l02961"></a>02961 <span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> SPACE_DIM&gt;
<a name="l02962"></a><a class="code" href="classHeartConfig.html#31c997d4d91e1bb1cbb0177d29186cd8">02962</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#31c997d4d91e1bb1cbb0177d29186cd8">HeartConfig::SetPseudoEcgElectrodePositions</a>(<span class="keyword">const</span> std::vector&lt;<a class="code" href="classChastePoint.html">ChastePoint&lt;SPACE_DIM&gt;</a> &gt;&amp; rPseudoEcgElectrodePositions)
<a name="l02963"></a>02963 {
<a name="l02964"></a>02964     <a class="code" href="classHeartConfig.html#66b61cef16319298971d3961516229db">EnsurePostProcessingSectionPresent</a>();
<a name="l02965"></a>02965     XSD_SEQUENCE_TYPE(cp::postprocessing_type::PseudoEcgElectrodePosition)&amp; electrodes_sequence
<a name="l02966"></a>02966         = <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;PostProcessing()-&gt;PseudoEcgElectrodePosition();
<a name="l02967"></a>02967 
<a name="l02968"></a>02968     <span class="comment">//Erase or create a sequence</span>
<a name="l02969"></a>02969     electrodes_sequence.clear();
<a name="l02970"></a>02970 
<a name="l02971"></a>02971     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0; i&lt;rPseudoEcgElectrodePositions.size(); i++)
<a name="l02972"></a>02972     {
<a name="l02973"></a>02973         cp::point_type temp(rPseudoEcgElectrodePositions[i].GetWithDefault(0),
<a name="l02974"></a>02974                             rPseudoEcgElectrodePositions[i].GetWithDefault(1),
<a name="l02975"></a>02975                             rPseudoEcgElectrodePositions[i].GetWithDefault(2));
<a name="l02976"></a>02976         electrodes_sequence.push_back(temp);
<a name="l02977"></a>02977     }
<a name="l02978"></a>02978 }
<a name="l02979"></a>02979 
<a name="l02980"></a>02980 
<a name="l02981"></a>02981 <span class="comment">/*</span>
<a name="l02982"></a>02982 <span class="comment"> * Output visualizer</span>
<a name="l02983"></a>02983 <span class="comment"> */</span>
<a name="l02984"></a>02984 
<a name="l02985"></a><a class="code" href="classHeartConfig.html#73fef33f054b532719b5f83a784b2c0c">02985</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#73fef33f054b532719b5f83a784b2c0c">HeartConfig::EnsureOutputVisualizerExists</a>()
<a name="l02986"></a>02986 {
<a name="l02987"></a>02987     ENSURE_SECTION_PRESENT(<a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;OutputVisualizer(), cp::output_visualizer_type);
<a name="l02988"></a>02988 }
<a name="l02989"></a>02989 
<a name="l02990"></a><a class="code" href="classHeartConfig.html#7ef84b9090f708031aac64b7504742e0">02990</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#7ef84b9090f708031aac64b7504742e0">HeartConfig::SetVisualizeWithMeshalyzer</a>(<span class="keywordtype">bool</span> useMeshalyzer)
<a name="l02991"></a>02991 {
<a name="l02992"></a>02992     <a class="code" href="classHeartConfig.html#73fef33f054b532719b5f83a784b2c0c">EnsureOutputVisualizerExists</a>();
<a name="l02993"></a>02993 
<a name="l02994"></a>02994     <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;OutputVisualizer()-&gt;meshalyzer(
<a name="l02995"></a>02995         useMeshalyzer ? cp::yesno_type::yes : cp::yesno_type::no);
<a name="l02996"></a>02996 }
<a name="l02997"></a>02997 
<a name="l02998"></a><a class="code" href="classHeartConfig.html#f1c744570c4f03ee01b52c62ca4ef40f">02998</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#f1c744570c4f03ee01b52c62ca4ef40f">HeartConfig::SetVisualizeWithCmgui</a>(<span class="keywordtype">bool</span> useCmgui)
<a name="l02999"></a>02999 {
<a name="l03000"></a>03000     <a class="code" href="classHeartConfig.html#73fef33f054b532719b5f83a784b2c0c">EnsureOutputVisualizerExists</a>();
<a name="l03001"></a>03001 
<a name="l03002"></a>03002     <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;OutputVisualizer()-&gt;cmgui(
<a name="l03003"></a>03003         useCmgui ? cp::yesno_type::yes : cp::yesno_type::no);
<a name="l03004"></a>03004 }
<a name="l03005"></a>03005 
<a name="l03006"></a><a class="code" href="classHeartConfig.html#a64153e80db50c971a58069dd3e1350e">03006</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a64153e80db50c971a58069dd3e1350e">HeartConfig::SetVisualizeWithVtk</a>(<span class="keywordtype">bool</span> useVtk)
<a name="l03007"></a>03007 {
<a name="l03008"></a>03008     <a class="code" href="classHeartConfig.html#73fef33f054b532719b5f83a784b2c0c">EnsureOutputVisualizerExists</a>();
<a name="l03009"></a>03009 
<a name="l03010"></a>03010     <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;OutputVisualizer()-&gt;vtk(
<a name="l03011"></a>03011         useVtk ? cp::yesno_type::yes : cp::yesno_type::no);
<a name="l03012"></a>03012 }
<a name="l03013"></a>03013 
<a name="l03014"></a><a class="code" href="classHeartConfig.html#f43426509538104d4a68b88328c470a6">03014</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#f43426509538104d4a68b88328c470a6">HeartConfig::SetVisualizeWithParallelVtk</a>(<span class="keywordtype">bool</span> useParallelVtk)
<a name="l03015"></a>03015 {
<a name="l03016"></a>03016     <a class="code" href="classHeartConfig.html#73fef33f054b532719b5f83a784b2c0c">EnsureOutputVisualizerExists</a>();
<a name="l03017"></a>03017 
<a name="l03018"></a>03018     <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;OutputVisualizer()-&gt;parallel_vtk(
<a name="l03019"></a>03019         useParallelVtk ? cp::yesno_type::yes : cp::yesno_type::no);
<a name="l03020"></a>03020 }
<a name="l03021"></a>03021 
<a name="l03022"></a><a class="code" href="classHeartConfig.html#37e6290f609b9921dc5a0f25a38dcdee">03022</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#37e6290f609b9921dc5a0f25a38dcdee">HeartConfig::SetElectrodeParameters</a>(<span class="keywordtype">bool</span> groundSecondElectrode,
<a name="l03023"></a>03023                                          <span class="keywordtype">unsigned</span> index, <span class="keywordtype">double</span> magnitude,
<a name="l03024"></a>03024                                          <span class="keywordtype">double</span> startTime, <span class="keywordtype">double</span> duration )
<a name="l03025"></a>03025 {
<a name="l03026"></a>03026     assert(index &lt; 3);
<a name="l03027"></a>03027 
<a name="l03028"></a>03028     cp::axis_type axis = cp::axis_type::x;
<a name="l03029"></a>03029     <span class="keywordflow">if</span> (index==1)
<a name="l03030"></a>03030     {
<a name="l03031"></a>03031         axis = cp::axis_type::y;
<a name="l03032"></a>03032     }
<a name="l03033"></a>03033     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (index==2)
<a name="l03034"></a>03034     {
<a name="l03035"></a>03035         axis = cp::axis_type::z;
<a name="l03036"></a>03036     }
<a name="l03037"></a>03037 
<a name="l03038"></a>03038     XSD_CREATE_WITH_FIXED_ATTR1(cp::surface_stimulus_strength_type, strength, magnitude, <span class="stringliteral">"uA/cm^2"</span>);
<a name="l03039"></a>03039     XSD_CREATE_WITH_FIXED_ATTR1(cp::time_type, start_time, startTime, <span class="stringliteral">"ms"</span>);
<a name="l03040"></a>03040     XSD_CREATE_WITH_FIXED_ATTR1(cp::time_type, duration_time, duration, <span class="stringliteral">"ms"</span>);
<a name="l03041"></a>03041 
<a name="l03042"></a>03042     <span class="keywordflow">if</span> (!<a class="code" href="classHeartConfig.html#e8af113affbf405e11b536a995bb8530">IsElectrodesPresent</a>())
<a name="l03043"></a>03043     {
<a name="l03044"></a>03044         cp::electrodes_type element( groundSecondElectrode ? cp::yesno_type::yes : cp::yesno_type::no,
<a name="l03045"></a>03045                                      axis,
<a name="l03046"></a>03046                                      strength,
<a name="l03047"></a>03047                                      start_time,
<a name="l03048"></a>03048                                      duration_time );
<a name="l03049"></a>03049         <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;Electrodes().set(element);
<a name="l03050"></a>03050     }
<a name="l03051"></a>03051     <span class="keywordflow">else</span>
<a name="l03052"></a>03052     {
<a name="l03053"></a>03053         <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;Electrodes()-&gt;GroundSecondElectrode(groundSecondElectrode ? cp::yesno_type::yes : cp::yesno_type::no);
<a name="l03054"></a>03054         <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;Electrodes()-&gt;PerpendicularToAxis(axis);
<a name="l03055"></a>03055         <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;Electrodes()-&gt;Strength(strength);
<a name="l03056"></a>03056         <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;Electrodes()-&gt;StartTime(start_time);
<a name="l03057"></a>03057         <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;Electrodes()-&gt;Duration(duration_time);
<a name="l03058"></a>03058     }
<a name="l03059"></a>03059 }
<a name="l03060"></a>03060 
<a name="l03061"></a><a class="code" href="classHeartConfig.html#bbfee3679dfe3964f5db187145084dc9">03061</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#bbfee3679dfe3964f5db187145084dc9">HeartConfig::GetElectrodeParameters</a>(<span class="keywordtype">bool</span>&amp; rGroundSecondElectrode,
<a name="l03062"></a>03062                                          <span class="keywordtype">unsigned</span>&amp; rIndex, <span class="keywordtype">double</span>&amp; rMagnitude,
<a name="l03063"></a>03063                                          <span class="keywordtype">double</span>&amp; rStartTime, <span class="keywordtype">double</span>&amp; rDuration )
<a name="l03064"></a>03064 {
<a name="l03065"></a>03065     <span class="keywordflow">if</span> (!<a class="code" href="classHeartConfig.html#e8af113affbf405e11b536a995bb8530">IsElectrodesPresent</a>())
<a name="l03066"></a>03066     {
<a name="l03067"></a>03067         <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a>(<span class="stringliteral">"Attempted to get electrodes that have not been defined."</span>);
<a name="l03068"></a>03068     }
<a name="l03069"></a>03069     <span class="keywordflow">else</span>
<a name="l03070"></a>03070     {
<a name="l03071"></a>03071         rGroundSecondElectrode = (<a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;Electrodes()-&gt;GroundSecondElectrode()==cp::yesno_type::yes);
<a name="l03072"></a>03072 
<a name="l03073"></a>03073         cp::axis_type axis = <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;Electrodes()-&gt;PerpendicularToAxis();
<a name="l03074"></a>03074         <span class="keywordflow">if</span> (axis==cp::axis_type::x)
<a name="l03075"></a>03075         {
<a name="l03076"></a>03076             rIndex = 0;
<a name="l03077"></a>03077         }
<a name="l03078"></a>03078         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (axis==cp::axis_type::y)
<a name="l03079"></a>03079         {
<a name="l03080"></a>03080             rIndex = 1;
<a name="l03081"></a>03081         }
<a name="l03082"></a>03082         <span class="keywordflow">else</span>
<a name="l03083"></a>03083         {
<a name="l03084"></a>03084             rIndex = 2;
<a name="l03085"></a>03085         }
<a name="l03086"></a>03086 
<a name="l03087"></a>03087         rMagnitude = <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;Electrodes()-&gt;Strength();
<a name="l03088"></a>03088         rStartTime = <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;Electrodes()-&gt;StartTime();
<a name="l03089"></a>03089         rDuration = <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation()-&gt;Electrodes()-&gt;Duration();
<a name="l03090"></a>03090     }
<a name="l03091"></a>03091 
<a name="l03092"></a>03092 }
<a name="l03093"></a>03093 
<a name="l03094"></a><a class="code" href="classHeartConfig.html#fbfe229dd570539f508a395ef7c0cdf6">03094</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#fbfe229dd570539f508a395ef7c0cdf6">HeartConfig::GetUseStateVariableInterpolation</a>()<span class="keyword"> const</span>
<a name="l03095"></a>03095 <span class="keyword"></span>{
<a name="l03096"></a>03096     <span class="keywordflow">try</span>
<a name="l03097"></a>03097     {
<a name="l03098"></a>03098         <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().UseStateVariableInterpolation(),
<a name="l03099"></a>03099                                &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Numerical().UseStateVariableInterpolation(),
<a name="l03100"></a>03100                                <span class="stringliteral">"UseStateVariableInterpolation"</span>)-&gt;<span class="keyword">get</span>() == cp::yesno_type::yes;
<a name="l03101"></a>03101     }
<a name="l03102"></a>03102     <span class="keywordflow">catch</span> (<span class="keyword">const</span> <a class="code" href="classException.html">Exception</a>&amp; e)
<a name="l03103"></a>03103     {
<a name="l03104"></a>03104         <span class="comment">// It's an older version parameters &amp; defaults (we're loading a checkpoint)</span>
<a name="l03105"></a>03105         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03106"></a>03106     }
<a name="l03107"></a>03107 }
<a name="l03108"></a>03108 
<a name="l03109"></a><a class="code" href="classHeartConfig.html#7515aa0d0eda9b74eee15ba3e3bc94ca">03109</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#7515aa0d0eda9b74eee15ba3e3bc94ca">HeartConfig::SetUseStateVariableInterpolation</a>(<span class="keywordtype">bool</span> useStateVariableInterpolation)
<a name="l03110"></a>03110 {
<a name="l03111"></a>03111     <span class="keywordflow">if</span> (useStateVariableInterpolation)
<a name="l03112"></a>03112     {
<a name="l03113"></a>03113         <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().UseStateVariableInterpolation().set(cp::yesno_type::yes);
<a name="l03114"></a>03114     }
<a name="l03115"></a>03115     <span class="keywordflow">else</span>
<a name="l03116"></a>03116     {
<a name="l03117"></a>03117         <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().UseStateVariableInterpolation().set(cp::yesno_type::no);
<a name="l03118"></a>03118     }
<a name="l03119"></a>03119 }
<a name="l03120"></a>03120 
<a name="l03121"></a>03121 
<a name="l03122"></a>03122 
<a name="l03123"></a><a class="code" href="classHeartConfig.html#23c9c1ad89e590979fa482ff51c2e57a">03123</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#23c9c1ad89e590979fa482ff51c2e57a">HeartConfig::HasDrugDose</a>()<span class="keyword"> const</span>
<a name="l03124"></a>03124 <span class="keyword"></span>{
<a name="l03125"></a>03125     <span class="keywordflow">try</span>
<a name="l03126"></a>03126     {
<a name="l03127"></a>03127         <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Physiological().ApplyDrug(),
<a name="l03128"></a>03128                         &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Physiological().ApplyDrug(),
<a name="l03129"></a>03129                         <span class="stringliteral">"ApplyDrug"</span>)-&gt;present();
<a name="l03130"></a>03130         <span class="comment">// If there's an element</span>
<a name="l03131"></a>03131         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l03132"></a>03132     }
<a name="l03133"></a>03133     <span class="keywordflow">catch</span> (<a class="code" href="classException.html">Exception</a> &amp;e)
<a name="l03134"></a>03134     {
<a name="l03135"></a>03135         <span class="comment">// No element</span>
<a name="l03136"></a>03136         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l03137"></a>03137     }
<a name="l03138"></a>03138 }
<a name="l03139"></a>03139 
<a name="l03140"></a><a class="code" href="classHeartConfig.html#5c527c55741ca679a4d017b72126700a">03140</a> <span class="keywordtype">double</span> <a class="code" href="classHeartConfig.html#5c527c55741ca679a4d017b72126700a">HeartConfig::GetDrugDose</a>()<span class="keyword"> const</span>
<a name="l03141"></a>03141 <span class="keyword"></span>{
<a name="l03142"></a>03142     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Physiological().ApplyDrug(),
<a name="l03143"></a>03143                            &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Physiological().ApplyDrug(),
<a name="l03144"></a>03144                            <span class="stringliteral">"ApplyDrug"</span>)-&gt;<span class="keyword">get</span>().concentration();
<a name="l03145"></a>03145 }
<a name="l03146"></a>03146 
<a name="l03147"></a><a class="code" href="classHeartConfig.html#4d4dbabe117107031e2451e05fdf1b35">03147</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#4d4dbabe117107031e2451e05fdf1b35">HeartConfig::SetDrugDose</a>(<span class="keywordtype">double</span> drugDose)
<a name="l03148"></a>03148 {
<a name="l03149"></a>03149     <span class="keywordflow">if</span> (!<a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Physiological().ApplyDrug().present())
<a name="l03150"></a>03150     {
<a name="l03151"></a>03151         cp::apply_drug_type drug(drugDose);
<a name="l03152"></a>03152         <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Physiological().ApplyDrug().set(drug);
<a name="l03153"></a>03153     }
<a name="l03154"></a>03154     <span class="keywordflow">else</span>
<a name="l03155"></a>03155     {
<a name="l03156"></a>03156         <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Physiological().ApplyDrug()-&gt;concentration(drugDose);
<a name="l03157"></a>03157     }
<a name="l03158"></a>03158 }
<a name="l03159"></a>03159 
<a name="l03160"></a><a class="code" href="classHeartConfig.html#c5924ffcb6b5c5202eafbf87bc499acb">03160</a> std::map&lt;std::string, std::pair&lt;double, double&gt; &gt; <a class="code" href="classHeartConfig.html#c5924ffcb6b5c5202eafbf87bc499acb">HeartConfig::GetIc50Values</a>()
<a name="l03161"></a>03161 {
<a name="l03162"></a>03162     std::map&lt;std::string, std::pair&lt;double, double&gt; &gt; ic50s;
<a name="l03163"></a>03163 
<a name="l03164"></a>03164     XSD_SEQUENCE_TYPE(cp::apply_drug_type::IC50)&amp;
<a name="l03165"></a>03165         ic50_seq = <a class="code" href="classHeartConfig.html#2e7b99ddb880602e089c56f7bc265908">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Physiological().ApplyDrug(),
<a name="l03166"></a>03166                                    &amp; <a class="code" href="classHeartConfig.html#b9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Physiological().ApplyDrug(),
<a name="l03167"></a>03167                                    <span class="stringliteral">"ApplyDrug"</span>)-&gt;<span class="keyword">get</span>().IC50();
<a name="l03168"></a>03168 
<a name="l03169"></a>03169     <span class="keywordflow">for</span> (XSD_ITERATOR_TYPE(cp::apply_drug_type::IC50) i = ic50_seq.begin();
<a name="l03170"></a>03170          i != ic50_seq.end();
<a name="l03171"></a>03171          ++i)
<a name="l03172"></a>03172     {
<a name="l03173"></a>03173         std::pair&lt;double, double&gt; ic50_hill(*i, i-&gt;hill());
<a name="l03174"></a>03174         std::string current = i-&gt;current();
<a name="l03175"></a>03175         ic50s[current] = ic50_hill;
<a name="l03176"></a>03176     }
<a name="l03177"></a>03177 
<a name="l03178"></a>03178     <span class="keywordflow">return</span> ic50s;
<a name="l03179"></a>03179 }
<a name="l03180"></a>03180 
<a name="l03181"></a><a class="code" href="classHeartConfig.html#5f10bf2e6cd00ccead4b501e6e66a369">03181</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#5f10bf2e6cd00ccead4b501e6e66a369">HeartConfig::SetIc50Value</a>(<span class="keyword">const</span> std::string&amp; rCurrentName, <span class="keywordtype">double</span> ic50, <span class="keywordtype">double</span> hill)
<a name="l03182"></a>03182 {
<a name="l03183"></a>03183     <span class="keywordflow">if</span> (!<a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Physiological().ApplyDrug().present())
<a name="l03184"></a>03184     {
<a name="l03185"></a>03185         <a class="code" href="classHeartConfig.html#4d4dbabe117107031e2451e05fdf1b35">SetDrugDose</a>(0.0);
<a name="l03186"></a>03186     }
<a name="l03187"></a>03187     XSD_SEQUENCE_TYPE(cp::apply_drug_type::IC50)&amp; ic50_seq = <a class="code" href="classHeartConfig.html#7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Physiological().ApplyDrug()-&gt;IC50();
<a name="l03188"></a>03188     <span class="keywordflow">if</span> (ic50_seq.empty())
<a name="l03189"></a>03189     {
<a name="l03190"></a>03190         <span class="comment">// Erase or create a sequence</span>
<a name="l03191"></a>03191         ic50_seq.clear();
<a name="l03192"></a>03192     }
<a name="l03193"></a>03193     <span class="keywordtype">bool</span> entry_exists = <span class="keyword">false</span>;
<a name="l03194"></a>03194     cp::ic50_type ic50_elt(ic50, rCurrentName);
<a name="l03195"></a>03195     ic50_elt.hill(hill);
<a name="l03196"></a>03196     <span class="keywordflow">for</span> (XSD_ITERATOR_TYPE(cp::apply_drug_type::IC50) i = ic50_seq.begin();
<a name="l03197"></a>03197          i != ic50_seq.end();
<a name="l03198"></a>03198          ++i)
<a name="l03199"></a>03199     {
<a name="l03200"></a>03200         <span class="keywordflow">if</span> (i-&gt;current() == rCurrentName)
<a name="l03201"></a>03201         {
<a name="l03202"></a>03202             entry_exists = <span class="keyword">true</span>;
<a name="l03203"></a>03203             *i = ic50_elt;
<a name="l03204"></a>03204             <span class="keywordflow">break</span>;
<a name="l03205"></a>03205         }
<a name="l03206"></a>03206     }
<a name="l03207"></a>03207     <span class="keywordflow">if</span> (!entry_exists)
<a name="l03208"></a>03208     {
<a name="l03209"></a>03209         ic50_seq.push_back(ic50_elt);
<a name="l03210"></a>03210     }
<a name="l03211"></a>03211 }
<a name="l03212"></a>03212 
<a name="l03213"></a>03213 
<a name="l03214"></a>03214 
<a name="l03215"></a><a class="code" href="classHeartConfig.html#ec6e4d8eae6507dcc71a5725a2687eb2">03215</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#ec6e4d8eae6507dcc71a5725a2687eb2">HeartConfig::SetUseMassLumping</a>(<span class="keywordtype">bool</span> useMassLumping)
<a name="l03216"></a>03216 {
<a name="l03217"></a>03217     <a class="code" href="classHeartConfig.html#8dec021b51fe856a7fa9f9f4efdb75bd">mUseMassLumping</a> = useMassLumping;
<a name="l03218"></a>03218 }
<a name="l03219"></a>03219 
<a name="l03220"></a><a class="code" href="classHeartConfig.html#6a885095c6fc46a6bb7e68774e57227f">03220</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#6a885095c6fc46a6bb7e68774e57227f">HeartConfig::GetUseMassLumping</a>()
<a name="l03221"></a>03221 {
<a name="l03222"></a>03222     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#8dec021b51fe856a7fa9f9f4efdb75bd">mUseMassLumping</a>;
<a name="l03223"></a>03223 }
<a name="l03224"></a>03224 
<a name="l03225"></a><a class="code" href="classHeartConfig.html#0d1a94db0e34ed8795d59ac46944fe17">03225</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#0d1a94db0e34ed8795d59ac46944fe17">HeartConfig::SetUseMassLumpingForPrecond</a>(<span class="keywordtype">bool</span> useMassLumping)
<a name="l03226"></a>03226 {
<a name="l03227"></a>03227     <a class="code" href="classHeartConfig.html#c92f76dda02e32251cb54ab8db4e4731">mUseMassLumpingForPrecond</a> = useMassLumping;
<a name="l03228"></a>03228 }
<a name="l03229"></a>03229 
<a name="l03230"></a><a class="code" href="classHeartConfig.html#d80730768d7bcee8bcda3b44315a172b">03230</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#d80730768d7bcee8bcda3b44315a172b">HeartConfig::GetUseMassLumpingForPrecond</a>()
<a name="l03231"></a>03231 {
<a name="l03232"></a>03232     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#c92f76dda02e32251cb54ab8db4e4731">mUseMassLumpingForPrecond</a>;
<a name="l03233"></a>03233 }
<a name="l03234"></a>03234 
<a name="l03235"></a><a class="code" href="classHeartConfig.html#67e90f1a2973f64e52353bde6c5ca0dd">03235</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#67e90f1a2973f64e52353bde6c5ca0dd">HeartConfig::SetUseReactionDiffusionOperatorSplitting</a>(<span class="keywordtype">bool</span> useOperatorSplitting)
<a name="l03236"></a>03236 {
<a name="l03237"></a>03237     <a class="code" href="classHeartConfig.html#e42bb9c3f734dfaa2247de53cf3543a1">mUseReactionDiffusionOperatorSplitting</a> = useOperatorSplitting;
<a name="l03238"></a>03238 }
<a name="l03239"></a>03239 
<a name="l03240"></a><a class="code" href="classHeartConfig.html#a4c07337945a4b2992a23d99162a50f3">03240</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#a4c07337945a4b2992a23d99162a50f3">HeartConfig::GetUseReactionDiffusionOperatorSplitting</a>()
<a name="l03241"></a>03241 {
<a name="l03242"></a>03242     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#e42bb9c3f734dfaa2247de53cf3543a1">mUseReactionDiffusionOperatorSplitting</a>;
<a name="l03243"></a>03243 }
<a name="l03244"></a>03244 
<a name="l03245"></a><a class="code" href="classHeartConfig.html#1c2e9fe97d37940788e7f815abf177d9">03245</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#1c2e9fe97d37940788e7f815abf177d9">HeartConfig::SetUseFixedNumberIterationsLinearSolver</a>(<span class="keywordtype">bool</span> useFixedNumberIterations, <span class="keywordtype">unsigned</span> evaluateNumItsEveryNSolves)
<a name="l03246"></a>03246 {
<a name="l03247"></a>03247     <a class="code" href="classHeartConfig.html#2b62de1b5893819e228fa281b33bcb7c">mUseFixedNumberIterations</a> = useFixedNumberIterations;
<a name="l03248"></a>03248     <a class="code" href="classHeartConfig.html#88ce4e48dfccc4028c6b8718314f4f55">mEvaluateNumItsEveryNSolves</a> = evaluateNumItsEveryNSolves;
<a name="l03249"></a>03249 }
<a name="l03250"></a>03250 
<a name="l03251"></a><a class="code" href="classHeartConfig.html#3332318bea3eb41149090030ad38e309">03251</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#3332318bea3eb41149090030ad38e309">HeartConfig::GetUseFixedNumberIterationsLinearSolver</a>()
<a name="l03252"></a>03252 {
<a name="l03253"></a>03253     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#2b62de1b5893819e228fa281b33bcb7c">mUseFixedNumberIterations</a>;
<a name="l03254"></a>03254 }
<a name="l03255"></a>03255 
<a name="l03256"></a><a class="code" href="classHeartConfig.html#82a57b9262a618cf827865d9ad2f1ca4">03256</a> <span class="keywordtype">unsigned</span> <a class="code" href="classHeartConfig.html#82a57b9262a618cf827865d9ad2f1ca4">HeartConfig::GetEvaluateNumItsEveryNSolves</a>()
<a name="l03257"></a>03257 {
<a name="l03258"></a>03258     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#88ce4e48dfccc4028c6b8718314f4f55">mEvaluateNumItsEveryNSolves</a>;
<a name="l03259"></a>03259 }
<a name="l03260"></a>03260 
<a name="l03261"></a>03261 <span class="comment">/**********************************************************************</span>
<a name="l03262"></a>03262 <span class="comment"> *                                                                    *</span>
<a name="l03263"></a>03263 <span class="comment"> *                                                                    *</span>
<a name="l03264"></a>03264 <span class="comment"> *            Utility methods for reading/transforming XML            *</span>
<a name="l03265"></a>03265 <span class="comment"> *                                                                    *</span>
<a name="l03266"></a>03266 <span class="comment"> *                                                                    *</span>
<a name="l03267"></a>03267 <span class="comment"> **********************************************************************/</span>
<a name="l03268"></a>03268 
<a name="l03269"></a>03269 
<a name="l03270"></a><a class="code" href="classXmlTransforms.html#0213cbf8bed42fa7e3236fdf4376bf64">03270</a> <span class="keywordtype">void</span> <a class="code" href="classXmlTransforms.html#0213cbf8bed42fa7e3236fdf4376bf64">XmlTransforms::TransformArchiveDirectory</a>(xercesc::DOMDocument* pDocument,
<a name="l03271"></a>03271                                               xercesc::DOMElement* pRootElement)
<a name="l03272"></a>03272 {
<a name="l03273"></a>03273     <span class="keyword">using namespace </span>xercesc;
<a name="l03274"></a>03274     std::vector&lt;xercesc::DOMElement*&gt; elts = <a class="code" href="classXmlTools.html#7032bd8d58add48ae794c94f963b3bfb">XmlTools::FindElements</a>(
<a name="l03275"></a>03275         pRootElement,
<a name="l03276"></a>03276         <span class="stringliteral">"ResumeSimulation/ArchiveDirectory"</span>);
<a name="l03277"></a>03277     <span class="keywordflow">if</span> (elts.size() &gt; 0)
<a name="l03278"></a>03278     {
<a name="l03279"></a>03279         <span class="comment">// We have an ArchiveDirectory element, so add the relative_to='chaste_test_output' attribute</span>
<a name="l03280"></a>03280         DOMElement* p_dir_elt = elts[0];
<a name="l03281"></a>03281         p_dir_elt-&gt;setAttribute(X(<span class="stringliteral">"relative_to"</span>), X(<span class="stringliteral">"chaste_test_output"</span>));
<a name="l03282"></a>03282     }
<a name="l03283"></a>03283 }
<a name="l03284"></a>03284 
<a name="l03285"></a><a class="code" href="classXmlTransforms.html#1e5bd50d05c32cf8257cacbb2b650bbd">03285</a> <span class="keywordtype">void</span> <a class="code" href="classXmlTransforms.html#1e5bd50d05c32cf8257cacbb2b650bbd">XmlTransforms::TransformIonicModelDefinitions</a>(xercesc::DOMDocument* pDocument,
<a name="l03286"></a>03286                                                    xercesc::DOMElement* pRootElement)
<a name="l03287"></a>03287 {
<a name="l03288"></a>03288     <span class="comment">// Default ionic model</span>
<a name="l03289"></a>03289     std::vector&lt;xercesc::DOMElement*&gt; p_elt_list = <a class="code" href="classXmlTools.html#7032bd8d58add48ae794c94f963b3bfb">XmlTools::FindElements</a>(
<a name="l03290"></a>03290         pRootElement,
<a name="l03291"></a>03291         <span class="stringliteral">"Simulation/IonicModels/Default"</span>);
<a name="l03292"></a>03292     <span class="keywordflow">if</span> (p_elt_list.size() &gt; 0)
<a name="l03293"></a>03293     {
<a name="l03294"></a>03294         assert(p_elt_list.size() == 1); <span class="comment">// Asserted by schema</span>
<a name="l03295"></a>03295         <a class="code" href="classXmlTools.html#c1a9819d780ae39e68c297797fa25498">XmlTools::WrapContentInElement</a>(pDocument, p_elt_list[0], X(<span class="stringliteral">"Hardcoded"</span>));
<a name="l03296"></a>03296         <span class="comment">// Now do any region-specific definitions</span>
<a name="l03297"></a>03297         p_elt_list = <a class="code" href="classXmlTools.html#7032bd8d58add48ae794c94f963b3bfb">XmlTools::FindElements</a>(pRootElement, <span class="stringliteral">"Simulation/IonicModels/Region/IonicModel"</span>);
<a name="l03298"></a>03298         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0; i&lt;p_elt_list.size(); i++)
<a name="l03299"></a>03299         {
<a name="l03300"></a>03300             <a class="code" href="classXmlTools.html#c1a9819d780ae39e68c297797fa25498">XmlTools::WrapContentInElement</a>(pDocument, p_elt_list[i], X(<span class="stringliteral">"Hardcoded"</span>));
<a name="l03301"></a>03301         }
<a name="l03302"></a>03302     }
<a name="l03303"></a>03303 }
<a name="l03304"></a>03304 
<a name="l03305"></a><a class="code" href="classXmlTransforms.html#b7c65c8fd2a2e9b07b70b7009df314ef">03305</a> <span class="keywordtype">void</span> <a class="code" href="classXmlTransforms.html#b7c65c8fd2a2e9b07b70b7009df314ef">XmlTransforms::CheckForIluPreconditioner</a>(xercesc::DOMDocument* pDocument,
<a name="l03306"></a>03306                                               xercesc::DOMElement* pRootElement)
<a name="l03307"></a>03307 {
<a name="l03308"></a>03308     std::vector&lt;xercesc::DOMElement*&gt; p_elt_list = <a class="code" href="classXmlTools.html#7032bd8d58add48ae794c94f963b3bfb">XmlTools::FindElements</a>(
<a name="l03309"></a>03309         pRootElement,
<a name="l03310"></a>03310         <span class="stringliteral">"Numerical/KSPPreconditioner"</span>);
<a name="l03311"></a>03311     <span class="keywordflow">if</span> (p_elt_list.size() &gt; 0)
<a name="l03312"></a>03312     {
<a name="l03313"></a>03313         assert(p_elt_list.size() == 1); <span class="comment">// Asserted by schema</span>
<a name="l03314"></a>03314         std::string text_value = X2C(p_elt_list[0]-&gt;getTextContent());
<a name="l03315"></a>03315         <span class="keywordflow">if</span> (text_value == <span class="stringliteral">"ilu"</span>)
<a name="l03316"></a>03316         {
<a name="l03317"></a>03317             <a class="code" href="Exception_8hpp.html#a49c727f91093a79c46ee6ecd83548bb">EXCEPTION</a>(<span class="stringliteral">"PETSc does not have a parallel implementation of ilu, so we no longer allow it as an option.  Use bjacobi instead."</span>);
<a name="l03318"></a>03318         }
<a name="l03319"></a>03319     }
<a name="l03320"></a>03320 }
<a name="l03321"></a>03321 
<a name="l03323"></a>03323 <span class="comment">// Explicit instantiation of the templated functions</span>
<a name="l03325"></a>03325 <span class="comment"></span><span class="preprocessor">#define COVERAGE_IGNORE //These methods are covered above with DIM=1,2,3 but the instantiations may fail spuriously</span>
<a name="l03326"></a>03326 <span class="preprocessor"></span>
<a name="l03330"></a>03330 <span class="keyword">template</span> <span class="keywordtype">void</span> HeartConfig::GetIonicModelRegions&lt;3u&gt;(std::vector&lt;boost::shared_ptr&lt;AbstractChasteRegion&lt;3u&gt; &gt; &gt;&amp; , std::vector&lt;cp::ionic_model_selection_type&gt;&amp;) <span class="keyword">const</span>;
<a name="l03331"></a>03331 <span class="keyword">template</span> <span class="keywordtype">void</span> HeartConfig::GetStimuli&lt;3u&gt;(std::vector&lt;boost::shared_ptr&lt;AbstractStimulusFunction&gt; &gt;&amp; , std::vector&lt;boost::shared_ptr&lt;AbstractChasteRegion&lt;3u&gt; &gt; &gt;&amp; ) <span class="keyword">const</span>;
<a name="l03332"></a>03332 <span class="keyword">template</span> <span class="keywordtype">void</span> HeartConfig::GetCellHeterogeneities&lt;3u&gt;(std::vector&lt;boost::shared_ptr&lt;AbstractChasteRegion&lt;3u&gt; &gt; &gt;&amp; ,std::vector&lt;double&gt;&amp; ,std::vector&lt;double&gt;&amp; ,std::vector&lt;double&gt;&amp; ,std::vector&lt;std::map&lt;std::string, double&gt; &gt;*) ;
<a name="l03333"></a>03333 <span class="keyword">template</span> <span class="keywordtype">void</span> HeartConfig::GetConductivityHeterogeneities&lt;3u&gt;(std::vector&lt;boost::shared_ptr&lt;AbstractChasteRegion&lt;3u&gt; &gt; &gt;&amp; ,std::vector&lt; c_vector&lt;double,3&gt; &gt;&amp; ,std::vector&lt; c_vector&lt;double,3&gt; &gt;&amp; ) <span class="keyword">const</span>;
<a name="l03334"></a>03334 
<a name="l03335"></a>03335 <span class="keyword">template</span> <span class="keywordtype">void</span> HeartConfig::GetIonicModelRegions&lt;2u&gt;(std::vector&lt;boost::shared_ptr&lt;AbstractChasteRegion&lt;2u&gt; &gt; &gt;&amp; , std::vector&lt;cp::ionic_model_selection_type&gt;&amp;) <span class="keyword">const</span>;
<a name="l03336"></a>03336 <span class="keyword">template</span> <span class="keywordtype">void</span> HeartConfig::GetStimuli&lt;2u&gt;(std::vector&lt;boost::shared_ptr&lt;AbstractStimulusFunction&gt; &gt;&amp; , std::vector&lt;boost::shared_ptr&lt;AbstractChasteRegion&lt;2u&gt; &gt; &gt;&amp; ) <span class="keyword">const</span>;
<a name="l03337"></a>03337 <span class="keyword">template</span> <span class="keywordtype">void</span> HeartConfig::GetCellHeterogeneities&lt;2u&gt;(std::vector&lt;boost::shared_ptr&lt;AbstractChasteRegion&lt;2u&gt; &gt; &gt;&amp; ,std::vector&lt;double&gt;&amp; ,std::vector&lt;double&gt;&amp; ,std::vector&lt;double&gt;&amp; ,std::vector&lt;std::map&lt;std::string, double&gt; &gt;*) ;
<a name="l03338"></a>03338 <span class="keyword">template</span> <span class="keywordtype">void</span> HeartConfig::GetConductivityHeterogeneities&lt;2u&gt;(std::vector&lt;boost::shared_ptr&lt;AbstractChasteRegion&lt;2u&gt; &gt; &gt;&amp; ,std::vector&lt; c_vector&lt;double,3&gt; &gt;&amp; ,std::vector&lt; c_vector&lt;double,3&gt; &gt;&amp; ) <span class="keyword">const</span>;
<a name="l03339"></a>03339 
<a name="l03340"></a>03340 <span class="keyword">template</span> <span class="keywordtype">void</span> HeartConfig::GetIonicModelRegions&lt;1u&gt;(std::vector&lt;boost::shared_ptr&lt;AbstractChasteRegion&lt;1u&gt; &gt; &gt;&amp; , std::vector&lt;cp::ionic_model_selection_type&gt;&amp;) <span class="keyword">const</span>;
<a name="l03341"></a>03341 <span class="keyword">template</span> <span class="keywordtype">void</span> HeartConfig::GetStimuli&lt;1u&gt;(std::vector&lt;boost::shared_ptr&lt;AbstractStimulusFunction&gt; &gt;&amp; , std::vector&lt;boost::shared_ptr&lt;AbstractChasteRegion&lt;1u&gt; &gt; &gt;&amp; ) <span class="keyword">const</span>;
<a name="l03342"></a>03342 <span class="keyword">template</span> <span class="keywordtype">void</span> HeartConfig::GetCellHeterogeneities&lt;1u&gt;(std::vector&lt;boost::shared_ptr&lt;AbstractChasteRegion&lt;1u&gt; &gt; &gt;&amp; ,std::vector&lt;double&gt;&amp; ,std::vector&lt;double&gt;&amp; ,std::vector&lt;double&gt;&amp; ,std::vector&lt;std::map&lt;std::string, double&gt; &gt;*);
<a name="l03343"></a>03343 <span class="keyword">template</span> <span class="keywordtype">void</span> HeartConfig::GetConductivityHeterogeneities&lt;1u&gt;(std::vector&lt;boost::shared_ptr&lt;AbstractChasteRegion&lt;1u&gt; &gt; &gt;&amp; ,std::vector&lt; c_vector&lt;double,3&gt; &gt;&amp; ,std::vector&lt; c_vector&lt;double,3&gt; &gt;&amp; ) <span class="keyword">const</span>;
<a name="l03344"></a>03344 
<a name="l03345"></a>03345 <span class="keyword">template</span> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#28e2c87ca9ef53288b40a12e724b01a5">HeartConfig::GetPseudoEcgElectrodePositions</a>(std::vector&lt;<a class="code" href="classChastePoint.html">ChastePoint&lt;1u&gt;</a> &gt;&amp; rPseudoEcgElectrodePositions) <span class="keyword">const</span>;
<a name="l03346"></a>03346 <span class="keyword">template</span> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#28e2c87ca9ef53288b40a12e724b01a5">HeartConfig::GetPseudoEcgElectrodePositions</a>(std::vector&lt;<a class="code" href="classChastePoint.html">ChastePoint&lt;2u&gt;</a> &gt;&amp; rPseudoEcgElectrodePositions) <span class="keyword">const</span>;
<a name="l03347"></a>03347 <span class="keyword">template</span> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#28e2c87ca9ef53288b40a12e724b01a5">HeartConfig::GetPseudoEcgElectrodePositions</a>(std::vector&lt;<a class="code" href="classChastePoint.html">ChastePoint&lt;3u&gt;</a> &gt;&amp; rPseudoEcgElectrodePositions) <span class="keyword">const</span>;
<a name="l03348"></a>03348 
<a name="l03349"></a>03349 <span class="keyword">template</span> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#31c997d4d91e1bb1cbb0177d29186cd8">HeartConfig::SetPseudoEcgElectrodePositions</a>(<span class="keyword">const</span> std::vector&lt;<a class="code" href="classChastePoint.html">ChastePoint&lt;1u&gt;</a> &gt;&amp; rPseudoEcgElectrodePositions);
<a name="l03350"></a>03350 <span class="keyword">template</span> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#31c997d4d91e1bb1cbb0177d29186cd8">HeartConfig::SetPseudoEcgElectrodePositions</a>(<span class="keyword">const</span> std::vector&lt;<a class="code" href="classChastePoint.html">ChastePoint&lt;2u&gt;</a> &gt;&amp; rPseudoEcgElectrodePositions);
<a name="l03351"></a>03351 <span class="keyword">template</span> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#31c997d4d91e1bb1cbb0177d29186cd8">HeartConfig::SetPseudoEcgElectrodePositions</a>(<span class="keyword">const</span> std::vector&lt;<a class="code" href="classChastePoint.html">ChastePoint&lt;3u&gt;</a> &gt;&amp; rPseudoEcgElectrodePositions);
<a name="l03356"></a>03356 <span class="preprocessor">#undef COVERAGE_IGNORE //These methods are covered above with DIM=1,2,3 but the instantiations may fail spuriously</span>
<a name="l03357"></a>03357 <span class="preprocessor"></span>
<a name="l03358"></a>03358 
<a name="l03359"></a>03359 <span class="comment">// Serialization for Boost &gt;= 1.36</span>
<a name="l03360"></a>03360 <span class="preprocessor">#include "<a class="code" href="SerializationExportWrapperForCpp_8hpp.html">SerializationExportWrapperForCpp.hpp</a>"</span>
<a name="l03361"></a>03361 <a class="code" href="SerializationExportWrapper_8hpp.html#ce086cfef82d692752842bea698f6e7c">CHASTE_CLASS_EXPORT</a>(<a class="code" href="classHeartConfig.html">HeartConfig</a>)
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Tue May 31 14:31:41 2011 for Chaste by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.5 </small></address>
</body>
</html>
