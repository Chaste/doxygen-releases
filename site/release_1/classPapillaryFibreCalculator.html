<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Chaste: PapillaryFibreCalculator Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.5 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li class="current"><a href="classes.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="classes.html"><span>Alphabetical&nbsp;List</span></a></li>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>PapillaryFibreCalculator Class Reference</h1><!-- doxytag: class="PapillaryFibreCalculator" --><code>#include &lt;<a class="el" href="PapillaryFibreCalculator_8hpp-source.html">PapillaryFibreCalculator.hpp</a>&gt;</code>
<p>
<div class="dynheader">
Collaboration diagram for PapillaryFibreCalculator:</div>
<div class="dynsection">
<p><center><img src="classPapillaryFibreCalculator__coll__graph.png" border="0" usemap="#PapillaryFibreCalculator__coll__map" alt="Collaboration graph"></center>
<center><font size="2">[<a href="graph_legend.html">legend</a>]</font></center></div>

<p>
<a href="classPapillaryFibreCalculator-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPapillaryFibreCalculator.html#622fdd97aeff3b88993dd461de891793">PapillaryFibreCalculator</a> (TetrahedralMesh&lt; 3, 3 &gt; &amp;rMesh)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">std::vector&lt; c_vector&lt; double, 3 &gt; &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPapillaryFibreCalculator.html#b851e2ce7526cacf75f0d8f8f4f7b2f3">CalculateFibreOrientations</a> ()</td></tr>

<tr><td colspan="2"><br><h2>Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">c_vector&lt; double, 3 &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPapillaryFibreCalculator.html#a656ead4ed1859548f50523590be085c">GetRadiusVectorForOneElement</a> (unsigned elementIndex)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPapillaryFibreCalculator.html#a6fd6613f935e6b22a04d592c14cdf74">GetRadiusVectors</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPapillaryFibreCalculator.html#0974043b3fd190c35c98e9e27ab7eaca">ConstructStructureTensors</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPapillaryFibreCalculator.html#619692b962756bc710963790ae4e06b8">SmoothStructureTensors</a> ()</td></tr>

<tr><td colspan="2"><br><h2>Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="bd8adc35ff9ab543a8496a0d176fdd1e"></a><!-- doxytag: member="PapillaryFibreCalculator::mrMesh" ref="bd8adc35ff9ab543a8496a0d176fdd1e" args="" -->
TetrahedralMesh&lt; 3, 3 &gt; &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><b>mrMesh</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">std::vector&lt; c_vector&lt; double, 3 &gt; &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPapillaryFibreCalculator.html#d8034748fb5eb4b0add1ac778f709e6e">mRadiusVectors</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">std::vector&lt; c_matrix&lt; double, 3, 3 &gt; &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPapillaryFibreCalculator.html#7f01a320117a5e873f80e53e2a391438">mStructureTensors</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">std::vector&lt; c_matrix&lt; double, 3, 3 &gt; &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPapillaryFibreCalculator.html#695804a0cfce3c49295d56e192dcedac">mSmoothedStructureTensors</a></td></tr>

<tr><td colspan="2"><br><h2>Friends</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="e3fa4533f529a0fdf9827c88e2ff76e1"></a><!-- doxytag: member="PapillaryFibreCalculator::TestPapillaryFibreCalculator" ref="e3fa4533f529a0fdf9827c88e2ff76e1" args="" -->
class&nbsp;</td><td class="memItemRight" valign="bottom"><b>TestPapillaryFibreCalculator</b></td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Assigns fibre orientation vectors for papillary muscle structures. Vectors are assigned to be parallel to the direction of the axis of the muscle. To do this we use the "Structure Tensor" method. 
<p>Definition at line <a class="el" href="PapillaryFibreCalculator_8hpp-source.html#l00039">39</a> of file <a class="el" href="PapillaryFibreCalculator_8hpp-source.html">PapillaryFibreCalculator.hpp</a>.</p>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="622fdd97aeff3b88993dd461de891793"></a><!-- doxytag: member="PapillaryFibreCalculator::PapillaryFibreCalculator" ref="622fdd97aeff3b88993dd461de891793" args="(TetrahedralMesh&lt; 3, 3 &gt; &amp;rMesh)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PapillaryFibreCalculator::PapillaryFibreCalculator           </td>
          <td>(</td>
          <td class="paramtype">TetrahedralMesh&lt; 3, 3 &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>rMesh</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Constructor saves mesh and allocates memory<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>rMesh</em>&nbsp;</td><td>The mesh to calculate fibres on </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="PapillaryFibreCalculator_8hpp-source.html#l00105">105</a> of file <a class="el" href="PapillaryFibreCalculator_8hpp-source.html">PapillaryFibreCalculator.hpp</a>.</p>

<p>References <a class="el" href="PapillaryFibreCalculator_8hpp-source.html#l00047">mRadiusVectors</a>, <a class="el" href="PapillaryFibreCalculator_8hpp-source.html#l00051">mSmoothedStructureTensors</a>, and <a class="el" href="PapillaryFibreCalculator_8hpp-source.html#l00049">mStructureTensors</a>.</p>

</div>
</div><p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="a656ead4ed1859548f50523590be085c"></a><!-- doxytag: member="PapillaryFibreCalculator::GetRadiusVectorForOneElement" ref="a656ead4ed1859548f50523590be085c" args="(unsigned elementIndex)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">c_vector&lt; double, 3 &gt; PapillaryFibreCalculator::GetRadiusVectorForOneElement           </td>
          <td>(</td>
          <td class="paramtype">unsigned&nbsp;</td>
          <td class="paramname"> <em>elementIndex</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This method calculates the vector from the centroid of an element to all of the boundary nodes. It returns the shortest of the vectors.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>elementIndex</em>&nbsp;</td><td>The index of the element we are calculating radial vectors for </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>The shortest radial vector </dd></dl>

<p>Definition at line <a class="el" href="PapillaryFibreCalculator_8hpp-source.html#l00132">132</a> of file <a class="el" href="PapillaryFibreCalculator_8hpp-source.html">PapillaryFibreCalculator.hpp</a>.</p>

<p>Referenced by <a class="el" href="PapillaryFibreCalculator_8hpp-source.html#l00163">GetRadiusVectors()</a>.</p>

</div>
</div><p>
<a class="anchor" name="a6fd6613f935e6b22a04d592c14cdf74"></a><!-- doxytag: member="PapillaryFibreCalculator::GetRadiusVectors" ref="a6fd6613f935e6b22a04d592c14cdf74" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PapillaryFibreCalculator::GetRadiusVectors           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This method calls <a class="el" href="classPapillaryFibreCalculator.html#a656ead4ed1859548f50523590be085c">GetRadiusVectorForOneElement()</a> for each of the elements sets the radial vector for each element of the mesh. 
<p>Definition at line <a class="el" href="PapillaryFibreCalculator_8hpp-source.html#l00163">163</a> of file <a class="el" href="PapillaryFibreCalculator_8hpp-source.html">PapillaryFibreCalculator.hpp</a>.</p>

<p>References <a class="el" href="PapillaryFibreCalculator_8hpp-source.html#l00132">GetRadiusVectorForOneElement()</a>, and <a class="el" href="PapillaryFibreCalculator_8hpp-source.html#l00047">mRadiusVectors</a>.</p>

<p>Referenced by <a class="el" href="PapillaryFibreCalculator_8hpp-source.html#l00113">CalculateFibreOrientations()</a>.</p>

</div>
</div><p>
<a class="anchor" name="0974043b3fd190c35c98e9e27ab7eaca"></a><!-- doxytag: member="PapillaryFibreCalculator::ConstructStructureTensors" ref="0974043b3fd190c35c98e9e27ab7eaca" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PapillaryFibreCalculator::ConstructStructureTensors           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This generates structure tensors from the radial vectors by taking<p>
T = r.r' 
<p>Definition at line <a class="el" href="PapillaryFibreCalculator_8hpp-source.html#l00176">176</a> of file <a class="el" href="PapillaryFibreCalculator_8hpp-source.html">PapillaryFibreCalculator.hpp</a>.</p>

<p>References <a class="el" href="PapillaryFibreCalculator_8hpp-source.html#l00047">mRadiusVectors</a>, and <a class="el" href="PapillaryFibreCalculator_8hpp-source.html#l00049">mStructureTensors</a>.</p>

<p>Referenced by <a class="el" href="PapillaryFibreCalculator_8hpp-source.html#l00113">CalculateFibreOrientations()</a>.</p>

</div>
</div><p>
<a class="anchor" name="619692b962756bc710963790ae4e06b8"></a><!-- doxytag: member="PapillaryFibreCalculator::SmoothStructureTensors" ref="619692b962756bc710963790ae4e06b8" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PapillaryFibreCalculator::SmoothStructureTensors           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Smoothes the structure tensor components for each papillary element by looping over all other papillary elements, calculating distance geometric distance between the two elements; if it is within a certain limit, include this in the Gaussian kernel<p>
Here mStructureTensors[i] is the 'rough' tensor for each element and mSmoothedStructureTensors[i] is the smoothed tensor for each element 
<p>Definition at line <a class="el" href="PapillaryFibreCalculator_8hpp-source.html#l00184">184</a> of file <a class="el" href="PapillaryFibreCalculator_8hpp-source.html">PapillaryFibreCalculator.hpp</a>.</p>

<p>References <a class="el" href="PapillaryFibreCalculator_8hpp-source.html#l00051">mSmoothedStructureTensors</a>, and <a class="el" href="PapillaryFibreCalculator_8hpp-source.html#l00049">mStructureTensors</a>.</p>

<p>Referenced by <a class="el" href="PapillaryFibreCalculator_8hpp-source.html#l00113">CalculateFibreOrientations()</a>.</p>

</div>
</div><p>
<a class="anchor" name="b851e2ce7526cacf75f0d8f8f4f7b2f3"></a><!-- doxytag: member="PapillaryFibreCalculator::CalculateFibreOrientations" ref="b851e2ce7526cacf75f0d8f8f4f7b2f3" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; c_vector&lt; double, 3 &gt; &gt; PapillaryFibreCalculator::CalculateFibreOrientations           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Main method - calculate the fibre orientations<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>A fibre vector for each element </dd></dl>

<p>Definition at line <a class="el" href="PapillaryFibreCalculator_8hpp-source.html#l00113">113</a> of file <a class="el" href="PapillaryFibreCalculator_8hpp-source.html">PapillaryFibreCalculator.hpp</a>.</p>

<p>References <a class="el" href="PapillaryFibreCalculator_8hpp-source.html#l00176">ConstructStructureTensors()</a>, <a class="el" href="PapillaryFibreCalculator_8hpp-source.html#l00163">GetRadiusVectors()</a>, <a class="el" href="PapillaryFibreCalculator_8hpp-source.html#l00051">mSmoothedStructureTensors</a>, and <a class="el" href="PapillaryFibreCalculator_8hpp-source.html#l00184">SmoothStructureTensors()</a>.</p>

</div>
</div><p>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="d8034748fb5eb4b0add1ac778f709e6e"></a><!-- doxytag: member="PapillaryFibreCalculator::mRadiusVectors" ref="d8034748fb5eb4b0add1ac778f709e6e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; c_vector&lt;double, 3&gt; &gt; <a class="el" href="classPapillaryFibreCalculator.html#d8034748fb5eb4b0add1ac778f709e6e">PapillaryFibreCalculator::mRadiusVectors</a><code> [private]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
vectors from the centre of each element to the nearest boundary node 
<p>Definition at line <a class="el" href="PapillaryFibreCalculator_8hpp-source.html#l00047">47</a> of file <a class="el" href="PapillaryFibreCalculator_8hpp-source.html">PapillaryFibreCalculator.hpp</a>.</p>

<p>Referenced by <a class="el" href="PapillaryFibreCalculator_8hpp-source.html#l00176">ConstructStructureTensors()</a>, <a class="el" href="PapillaryFibreCalculator_8hpp-source.html#l00163">GetRadiusVectors()</a>, and <a class="el" href="PapillaryFibreCalculator_8hpp-source.html#l00105">PapillaryFibreCalculator()</a>.</p>

</div>
</div><p>
<a class="anchor" name="7f01a320117a5e873f80e53e2a391438"></a><!-- doxytag: member="PapillaryFibreCalculator::mStructureTensors" ref="7f01a320117a5e873f80e53e2a391438" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; c_matrix&lt;double,3,3&gt; &gt; <a class="el" href="classPapillaryFibreCalculator.html#7f01a320117a5e873f80e53e2a391438">PapillaryFibreCalculator::mStructureTensors</a><code> [private]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Tensors created from mRadiusVectors 
<p>Definition at line <a class="el" href="PapillaryFibreCalculator_8hpp-source.html#l00049">49</a> of file <a class="el" href="PapillaryFibreCalculator_8hpp-source.html">PapillaryFibreCalculator.hpp</a>.</p>

<p>Referenced by <a class="el" href="PapillaryFibreCalculator_8hpp-source.html#l00176">ConstructStructureTensors()</a>, <a class="el" href="PapillaryFibreCalculator_8hpp-source.html#l00105">PapillaryFibreCalculator()</a>, and <a class="el" href="PapillaryFibreCalculator_8hpp-source.html#l00184">SmoothStructureTensors()</a>.</p>

</div>
</div><p>
<a class="anchor" name="695804a0cfce3c49295d56e192dcedac"></a><!-- doxytag: member="PapillaryFibreCalculator::mSmoothedStructureTensors" ref="695804a0cfce3c49295d56e192dcedac" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; c_matrix&lt;double,3,3&gt; &gt; <a class="el" href="classPapillaryFibreCalculator.html#695804a0cfce3c49295d56e192dcedac">PapillaryFibreCalculator::mSmoothedStructureTensors</a><code> [private]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Smoothed tensors created from mStructureTensors 
<p>Definition at line <a class="el" href="PapillaryFibreCalculator_8hpp-source.html#l00051">51</a> of file <a class="el" href="PapillaryFibreCalculator_8hpp-source.html">PapillaryFibreCalculator.hpp</a>.</p>

<p>Referenced by <a class="el" href="PapillaryFibreCalculator_8hpp-source.html#l00113">CalculateFibreOrientations()</a>, <a class="el" href="PapillaryFibreCalculator_8hpp-source.html#l00105">PapillaryFibreCalculator()</a>, and <a class="el" href="PapillaryFibreCalculator_8hpp-source.html#l00184">SmoothStructureTensors()</a>.</p>

</div>
</div><p>
<hr>The documentation for this class was generated from the following file:<ul>
<li>/tmp/release_1/heart/src/problem/<a class="el" href="PapillaryFibreCalculator_8hpp-source.html">PapillaryFibreCalculator.hpp</a></ul>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Wed Mar 18 12:52:47 2009 for Chaste by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.5 </small></address>
</body>
</html>
