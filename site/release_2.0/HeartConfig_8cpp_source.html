<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Chaste: /tmp/release_2.0/heart/src/problem/HeartConfig.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.2 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_ceb577a46ca9bf0c8d8d9bcb7e4708f6.html">tmp</a>&nbsp;&raquo;&nbsp;<a class="el" href="dir_d14bb195bafb205818bb3fca268a2e26.html">release_2.0</a>&nbsp;&raquo;&nbsp;<a class="el" href="dir_c3d327ccb8005d8d8bcee288b9ba7408.html">heart</a>&nbsp;&raquo;&nbsp;<a class="el" href="dir_1e3a403e55794dbcb748fbcb2ac20489.html">src</a>&nbsp;&raquo;&nbsp;<a class="el" href="dir_7a30d4bf949ad16cd01f63ca0e9321c8.html">problem</a>
  </div>
</div>
<div class="contents">
<h1>HeartConfig.cpp</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"></span>
<a name="l00003"></a>00003 <span class="comment">Copyright (C) University of Oxford, 2005-2010</span>
<a name="l00004"></a>00004 <span class="comment"></span>
<a name="l00005"></a>00005 <span class="comment">University of Oxford means the Chancellor, Masters and Scholars of the</span>
<a name="l00006"></a>00006 <span class="comment">University of Oxford, having an administrative office at Wellington</span>
<a name="l00007"></a>00007 <span class="comment">Square, Oxford OX1 2JD, UK.</span>
<a name="l00008"></a>00008 <span class="comment"></span>
<a name="l00009"></a>00009 <span class="comment">This file is part of Chaste.</span>
<a name="l00010"></a>00010 <span class="comment"></span>
<a name="l00011"></a>00011 <span class="comment">Chaste is free software: you can redistribute it and/or modify it</span>
<a name="l00012"></a>00012 <span class="comment">under the terms of the GNU Lesser General Public License as published</span>
<a name="l00013"></a>00013 <span class="comment">by the Free Software Foundation, either version 2.1 of the License, or</span>
<a name="l00014"></a>00014 <span class="comment">(at your option) any later version.</span>
<a name="l00015"></a>00015 <span class="comment"></span>
<a name="l00016"></a>00016 <span class="comment">Chaste is distributed in the hope that it will be useful, but WITHOUT</span>
<a name="l00017"></a>00017 <span class="comment">ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or</span>
<a name="l00018"></a>00018 <span class="comment">FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser General Public</span>
<a name="l00019"></a>00019 <span class="comment">License for more details. The offer of Chaste under the terms of the</span>
<a name="l00020"></a>00020 <span class="comment">License is subject to the License being interpreted in accordance with</span>
<a name="l00021"></a>00021 <span class="comment">English Law and subject to any action against the University of Oxford</span>
<a name="l00022"></a>00022 <span class="comment">being under the jurisdiction of the English Courts.</span>
<a name="l00023"></a>00023 <span class="comment"></span>
<a name="l00024"></a>00024 <span class="comment">You should have received a copy of the GNU Lesser General Public License</span>
<a name="l00025"></a>00025 <span class="comment">along with Chaste. If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l00026"></a>00026 <span class="comment"></span>
<a name="l00027"></a>00027 <span class="comment">*/</span>
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 <span class="comment">// Work-around for newer Boost versions</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &quot;<a class="code" href="CheckpointArchiveTypesIfNeeded_8hpp.html">CheckpointArchiveTypesIfNeeded.hpp</a>&quot;</span>
<a name="l00031"></a>00031 
<a name="l00032"></a>00032 <span class="preprocessor">#include &quot;UblasCustomFunctions.hpp&quot;</span>
<a name="l00033"></a>00033 
<a name="l00034"></a>00034 <span class="preprocessor">#include &quot;HeartConfig.hpp&quot;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &quot;OutputFileHandler.hpp&quot;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &quot;Exception.hpp&quot;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &quot;ChastePoint.hpp&quot;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &quot;Version.hpp&quot;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &quot;AbstractChasteRegion.hpp&quot;</span>
<a name="l00040"></a>00040 
<a name="l00041"></a>00041 <span class="preprocessor">#include &lt;cassert&gt;</span>
<a name="l00042"></a>00042 
<a name="l00043"></a>00043 <span class="preprocessor">#include &lt;xercesc/util/PlatformUtils.hpp&gt;</span>
<a name="l00044"></a>00044 <span class="preprocessor">#include &lt;xercesc/util/QName.hpp&gt;</span>
<a name="l00045"></a>00045 <span class="preprocessor">#include &lt;xsd/cxx/tree/error-handler.hxx&gt;</span>
<a name="l00046"></a>00046 
<a name="l00047"></a>00047 <span class="comment">// Coping with changes to XSD interface</span>
<a name="l00048"></a>00048 <span class="preprocessor">#if (XSD_INT_VERSION &gt;= 3000000L)</span>
<a name="l00049"></a>00049 <span class="preprocessor"></span><span class="preprocessor">#define XSD_SEQUENCE_TYPE(base) base##_sequence</span>
<a name="l00050"></a>00050 <span class="preprocessor"></span><span class="preprocessor">#define XSD_ITERATOR_TYPE(base) base##_iterator</span>
<a name="l00051"></a>00051 <span class="preprocessor"></span><span class="preprocessor">#define XSD_NESTED_TYPE(t) t##_type</span>
<a name="l00052"></a>00052 <span class="preprocessor"></span><span class="preprocessor">#define XSD_ANON_TYPE(t1, t2) \</span>
<a name="l00053"></a>00053 <span class="preprocessor">    t1::t2##_type</span>
<a name="l00054"></a>00054 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00055"></a>00055 <span class="preprocessor"></span><span class="preprocessor">#define XSD_SEQUENCE_TYPE(base) base::container</span>
<a name="l00056"></a>00056 <span class="preprocessor"></span><span class="preprocessor">#define XSD_ITERATOR_TYPE(base) base::iterator</span>
<a name="l00057"></a>00057 <span class="preprocessor"></span><span class="preprocessor">#define XSD_NESTED_TYPE(t) t::type</span>
<a name="l00058"></a>00058 <span class="preprocessor"></span><span class="preprocessor">#define XSD_ANON_TYPE(t1, t2) \</span>
<a name="l00059"></a>00059 <span class="preprocessor">    t1::t2::_xsd_##t2##_::t2</span>
<a name="l00060"></a>00060 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00061"></a>00061 <span class="preprocessor"></span>
<a name="l00062"></a>00062 <span class="comment">// These are for convenience</span>
<a name="l00063"></a>00063 <span class="preprocessor">#define XSD_ANON_SEQUENCE_TYPE(t1, t2, t3) \</span>
<a name="l00064"></a>00064 <span class="preprocessor">    XSD_SEQUENCE_TYPE(XSD_ANON_TYPE(t1, t2)::t3)</span>
<a name="l00065"></a>00065 <span class="preprocessor"></span><span class="preprocessor">#define XSD_ANON_ITERATOR_TYPE(t1, t2, t3) \</span>
<a name="l00066"></a>00066 <span class="preprocessor">    XSD_ITERATOR_TYPE(XSD_ANON_TYPE(t1, t2)::t3)</span>
<a name="l00067"></a>00067 <span class="preprocessor"></span>
<a name="l00068"></a>00068 <span class="comment">// Newer versions don&#39;t allow you to set fixed attributes</span>
<a name="l00069"></a>00069 <span class="preprocessor">#if (XSD_INT_VERSION &gt;= 3020000L)</span>
<a name="l00070"></a>00070 <span class="preprocessor"></span><span class="preprocessor">#define XSD_CREATE_WITH_FIXED_ATTR(type, name, attr) \</span>
<a name="l00071"></a>00071 <span class="preprocessor">    type name</span>
<a name="l00072"></a>00072 <span class="preprocessor"></span><span class="preprocessor">#define XSD_CREATE_WITH_FIXED_ATTR1(type, name, arg1, attr) \</span>
<a name="l00073"></a>00073 <span class="preprocessor">    type name(arg1)</span>
<a name="l00074"></a>00074 <span class="preprocessor"></span><span class="preprocessor">#define XSD_CREATE_WITH_FIXED_ATTR2(type, name, arg1, arg2, attr) \</span>
<a name="l00075"></a>00075 <span class="preprocessor">    type name(arg1, arg2)</span>
<a name="l00076"></a>00076 <span class="preprocessor"></span><span class="preprocessor">#define XSD_CREATE_WITH_FIXED_ATTR3(type, name, arg1, arg2, arg3, attr) \</span>
<a name="l00077"></a>00077 <span class="preprocessor">    type name(arg1, arg2, arg3)</span>
<a name="l00078"></a>00078 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00079"></a>00079 <span class="preprocessor"></span><span class="preprocessor">#define XSD_CREATE_WITH_FIXED_ATTR(type, name, attr) \</span>
<a name="l00080"></a>00080 <span class="preprocessor">    type name(attr)</span>
<a name="l00081"></a>00081 <span class="preprocessor"></span><span class="preprocessor">#define XSD_CREATE_WITH_FIXED_ATTR1(type, name, arg1, attr) \</span>
<a name="l00082"></a>00082 <span class="preprocessor">    type name(arg1, attr)</span>
<a name="l00083"></a>00083 <span class="preprocessor"></span><span class="preprocessor">#define XSD_CREATE_WITH_FIXED_ATTR2(type, name, arg1, arg2, attr) \</span>
<a name="l00084"></a>00084 <span class="preprocessor">    type name(arg1, arg2, attr)</span>
<a name="l00085"></a>00085 <span class="preprocessor"></span><span class="preprocessor">#define XSD_CREATE_WITH_FIXED_ATTR3(type, name, arg1, arg2, arg3, attr) \</span>
<a name="l00086"></a>00086 <span class="preprocessor">    type name(arg1, arg2, arg3, attr)</span>
<a name="l00087"></a>00087 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00088"></a>00088 <span class="preprocessor"></span>
<a name="l00089"></a>00089 <span class="keyword">using namespace </span>xsd::cxx::tree;
<a name="l00090"></a>00090 
<a name="l00091"></a>00091 <span class="comment">//</span>
<a name="l00092"></a>00092 <span class="comment">// Definition of static member variables</span>
<a name="l00093"></a>00093 <span class="comment">//</span>
<a name="l00094"></a>00094 std::auto_ptr&lt;HeartConfig&gt; <a class="code" href="classHeartConfig.html#a1d700f703ffa3528790264535857411a">HeartConfig::mpInstance</a>;
<a name="l00095"></a>00095 
<a name="l00096"></a>00096 <span class="comment">//</span>
<a name="l00097"></a>00097 <span class="comment">// Methods</span>
<a name="l00098"></a>00098 <span class="comment">//</span>
<a name="l00099"></a>00099 
<a name="l00100"></a><a class="code" href="classHeartConfig.html#af8ab048189a76d46bbec0ff541449b89">00100</a> <a class="code" href="classHeartConfig.html">HeartConfig</a>* <a class="code" href="classHeartConfig.html#af8ab048189a76d46bbec0ff541449b89">HeartConfig::Instance</a>()
<a name="l00101"></a>00101 {
<a name="l00102"></a>00102     <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#a1d700f703ffa3528790264535857411a">mpInstance</a>.get() == NULL)
<a name="l00103"></a>00103     {
<a name="l00104"></a>00104         <a class="code" href="classHeartConfig.html#a1d700f703ffa3528790264535857411a">mpInstance</a>.reset(<span class="keyword">new</span> <a class="code" href="classHeartConfig.html">HeartConfig</a>);
<a name="l00105"></a>00105     }
<a name="l00106"></a>00106     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#a1d700f703ffa3528790264535857411a">mpInstance</a>.get();
<a name="l00107"></a>00107 }
<a name="l00108"></a>00108 
<a name="l00109"></a>00109 HeartConfig::HeartConfig()
<a name="l00110"></a>00110 {
<a name="l00111"></a>00111     assert(<a class="code" href="classHeartConfig.html#a1d700f703ffa3528790264535857411a">mpInstance</a>.get() == NULL);
<a name="l00112"></a>00112     <a class="code" href="classHeartConfig.html#a39f79c982e9983fe8c2823d8de697d85">mUseFixedSchemaLocation</a> = <span class="keyword">true</span>;
<a name="l00113"></a>00113     <a class="code" href="classHeartConfig.html#a92d7f06c5cf8caa9c8cf3f65ada9bb6b">SetDefaultSchemaLocations</a>();
<a name="l00114"></a>00114 
<a name="l00115"></a>00115     <a class="code" href="classHeartConfig.html#a380c38e127a3dcb18948bdc52d99259c">SetDefaultsFile</a>(<span class="stringliteral">&quot;ChasteDefaults.xml&quot;</span>);
<a name="l00116"></a>00116 
<a name="l00117"></a>00117     <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a> = <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>;
<a name="l00118"></a>00118     <span class="comment">//CheckTimeSteps(); // necessity of this line of code is not tested -- remove with caution!</span>
<a name="l00119"></a>00119 
<a name="l00120"></a>00120     <span class="comment">//initialise the member variable of the layers</span>
<a name="l00121"></a>00121     <a class="code" href="classHeartConfig.html#aefbe15b3fd5d616d98a35dd172608529">mEpiFraction</a> = -1.0;
<a name="l00122"></a>00122     <a class="code" href="classHeartConfig.html#a9c9f9fefab6c029324426098740b5bc4">mEndoFraction</a> =  -1.0;
<a name="l00123"></a>00123     <a class="code" href="classHeartConfig.html#a5648845197c449e58c2c879f7422df3f">mMidFraction</a> = -1.0;
<a name="l00124"></a>00124     <a class="code" href="classHeartConfig.html#a6ebec0d7deb03099ae581bca114147fb">mUserAskedForCellularTransmuralHeterogeneities</a>=<span class="keyword">false</span>;
<a name="l00125"></a>00125     <a class="code" href="classHeartConfig.html#a7def5e1c5ce3568eecb287368694aa6b">mUserAskedForCuboidsForCellularHeterogeneities</a>=<span class="keyword">false</span>;
<a name="l00126"></a>00126     <span class="comment">// initialise to senseless values (these should be only 0, 1 and 2)</span>
<a name="l00127"></a>00127     <span class="comment">// note: the &#39;minus 3&#39; is for checking purposes as we need to add 0, 1 or 2 to this initial value</span>
<a name="l00128"></a>00128     <span class="comment">// and UINT_MAX+1 seems to be 0</span>
<a name="l00129"></a>00129     <a class="code" href="classHeartConfig.html#abfdca19b9fc56fe21ef23d2593cc022f">mIndexMid</a> = UINT_MAX-3u;
<a name="l00130"></a>00130     <a class="code" href="classHeartConfig.html#ab24f553ab1e97d36b8467f7ca1bcf800">mIndexEpi</a> = UINT_MAX-3u;
<a name="l00131"></a>00131     <a class="code" href="classHeartConfig.html#a4785f6ad1c60766c471bcb525eac02d3">mIndexEndo</a> = UINT_MAX-3u;
<a name="l00132"></a>00132 }
<a name="l00133"></a>00133 
<a name="l00134"></a><a class="code" href="classHeartConfig.html#aa43c19f27c6313368b04ceabcd502ae4">00134</a> <a class="code" href="classHeartConfig.html#aa43c19f27c6313368b04ceabcd502ae4">HeartConfig::~HeartConfig</a>()
<a name="l00135"></a>00135 {
<a name="l00136"></a>00136 }
<a name="l00137"></a>00137 
<a name="l00138"></a><a class="code" href="classHeartConfig.html#a380c38e127a3dcb18948bdc52d99259c">00138</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a380c38e127a3dcb18948bdc52d99259c">HeartConfig::SetDefaultsFile</a>(<span class="keyword">const</span> std::string&amp; rFileName)
<a name="l00139"></a>00139 {
<a name="l00140"></a>00140     <span class="keywordtype">bool</span> same_target = (<a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a> == <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>);
<a name="l00141"></a>00141 
<a name="l00142"></a>00142     <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a> = <a class="code" href="classHeartConfig.html#a871a948c9d64ccfdecc2c3a1d47fb304">ReadFile</a>(rFileName);
<a name="l00143"></a>00143 
<a name="l00144"></a>00144     <span class="keywordflow">if</span> (same_target)
<a name="l00145"></a>00145     {
<a name="l00146"></a>00146         <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a> = <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>;
<a name="l00147"></a>00147     }
<a name="l00148"></a>00148     <a class="code" href="classHeartConfig.html#aef79708e5e663a9ea5ff236ecc0bbd85">CheckTimeSteps</a>();
<a name="l00149"></a>00149 }
<a name="l00150"></a>00150 
<a name="l00151"></a><a class="code" href="classHeartConfig.html#ac432ab6bce14059d6e18e92dbec89b74">00151</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#ac432ab6bce14059d6e18e92dbec89b74">HeartConfig::Write</a>(<span class="keywordtype">bool</span> useArchiveLocationInfo, std::string subfolderName)
<a name="l00152"></a>00152 {
<a name="l00153"></a>00153     <span class="comment">//Output file</span>
<a name="l00154"></a>00154     std::string output_dirname;
<a name="l00155"></a>00155     <span class="keywordflow">if</span> (useArchiveLocationInfo)
<a name="l00156"></a>00156     {
<a name="l00157"></a>00157         output_dirname = <a class="code" href="classArchiveLocationInfo.html#aad18070e4bce7b1cdd8f5c9d7e047b1d">ArchiveLocationInfo::GetArchiveDirectory</a>();
<a name="l00158"></a>00158     }
<a name="l00159"></a>00159     <span class="keywordflow">else</span>
<a name="l00160"></a>00160     {
<a name="l00161"></a>00161         <a class="code" href="classOutputFileHandler.html">OutputFileHandler</a> handler(<a class="code" href="classHeartConfig.html#ad4f49a0c81a7463613fdde99fb56e224">GetOutputDirectory</a>(), <span class="keyword">false</span>);
<a name="l00162"></a>00162         output_dirname =  handler.<a class="code" href="classOutputFileHandler.html#ae85d34d7b0ab4ac1e8f8352ea5f2af83">GetOutputDirectoryFullPath</a>() + subfolderName + <span class="stringliteral">&quot;/&quot;</span>;
<a name="l00163"></a>00163     }
<a name="l00164"></a>00164     <span class="keywordflow">if</span> (!<a class="code" href="classPetscTools.html#a30cf1b3576c5dd99556f6b87a05be7cc">PetscTools::AmMaster</a>())
<a name="l00165"></a>00165     {
<a name="l00166"></a>00166         <span class="comment">//Only the master process is writing the configuration files</span>
<a name="l00167"></a>00167         <span class="keywordflow">return</span>;
<a name="l00168"></a>00168     }
<a name="l00169"></a>00169     out_stream p_defaults_file( <span class="keyword">new</span> std::ofstream( (output_dirname+<span class="stringliteral">&quot;ChasteDefaults.xml&quot;</span>).c_str() ) );
<a name="l00170"></a>00170     out_stream p_parameters_file( <span class="keyword">new</span> std::ofstream( (output_dirname+<span class="stringliteral">&quot;ChasteParameters.xml&quot;</span>).c_str() ) );
<a name="l00171"></a>00171 
<a name="l00172"></a>00172     <span class="keywordflow">if</span> (!p_defaults_file-&gt;is_open() || !p_parameters_file-&gt;is_open())
<a name="l00173"></a>00173     {
<a name="l00174"></a>00174         EXCEPTION(<span class="stringliteral">&quot;Could not open XML file in HeartConfig&quot;</span>);
<a name="l00175"></a>00175     }
<a name="l00176"></a>00176 
<a name="l00177"></a>00177     <span class="comment">//Schema map</span>
<a name="l00178"></a>00178     <span class="comment">//Note - this location is relative to where we are storing the xml</span>
<a name="l00179"></a>00179     ::xml_schema::namespace_infomap map;
<a name="l00180"></a>00180     std::string absolute_path_to_xsd = <a class="code" href="classHeartConfig.html#a01341ecd6e9039ae130cbfcf0e355dfd">EscapeSpaces</a>(<a class="code" href="classChasteBuildInfo.html#ab1d5cd2c8e4852a5b0ac4f525c1e2565">ChasteBuildInfo::GetRootDir</a>());
<a name="l00181"></a>00181     absolute_path_to_xsd += <span class="stringliteral">&quot;/heart/src/io/&quot;</span>;
<a name="l00182"></a>00182     <span class="comment">// Release 1.1 (and earlier) didn&#39;t use a namespace</span>
<a name="l00183"></a>00183     map[<span class="stringliteral">&quot;&quot;</span>].schema = absolute_path_to_xsd + <span class="stringliteral">&quot;ChasteParameters_1_1.xsd&quot;</span>;
<a name="l00184"></a>00184     <span class="comment">// Later releases use namespaces of the form https://chaste.comlab.ox.ac.uk/nss/parameters/N_M</span>
<a name="l00185"></a>00185     map[<span class="stringliteral">&quot;cp20&quot;</span>].name = <span class="stringliteral">&quot;https://chaste.comlab.ox.ac.uk/nss/parameters/2_0&quot;</span>;
<a name="l00186"></a>00186     map[<span class="stringliteral">&quot;cp20&quot;</span>].schema = absolute_path_to_xsd + <span class="stringliteral">&quot;ChasteParameters_2_0.xsd&quot;</span>;
<a name="l00187"></a>00187 
<a name="l00188"></a>00188     cp::ChasteParameters(*p_parameters_file, *<a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>, map);
<a name="l00189"></a>00189     cp::ChasteParameters(*p_defaults_file, *<a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>, map);
<a name="l00190"></a>00190 }
<a name="l00191"></a>00191 
<a name="l00192"></a><a class="code" href="classHeartConfig.html#a92d7f06c5cf8caa9c8cf3f65ada9bb6b">00192</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a92d7f06c5cf8caa9c8cf3f65ada9bb6b">HeartConfig::SetDefaultSchemaLocations</a>()
<a name="l00193"></a>00193 {
<a name="l00194"></a>00194     <a class="code" href="classHeartConfig.html#a0378789cef3d6ef3001bbb94e9e48798">mSchemaLocations</a>.clear();
<a name="l00195"></a>00195     <span class="comment">// Location of schemas in the source tree</span>
<a name="l00196"></a>00196     std::string root_dir = std::string(<a class="code" href="classChasteBuildInfo.html#ab1d5cd2c8e4852a5b0ac4f525c1e2565">ChasteBuildInfo::GetRootDir</a>()) + <span class="stringliteral">&quot;/heart/src/io/&quot;</span>;
<a name="l00197"></a>00197     <span class="comment">// Release 1.1 (and earlier) didn&#39;t use a namespace</span>
<a name="l00198"></a>00198     <a class="code" href="classHeartConfig.html#a0378789cef3d6ef3001bbb94e9e48798">mSchemaLocations</a>[<span class="stringliteral">&quot;&quot;</span>] = root_dir + <span class="stringliteral">&quot;ChasteParameters_1_1.xsd&quot;</span>;
<a name="l00199"></a>00199     <span class="comment">// Later releases use namespaces of the form https://chaste.comlab.ox.ac.uk/nss/parameters/N_M</span>
<a name="l00200"></a>00200     <a class="code" href="classHeartConfig.html#a0378789cef3d6ef3001bbb94e9e48798">mSchemaLocations</a>[<span class="stringliteral">&quot;https://chaste.comlab.ox.ac.uk/nss/parameters/2_0&quot;</span>] = root_dir + <span class="stringliteral">&quot;ChasteParameters_2_0.xsd&quot;</span>;
<a name="l00201"></a>00201 }
<a name="l00202"></a>00202 
<a name="l00203"></a><a class="code" href="classHeartConfig.html#a6e38ef44c15a2d35c349cf323dca4fbb">00203</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a6e38ef44c15a2d35c349cf323dca4fbb">HeartConfig::SetFixedSchemaLocations</a>(<span class="keyword">const</span> SchemaLocationsMap&amp; rSchemaLocations)
<a name="l00204"></a>00204 {
<a name="l00205"></a>00205     <a class="code" href="classHeartConfig.html#a0378789cef3d6ef3001bbb94e9e48798">mSchemaLocations</a> = rSchemaLocations;
<a name="l00206"></a>00206     <a class="code" href="classHeartConfig.html#a54b8f9c822ac30d9a22e6121f428658b">SetUseFixedSchemaLocation</a>(<span class="keyword">true</span>);
<a name="l00207"></a>00207 }
<a name="l00208"></a>00208 
<a name="l00209"></a><a class="code" href="classHeartConfig.html#a54b8f9c822ac30d9a22e6121f428658b">00209</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a54b8f9c822ac30d9a22e6121f428658b">HeartConfig::SetUseFixedSchemaLocation</a>(<span class="keywordtype">bool</span> useFixedSchemaLocation)
<a name="l00210"></a>00210 {
<a name="l00211"></a>00211     <a class="code" href="classHeartConfig.html#a39f79c982e9983fe8c2823d8de697d85">mUseFixedSchemaLocation</a> = useFixedSchemaLocation;
<a name="l00212"></a>00212 }
<a name="l00213"></a>00213 
<a name="l00214"></a><a class="code" href="classHeartConfig.html#a01341ecd6e9039ae130cbfcf0e355dfd">00214</a> std::string <a class="code" href="classHeartConfig.html#a01341ecd6e9039ae130cbfcf0e355dfd">HeartConfig::EscapeSpaces</a>(<span class="keyword">const</span> std::string&amp; rPath)
<a name="l00215"></a>00215 {
<a name="l00216"></a>00216     std::string escaped_path;
<a name="l00217"></a>00217     <span class="keywordflow">for</span> (std::string::const_iterator it = rPath.begin(); it != rPath.end(); ++it)
<a name="l00218"></a>00218     {
<a name="l00219"></a>00219         <span class="keywordflow">if</span> (*it == <span class="charliteral">&#39; &#39;</span>)
<a name="l00220"></a>00220         {
<a name="l00221"></a>00221             escaped_path += <span class="stringliteral">&quot;%20&quot;</span>;
<a name="l00222"></a>00222         }
<a name="l00223"></a>00223         <span class="keywordflow">else</span>
<a name="l00224"></a>00224         {
<a name="l00225"></a>00225             escaped_path += *it;
<a name="l00226"></a>00226         }
<a name="l00227"></a>00227     }
<a name="l00228"></a>00228     <span class="keywordflow">return</span> escaped_path;
<a name="l00229"></a>00229 }
<a name="l00230"></a>00230 
<a name="l00231"></a><a class="code" href="classHeartConfig.html#a871a948c9d64ccfdecc2c3a1d47fb304">00231</a> boost::shared_ptr&lt;cp::chaste_parameters_type&gt; <a class="code" href="classHeartConfig.html#a871a948c9d64ccfdecc2c3a1d47fb304">HeartConfig::ReadFile</a>(<span class="keyword">const</span> std::string&amp; rFileName)
<a name="l00232"></a>00232 {
<a name="l00233"></a>00233     <span class="comment">// Determine whether to use the schema path given in the input XML, or our own schema</span>
<a name="l00234"></a>00234     ::xml_schema::properties props;
<a name="l00235"></a>00235     <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#a39f79c982e9983fe8c2823d8de697d85">mUseFixedSchemaLocation</a>)
<a name="l00236"></a>00236     {
<a name="l00237"></a>00237         <span class="keywordflow">for</span> (SchemaLocationsMap::iterator it = <a class="code" href="classHeartConfig.html#a0378789cef3d6ef3001bbb94e9e48798">mSchemaLocations</a>.begin();
<a name="l00238"></a>00238              it != <a class="code" href="classHeartConfig.html#a0378789cef3d6ef3001bbb94e9e48798">mSchemaLocations</a>.end();
<a name="l00239"></a>00239              ++it)
<a name="l00240"></a>00240         {
<a name="l00241"></a>00241             <span class="keywordflow">if</span> (it-&gt;first == <span class="stringliteral">&quot;&quot;</span>)
<a name="l00242"></a>00242             {
<a name="l00243"></a>00243                 props.no_namespace_schema_location(<a class="code" href="classHeartConfig.html#a01341ecd6e9039ae130cbfcf0e355dfd">EscapeSpaces</a>(it-&gt;second));
<a name="l00244"></a>00244             }
<a name="l00245"></a>00245             <span class="keywordflow">else</span>
<a name="l00246"></a>00246             {
<a name="l00247"></a>00247                 props.schema_location(it-&gt;first, <a class="code" href="classHeartConfig.html#a01341ecd6e9039ae130cbfcf0e355dfd">EscapeSpaces</a>(it-&gt;second));
<a name="l00248"></a>00248             }
<a name="l00249"></a>00249         }
<a name="l00250"></a>00250     }
<a name="l00251"></a>00251 
<a name="l00252"></a>00252     <span class="comment">// Get the parameters using the method &#39;ChasteParameters(rFileName)&#39;,</span>
<a name="l00253"></a>00253     <span class="comment">// which returns a std::auto_ptr. We convert to a shared_ptr for easier semantics.</span>
<a name="l00254"></a>00254     <span class="keywordflow">try</span>
<a name="l00255"></a>00255     {
<a name="l00256"></a>00256         <span class="comment">// Make sure Xerces initialization &amp; finalization happens</span>
<a name="l00257"></a>00257         ::xsd::cxx::xml::auto_initializer init_fini(<span class="keyword">true</span>, <span class="keyword">true</span>);
<a name="l00258"></a>00258         <span class="comment">// Set up an error handler</span>
<a name="l00259"></a>00259         ::xsd::cxx::tree::error_handler&lt;char&gt; error_handler;
<a name="l00260"></a>00260         <span class="comment">// Parse XML to DOM</span>
<a name="l00261"></a>00261         xsd::cxx::xml::dom::auto_ptr&lt;xercesc::DOMDocument&gt; p_doc = <a class="code" href="classHeartConfig.html#a4e69db53c7ebdbfc283c8d072c289373">ReadFileToDomDocument</a>(rFileName, error_handler, props);
<a name="l00262"></a>00262         <span class="comment">// Any errors?</span>
<a name="l00263"></a>00263         error_handler.throw_if_failed&lt; ::xsd::cxx::tree::parsing&lt; char &gt; &gt;();
<a name="l00264"></a>00264         <span class="comment">// Test the namespace on the root element</span>
<a name="l00265"></a>00265         xercesc::DOMElement* p_root_elt = p_doc-&gt;getDocumentElement();
<a name="l00266"></a>00266         std::string namespace_uri(xsd::cxx::xml::transcode&lt;char&gt;(p_root_elt-&gt;getNamespaceURI()));
<a name="l00267"></a>00267         <span class="keywordflow">if</span> (namespace_uri == <span class="stringliteral">&quot;&quot;</span>)
<a name="l00268"></a>00268         {
<a name="l00269"></a>00269             <span class="comment">// Pretend it&#39;s a version 2.0 file</span>
<a name="l00270"></a>00270             <a class="code" href="classHeartConfig.html#aeca3d17309388a980ce6e63f650a0cd0">AddNamespace</a>(p_doc.get(), p_root_elt, <span class="stringliteral">&quot;https://chaste.comlab.ox.ac.uk/nss/parameters/2_0&quot;</span>);
<a name="l00271"></a>00271             <span class="comment">// Change definitions of ionic models</span>
<a name="l00272"></a>00272             <a class="code" href="classHeartConfig.html#a8efab641595dfa357ab0b6ca7f1ffad1">TransformIonicModelDefinitions</a>(p_doc.get(), p_root_elt);
<a name="l00273"></a>00273         }
<a name="l00274"></a>00274         <span class="comment">// Parse DOM to object model</span>
<a name="l00275"></a>00275         std::auto_ptr&lt;cp::chaste_parameters_type&gt; p_params(cp::ChasteParameters(*p_doc, ::xml_schema::flags::dont_initialize, props));
<a name="l00276"></a>00276         <span class="comment">// Get rid of the DOM stuff</span>
<a name="l00277"></a>00277         p_doc.reset();
<a name="l00278"></a>00278 
<a name="l00279"></a>00279         <span class="keywordflow">return</span> boost::shared_ptr&lt;cp::chaste_parameters_type&gt;(p_params);
<a name="l00280"></a>00280     }
<a name="l00281"></a>00281     <span class="keywordflow">catch</span> (<span class="keyword">const</span> xml_schema::parsing&amp; e)
<a name="l00282"></a>00282     {
<a name="l00283"></a>00283         <span class="comment">// Make sure we don&#39;t store invalid parameters</span>
<a name="l00284"></a>00284         <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>.reset();
<a name="l00285"></a>00285         <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>.reset();
<a name="l00286"></a>00286         <span class="comment">// Test for missing schema/xml file</span>
<a name="l00287"></a>00287 <span class="preprocessor">#if (XSD_INT_VERSION &gt;= 3000000L)</span>
<a name="l00288"></a>00288 <span class="preprocessor"></span>        <span class="keyword">const</span> xml_schema::diagnostics&amp; diags = e.diagnostics();
<a name="l00289"></a>00289         <span class="keyword">const</span> xml_schema::error&amp; first_error = diags[0];
<a name="l00290"></a>00290 <span class="preprocessor">#else</span>
<a name="l00291"></a>00291 <span class="preprocessor"></span>        <span class="keyword">const</span> xml_schema::errors&amp; errors = e.errors();
<a name="l00292"></a>00292         <span class="keyword">const</span> xml_schema::error&amp; first_error = errors[0];
<a name="l00293"></a>00293 <span class="preprocessor">#endif</span>
<a name="l00294"></a>00294 <span class="preprocessor"></span>        <span class="keywordflow">if</span> (first_error.line() == 0u)
<a name="l00295"></a>00295         {
<a name="l00296"></a>00296             std::cerr &lt;&lt; first_error &lt;&lt; std::endl;
<a name="l00297"></a>00297             EXCEPTION(<span class="stringliteral">&quot;Missing file parsing configuration file: &quot;</span> + rFileName);
<a name="l00298"></a>00298         }
<a name="l00299"></a>00299         <span class="keywordflow">else</span>
<a name="l00300"></a>00300         {
<a name="l00301"></a>00301             std::cerr &lt;&lt; e &lt;&lt; std::endl;
<a name="l00302"></a>00302             EXCEPTION(<span class="stringliteral">&quot;XML parsing error in configuration file: &quot;</span> + rFileName);
<a name="l00303"></a>00303         }
<a name="l00304"></a>00304     }
<a name="l00305"></a>00305     <span class="keywordflow">catch</span> (<span class="keyword">const</span> xml_schema::exception&amp; e)
<a name="l00306"></a>00306     {
<a name="l00307"></a>00307         std::cerr &lt;&lt; e &lt;&lt; std::endl;
<a name="l00308"></a>00308         <span class="comment">// Make sure we don&#39;t store invalid parameters</span>
<a name="l00309"></a>00309         <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>.reset();
<a name="l00310"></a>00310         <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>.reset();
<a name="l00311"></a>00311         EXCEPTION(<span class="stringliteral">&quot;XML parsing error in configuration file: &quot;</span> + rFileName);
<a name="l00312"></a>00312     }
<a name="l00313"></a>00313 }
<a name="l00314"></a>00314 
<a name="l00315"></a><a class="code" href="classHeartConfig.html#af6fed28371be1a69eefe2de666d44a87">00315</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#af6fed28371be1a69eefe2de666d44a87">HeartConfig::SetParametersFile</a>(<span class="keyword">const</span> std::string&amp; rFileName)
<a name="l00316"></a>00316 {
<a name="l00317"></a>00317     <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a> = <a class="code" href="classHeartConfig.html#a871a948c9d64ccfdecc2c3a1d47fb304">ReadFile</a>(rFileName);
<a name="l00318"></a>00318 
<a name="l00319"></a>00319     <a class="code" href="classHeartConfig.html#aef79708e5e663a9ea5ff236ecc0bbd85">CheckTimeSteps</a>(); <span class="comment">// For consistency with SetDefaultsFile</span>
<a name="l00320"></a>00320 }
<a name="l00321"></a>00321 
<a name="l00322"></a>00322 
<a name="l00323"></a><a class="code" href="classHeartConfig.html#ae2378924829d86f77eb14c5fd0326e80">00323</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#ae2378924829d86f77eb14c5fd0326e80">HeartConfig::Reset</a>()
<a name="l00324"></a>00324 {
<a name="l00325"></a>00325     <span class="comment">// Throw it away first, so that mpInstance is NULL when we...</span>
<a name="l00326"></a>00326     <a class="code" href="classHeartConfig.html#a1d700f703ffa3528790264535857411a">mpInstance</a>.reset();
<a name="l00327"></a>00327     <span class="comment">// ...make a new one</span>
<a name="l00328"></a>00328     <a class="code" href="classHeartConfig.html#a1d700f703ffa3528790264535857411a">mpInstance</a>.reset(<span class="keyword">new</span> <a class="code" href="classHeartConfig.html">HeartConfig</a>);
<a name="l00329"></a>00329 }
<a name="l00330"></a>00330 
<a name="l00331"></a><a class="code" href="classHeartConfig.html#a894d374015f888c2111ec252134395fc">00331</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#a894d374015f888c2111ec252134395fc">HeartConfig::IsSimulationDefined</a>()<span class="keyword"> const</span>
<a name="l00332"></a>00332 <span class="keyword"></span>{
<a name="l00333"></a>00333     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().present();
<a name="l00334"></a>00334 }
<a name="l00335"></a>00335 
<a name="l00336"></a><a class="code" href="classHeartConfig.html#a67ec8f0a426a424b562ab106fb1fc144">00336</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#a67ec8f0a426a424b562ab106fb1fc144">HeartConfig::IsSimulationResumed</a>()<span class="keyword"> const</span>
<a name="l00337"></a>00337 <span class="keyword"></span>{
<a name="l00338"></a>00338     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;ResumeSimulation().present();
<a name="l00339"></a>00339 }
<a name="l00340"></a>00340 
<a name="l00341"></a>00341 
<a name="l00342"></a>00342 <span class="keyword">template</span>&lt;<span class="keyword">class</span> TYPE&gt;
<a name="l00343"></a><a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">00343</a> TYPE* <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">HeartConfig::DecideLocation</a>(TYPE* ptr1, TYPE* ptr2, <span class="keyword">const</span> std::string&amp; nameParameter)<span class="keyword"> const</span>
<a name="l00344"></a>00344 <span class="keyword"></span>{
<a name="l00345"></a>00345     <span class="keywordflow">if</span> (ptr1-&gt;present())
<a name="l00346"></a>00346     {
<a name="l00347"></a>00347         <span class="keywordflow">return</span> ptr1;
<a name="l00348"></a>00348     }
<a name="l00349"></a>00349     <span class="keywordflow">if</span> (ptr2-&gt;present())
<a name="l00350"></a>00350     {
<a name="l00351"></a>00351         <span class="keywordflow">return</span> ptr2;
<a name="l00352"></a>00352     }
<a name="l00353"></a>00353     EXCEPTION(<span class="stringliteral">&quot;No &quot;</span> + nameParameter + <span class="stringliteral">&quot; provided (neither default nor user defined)&quot;</span>);
<a name="l00354"></a>00354 }
<a name="l00355"></a>00355 
<a name="l00356"></a><a class="code" href="classHeartConfig.html#aab7ea75d3f83c1202127db592d934532">00356</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#aab7ea75d3f83c1202127db592d934532">HeartConfig::CheckSimulationIsDefined</a>(std::string callingMethod)<span class="keyword"> const</span>
<a name="l00357"></a>00357 <span class="keyword"></span>{
<a name="l00358"></a>00358     <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#a67ec8f0a426a424b562ab106fb1fc144">IsSimulationResumed</a>())
<a name="l00359"></a>00359     {
<a name="l00360"></a>00360         EXCEPTION(callingMethod + <span class="stringliteral">&quot; information is not available in a resumed simulation.&quot;</span>);
<a name="l00361"></a>00361     }
<a name="l00362"></a>00362 }
<a name="l00363"></a>00363 
<a name="l00364"></a><a class="code" href="classHeartConfig.html#a2be3fdcc724c4a6609526b53f86d8c01">00364</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a2be3fdcc724c4a6609526b53f86d8c01">HeartConfig::CheckResumeSimulationIsDefined</a>(std::string callingMethod)<span class="keyword"> const</span>
<a name="l00365"></a>00365 <span class="keyword"></span>{
<a name="l00366"></a>00366     <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#a894d374015f888c2111ec252134395fc">IsSimulationDefined</a>())
<a name="l00367"></a>00367     {
<a name="l00368"></a>00368         EXCEPTION(callingMethod + <span class="stringliteral">&quot; information is not available in a standard (non-resumed) simulation.&quot;</span>);
<a name="l00369"></a>00369     }
<a name="l00370"></a>00370 }
<a name="l00371"></a>00371 
<a name="l00372"></a><a class="code" href="classHeartConfig.html#a4170d162538ec096d7df103f5781a998">00372</a> <span class="keywordtype">unsigned</span> <a class="code" href="classHeartConfig.html#a4170d162538ec096d7df103f5781a998">HeartConfig::GetSpaceDimension</a>()<span class="keyword"> const</span>
<a name="l00373"></a>00373 <span class="keyword"></span>{
<a name="l00374"></a>00374     <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#a894d374015f888c2111ec252134395fc">IsSimulationDefined</a>())
<a name="l00375"></a>00375     {
<a name="l00376"></a>00376         <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().SpaceDimension(),
<a name="l00377"></a>00377                                &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation().get().SpaceDimension(),
<a name="l00378"></a>00378                                <span class="stringliteral">&quot;SpaceDimension&quot;</span>)-&gt;<span class="keyword">get</span>();
<a name="l00379"></a>00379     }
<a name="l00380"></a>00380     <span class="keywordflow">else</span>
<a name="l00381"></a>00381     {
<a name="l00382"></a>00382         <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;ResumeSimulation().get().SpaceDimension();
<a name="l00383"></a>00383     }
<a name="l00384"></a>00384 }
<a name="l00385"></a>00385 
<a name="l00386"></a><a class="code" href="classHeartConfig.html#ad3e460b2f9f263ec6ac04fda60197780">00386</a> <span class="keywordtype">double</span> <a class="code" href="classHeartConfig.html#ad3e460b2f9f263ec6ac04fda60197780">HeartConfig::GetSimulationDuration</a>()<span class="keyword"> const</span>
<a name="l00387"></a>00387 <span class="keyword"></span>{
<a name="l00388"></a>00388     <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#a894d374015f888c2111ec252134395fc">IsSimulationDefined</a>())
<a name="l00389"></a>00389     {
<a name="l00390"></a>00390         <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().SimulationDuration(),
<a name="l00391"></a>00391                                &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation().get().SimulationDuration(),
<a name="l00392"></a>00392                                <span class="stringliteral">&quot;Simulation/SimulationDuration&quot;</span>)-&gt;<span class="keyword">get</span>();
<a name="l00393"></a>00393     }
<a name="l00394"></a>00394     <span class="keywordflow">else</span> <span class="comment">// IsSimulationResumed</span>
<a name="l00395"></a>00395     {
<a name="l00396"></a>00396         <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;ResumeSimulation().get().SimulationDuration();
<a name="l00397"></a>00397     }
<a name="l00398"></a>00398 }
<a name="l00399"></a>00399 
<a name="l00400"></a><a class="code" href="classHeartConfig.html#a493a8d7316bd8e257459ec0372fd8706">00400</a> cp::domain_type <a class="code" href="classHeartConfig.html#a493a8d7316bd8e257459ec0372fd8706">HeartConfig::GetDomain</a>()<span class="keyword"> const</span>
<a name="l00401"></a>00401 <span class="keyword"></span>{
<a name="l00402"></a>00402     <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#a894d374015f888c2111ec252134395fc">IsSimulationDefined</a>())
<a name="l00403"></a>00403     {
<a name="l00404"></a>00404         <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().Domain(),
<a name="l00405"></a>00405                                &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation().get().Domain(),
<a name="l00406"></a>00406                                <span class="stringliteral">&quot;Domain&quot;</span>)-&gt;<span class="keyword">get</span>();
<a name="l00407"></a>00407     }
<a name="l00408"></a>00408     <span class="keywordflow">else</span>
<a name="l00409"></a>00409     {
<a name="l00410"></a>00410         <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;ResumeSimulation().get().Domain();
<a name="l00411"></a>00411     }
<a name="l00412"></a>00412 }
<a name="l00413"></a>00413 
<a name="l00414"></a><a class="code" href="classHeartConfig.html#a3b1e0fb27bd34fa487627bf80c2b9c57">00414</a> cp::ionic_model_selection_type <a class="code" href="classHeartConfig.html#a3b1e0fb27bd34fa487627bf80c2b9c57">HeartConfig::GetDefaultIonicModel</a>()<span class="keyword"> const</span>
<a name="l00415"></a>00415 <span class="keyword"></span>{
<a name="l00416"></a>00416     <a class="code" href="classHeartConfig.html#aab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">&quot;DefaultIonicModel&quot;</span>);
<a name="l00417"></a>00417 
<a name="l00418"></a>00418     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().IonicModels(),
<a name="l00419"></a>00419                            &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation().get().IonicModels(),
<a name="l00420"></a>00420                            <span class="stringliteral">&quot;IonicModel&quot;</span>)-&gt;<span class="keyword">get</span>().Default();
<a name="l00421"></a>00421 }
<a name="l00422"></a>00422 
<a name="l00423"></a>00423 <span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> DIM&gt;
<a name="l00424"></a><a class="code" href="classHeartConfig.html#a52a6c8732dadbb923dd233dada799e81">00424</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a52a6c8732dadbb923dd233dada799e81">HeartConfig::GetIonicModelRegions</a>(std::vector&lt;<a class="code" href="classChasteCuboid.html">ChasteCuboid&lt;DIM&gt;</a> &gt;&amp; definedRegions,
<a name="l00425"></a>00425                                        std::vector&lt;cp::ionic_model_selection_type&gt;&amp; ionicModels)<span class="keyword"> const</span>
<a name="l00426"></a>00426 <span class="keyword"></span>{
<a name="l00427"></a>00427     <a class="code" href="classHeartConfig.html#aab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">&quot;IonicModelRegions&quot;</span>);
<a name="l00428"></a>00428     definedRegions.clear();
<a name="l00429"></a>00429     ionicModels.clear();
<a name="l00430"></a>00430 
<a name="l00431"></a>00431     XSD_SEQUENCE_TYPE(cp::ionic_models_type::Region)&amp;
<a name="l00432"></a>00432          regions = <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().IonicModels(),
<a name="l00433"></a>00433                                    &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation().get().IonicModels(),
<a name="l00434"></a>00434                                    <span class="stringliteral">&quot;IonicModel&quot;</span>)-&gt;<span class="keyword">get</span>().Region();
<a name="l00435"></a>00435 
<a name="l00436"></a>00436     <span class="keywordflow">for</span> (XSD_ITERATOR_TYPE(cp::ionic_models_type::Region) i = regions.begin();
<a name="l00437"></a>00437          i != regions.end();
<a name="l00438"></a>00438          ++i)
<a name="l00439"></a>00439     {
<a name="l00440"></a>00440         cp::ionic_model_region_type ionic_model_region(*i);
<a name="l00441"></a>00441         <span class="keywordflow">if</span> (ionic_model_region.Location().Cuboid().present())
<a name="l00442"></a>00442         {
<a name="l00443"></a>00443             cp::point_type point_a = ionic_model_region.Location().Cuboid()-&gt;LowerCoordinates();
<a name="l00444"></a>00444             cp::point_type point_b = ionic_model_region.Location().Cuboid()-&gt;UpperCoordinates();
<a name="l00445"></a>00445 
<a name="l00446"></a>00446             <span class="keywordflow">switch</span> (DIM)
<a name="l00447"></a>00447             {
<a name="l00448"></a>00448                 <span class="keywordflow">case</span> 1:
<a name="l00449"></a>00449                 {
<a name="l00450"></a>00450                     <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_a ( point_a.x() );
<a name="l00451"></a>00451                     <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_b ( point_b.x() );
<a name="l00452"></a>00452                     definedRegions.push_back(<a class="code" href="classChasteCuboid.html">ChasteCuboid&lt;DIM&gt;</a>( chaste_point_a, chaste_point_b ));
<a name="l00453"></a>00453                     <span class="keywordflow">break</span>;
<a name="l00454"></a>00454                 }
<a name="l00455"></a>00455                 <span class="keywordflow">case</span> 2:
<a name="l00456"></a>00456                 {
<a name="l00457"></a>00457                     <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_a ( point_a.x(), point_a.y() );
<a name="l00458"></a>00458                     <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_b ( point_b.x(), point_b.y() );
<a name="l00459"></a>00459                     definedRegions.push_back(<a class="code" href="classChasteCuboid.html">ChasteCuboid&lt;DIM&gt;</a>( chaste_point_a, chaste_point_b ));
<a name="l00460"></a>00460                     <span class="keywordflow">break</span>;
<a name="l00461"></a>00461                 }
<a name="l00462"></a>00462                 <span class="keywordflow">case</span> 3:
<a name="l00463"></a>00463                 {
<a name="l00464"></a>00464                     <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_a ( point_a.x(), point_a.y(), point_a.z() );
<a name="l00465"></a>00465                     <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_b ( point_b.x(), point_b.y(), point_b.z() );
<a name="l00466"></a>00466                     definedRegions.push_back(<a class="code" href="classChasteCuboid.html">ChasteCuboid&lt;DIM&gt;</a>( chaste_point_a, chaste_point_b ));
<a name="l00467"></a>00467                     <span class="keywordflow">break</span>;
<a name="l00468"></a>00468                 }
<a name="l00469"></a>00469                 <span class="keywordflow">default</span>:
<a name="l00470"></a>00470                     NEVER_REACHED;
<a name="l00471"></a>00471                     <span class="keywordflow">break</span>;
<a name="l00472"></a>00472             }
<a name="l00473"></a>00473 
<a name="l00474"></a>00474             ionicModels.push_back(ionic_model_region.IonicModel());
<a name="l00475"></a>00475         }
<a name="l00476"></a>00476         <span class="keywordflow">else</span>
<a name="l00477"></a>00477         {
<a name="l00478"></a>00478             <span class="keywordflow">if</span>(ionic_model_region.Location().EpiLayer().present() || ionic_model_region.Location().MidLayer().present() || ionic_model_region.Location().EndoLayer().present() )
<a name="l00479"></a>00479             {
<a name="l00481"></a>00481                 EXCEPTION(<span class="stringliteral">&quot;Definition of transmural layers is not yet supported for defining different ionic models, please use cuboids instead&quot;</span>);
<a name="l00482"></a>00482             }
<a name="l00483"></a>00483         }
<a name="l00484"></a>00484     }
<a name="l00485"></a>00485 }
<a name="l00486"></a>00486 
<a name="l00487"></a>00487 
<a name="l00488"></a><a class="code" href="classHeartConfig.html#a1f847d3789d27d2c4ac4adc8010fe311">00488</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#a1f847d3789d27d2c4ac4adc8010fe311">HeartConfig::IsMeshProvided</a>()<span class="keyword"> const</span>
<a name="l00489"></a>00489 <span class="keyword"></span>{
<a name="l00490"></a>00490     <a class="code" href="classHeartConfig.html#aab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">&quot;Mesh&quot;</span>);
<a name="l00491"></a>00491 
<a name="l00492"></a>00492     <span class="keywordflow">try</span>
<a name="l00493"></a>00493     {
<a name="l00494"></a>00494         <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().Mesh(),
<a name="l00495"></a>00495                         &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation().get().Mesh(),
<a name="l00496"></a>00496                         <span class="stringliteral">&quot;Mesh&quot;</span>);
<a name="l00497"></a>00497         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00498"></a>00498     }
<a name="l00499"></a>00499     <span class="keywordflow">catch</span> (<a class="code" href="classException.html">Exception</a>&amp; e)
<a name="l00500"></a>00500     {
<a name="l00501"></a>00501         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00502"></a>00502     }
<a name="l00503"></a>00503 }
<a name="l00504"></a>00504 
<a name="l00505"></a><a class="code" href="classHeartConfig.html#afba7fca19523a0e6a3c2037b165dba92">00505</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#afba7fca19523a0e6a3c2037b165dba92">HeartConfig::GetCreateMesh</a>()<span class="keyword"> const</span>
<a name="l00506"></a>00506 <span class="keyword"></span>{
<a name="l00507"></a>00507     <a class="code" href="classHeartConfig.html#aab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">&quot;Mesh&quot;</span>);
<a name="l00508"></a>00508 
<a name="l00509"></a>00509     cp::mesh_type <a class="code" href="structmesh.html">mesh</a> = <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().Mesh(),
<a name="l00510"></a>00510                                          &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation().get().Mesh(),
<a name="l00511"></a>00511                                          <span class="stringliteral">&quot;Mesh&quot;</span>)-&gt;<span class="keyword">get</span>();
<a name="l00512"></a>00512 
<a name="l00513"></a>00513     <span class="keywordflow">return</span> (mesh.Slab().present() || mesh.Sheet().present() || mesh.Fibre().present());
<a name="l00514"></a>00514 }
<a name="l00515"></a>00515 
<a name="l00516"></a><a class="code" href="classHeartConfig.html#ac5ed721756c4f02416abe35847591af3">00516</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#ac5ed721756c4f02416abe35847591af3">HeartConfig::GetCreateSlab</a>()<span class="keyword"> const</span>
<a name="l00517"></a>00517 <span class="keyword"></span>{
<a name="l00518"></a>00518     <a class="code" href="classHeartConfig.html#aab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">&quot;Mesh&quot;</span>);
<a name="l00519"></a>00519 
<a name="l00520"></a>00520     cp::mesh_type <a class="code" href="structmesh.html">mesh</a> = <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().Mesh(),
<a name="l00521"></a>00521                                          &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation().get().Mesh(),
<a name="l00522"></a>00522                                          <span class="stringliteral">&quot;Mesh&quot;</span>)-&gt;<span class="keyword">get</span>();
<a name="l00523"></a>00523 
<a name="l00524"></a>00524     <span class="keywordflow">return</span> (mesh.Slab().present());
<a name="l00525"></a>00525 }
<a name="l00526"></a>00526 
<a name="l00527"></a><a class="code" href="classHeartConfig.html#a60ed4f42ad75ecb04db166120540f387">00527</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#a60ed4f42ad75ecb04db166120540f387">HeartConfig::GetCreateSheet</a>()<span class="keyword"> const</span>
<a name="l00528"></a>00528 <span class="keyword"></span>{
<a name="l00529"></a>00529     <a class="code" href="classHeartConfig.html#aab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">&quot;Mesh&quot;</span>);
<a name="l00530"></a>00530 
<a name="l00531"></a>00531     cp::mesh_type <a class="code" href="structmesh.html">mesh</a> = <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().Mesh(),
<a name="l00532"></a>00532                                          &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation().get().Mesh(),
<a name="l00533"></a>00533                                          <span class="stringliteral">&quot;Mesh&quot;</span>)-&gt;<span class="keyword">get</span>();
<a name="l00534"></a>00534 
<a name="l00535"></a>00535     <span class="keywordflow">return</span> (mesh.Sheet().present());
<a name="l00536"></a>00536 }
<a name="l00537"></a>00537 
<a name="l00538"></a><a class="code" href="classHeartConfig.html#abb6c5c1d7b12371e13c65db55e4d054c">00538</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#abb6c5c1d7b12371e13c65db55e4d054c">HeartConfig::GetCreateFibre</a>()<span class="keyword"> const</span>
<a name="l00539"></a>00539 <span class="keyword"></span>{
<a name="l00540"></a>00540     <a class="code" href="classHeartConfig.html#aab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">&quot;Mesh&quot;</span>);
<a name="l00541"></a>00541 
<a name="l00542"></a>00542     cp::mesh_type <a class="code" href="structmesh.html">mesh</a> = <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().Mesh(),
<a name="l00543"></a>00543                                          &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation().get().Mesh(),
<a name="l00544"></a>00544                                          <span class="stringliteral">&quot;Mesh&quot;</span>)-&gt;<span class="keyword">get</span>();
<a name="l00545"></a>00545 
<a name="l00546"></a>00546     <span class="keywordflow">return</span> (mesh.Fibre().present());
<a name="l00547"></a>00547 }
<a name="l00548"></a>00548 
<a name="l00549"></a>00549 
<a name="l00550"></a><a class="code" href="classHeartConfig.html#a9624dfc37c6c70cb92826ea3677bd905">00550</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#a9624dfc37c6c70cb92826ea3677bd905">HeartConfig::GetLoadMesh</a>()<span class="keyword"> const</span>
<a name="l00551"></a>00551 <span class="keyword"></span>{
<a name="l00552"></a>00552     <a class="code" href="classHeartConfig.html#aab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">&quot;Mesh&quot;</span>);
<a name="l00553"></a>00553 
<a name="l00554"></a>00554     <span class="keywordflow">return</span> (<a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().Mesh(),
<a name="l00555"></a>00555                             &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation().get().Mesh(),
<a name="l00556"></a>00556                             <span class="stringliteral">&quot;Mesh&quot;</span>)-&gt;<span class="keyword">get</span>().LoadMesh().present());
<a name="l00557"></a>00557 }
<a name="l00558"></a>00558 
<a name="l00559"></a><a class="code" href="classHeartConfig.html#aca214e0a3a7aefaa8694e602a6346dc7">00559</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#aca214e0a3a7aefaa8694e602a6346dc7">HeartConfig::GetSlabDimensions</a>(c_vector&lt;double, 3&gt;&amp; slabDimensions)<span class="keyword"> const</span>
<a name="l00560"></a>00560 <span class="keyword"></span>{
<a name="l00561"></a>00561     <a class="code" href="classHeartConfig.html#aab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">&quot;Slab&quot;</span>);
<a name="l00562"></a>00562 
<a name="l00563"></a>00563     <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#a4170d162538ec096d7df103f5781a998">GetSpaceDimension</a>()!=3 || !<a class="code" href="classHeartConfig.html#ac5ed721756c4f02416abe35847591af3">GetCreateSlab</a>())
<a name="l00564"></a>00564     {
<a name="l00565"></a>00565         EXCEPTION(<span class="stringliteral">&quot;Tissue slabs can only be defined in 3D&quot;</span>);
<a name="l00566"></a>00566     }
<a name="l00567"></a>00567 
<a name="l00568"></a>00568     optional&lt;cp::slab_type, false&gt; slab_dimensions = <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().Mesh(),
<a name="l00569"></a>00569                                                                      &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation().get().Mesh(),
<a name="l00570"></a>00570                                                                      <span class="stringliteral">&quot;Slab&quot;</span>)-&gt;<span class="keyword">get</span>().Slab();
<a name="l00571"></a>00571 
<a name="l00572"></a>00572     slabDimensions[0] = slab_dimensions-&gt;x();
<a name="l00573"></a>00573     slabDimensions[1] = slab_dimensions-&gt;y();
<a name="l00574"></a>00574     slabDimensions[2] = slab_dimensions-&gt;z();
<a name="l00575"></a>00575 }
<a name="l00576"></a>00576 
<a name="l00577"></a><a class="code" href="classHeartConfig.html#a63918706b7ce417121fc7dc198f6ef94">00577</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a63918706b7ce417121fc7dc198f6ef94">HeartConfig::GetSheetDimensions</a>(c_vector&lt;double, 2&gt;&amp; sheetDimensions)<span class="keyword"> const</span>
<a name="l00578"></a>00578 <span class="keyword"></span>{
<a name="l00579"></a>00579     <a class="code" href="classHeartConfig.html#aab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">&quot;Sheet&quot;</span>);
<a name="l00580"></a>00580 
<a name="l00581"></a>00581     <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#a4170d162538ec096d7df103f5781a998">GetSpaceDimension</a>()!=2 || !<a class="code" href="classHeartConfig.html#a60ed4f42ad75ecb04db166120540f387">GetCreateSheet</a>())
<a name="l00582"></a>00582     {
<a name="l00583"></a>00583         EXCEPTION(<span class="stringliteral">&quot;Tissue sheets can only be defined in 2D&quot;</span>);
<a name="l00584"></a>00584     }
<a name="l00585"></a>00585 
<a name="l00586"></a>00586     optional&lt;cp::sheet_type, false&gt; sheet_dimensions = <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().Mesh(),
<a name="l00587"></a>00587                                                                        &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation().get().Mesh(),
<a name="l00588"></a>00588                                                                        <span class="stringliteral">&quot;Sheet&quot;</span>)-&gt;<span class="keyword">get</span>().Sheet();
<a name="l00589"></a>00589 
<a name="l00590"></a>00590     sheetDimensions[0] = sheet_dimensions-&gt;x();
<a name="l00591"></a>00591     sheetDimensions[1] = sheet_dimensions-&gt;y();
<a name="l00592"></a>00592 }
<a name="l00593"></a>00593 
<a name="l00594"></a><a class="code" href="classHeartConfig.html#a0ee95147168ddacf8a17a92c17101ced">00594</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a0ee95147168ddacf8a17a92c17101ced">HeartConfig::GetFibreLength</a>(c_vector&lt;double, 1&gt;&amp; fibreLength)<span class="keyword"> const</span>
<a name="l00595"></a>00595 <span class="keyword"></span>{
<a name="l00596"></a>00596     <a class="code" href="classHeartConfig.html#aab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">&quot;Fibre&quot;</span>);
<a name="l00597"></a>00597 
<a name="l00598"></a>00598     <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#a4170d162538ec096d7df103f5781a998">GetSpaceDimension</a>()!=1 || !<a class="code" href="classHeartConfig.html#abb6c5c1d7b12371e13c65db55e4d054c">GetCreateFibre</a>())
<a name="l00599"></a>00599     {
<a name="l00600"></a>00600         EXCEPTION(<span class="stringliteral">&quot;Tissue fibres can only be defined in 1D&quot;</span>);
<a name="l00601"></a>00601     }
<a name="l00602"></a>00602 
<a name="l00603"></a>00603     optional&lt;cp::fibre_type, false&gt; fibre_length = <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().Mesh(),
<a name="l00604"></a>00604                                                                    &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation().get().Mesh(),
<a name="l00605"></a>00605                                                                    <span class="stringliteral">&quot;Fibre&quot;</span>)-&gt;<span class="keyword">get</span>().Fibre();
<a name="l00606"></a>00606 
<a name="l00607"></a>00607     fibreLength[0] = fibre_length-&gt;x();
<a name="l00608"></a>00608 }
<a name="l00609"></a>00609 
<a name="l00610"></a>00610 
<a name="l00611"></a><a class="code" href="classHeartConfig.html#a3d0e9ad0966d4cee984223e904c68092">00611</a> <span class="keywordtype">double</span> <a class="code" href="classHeartConfig.html#a3d0e9ad0966d4cee984223e904c68092">HeartConfig::GetInterNodeSpace</a>()<span class="keyword"> const</span>
<a name="l00612"></a>00612 <span class="keyword"></span>{
<a name="l00613"></a>00613     <a class="code" href="classHeartConfig.html#aab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">&quot;InterNodeSpace&quot;</span>);
<a name="l00614"></a>00614     assert(<a class="code" href="classHeartConfig.html#afba7fca19523a0e6a3c2037b165dba92">GetCreateMesh</a>());
<a name="l00615"></a>00615 
<a name="l00616"></a>00616     <span class="keywordflow">switch</span>(<a class="code" href="classHeartConfig.html#a4170d162538ec096d7df103f5781a998">GetSpaceDimension</a>())
<a name="l00617"></a>00617     {
<a name="l00618"></a>00618         <span class="keywordflow">case</span> 3:
<a name="l00619"></a>00619             <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().Mesh(),
<a name="l00620"></a>00620                                    &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation().get().Mesh(),
<a name="l00621"></a>00621                                    <span class="stringliteral">&quot;Slab&quot;</span>)-&gt;<span class="keyword">get</span>().Slab()-&gt;inter_node_space();
<a name="l00622"></a>00622             <span class="keywordflow">break</span>;
<a name="l00623"></a>00623         <span class="keywordflow">case</span> 2:
<a name="l00624"></a>00624             <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().Mesh(),
<a name="l00625"></a>00625                                    &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation().get().Mesh(),
<a name="l00626"></a>00626                                    <span class="stringliteral">&quot;Sheet&quot;</span>)-&gt;<span class="keyword">get</span>().Sheet()-&gt;inter_node_space();
<a name="l00627"></a>00627             <span class="keywordflow">break</span>;
<a name="l00628"></a>00628         <span class="keywordflow">case</span> 1:
<a name="l00629"></a>00629             <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().Mesh(),
<a name="l00630"></a>00630                                    &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation().get().Mesh(),
<a name="l00631"></a>00631                                    <span class="stringliteral">&quot;Fibre&quot;</span>)-&gt;<span class="keyword">get</span>().Fibre()-&gt;inter_node_space();
<a name="l00632"></a>00632             <span class="keywordflow">break</span>;
<a name="l00633"></a>00633         <span class="keywordflow">default</span>:
<a name="l00634"></a>00634             NEVER_REACHED;
<a name="l00635"></a>00635     }
<a name="l00636"></a>00636 
<a name="l00637"></a>00637 
<a name="l00638"></a>00638 }
<a name="l00639"></a>00639 
<a name="l00640"></a><a class="code" href="classHeartConfig.html#a474d5fef81b34e7ecf4182008289b381">00640</a> std::string <a class="code" href="classHeartConfig.html#a474d5fef81b34e7ecf4182008289b381">HeartConfig::GetMeshName</a>()<span class="keyword"> const</span>
<a name="l00641"></a>00641 <span class="keyword"></span>{
<a name="l00642"></a>00642     <a class="code" href="classHeartConfig.html#aab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">&quot;LoadMesh&quot;</span>);
<a name="l00643"></a>00643     assert(<a class="code" href="classHeartConfig.html#a9624dfc37c6c70cb92826ea3677bd905">GetLoadMesh</a>());
<a name="l00644"></a>00644 
<a name="l00645"></a>00645     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().Mesh(),
<a name="l00646"></a>00646                            &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation().get().Mesh(),
<a name="l00647"></a>00647                            <span class="stringliteral">&quot;LoadMesh&quot;</span>)-&gt;<span class="keyword">get</span>().LoadMesh()-&gt;name();
<a name="l00648"></a>00648 }
<a name="l00649"></a>00649 
<a name="l00650"></a><a class="code" href="classHeartConfig.html#a40117fc56c45d408cdd57a1e3538b989">00650</a> cp::media_type <a class="code" href="classHeartConfig.html#a40117fc56c45d408cdd57a1e3538b989">HeartConfig::GetConductivityMedia</a>()<span class="keyword"> const</span>
<a name="l00651"></a>00651 <span class="keyword"></span>{
<a name="l00652"></a>00652     <a class="code" href="classHeartConfig.html#aab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">&quot;LoadMesh&quot;</span>);
<a name="l00653"></a>00653     assert(<a class="code" href="classHeartConfig.html#a9624dfc37c6c70cb92826ea3677bd905">GetLoadMesh</a>());
<a name="l00654"></a>00654 
<a name="l00655"></a>00655     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().Mesh(),
<a name="l00656"></a>00656                            &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation().get().Mesh(),
<a name="l00657"></a>00657                            <span class="stringliteral">&quot;LoadMesh&quot;</span>)-&gt;<span class="keyword">get</span>().LoadMesh()-&gt;conductivity_media();
<a name="l00658"></a>00658 }
<a name="l00659"></a>00659 
<a name="l00660"></a>00660 <span class="keyword">template</span> &lt;<span class="keywordtype">unsigned</span> DIM&gt;
<a name="l00661"></a><a class="code" href="classHeartConfig.html#a3e7bfaab40d27a13d56a67e0c4c202ae">00661</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a3e7bfaab40d27a13d56a67e0c4c202ae">HeartConfig::GetStimuli</a>(std::vector&lt;boost::shared_ptr&lt;SimpleStimulus&gt; &gt;&amp; rStimuliApplied,
<a name="l00662"></a>00662                              std::vector&lt;<a class="code" href="classChasteCuboid.html">ChasteCuboid&lt;DIM&gt;</a> &gt;&amp; rStimulatedAreas)<span class="keyword"> const</span>
<a name="l00663"></a>00663 <span class="keyword"></span>{
<a name="l00664"></a>00664     <a class="code" href="classHeartConfig.html#aab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">&quot;Stimuli&quot;</span>);
<a name="l00665"></a>00665     XSD_ANON_SEQUENCE_TYPE(cp::simulation_type, Stimuli, Stimulus)&amp;
<a name="l00666"></a>00666          stimuli = <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().Stimuli(),
<a name="l00667"></a>00667                            &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation().get().Stimuli(),
<a name="l00668"></a>00668                            <span class="stringliteral">&quot;Stimuli&quot;</span>)-&gt;<span class="keyword">get</span>().Stimulus();
<a name="l00669"></a>00669     <span class="keywordflow">for</span> (XSD_ANON_ITERATOR_TYPE(cp::simulation_type, Stimuli, Stimulus) i = stimuli.begin();
<a name="l00670"></a>00670          i != stimuli.end();
<a name="l00671"></a>00671          ++i)
<a name="l00672"></a>00672     {
<a name="l00673"></a>00673         cp::stimulus_type stimulus(*i);
<a name="l00674"></a>00674         <span class="keywordflow">if</span> (stimulus.Location().Cuboid().present())
<a name="l00675"></a>00675         {
<a name="l00676"></a>00676             cp::point_type point_a = stimulus.Location().Cuboid()-&gt;LowerCoordinates();
<a name="l00677"></a>00677             cp::point_type point_b = stimulus.Location().Cuboid()-&gt;UpperCoordinates();
<a name="l00678"></a>00678             <span class="keywordflow">switch</span> (DIM)
<a name="l00679"></a>00679             {
<a name="l00680"></a>00680                 <span class="keywordflow">case</span> 1:
<a name="l00681"></a>00681                 {
<a name="l00682"></a>00682                     <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_a ( point_a.x() );
<a name="l00683"></a>00683                     <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_b ( point_b.x() );
<a name="l00684"></a>00684                     rStimulatedAreas.push_back( <a class="code" href="classChasteCuboid.html">ChasteCuboid&lt;DIM&gt;</a>( chaste_point_a, chaste_point_b ) );
<a name="l00685"></a>00685                     <span class="keywordflow">break</span>;
<a name="l00686"></a>00686                 }
<a name="l00687"></a>00687                 <span class="keywordflow">case</span> 2:
<a name="l00688"></a>00688                 {
<a name="l00689"></a>00689                     <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_a ( point_a.x(), point_a.y() );
<a name="l00690"></a>00690                     <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_b ( point_b.x(), point_b.y() );
<a name="l00691"></a>00691                     rStimulatedAreas.push_back( <a class="code" href="classChasteCuboid.html">ChasteCuboid&lt;DIM&gt;</a>( chaste_point_a, chaste_point_b ) );
<a name="l00692"></a>00692                     <span class="keywordflow">break</span>;
<a name="l00693"></a>00693                 }
<a name="l00694"></a>00694                 <span class="keywordflow">case</span> 3:
<a name="l00695"></a>00695                 {
<a name="l00696"></a>00696                     <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_a ( point_a.x(), point_a.y(), point_a.z() );
<a name="l00697"></a>00697                     <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_b ( point_b.x(), point_b.y(), point_b.z() );
<a name="l00698"></a>00698                     rStimulatedAreas.push_back( <a class="code" href="classChasteCuboid.html">ChasteCuboid&lt;DIM&gt;</a>( chaste_point_a, chaste_point_b ) );
<a name="l00699"></a>00699                     <span class="keywordflow">break</span>;
<a name="l00700"></a>00700                 }
<a name="l00701"></a>00701                 <span class="keywordflow">default</span>:
<a name="l00702"></a>00702                     NEVER_REACHED;
<a name="l00703"></a>00703                     <span class="keywordflow">break</span>;
<a name="l00704"></a>00704             }
<a name="l00705"></a>00705 
<a name="l00706"></a>00706             boost::shared_ptr&lt;SimpleStimulus&gt; stim(<span class="keyword">new</span> <a class="code" href="classSimpleStimulus.html">SimpleStimulus</a>(stimulus.Strength(),
<a name="l00707"></a>00707                                                                       stimulus.Duration(),
<a name="l00708"></a>00708                                                                       stimulus.Delay()));
<a name="l00709"></a>00709             rStimuliApplied.push_back( stim );
<a name="l00710"></a>00710         }
<a name="l00711"></a>00711         <span class="keywordflow">else</span>
<a name="l00712"></a>00712         {
<a name="l00713"></a>00713             <span class="keywordflow">if</span>(stimulus.Location().EpiLayer().present() || stimulus.Location().MidLayer().present() || stimulus.Location().EndoLayer().present() )
<a name="l00714"></a>00714             {
<a name="l00715"></a>00715                 EXCEPTION(<span class="stringliteral">&quot;Definition of transmural layers is not yet supported for specifying stimulated areas, please use cuboids instead&quot;</span>);
<a name="l00716"></a>00716             }
<a name="l00717"></a>00717         }
<a name="l00718"></a>00718     }
<a name="l00719"></a>00719 }
<a name="l00720"></a>00720 
<a name="l00721"></a>00721 <span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> DIM&gt;
<a name="l00722"></a><a class="code" href="classHeartConfig.html#a1d87ceebdd23866393deaad3e8ffc1cc">00722</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a1d87ceebdd23866393deaad3e8ffc1cc">HeartConfig::GetCellHeterogeneities</a>(std::vector&lt;<a class="code" href="classAbstractChasteRegion.html">AbstractChasteRegion&lt;DIM&gt;</a>* &gt;&amp; rCellHeterogeneityRegions,
<a name="l00723"></a>00723                                          std::vector&lt;double&gt;&amp; rScaleFactorGks,
<a name="l00724"></a>00724                                          std::vector&lt;double&gt;&amp; rScaleFactorIto,
<a name="l00725"></a>00725                                          std::vector&lt;double&gt;&amp; rScaleFactorGkr)
<a name="l00726"></a>00726 {
<a name="l00727"></a>00727     <a class="code" href="classHeartConfig.html#aab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">&quot;CellHeterogeneities&quot;</span>);
<a name="l00728"></a>00728     XSD_ANON_SEQUENCE_TYPE(cp::simulation_type, CellHeterogeneities, CellHeterogeneity)&amp;
<a name="l00729"></a>00729          cell_heterogeneity = <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().CellHeterogeneities(),
<a name="l00730"></a>00730                                                  &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation().get().CellHeterogeneities(),
<a name="l00731"></a>00731                                                  <span class="stringliteral">&quot;CellHeterogeneities&quot;</span>)-&gt;<span class="keyword">get</span>().CellHeterogeneity();
<a name="l00732"></a>00732 
<a name="l00733"></a>00733     <span class="keywordtype">bool</span> user_supplied_negative_value = <span class="keyword">false</span>;
<a name="l00734"></a>00734     <span class="keywordtype">bool</span> user_asking_for_transmural_layers = <span class="keyword">false</span>;
<a name="l00735"></a>00735     <span class="keywordtype">unsigned</span> counter_of_heterogeneities = 0;
<a name="l00736"></a>00736 
<a name="l00737"></a>00737     <span class="keywordflow">for</span> (XSD_ANON_ITERATOR_TYPE(cp::simulation_type, CellHeterogeneities, CellHeterogeneity) i = cell_heterogeneity.begin();
<a name="l00738"></a>00738          i != cell_heterogeneity.end();
<a name="l00739"></a>00739          ++i)
<a name="l00740"></a>00740     {
<a name="l00741"></a>00741         cp::cell_heterogeneity_type ht(*i);
<a name="l00742"></a>00742 
<a name="l00743"></a>00743         <span class="keywordflow">if</span> (ht.Location().Cuboid().present())
<a name="l00744"></a>00744         {
<a name="l00745"></a>00745             <a class="code" href="classHeartConfig.html#a7def5e1c5ce3568eecb287368694aa6b">mUserAskedForCuboidsForCellularHeterogeneities</a> = <span class="keyword">true</span>;
<a name="l00746"></a>00746             cp::point_type point_a = ht.Location().Cuboid()-&gt;LowerCoordinates();
<a name="l00747"></a>00747             cp::point_type point_b = ht.Location().Cuboid()-&gt;UpperCoordinates();
<a name="l00748"></a>00748 
<a name="l00749"></a>00749             <span class="keywordflow">switch</span> (DIM)
<a name="l00750"></a>00750             {
<a name="l00751"></a>00751                 <span class="keywordflow">case</span> 1:
<a name="l00752"></a>00752                 {
<a name="l00753"></a>00753                     <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_a ( point_a.x() );
<a name="l00754"></a>00754                     <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_b ( point_b.x() );
<a name="l00755"></a>00755                     rCellHeterogeneityRegions.push_back(<span class="keyword">new</span> <a class="code" href="classChasteCuboid.html">ChasteCuboid&lt;DIM&gt;</a> ( chaste_point_a, chaste_point_b ) );
<a name="l00756"></a>00756                     <span class="keywordflow">break</span>;
<a name="l00757"></a>00757                 }
<a name="l00758"></a>00758                 <span class="keywordflow">case</span> 2:
<a name="l00759"></a>00759                 {
<a name="l00760"></a>00760                     <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_a ( point_a.x(), point_a.y() );
<a name="l00761"></a>00761                     <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_b ( point_b.x(), point_b.y() );
<a name="l00762"></a>00762                     rCellHeterogeneityRegions.push_back(<span class="keyword">new</span> <a class="code" href="classChasteCuboid.html">ChasteCuboid&lt;DIM&gt;</a> ( chaste_point_a, chaste_point_b ) );
<a name="l00763"></a>00763                     <span class="keywordflow">break</span>;
<a name="l00764"></a>00764                 }
<a name="l00765"></a>00765                 <span class="keywordflow">case</span> 3:
<a name="l00766"></a>00766                 {
<a name="l00767"></a>00767                     <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_a ( point_a.x(), point_a.y(), point_a.z() );
<a name="l00768"></a>00768                     <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_b ( point_b.x(), point_b.y(), point_b.z() );
<a name="l00769"></a>00769                     rCellHeterogeneityRegions.push_back(<span class="keyword">new</span> <a class="code" href="classChasteCuboid.html">ChasteCuboid&lt;DIM&gt;</a> ( chaste_point_a, chaste_point_b ) );
<a name="l00770"></a>00770                     <span class="keywordflow">break</span>;
<a name="l00771"></a>00771                 }
<a name="l00772"></a>00772                 <span class="keywordflow">default</span>:
<a name="l00773"></a>00773                     NEVER_REACHED;
<a name="l00774"></a>00774                     <span class="keywordflow">break</span>;
<a name="l00775"></a>00775             }
<a name="l00776"></a>00776 
<a name="l00777"></a>00777         }
<a name="l00778"></a>00778         <span class="keywordflow">else</span>
<a name="l00779"></a>00779         {
<a name="l00780"></a>00780 
<a name="l00781"></a>00781             <span class="keywordflow">if</span>(ht.Location().EpiLayer().present())
<a name="l00782"></a>00782             {
<a name="l00783"></a>00783                 <a class="code" href="classHeartConfig.html#aefbe15b3fd5d616d98a35dd172608529">mEpiFraction</a>  =  ht.Location().EpiLayer().get();
<a name="l00784"></a>00784 
<a name="l00785"></a>00785                 user_asking_for_transmural_layers = <span class="keyword">true</span>;
<a name="l00786"></a>00786                 <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#aefbe15b3fd5d616d98a35dd172608529">mEpiFraction</a> &lt;0)
<a name="l00787"></a>00787                 {
<a name="l00788"></a>00788                     user_supplied_negative_value=<span class="keyword">true</span>;
<a name="l00789"></a>00789                 }
<a name="l00790"></a>00790                 <a class="code" href="classHeartConfig.html#ab24f553ab1e97d36b8467f7ca1bcf800">mIndexEpi</a> = counter_of_heterogeneities;
<a name="l00791"></a>00791             }
<a name="l00792"></a>00792             <span class="keywordflow">if</span>(ht.Location().EndoLayer().present())
<a name="l00793"></a>00793             {
<a name="l00794"></a>00794                 <a class="code" href="classHeartConfig.html#a9c9f9fefab6c029324426098740b5bc4">mEndoFraction</a>  =  ht.Location().EndoLayer().get();
<a name="l00795"></a>00795 
<a name="l00796"></a>00796                 user_asking_for_transmural_layers = <span class="keyword">true</span>;
<a name="l00797"></a>00797                 <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#a9c9f9fefab6c029324426098740b5bc4">mEndoFraction</a> &lt;0)
<a name="l00798"></a>00798                 {
<a name="l00799"></a>00799                     user_supplied_negative_value=<span class="keyword">true</span>;
<a name="l00800"></a>00800                 }
<a name="l00801"></a>00801                 <a class="code" href="classHeartConfig.html#a4785f6ad1c60766c471bcb525eac02d3">mIndexEndo</a> = counter_of_heterogeneities;
<a name="l00802"></a>00802             }
<a name="l00803"></a>00803             <span class="keywordflow">if</span>(ht.Location().MidLayer().present())
<a name="l00804"></a>00804             {
<a name="l00805"></a>00805                 <a class="code" href="classHeartConfig.html#a5648845197c449e58c2c879f7422df3f">mMidFraction</a>  =  ht.Location().MidLayer().get();
<a name="l00806"></a>00806 
<a name="l00807"></a>00807                 user_asking_for_transmural_layers = <span class="keyword">true</span>;
<a name="l00808"></a>00808                 <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#a5648845197c449e58c2c879f7422df3f">mMidFraction</a> &lt;0)
<a name="l00809"></a>00809                 {
<a name="l00810"></a>00810                     user_supplied_negative_value=<span class="keyword">true</span>;
<a name="l00811"></a>00811                 }
<a name="l00812"></a>00812                 <a class="code" href="classHeartConfig.html#abfdca19b9fc56fe21ef23d2593cc022f">mIndexMid</a> =  counter_of_heterogeneities;
<a name="l00813"></a>00813             }
<a name="l00814"></a>00814         }
<a name="l00815"></a>00815         rScaleFactorGks.push_back (ht.ScaleFactorGks());
<a name="l00816"></a>00816         rScaleFactorIto.push_back (ht.ScaleFactorIto());
<a name="l00817"></a>00817         rScaleFactorGkr.push_back (ht.ScaleFactorGkr());
<a name="l00818"></a>00818         counter_of_heterogeneities++;
<a name="l00819"></a>00819     }
<a name="l00820"></a>00820 
<a name="l00821"></a>00821     <span class="comment">//set the flag for request of transmural layers</span>
<a name="l00822"></a>00822      <a class="code" href="classHeartConfig.html#a6ebec0d7deb03099ae581bca114147fb">mUserAskedForCellularTransmuralHeterogeneities</a> = user_asking_for_transmural_layers;
<a name="l00823"></a>00823 
<a name="l00824"></a>00824      <span class="comment">// cuboids and layers at the same time are not yet supported</span>
<a name="l00825"></a>00825      <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#a7def5e1c5ce3568eecb287368694aa6b">mUserAskedForCuboidsForCellularHeterogeneities</a> &amp;&amp; <a class="code" href="classHeartConfig.html#a6ebec0d7deb03099ae581bca114147fb">mUserAskedForCellularTransmuralHeterogeneities</a>)
<a name="l00826"></a>00826      {
<a name="l00827"></a>00827          <span class="comment">// free the pointers before throwing the exception</span>
<a name="l00828"></a>00828         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> index=0;index &lt; rCellHeterogeneityRegions.size(); index++)
<a name="l00829"></a>00829         {
<a name="l00830"></a>00830             <span class="keyword">delete</span> rCellHeterogeneityRegions[index];
<a name="l00831"></a>00831         }
<a name="l00832"></a>00832         EXCEPTION (<span class="stringliteral">&quot;Specification of cellular heterogeneities by cuboids and layers at the same time is not yet supported&quot;</span>);
<a name="l00833"></a>00833      }
<a name="l00834"></a>00834      <span class="comment">//check the user input if the transmural heterogeneities have been requested</span>
<a name="l00835"></a>00835      <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#a6ebec0d7deb03099ae581bca114147fb">mUserAskedForCellularTransmuralHeterogeneities</a>)
<a name="l00836"></a>00836      {
<a name="l00837"></a>00837         <span class="comment">//check that the user supplied all three layers, the indexes should be 0, 1 and 2.</span>
<a name="l00838"></a>00838         <span class="comment">// As they are initialised to a higher value, if their summation is higher than 3,</span>
<a name="l00839"></a>00839         <span class="comment">// one (or more) is missing</span>
<a name="l00840"></a>00840         <span class="keywordflow">if</span> ((<a class="code" href="classHeartConfig.html#abfdca19b9fc56fe21ef23d2593cc022f">mIndexMid</a>+<a class="code" href="classHeartConfig.html#a4785f6ad1c60766c471bcb525eac02d3">mIndexEndo</a>+<a class="code" href="classHeartConfig.html#ab24f553ab1e97d36b8467f7ca1bcf800">mIndexEpi</a>) &gt; 3)
<a name="l00841"></a>00841         {
<a name="l00842"></a>00842             EXCEPTION (<span class="stringliteral">&quot;Three specifications of layers must be supplied&quot;</span>);
<a name="l00843"></a>00843         }
<a name="l00844"></a>00844         <span class="keywordflow">if</span> (fabs((<a class="code" href="classHeartConfig.html#a9c9f9fefab6c029324426098740b5bc4">mEndoFraction</a>+<a class="code" href="classHeartConfig.html#a5648845197c449e58c2c879f7422df3f">mMidFraction</a>+<a class="code" href="classHeartConfig.html#aefbe15b3fd5d616d98a35dd172608529">mEpiFraction</a>)-1)&gt;1e-2)
<a name="l00845"></a>00845         {
<a name="l00846"></a>00846             EXCEPTION (<span class="stringliteral">&quot;Summation of epicardial, midmyocardial and endocardial fractions should be 1&quot;</span>);
<a name="l00847"></a>00847         }
<a name="l00848"></a>00848         <span class="keywordflow">if</span> (user_supplied_negative_value)
<a name="l00849"></a>00849         {
<a name="l00850"></a>00850            EXCEPTION (<span class="stringliteral">&quot;Fractions must be positive&quot;</span>);
<a name="l00851"></a>00851         }
<a name="l00852"></a>00852      }
<a name="l00853"></a>00853 }
<a name="l00854"></a>00854 
<a name="l00855"></a><a class="code" href="classHeartConfig.html#a05a43dba4479aecdba22e537105934ce">00855</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#a05a43dba4479aecdba22e537105934ce">HeartConfig::AreCellularTransmuralHeterogeneitiesRequested</a>()
<a name="l00856"></a>00856 {
<a name="l00857"></a>00857     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#a6ebec0d7deb03099ae581bca114147fb">mUserAskedForCellularTransmuralHeterogeneities</a>;
<a name="l00858"></a>00858 }
<a name="l00859"></a>00859 
<a name="l00860"></a><a class="code" href="classHeartConfig.html#aa26b73588c6716e8b8b9f9d228f7892a">00860</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#aa26b73588c6716e8b8b9f9d228f7892a">HeartConfig::AreCellularlHeterogeneitiesSpecifiedByCuboids</a>()
<a name="l00861"></a>00861 {
<a name="l00862"></a>00862     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#a7def5e1c5ce3568eecb287368694aa6b">mUserAskedForCuboidsForCellularHeterogeneities</a>;
<a name="l00863"></a>00863 }
<a name="l00864"></a>00864 
<a name="l00865"></a><a class="code" href="classHeartConfig.html#ac6a311736789413d8f0780f62ff53b41">00865</a> <span class="keywordtype">double</span> <a class="code" href="classHeartConfig.html#ac6a311736789413d8f0780f62ff53b41">HeartConfig::GetEpiLayerFraction</a>()
<a name="l00866"></a>00866 {
<a name="l00867"></a>00867     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#aefbe15b3fd5d616d98a35dd172608529">mEpiFraction</a>;
<a name="l00868"></a>00868 }
<a name="l00869"></a>00869 
<a name="l00870"></a><a class="code" href="classHeartConfig.html#ab27a388cfb3df276617aaae504e7c602">00870</a> <span class="keywordtype">double</span> <a class="code" href="classHeartConfig.html#ab27a388cfb3df276617aaae504e7c602">HeartConfig::GetEndoLayerFraction</a>()
<a name="l00871"></a>00871 {
<a name="l00872"></a>00872     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#a9c9f9fefab6c029324426098740b5bc4">mEndoFraction</a>;
<a name="l00873"></a>00873 }
<a name="l00874"></a>00874 
<a name="l00875"></a><a class="code" href="classHeartConfig.html#a40a8c0d11e49c75744f1f46ab350b938">00875</a> <span class="keywordtype">double</span> <a class="code" href="classHeartConfig.html#a40a8c0d11e49c75744f1f46ab350b938">HeartConfig::GetMidLayerFraction</a>()
<a name="l00876"></a>00876 {
<a name="l00877"></a>00877     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#a5648845197c449e58c2c879f7422df3f">mMidFraction</a>;
<a name="l00878"></a>00878 }
<a name="l00879"></a>00879 
<a name="l00880"></a><a class="code" href="classHeartConfig.html#a983aa22ea5954f80e4554dedb39361a1">00880</a> <span class="keywordtype">unsigned</span> <a class="code" href="classHeartConfig.html#a983aa22ea5954f80e4554dedb39361a1">HeartConfig::GetEpiLayerIndex</a>()
<a name="l00881"></a>00881 {
<a name="l00882"></a>00882     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#ab24f553ab1e97d36b8467f7ca1bcf800">mIndexEpi</a>;
<a name="l00883"></a>00883 }
<a name="l00884"></a>00884 
<a name="l00885"></a><a class="code" href="classHeartConfig.html#ac929ad5b6b509ffbb76853e5374df9f9">00885</a> <span class="keywordtype">unsigned</span> <a class="code" href="classHeartConfig.html#ac929ad5b6b509ffbb76853e5374df9f9">HeartConfig::GetEndoLayerIndex</a>()
<a name="l00886"></a>00886 {
<a name="l00887"></a>00887     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#a4785f6ad1c60766c471bcb525eac02d3">mIndexEndo</a>;
<a name="l00888"></a>00888 }
<a name="l00889"></a>00889 
<a name="l00890"></a><a class="code" href="classHeartConfig.html#a79cca34d2513013d0367b703827302cb">00890</a> <span class="keywordtype">unsigned</span> <a class="code" href="classHeartConfig.html#a79cca34d2513013d0367b703827302cb">HeartConfig::GetMidLayerIndex</a>()
<a name="l00891"></a>00891 {
<a name="l00892"></a>00892     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#abfdca19b9fc56fe21ef23d2593cc022f">mIndexMid</a>;
<a name="l00893"></a>00893 }
<a name="l00894"></a>00894 
<a name="l00895"></a><a class="code" href="classHeartConfig.html#abcf7598b37ec20f65a3033dafafff7dd">00895</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#abcf7598b37ec20f65a3033dafafff7dd">HeartConfig::GetConductivityHeterogeneitiesProvided</a>()<span class="keyword"> const</span>
<a name="l00896"></a>00896 <span class="keyword"></span>{
<a name="l00897"></a>00897     <a class="code" href="classHeartConfig.html#aab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">&quot;ConductivityHeterogeneities&quot;</span>);
<a name="l00898"></a>00898     <span class="keywordflow">try</span>
<a name="l00899"></a>00899     {
<a name="l00900"></a>00900         <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().ConductivityHeterogeneities(),
<a name="l00901"></a>00901                         &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation().get().ConductivityHeterogeneities(),
<a name="l00902"></a>00902                         <span class="stringliteral">&quot;ConductivityHeterogeneities&quot;</span>);
<a name="l00903"></a>00903         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00904"></a>00904     }
<a name="l00905"></a>00905     <span class="keywordflow">catch</span> (<a class="code" href="classException.html">Exception</a>&amp; e)
<a name="l00906"></a>00906     {
<a name="l00907"></a>00907         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00908"></a>00908     }
<a name="l00909"></a>00909 }
<a name="l00910"></a>00910 
<a name="l00911"></a>00911 <span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> DIM&gt;
<a name="l00912"></a><a class="code" href="classHeartConfig.html#a46798fe1a461e288e8c5a96bc62ee695">00912</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a46798fe1a461e288e8c5a96bc62ee695">HeartConfig::GetConductivityHeterogeneities</a>(
<a name="l00913"></a>00913         std::vector&lt;<a class="code" href="classChasteCuboid.html">ChasteCuboid&lt;DIM&gt;</a> &gt;&amp; conductivitiesHeterogeneityAreas,
<a name="l00914"></a>00914         std::vector&lt; c_vector&lt;double,3&gt; &gt;&amp; intraConductivities,
<a name="l00915"></a>00915         std::vector&lt; c_vector&lt;double,3&gt; &gt;&amp; extraConductivities)<span class="keyword"> const</span>
<a name="l00916"></a>00916 <span class="keyword"></span>{
<a name="l00917"></a>00917     <a class="code" href="classHeartConfig.html#aab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">&quot;ConductivityHeterogeneities&quot;</span>);
<a name="l00918"></a>00918     XSD_ANON_SEQUENCE_TYPE(cp::simulation_type, ConductivityHeterogeneities, ConductivityHeterogeneity)&amp;
<a name="l00919"></a>00919          conductivity_heterogeneity = <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().ConductivityHeterogeneities(),
<a name="l00920"></a>00920                                                       &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation().get().ConductivityHeterogeneities(),
<a name="l00921"></a>00921                                                       <span class="stringliteral">&quot;ConductivityHeterogeneities&quot;</span>)-&gt;<span class="keyword">get</span>().ConductivityHeterogeneity();
<a name="l00922"></a>00922 
<a name="l00923"></a>00923     <span class="keywordflow">for</span> (XSD_ANON_ITERATOR_TYPE(cp::simulation_type, ConductivityHeterogeneities, ConductivityHeterogeneity) i = conductivity_heterogeneity.begin();
<a name="l00924"></a>00924          i != conductivity_heterogeneity.end();
<a name="l00925"></a>00925          ++i)
<a name="l00926"></a>00926     {
<a name="l00927"></a>00927         cp::conductivity_heterogeneity_type ht(*i);
<a name="l00928"></a>00928         <span class="keywordflow">if</span> (ht.Location().Cuboid().present())
<a name="l00929"></a>00929         {
<a name="l00930"></a>00930             cp::point_type point_a = ht.Location().Cuboid()-&gt;LowerCoordinates();
<a name="l00931"></a>00931             cp::point_type point_b = ht.Location().Cuboid()-&gt;UpperCoordinates();
<a name="l00932"></a>00932 
<a name="l00933"></a>00933             <span class="keywordflow">switch</span> (DIM)
<a name="l00934"></a>00934             {
<a name="l00935"></a>00935                 <span class="keywordflow">case</span> 1:
<a name="l00936"></a>00936                 {
<a name="l00937"></a>00937                     <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_a ( point_a.x() );
<a name="l00938"></a>00938                     <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_b ( point_b.x() );
<a name="l00939"></a>00939                     conductivitiesHeterogeneityAreas.push_back( <a class="code" href="classChasteCuboid.html">ChasteCuboid&lt;DIM&gt;</a> ( chaste_point_a, chaste_point_b ) );
<a name="l00940"></a>00940                     <span class="keywordflow">break</span>;
<a name="l00941"></a>00941                 }
<a name="l00942"></a>00942                 <span class="keywordflow">case</span> 2:
<a name="l00943"></a>00943                 {
<a name="l00944"></a>00944                     <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_a ( point_a.x(), point_a.y() );
<a name="l00945"></a>00945                     <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_b ( point_b.x(), point_b.y() );
<a name="l00946"></a>00946                     conductivitiesHeterogeneityAreas.push_back( <a class="code" href="classChasteCuboid.html">ChasteCuboid&lt;DIM&gt;</a> ( chaste_point_a, chaste_point_b ) );
<a name="l00947"></a>00947                     <span class="keywordflow">break</span>;
<a name="l00948"></a>00948                 }
<a name="l00949"></a>00949                 <span class="keywordflow">case</span> 3:
<a name="l00950"></a>00950                 {
<a name="l00951"></a>00951                     <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_a ( point_a.x(), point_a.y(), point_a.z() );
<a name="l00952"></a>00952                     <a class="code" href="classChastePoint.html">ChastePoint&lt;DIM&gt;</a> chaste_point_b ( point_b.x(), point_b.y(), point_b.z() );
<a name="l00953"></a>00953                     conductivitiesHeterogeneityAreas.push_back( <a class="code" href="classChasteCuboid.html">ChasteCuboid&lt;DIM&gt;</a> ( chaste_point_a, chaste_point_b ) );
<a name="l00954"></a>00954                     <span class="keywordflow">break</span>;
<a name="l00955"></a>00955                 }
<a name="l00956"></a>00956                 <span class="keywordflow">default</span>:
<a name="l00957"></a>00957                     NEVER_REACHED;
<a name="l00958"></a>00958                     <span class="keywordflow">break</span>;
<a name="l00959"></a>00959             }
<a name="l00960"></a>00960 
<a name="l00961"></a>00961 
<a name="l00962"></a>00962         }
<a name="l00963"></a>00963         <span class="keywordflow">else</span>
<a name="l00964"></a>00964         {
<a name="l00965"></a>00965             <span class="keywordflow">if</span>(ht.Location().EpiLayer().present() || ht.Location().MidLayer().present() || ht.Location().EndoLayer().present() )
<a name="l00966"></a>00966             {
<a name="l00968"></a>00968                 EXCEPTION(<span class="stringliteral">&quot;Definition of transmural layers is not allowed for conductivities heterogeneities, you may use fibre orientation support instead&quot;</span>);
<a name="l00969"></a>00969             }
<a name="l00970"></a>00970         }
<a name="l00971"></a>00971 
<a name="l00972"></a>00972         <span class="keywordflow">if</span> (ht.IntracellularConductivities().present())
<a name="l00973"></a>00973         {
<a name="l00974"></a>00974             <span class="keywordtype">double</span> intra_x = ht.IntracellularConductivities().get().longi();
<a name="l00975"></a>00975             <span class="keywordtype">double</span> intra_y = ht.IntracellularConductivities().get().trans();
<a name="l00976"></a>00976             <span class="keywordtype">double</span> intra_z = ht.IntracellularConductivities().get().normal();
<a name="l00977"></a>00977 
<a name="l00978"></a>00978             intraConductivities.push_back( Create_c_vector(intra_x, intra_y, intra_z) );
<a name="l00979"></a>00979         }
<a name="l00980"></a>00980         <span class="keywordflow">else</span>
<a name="l00981"></a>00981         {
<a name="l00982"></a>00982             c_vector&lt;double, 3&gt; intra_conductivities;
<a name="l00983"></a>00983             <a class="code" href="classHeartConfig.html#aca1345d62f0aa522f210815d812f4401">GetIntracellularConductivities</a>(intra_conductivities);
<a name="l00984"></a>00984             intraConductivities.push_back(intra_conductivities);
<a name="l00985"></a>00985         }
<a name="l00986"></a>00986 
<a name="l00987"></a>00987         <span class="keywordflow">if</span> (ht.ExtracellularConductivities().present())
<a name="l00988"></a>00988         {
<a name="l00989"></a>00989             <span class="keywordtype">double</span> extra_x = ht.ExtracellularConductivities().get().longi();
<a name="l00990"></a>00990             <span class="keywordtype">double</span> extra_y = ht.ExtracellularConductivities().get().trans();
<a name="l00991"></a>00991             <span class="keywordtype">double</span> extra_z = ht.ExtracellularConductivities().get().normal();
<a name="l00992"></a>00992 
<a name="l00993"></a>00993             extraConductivities.push_back( Create_c_vector(extra_x, extra_y, extra_z) );
<a name="l00994"></a>00994         }
<a name="l00995"></a>00995         <span class="keywordflow">else</span>
<a name="l00996"></a>00996         {
<a name="l00997"></a>00997             c_vector&lt;double, 3&gt; extra_conductivities;
<a name="l00998"></a>00998             <a class="code" href="classHeartConfig.html#a88855dbd26f93d53e1b754a1db38f792">GetExtracellularConductivities</a>(extra_conductivities);
<a name="l00999"></a>00999             extraConductivities.push_back(extra_conductivities);
<a name="l01000"></a>01000         }
<a name="l01001"></a>01001 
<a name="l01002"></a>01002     }
<a name="l01003"></a>01003 }
<a name="l01004"></a>01004 
<a name="l01005"></a><a class="code" href="classHeartConfig.html#ad4f49a0c81a7463613fdde99fb56e224">01005</a> std::string <a class="code" href="classHeartConfig.html#ad4f49a0c81a7463613fdde99fb56e224">HeartConfig::GetOutputDirectory</a>()<span class="keyword"> const</span>
<a name="l01006"></a>01006 <span class="keyword"></span>{
<a name="l01007"></a>01007     <a class="code" href="classHeartConfig.html#aab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">&quot;Simulation/OutputDirectory&quot;</span>);
<a name="l01008"></a>01008     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().OutputDirectory(),
<a name="l01009"></a>01009                            &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation().get().OutputDirectory(),
<a name="l01010"></a>01010                            <span class="stringliteral">&quot;Simulation/OutputDirectory&quot;</span>)-&gt;<span class="keyword">get</span>();
<a name="l01011"></a>01011 }
<a name="l01012"></a>01012 
<a name="l01013"></a><a class="code" href="classHeartConfig.html#adc4a009d6fcd830191964ac40ec71889">01013</a> std::string <a class="code" href="classHeartConfig.html#adc4a009d6fcd830191964ac40ec71889">HeartConfig::GetOutputFilenamePrefix</a>()<span class="keyword"> const</span>
<a name="l01014"></a>01014 <span class="keyword"></span>{
<a name="l01015"></a>01015     <a class="code" href="classHeartConfig.html#aab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">&quot;Simulation/OutputFilenamePrefix&quot;</span>);
<a name="l01016"></a>01016     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().OutputFilenamePrefix(),
<a name="l01017"></a>01017                            &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation().get().OutputFilenamePrefix(),
<a name="l01018"></a>01018                            <span class="stringliteral">&quot;Simulation/OutputFilenamePrefix&quot;</span>)-&gt;<span class="keyword">get</span>();
<a name="l01019"></a>01019 }
<a name="l01020"></a>01020 
<a name="l01021"></a><a class="code" href="classHeartConfig.html#a076bbaf9d7412d31220dba3c574a2d86">01021</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#a076bbaf9d7412d31220dba3c574a2d86">HeartConfig::GetOutputVariablesProvided</a>()<span class="keyword"> const</span>
<a name="l01022"></a>01022 <span class="keyword"></span>{
<a name="l01023"></a>01023     <a class="code" href="classHeartConfig.html#aab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">&quot;OutputVariables&quot;</span>);
<a name="l01024"></a>01024 
<a name="l01025"></a>01025     <span class="keywordflow">try</span>
<a name="l01026"></a>01026     {
<a name="l01027"></a>01027         <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().OutputVariables(),
<a name="l01028"></a>01028                         &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation().get().OutputVariables(),
<a name="l01029"></a>01029                         <span class="stringliteral">&quot;OutputVariables&quot;</span>);
<a name="l01030"></a>01030         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01031"></a>01031     }
<a name="l01032"></a>01032     <span class="keywordflow">catch</span> (<a class="code" href="classException.html">Exception</a>&amp; e)
<a name="l01033"></a>01033     {
<a name="l01034"></a>01034         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01035"></a>01035     }
<a name="l01036"></a>01036 }
<a name="l01037"></a>01037 
<a name="l01038"></a><a class="code" href="classHeartConfig.html#a6c2f7134572ad159a552280d324ac698">01038</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a6c2f7134572ad159a552280d324ac698">HeartConfig::GetOutputVariables</a>(std::vector&lt;std::string&gt; &amp;outputVariables)<span class="keyword"> const</span>
<a name="l01039"></a>01039 <span class="keyword"></span>{
<a name="l01040"></a>01040     <a class="code" href="classHeartConfig.html#aab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">&quot;OutputVariables&quot;</span>);
<a name="l01041"></a>01041     XSD_SEQUENCE_TYPE(cp::output_variables_type::Var)&amp;
<a name="l01042"></a>01042          output_variables = <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().OutputVariables(),
<a name="l01043"></a>01043                                             &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation().get().OutputVariables(),
<a name="l01044"></a>01044                                             <span class="stringliteral">&quot;OutputVariables&quot;</span>)-&gt;<span class="keyword">get</span>().Var();
<a name="l01045"></a>01045 
<a name="l01046"></a>01046     <span class="keywordflow">for</span> (XSD_ITERATOR_TYPE(cp::output_variables_type::Var) i = output_variables.begin();
<a name="l01047"></a>01047          i != output_variables.end();
<a name="l01048"></a>01048          ++i)
<a name="l01049"></a>01049     {
<a name="l01050"></a>01050         cp::var_type var(*i);
<a name="l01051"></a>01051 
<a name="l01052"></a>01052         <span class="comment">// Add to outputVariables the string returned by var.name()</span>
<a name="l01053"></a>01053         outputVariables.push_back(var.name());
<a name="l01054"></a>01054     }
<a name="l01055"></a>01055 }
<a name="l01056"></a>01056 
<a name="l01057"></a><a class="code" href="classHeartConfig.html#a34e25b3a25618f0f8721c678e6b12f95">01057</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#a34e25b3a25618f0f8721c678e6b12f95">HeartConfig::GetCheckpointSimulation</a>()<span class="keyword"> const</span>
<a name="l01058"></a>01058 <span class="keyword"></span>{
<a name="l01059"></a>01059     <span class="keywordflow">try</span>
<a name="l01060"></a>01060     {
<a name="l01061"></a>01061         <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#a894d374015f888c2111ec252134395fc">IsSimulationDefined</a>())
<a name="l01062"></a>01062         {
<a name="l01063"></a>01063             <a class="code" href="classHeartConfig.html#aab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">&quot;GetSaveSimulation&quot;</span>);
<a name="l01064"></a>01064             <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().CheckpointSimulation(),
<a name="l01065"></a>01065                             &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation().get().CheckpointSimulation(),
<a name="l01066"></a>01066                             <span class="stringliteral">&quot;Simulation/SaveSimulation&quot;</span>);
<a name="l01067"></a>01067         }
<a name="l01068"></a>01068         <span class="keywordflow">else</span>
<a name="l01069"></a>01069         {
<a name="l01070"></a>01070             <a class="code" href="classHeartConfig.html#a2be3fdcc724c4a6609526b53f86d8c01">CheckResumeSimulationIsDefined</a>(<span class="stringliteral">&quot;GetSaveSimulation&quot;</span>);
<a name="l01071"></a>01071             <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;ResumeSimulation().get().CheckpointSimulation(),
<a name="l01072"></a>01072                             &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation().get().CheckpointSimulation(),
<a name="l01073"></a>01073                             <span class="stringliteral">&quot;ResumeSimulation/SaveSimulation&quot;</span>);
<a name="l01074"></a>01074         }
<a name="l01075"></a>01075         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01076"></a>01076     }
<a name="l01077"></a>01077     <span class="keywordflow">catch</span> (<a class="code" href="classException.html">Exception</a>&amp; e)
<a name="l01078"></a>01078     {
<a name="l01079"></a>01079         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01080"></a>01080     }
<a name="l01081"></a>01081 }
<a name="l01082"></a>01082 
<a name="l01083"></a><a class="code" href="classHeartConfig.html#a80bb45c8945a0a3b98b5a1151d79143a">01083</a> <span class="keywordtype">double</span> <a class="code" href="classHeartConfig.html#a80bb45c8945a0a3b98b5a1151d79143a">HeartConfig::GetCheckpointTimestep</a>()<span class="keyword"> const</span>
<a name="l01084"></a>01084 <span class="keyword"></span>{
<a name="l01085"></a>01085     <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#a894d374015f888c2111ec252134395fc">IsSimulationDefined</a>())
<a name="l01086"></a>01086     {
<a name="l01087"></a>01087         <a class="code" href="classHeartConfig.html#aab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">&quot;GetSaveSimulation&quot;</span>);
<a name="l01088"></a>01088         <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().CheckpointSimulation(),
<a name="l01089"></a>01089                         &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation().get().CheckpointSimulation(),
<a name="l01090"></a>01090                         <span class="stringliteral">&quot;Simulation/SaveSimulation&quot;</span>)-&gt;<span class="keyword">get</span>().timestep();
<a name="l01091"></a>01091     }
<a name="l01092"></a>01092     <span class="keywordflow">else</span>
<a name="l01093"></a>01093     {
<a name="l01094"></a>01094         <a class="code" href="classHeartConfig.html#a2be3fdcc724c4a6609526b53f86d8c01">CheckResumeSimulationIsDefined</a>(<span class="stringliteral">&quot;GetSaveSimulation&quot;</span>);
<a name="l01095"></a>01095         <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;ResumeSimulation().get().CheckpointSimulation(),
<a name="l01096"></a>01096                         &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation().get().CheckpointSimulation(),
<a name="l01097"></a>01097                         <span class="stringliteral">&quot;ResumeSimulation/SaveSimulation&quot;</span>)-&gt;<span class="keyword">get</span>().timestep();
<a name="l01098"></a>01098     }
<a name="l01099"></a>01099 }
<a name="l01100"></a>01100 
<a name="l01101"></a><a class="code" href="classHeartConfig.html#ad6f5c8169999d795e99f66befb962f0c">01101</a> <span class="keywordtype">unsigned</span> <a class="code" href="classHeartConfig.html#ad6f5c8169999d795e99f66befb962f0c">HeartConfig::GetMaxCheckpointsOnDisk</a>()<span class="keyword"> const</span>
<a name="l01102"></a>01102 <span class="keyword"></span>{
<a name="l01103"></a>01103     <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#a894d374015f888c2111ec252134395fc">IsSimulationDefined</a>())
<a name="l01104"></a>01104     {
<a name="l01105"></a>01105         <a class="code" href="classHeartConfig.html#aab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">&quot;GetSaveSimulation&quot;</span>);
<a name="l01106"></a>01106         <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().CheckpointSimulation(),
<a name="l01107"></a>01107                         &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation().get().CheckpointSimulation(),
<a name="l01108"></a>01108                         <span class="stringliteral">&quot;Simulation/SaveSimulation&quot;</span>)-&gt;<span class="keyword">get</span>().max_checkpoints_on_disk();
<a name="l01109"></a>01109     }
<a name="l01110"></a>01110     <span class="keywordflow">else</span>
<a name="l01111"></a>01111     {
<a name="l01112"></a>01112         <a class="code" href="classHeartConfig.html#a2be3fdcc724c4a6609526b53f86d8c01">CheckResumeSimulationIsDefined</a>(<span class="stringliteral">&quot;GetSaveSimulation&quot;</span>);
<a name="l01113"></a>01113         <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;ResumeSimulation().get().CheckpointSimulation(),
<a name="l01114"></a>01114                         &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation().get().CheckpointSimulation(),
<a name="l01115"></a>01115                         <span class="stringliteral">&quot;ResumeSimulation/SaveSimulation&quot;</span>)-&gt;<span class="keyword">get</span>().max_checkpoints_on_disk();
<a name="l01116"></a>01116     }
<a name="l01117"></a>01117 }
<a name="l01118"></a>01118 
<a name="l01119"></a>01119 
<a name="l01120"></a><a class="code" href="classHeartConfig.html#a633be1353f35989fbb5f8d41a8c5872d">01120</a> std::string <a class="code" href="classHeartConfig.html#a633be1353f35989fbb5f8d41a8c5872d">HeartConfig::GetArchivedSimulationDir</a>()<span class="keyword"> const</span>
<a name="l01121"></a>01121 <span class="keyword"></span>{
<a name="l01122"></a>01122     <a class="code" href="classHeartConfig.html#a2be3fdcc724c4a6609526b53f86d8c01">CheckResumeSimulationIsDefined</a>(<span class="stringliteral">&quot;GetArchivedSimulationDir&quot;</span>);
<a name="l01123"></a>01123 
<a name="l01124"></a>01124     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;ResumeSimulation().get().ArchiveDirectory();
<a name="l01125"></a>01125 }
<a name="l01126"></a>01126 
<a name="l01127"></a>01127 
<a name="l01128"></a><a class="code" href="classHeartConfig.html#aca1345d62f0aa522f210815d812f4401">01128</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#aca1345d62f0aa522f210815d812f4401">HeartConfig::GetIntracellularConductivities</a>(c_vector&lt;double, 3&gt;&amp; intraConductivities)<span class="keyword"> const</span>
<a name="l01129"></a>01129 <span class="keyword"></span>{
<a name="l01130"></a>01130     optional&lt;cp::conductivities_type, false&gt;* intra_conductivities
<a name="l01131"></a>01131         = <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Physiological().IntracellularConductivities(),
<a name="l01132"></a>01132                           &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Physiological().IntracellularConductivities(),
<a name="l01133"></a>01133                           <span class="stringliteral">&quot;IntracellularConductivities&quot;</span>);
<a name="l01134"></a>01134     <span class="keywordtype">double</span> intra_x_cond = intra_conductivities-&gt;get().longi();
<a name="l01135"></a>01135     <span class="keywordtype">double</span> intra_y_cond = intra_conductivities-&gt;get().trans();
<a name="l01136"></a>01136     <span class="keywordtype">double</span> intra_z_cond = intra_conductivities-&gt;get().normal();;
<a name="l01137"></a>01137 
<a name="l01138"></a>01138     assert(intra_y_cond != DBL_MAX);
<a name="l01139"></a>01139     assert(intra_z_cond != DBL_MAX);
<a name="l01140"></a>01140 
<a name="l01141"></a>01141     intraConductivities[0] = intra_x_cond;
<a name="l01142"></a>01142     intraConductivities[1] = intra_y_cond;
<a name="l01143"></a>01143     intraConductivities[2] = intra_z_cond;
<a name="l01144"></a>01144 }
<a name="l01145"></a>01145 
<a name="l01146"></a><a class="code" href="classHeartConfig.html#a2136658644fe12e309c2d7999e920095">01146</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#aca1345d62f0aa522f210815d812f4401">HeartConfig::GetIntracellularConductivities</a>(c_vector&lt;double, 2&gt;&amp; intraConductivities)<span class="keyword"> const</span>
<a name="l01147"></a>01147 <span class="keyword"></span>{
<a name="l01148"></a>01148     optional&lt;cp::conductivities_type, false&gt;* intra_conductivities
<a name="l01149"></a>01149         = <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Physiological().IntracellularConductivities(),
<a name="l01150"></a>01150                           &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Physiological().IntracellularConductivities(),
<a name="l01151"></a>01151                           <span class="stringliteral">&quot;IntracellularConductivities&quot;</span>);
<a name="l01152"></a>01152     <span class="keywordtype">double</span> intra_x_cond = intra_conductivities-&gt;get().longi();
<a name="l01153"></a>01153     <span class="keywordtype">double</span> intra_y_cond = intra_conductivities-&gt;get().trans();
<a name="l01154"></a>01154 
<a name="l01155"></a>01155     assert(intra_y_cond != DBL_MAX);
<a name="l01156"></a>01156 
<a name="l01157"></a>01157     intraConductivities[0] = intra_x_cond;
<a name="l01158"></a>01158     intraConductivities[1] = intra_y_cond;
<a name="l01159"></a>01159 }
<a name="l01160"></a>01160 
<a name="l01161"></a><a class="code" href="classHeartConfig.html#a8f5ed5c4dd484ba715da9073495b0748">01161</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#aca1345d62f0aa522f210815d812f4401">HeartConfig::GetIntracellularConductivities</a>(c_vector&lt;double, 1&gt;&amp; intraConductivities)<span class="keyword"> const</span>
<a name="l01162"></a>01162 <span class="keyword"></span>{
<a name="l01163"></a>01163     optional&lt;cp::conductivities_type, false&gt;* intra_conductivities
<a name="l01164"></a>01164         = <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Physiological().IntracellularConductivities(),
<a name="l01165"></a>01165                           &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Physiological().IntracellularConductivities(),
<a name="l01166"></a>01166                           <span class="stringliteral">&quot;IntracellularConductivities&quot;</span>);
<a name="l01167"></a>01167     <span class="keywordtype">double</span> intra_x_cond = intra_conductivities-&gt;get().longi();
<a name="l01168"></a>01168 
<a name="l01169"></a>01169     intraConductivities[0] = intra_x_cond;
<a name="l01170"></a>01170 }
<a name="l01171"></a>01171 
<a name="l01172"></a><a class="code" href="classHeartConfig.html#a88855dbd26f93d53e1b754a1db38f792">01172</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a88855dbd26f93d53e1b754a1db38f792">HeartConfig::GetExtracellularConductivities</a>(c_vector&lt;double, 3&gt;&amp; extraConductivities)<span class="keyword"> const</span>
<a name="l01173"></a>01173 <span class="keyword"></span>{
<a name="l01174"></a>01174     optional&lt;cp::conductivities_type, false&gt;* extra_conductivities
<a name="l01175"></a>01175         = <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Physiological().ExtracellularConductivities(),
<a name="l01176"></a>01176                           &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Physiological().ExtracellularConductivities(),
<a name="l01177"></a>01177                           <span class="stringliteral">&quot;ExtracellularConductivities&quot;</span>);
<a name="l01178"></a>01178     <span class="keywordtype">double</span> extra_x_cond = extra_conductivities-&gt;get().longi();
<a name="l01179"></a>01179     <span class="keywordtype">double</span> extra_y_cond = extra_conductivities-&gt;get().trans();
<a name="l01180"></a>01180     <span class="keywordtype">double</span> extra_z_cond = extra_conductivities-&gt;get().normal();;
<a name="l01181"></a>01181 
<a name="l01182"></a>01182     assert(extra_y_cond != DBL_MAX);
<a name="l01183"></a>01183     assert(extra_z_cond != DBL_MAX);
<a name="l01184"></a>01184 
<a name="l01185"></a>01185     extraConductivities[0] = extra_x_cond;
<a name="l01186"></a>01186     extraConductivities[1] = extra_y_cond;
<a name="l01187"></a>01187     extraConductivities[2] = extra_z_cond;
<a name="l01188"></a>01188 }
<a name="l01189"></a>01189 
<a name="l01190"></a><a class="code" href="classHeartConfig.html#a2a2351eed4d2a4e0f17c854976901be2">01190</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a88855dbd26f93d53e1b754a1db38f792">HeartConfig::GetExtracellularConductivities</a>(c_vector&lt;double, 2&gt;&amp; extraConductivities)<span class="keyword"> const</span>
<a name="l01191"></a>01191 <span class="keyword"></span>{
<a name="l01192"></a>01192     optional&lt;cp::conductivities_type, false&gt;* extra_conductivities
<a name="l01193"></a>01193         = <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Physiological().ExtracellularConductivities(),
<a name="l01194"></a>01194                           &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Physiological().ExtracellularConductivities(),
<a name="l01195"></a>01195                           <span class="stringliteral">&quot;ExtracellularConductivities&quot;</span>);
<a name="l01196"></a>01196     <span class="keywordtype">double</span> extra_x_cond = extra_conductivities-&gt;get().longi();
<a name="l01197"></a>01197     <span class="keywordtype">double</span> extra_y_cond = extra_conductivities-&gt;get().trans();
<a name="l01198"></a>01198 
<a name="l01199"></a>01199     assert(extra_y_cond != DBL_MAX);
<a name="l01200"></a>01200 
<a name="l01201"></a>01201     extraConductivities[0] = extra_x_cond;
<a name="l01202"></a>01202     extraConductivities[1] = extra_y_cond;
<a name="l01203"></a>01203 }
<a name="l01204"></a>01204 
<a name="l01205"></a><a class="code" href="classHeartConfig.html#a9b672856c90b4a742b0c285791f693a4">01205</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a88855dbd26f93d53e1b754a1db38f792">HeartConfig::GetExtracellularConductivities</a>(c_vector&lt;double, 1&gt;&amp; extraConductivities)<span class="keyword"> const</span>
<a name="l01206"></a>01206 <span class="keyword"></span>{
<a name="l01207"></a>01207     optional&lt;cp::conductivities_type, false&gt;* extra_conductivities
<a name="l01208"></a>01208         = <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Physiological().ExtracellularConductivities(),
<a name="l01209"></a>01209                           &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Physiological().ExtracellularConductivities(),
<a name="l01210"></a>01210                           <span class="stringliteral">&quot;ExtracellularConductivities&quot;</span>);
<a name="l01211"></a>01211     <span class="keywordtype">double</span> extra_x_cond = extra_conductivities-&gt;get().longi();
<a name="l01212"></a>01212 
<a name="l01213"></a>01213     extraConductivities[0] = extra_x_cond;
<a name="l01214"></a>01214 }
<a name="l01215"></a>01215 
<a name="l01216"></a><a class="code" href="classHeartConfig.html#a584c551947214a09cf46f84f97062484">01216</a> <span class="keywordtype">double</span> <a class="code" href="classHeartConfig.html#a584c551947214a09cf46f84f97062484">HeartConfig::GetBathConductivity</a>()<span class="keyword"> const</span>
<a name="l01217"></a>01217 <span class="keyword"></span>{
<a name="l01218"></a>01218     <span class="comment">/*bath conductivity mS/cm*/</span>
<a name="l01219"></a>01219     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Physiological().BathConductivity(),
<a name="l01220"></a>01220                            &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Physiological().BathConductivity(),
<a name="l01221"></a>01221                            <span class="stringliteral">&quot;BathConductivity&quot;</span>)-&gt;<span class="keyword">get</span>();
<a name="l01222"></a>01222 }
<a name="l01223"></a>01223 
<a name="l01224"></a><a class="code" href="classHeartConfig.html#a28720983a8bcd68fd8dfc6ce247fd325">01224</a> <span class="keywordtype">double</span> <a class="code" href="classHeartConfig.html#a28720983a8bcd68fd8dfc6ce247fd325">HeartConfig::GetSurfaceAreaToVolumeRatio</a>()<span class="keyword"> const</span>
<a name="l01225"></a>01225 <span class="keyword"></span>{
<a name="l01226"></a>01226     <span class="comment">/*surface area to volume ratio: 1/cm*/</span>
<a name="l01227"></a>01227     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Physiological().SurfaceAreaToVolumeRatio(),
<a name="l01228"></a>01228                            &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Physiological().SurfaceAreaToVolumeRatio(),
<a name="l01229"></a>01229                            <span class="stringliteral">&quot;SurfaceAreaToVolumeRatio&quot;</span>)-&gt;<span class="keyword">get</span>();
<a name="l01230"></a>01230 }
<a name="l01231"></a>01231 
<a name="l01232"></a><a class="code" href="classHeartConfig.html#a7dd59bcef90ddadee3e7a10cbf64be1d">01232</a> <span class="keywordtype">double</span> <a class="code" href="classHeartConfig.html#a7dd59bcef90ddadee3e7a10cbf64be1d">HeartConfig::GetCapacitance</a>()<span class="keyword"> const</span>
<a name="l01233"></a>01233 <span class="keyword"></span>{
<a name="l01234"></a>01234     <span class="comment">//         capacitance                 : uF/cm^2</span>
<a name="l01235"></a>01235     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Physiological().Capacitance(),
<a name="l01236"></a>01236                            &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Physiological().Capacitance(),
<a name="l01237"></a>01237                            <span class="stringliteral">&quot;Capacitance&quot;</span>)-&gt;<span class="keyword">get</span>();
<a name="l01238"></a>01238 }
<a name="l01239"></a>01239 
<a name="l01240"></a><a class="code" href="classHeartConfig.html#a383ab1c116a88ecd3f973ef371a2c8d9">01240</a> <span class="keywordtype">double</span> <a class="code" href="classHeartConfig.html#a383ab1c116a88ecd3f973ef371a2c8d9">HeartConfig::GetOdeTimeStep</a>()<span class="keyword"> const</span>
<a name="l01241"></a>01241 <span class="keyword"></span>{
<a name="l01242"></a>01242     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().TimeSteps(),
<a name="l01243"></a>01243                            &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Numerical().TimeSteps(),
<a name="l01244"></a>01244                            <span class="stringliteral">&quot;ode TimeStep&quot;</span>)-&gt;<span class="keyword">get</span>().ode();
<a name="l01245"></a>01245 }
<a name="l01246"></a>01246 
<a name="l01247"></a><a class="code" href="classHeartConfig.html#ac20bbc4140281b206a260a82cb59ab0f">01247</a> <span class="keywordtype">double</span> <a class="code" href="classHeartConfig.html#ac20bbc4140281b206a260a82cb59ab0f">HeartConfig::GetPdeTimeStep</a>()<span class="keyword"> const</span>
<a name="l01248"></a>01248 <span class="keyword"></span>{
<a name="l01249"></a>01249     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().TimeSteps(),
<a name="l01250"></a>01250                            &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Numerical().TimeSteps(),
<a name="l01251"></a>01251                            <span class="stringliteral">&quot;pde TimeStep&quot;</span>)-&gt;<span class="keyword">get</span>().pde();
<a name="l01252"></a>01252 }
<a name="l01253"></a>01253 
<a name="l01254"></a><a class="code" href="classHeartConfig.html#a33ae21f4b16476aa5cb975a455c5ba19">01254</a> <span class="keywordtype">double</span> <a class="code" href="classHeartConfig.html#a33ae21f4b16476aa5cb975a455c5ba19">HeartConfig::GetPrintingTimeStep</a>()<span class="keyword"> const</span>
<a name="l01255"></a>01255 <span class="keyword"></span>{
<a name="l01256"></a>01256     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().TimeSteps(),
<a name="l01257"></a>01257                            &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Numerical().TimeSteps(),
<a name="l01258"></a>01258                            <span class="stringliteral">&quot;printing TimeStep&quot;</span>)-&gt;<span class="keyword">get</span>().printing();
<a name="l01259"></a>01259 }
<a name="l01260"></a>01260 
<a name="l01261"></a><a class="code" href="classHeartConfig.html#aefd1b52bc3570c91aeb5c30793f8fb09">01261</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#aefd1b52bc3570c91aeb5c30793f8fb09">HeartConfig::GetUseAbsoluteTolerance</a>()<span class="keyword"> const</span>
<a name="l01262"></a>01262 <span class="keyword"></span>{
<a name="l01263"></a>01263     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().KSPTolerances(),
<a name="l01264"></a>01264                             &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Numerical().KSPTolerances(),
<a name="l01265"></a>01265                             <span class="stringliteral">&quot;KSPTolerances&quot;</span>)-&gt;<span class="keyword">get</span>().KSPAbsolute().present();
<a name="l01266"></a>01266 }
<a name="l01267"></a>01267 
<a name="l01268"></a><a class="code" href="classHeartConfig.html#a45eb855112098fbd11eeafa696af3865">01268</a> <span class="keywordtype">double</span> <a class="code" href="classHeartConfig.html#a45eb855112098fbd11eeafa696af3865">HeartConfig::GetAbsoluteTolerance</a>()<span class="keyword"> const</span>
<a name="l01269"></a>01269 <span class="keyword"></span>{
<a name="l01270"></a>01270     <span class="keywordflow">if</span> (!<a class="code" href="classHeartConfig.html#aefd1b52bc3570c91aeb5c30793f8fb09">GetUseAbsoluteTolerance</a>())
<a name="l01271"></a>01271     {
<a name="l01272"></a>01272         EXCEPTION(<span class="stringliteral">&quot;Absolute tolerance is not set in Chaste parameters&quot;</span>);
<a name="l01273"></a>01273     }
<a name="l01274"></a>01274     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().KSPTolerances(),
<a name="l01275"></a>01275                            &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Numerical().KSPTolerances(),
<a name="l01276"></a>01276                            <span class="stringliteral">&quot;KSPTolerances&quot;</span>)-&gt;<span class="keyword">get</span>().KSPAbsolute().get();
<a name="l01277"></a>01277 }
<a name="l01278"></a>01278 
<a name="l01279"></a><a class="code" href="classHeartConfig.html#a38875e6f770ba53ed2fe1bcb91d12a61">01279</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#a38875e6f770ba53ed2fe1bcb91d12a61">HeartConfig::GetUseRelativeTolerance</a>()<span class="keyword"> const</span>
<a name="l01280"></a>01280 <span class="keyword"></span>{
<a name="l01281"></a>01281      <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().KSPTolerances(),
<a name="l01282"></a>01282                             &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Numerical().KSPTolerances(),
<a name="l01283"></a>01283                             <span class="stringliteral">&quot;KSPTolerances&quot;</span>)-&gt;<span class="keyword">get</span>().KSPRelative().present();
<a name="l01284"></a>01284 }
<a name="l01285"></a>01285 
<a name="l01286"></a><a class="code" href="classHeartConfig.html#a1ea656c2fb65c0bfd25fbc162202fa1a">01286</a> <span class="keywordtype">double</span> <a class="code" href="classHeartConfig.html#a1ea656c2fb65c0bfd25fbc162202fa1a">HeartConfig::GetRelativeTolerance</a>()<span class="keyword"> const</span>
<a name="l01287"></a>01287 <span class="keyword"></span>{
<a name="l01288"></a>01288     <span class="keywordflow">if</span> (!<a class="code" href="classHeartConfig.html#a38875e6f770ba53ed2fe1bcb91d12a61">GetUseRelativeTolerance</a>())
<a name="l01289"></a>01289     {
<a name="l01290"></a>01290         EXCEPTION(<span class="stringliteral">&quot;Relative tolerance is not set in Chaste parameters&quot;</span>);
<a name="l01291"></a>01291     }
<a name="l01292"></a>01292     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().KSPTolerances(),
<a name="l01293"></a>01293                            &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Numerical().KSPTolerances(),
<a name="l01294"></a>01294                            <span class="stringliteral">&quot;KSPTolerances&quot;</span>)-&gt;<span class="keyword">get</span>().KSPRelative().get();
<a name="l01295"></a>01295 }
<a name="l01296"></a>01296 
<a name="l01297"></a><a class="code" href="classHeartConfig.html#ac50d7e66e3a6127cf337d2f65638ad6b">01297</a> <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="classHeartConfig.html#ac50d7e66e3a6127cf337d2f65638ad6b">HeartConfig::GetKSPSolver</a>()<span class="keyword"> const</span>
<a name="l01298"></a>01298 <span class="keyword"></span>{
<a name="l01299"></a>01299     <span class="keywordflow">switch</span> ( <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().KSPSolver(),
<a name="l01300"></a>01300                              &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Numerical().KSPSolver(),
<a name="l01301"></a>01301                             <span class="stringliteral">&quot;KSPSolver&quot;</span>)-&gt;<span class="keyword">get</span>() )
<a name="l01302"></a>01302     {
<a name="l01303"></a>01303         <span class="keywordflow">case</span> cp::ksp_solver_type::gmres :
<a name="l01304"></a>01304             <span class="keywordflow">return</span> <span class="stringliteral">&quot;gmres&quot;</span>;
<a name="l01305"></a>01305         <span class="keywordflow">case</span> cp::ksp_solver_type::cg :
<a name="l01306"></a>01306             <span class="keywordflow">return</span> <span class="stringliteral">&quot;cg&quot;</span>;
<a name="l01307"></a>01307         <span class="keywordflow">case</span> cp::ksp_solver_type::symmlq :
<a name="l01308"></a>01308             <span class="keywordflow">return</span> <span class="stringliteral">&quot;symmlq&quot;</span>;
<a name="l01309"></a>01309     }
<a name="l01310"></a>01310 <span class="preprocessor">#define COVERAGE_IGNORE</span>
<a name="l01311"></a>01311 <span class="preprocessor"></span>    EXCEPTION(<span class="stringliteral">&quot;Unknown ksp solver&quot;</span>);
<a name="l01312"></a>01312 <span class="preprocessor">#undef COVERAGE_IGNORE</span>
<a name="l01313"></a>01313 <span class="preprocessor"></span>}
<a name="l01314"></a>01314 
<a name="l01315"></a><a class="code" href="classHeartConfig.html#ac6d76aa8808fba0fa0da55d6b5749c22">01315</a> <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="classHeartConfig.html#ac6d76aa8808fba0fa0da55d6b5749c22">HeartConfig::GetKSPPreconditioner</a>()<span class="keyword"> const</span>
<a name="l01316"></a>01316 <span class="keyword"></span>{
<a name="l01317"></a>01317     <span class="keywordflow">switch</span> ( <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().KSPPreconditioner(),
<a name="l01318"></a>01318                              &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Numerical().KSPPreconditioner(),
<a name="l01319"></a>01319                              <span class="stringliteral">&quot;KSPPreconditioner&quot;</span>)-&gt;<span class="keyword">get</span>() )
<a name="l01320"></a>01320     {
<a name="l01321"></a>01321         <span class="keywordflow">case</span> cp::ksp_preconditioner_type::ilu :
<a name="l01322"></a>01322             <span class="keywordflow">return</span> <span class="stringliteral">&quot;ilu&quot;</span>;
<a name="l01323"></a>01323         <span class="keywordflow">case</span> cp::ksp_preconditioner_type::jacobi :
<a name="l01324"></a>01324             <span class="keywordflow">return</span> <span class="stringliteral">&quot;jacobi&quot;</span>;
<a name="l01325"></a>01325         <span class="keywordflow">case</span> cp::ksp_preconditioner_type::bjacobi :
<a name="l01326"></a>01326             <span class="keywordflow">return</span> <span class="stringliteral">&quot;bjacobi&quot;</span>;
<a name="l01327"></a>01327         <span class="keywordflow">case</span> cp::ksp_preconditioner_type::hypre :
<a name="l01328"></a>01328             <span class="keywordflow">return</span> <span class="stringliteral">&quot;hypre&quot;</span>;
<a name="l01329"></a>01329         <span class="keywordflow">case</span> cp::ksp_preconditioner_type::ml :
<a name="l01330"></a>01330             <span class="keywordflow">return</span> <span class="stringliteral">&quot;ml&quot;</span>;
<a name="l01331"></a>01331         <span class="keywordflow">case</span> cp::ksp_preconditioner_type::spai :
<a name="l01332"></a>01332             <span class="keywordflow">return</span> <span class="stringliteral">&quot;spai&quot;</span>;
<a name="l01333"></a>01333         <span class="keywordflow">case</span> cp::ksp_preconditioner_type::blockdiagonal :
<a name="l01334"></a>01334             <span class="keywordflow">return</span> <span class="stringliteral">&quot;blockdiagonal&quot;</span>;
<a name="l01335"></a>01335         <span class="keywordflow">case</span> cp::ksp_preconditioner_type::ldufactorisation :
<a name="l01336"></a>01336             <span class="keywordflow">return</span> <span class="stringliteral">&quot;ldufactorisation&quot;</span>;
<a name="l01337"></a>01337         <span class="keywordflow">case</span> cp::ksp_preconditioner_type::none :
<a name="l01338"></a>01338             <span class="keywordflow">return</span> <span class="stringliteral">&quot;none&quot;</span>;
<a name="l01339"></a>01339 
<a name="l01340"></a>01340     }
<a name="l01341"></a>01341 <span class="preprocessor">#define COVERAGE_IGNORE</span>
<a name="l01342"></a>01342 <span class="preprocessor"></span>    EXCEPTION(<span class="stringliteral">&quot;Unknown ksp preconditioner&quot;</span>);
<a name="l01343"></a>01343 <span class="preprocessor">#undef COVERAGE_IGNORE</span>
<a name="l01344"></a>01344 <span class="preprocessor"></span>}
<a name="l01345"></a>01345 
<a name="l01346"></a><a class="code" href="classHeartConfig.html#afacc6a848f43660c4cccfd9b66cc0df2">01346</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#afacc6a848f43660c4cccfd9b66cc0df2">HeartConfig::IsAdaptivityParametersPresent</a>()<span class="keyword"> const</span>
<a name="l01347"></a>01347 <span class="keyword"></span>{
<a name="l01348"></a>01348     <span class="keywordflow">try</span>
<a name="l01349"></a>01349     {
<a name="l01350"></a>01350         <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().AdaptivityParameters(),
<a name="l01351"></a>01351                         &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Numerical().AdaptivityParameters(),
<a name="l01352"></a>01352                         <span class="stringliteral">&quot;AdaptivityParameters&quot;</span>)-&gt;present();
<a name="l01353"></a>01353         <span class="comment">//If there&#39;s a section</span>
<a name="l01354"></a>01354         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01355"></a>01355     }
<a name="l01356"></a>01356     <span class="keywordflow">catch</span> (<a class="code" href="classException.html">Exception</a> &amp;e)
<a name="l01357"></a>01357     {
<a name="l01358"></a>01358         <span class="comment">//No section</span>
<a name="l01359"></a>01359         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01360"></a>01360     }
<a name="l01361"></a>01361 }
<a name="l01362"></a>01362 
<a name="l01363"></a><a class="code" href="classHeartConfig.html#a10bc06efde462cf251767739cd1b69ac">01363</a> <span class="keywordtype">double</span> <a class="code" href="classHeartConfig.html#a10bc06efde462cf251767739cd1b69ac">HeartConfig::GetTargetErrorForAdaptivity</a>()<span class="keyword"> const</span>
<a name="l01364"></a>01364 <span class="keyword"></span>{
<a name="l01365"></a>01365     <span class="keywordflow">if</span> ( <a class="code" href="classHeartConfig.html#afacc6a848f43660c4cccfd9b66cc0df2">IsAdaptivityParametersPresent</a>() )
<a name="l01366"></a>01366     {
<a name="l01367"></a>01367         <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().AdaptivityParameters(),
<a name="l01368"></a>01368                                &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Numerical().AdaptivityParameters(),
<a name="l01369"></a>01369                                <span class="stringliteral">&quot;TargetError&quot;</span>)-&gt;<span class="keyword">get</span>().target_error();
<a name="l01370"></a>01370     }
<a name="l01371"></a>01371     <span class="keywordflow">else</span>
<a name="l01372"></a>01372     {
<a name="l01373"></a>01373         EXCEPTION(<span class="stringliteral">&quot;Adaptivity parameters have not been set&quot;</span>);
<a name="l01374"></a>01374     }
<a name="l01375"></a>01375 }
<a name="l01376"></a>01376 
<a name="l01377"></a><a class="code" href="classHeartConfig.html#a66fc480d24bc9f8535c89cccd989f9af">01377</a> <span class="keywordtype">double</span> <a class="code" href="classHeartConfig.html#a66fc480d24bc9f8535c89cccd989f9af">HeartConfig::GetSigmaForAdaptivity</a>()<span class="keyword"> const</span>
<a name="l01378"></a>01378 <span class="keyword"></span>{
<a name="l01379"></a>01379     <span class="keywordflow">if</span> ( <a class="code" href="classHeartConfig.html#afacc6a848f43660c4cccfd9b66cc0df2">IsAdaptivityParametersPresent</a>() )
<a name="l01380"></a>01380     {
<a name="l01381"></a>01381         <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().AdaptivityParameters(),
<a name="l01382"></a>01382                                &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Numerical().AdaptivityParameters(),
<a name="l01383"></a>01383                                <span class="stringliteral">&quot;TargetError&quot;</span>)-&gt;<span class="keyword">get</span>().sigma();
<a name="l01384"></a>01384     }
<a name="l01385"></a>01385     <span class="keywordflow">else</span>
<a name="l01386"></a>01386     {
<a name="l01387"></a>01387         EXCEPTION(<span class="stringliteral">&quot;Adaptivity parameters have not been set&quot;</span>);
<a name="l01388"></a>01388     }
<a name="l01389"></a>01389 }
<a name="l01390"></a>01390 
<a name="l01391"></a><a class="code" href="classHeartConfig.html#a89155d1726cbe35f76ade0648e769a4d">01391</a> <span class="keywordtype">double</span> <a class="code" href="classHeartConfig.html#a89155d1726cbe35f76ade0648e769a4d">HeartConfig::GetMaxEdgeLengthForAdaptivity</a>()<span class="keyword"> const</span>
<a name="l01392"></a>01392 <span class="keyword"></span>{
<a name="l01393"></a>01393     <span class="keywordflow">if</span> ( <a class="code" href="classHeartConfig.html#afacc6a848f43660c4cccfd9b66cc0df2">IsAdaptivityParametersPresent</a>() )
<a name="l01394"></a>01394     {
<a name="l01395"></a>01395     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().AdaptivityParameters(),
<a name="l01396"></a>01396                            &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Numerical().AdaptivityParameters(),
<a name="l01397"></a>01397                            <span class="stringliteral">&quot;TargetError&quot;</span>)-&gt;<span class="keyword">get</span>().max_edge_length();
<a name="l01398"></a>01398     }
<a name="l01399"></a>01399     <span class="keywordflow">else</span>
<a name="l01400"></a>01400     {
<a name="l01401"></a>01401         EXCEPTION(<span class="stringliteral">&quot;Adaptivity parameters have not been set&quot;</span>);
<a name="l01402"></a>01402     }
<a name="l01403"></a>01403 }
<a name="l01404"></a>01404 
<a name="l01405"></a><a class="code" href="classHeartConfig.html#adcae58747ee8057177bc063ce4b9cc3b">01405</a> <span class="keywordtype">double</span> <a class="code" href="classHeartConfig.html#adcae58747ee8057177bc063ce4b9cc3b">HeartConfig::GetMinEdgeLengthForAdaptivity</a>()<span class="keyword"> const</span>
<a name="l01406"></a>01406 <span class="keyword"></span>{
<a name="l01407"></a>01407     <span class="keywordflow">if</span> ( <a class="code" href="classHeartConfig.html#afacc6a848f43660c4cccfd9b66cc0df2">IsAdaptivityParametersPresent</a>() )
<a name="l01408"></a>01408     {
<a name="l01409"></a>01409         <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().AdaptivityParameters(),
<a name="l01410"></a>01410                                &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Numerical().AdaptivityParameters(),
<a name="l01411"></a>01411                                <span class="stringliteral">&quot;TargetError&quot;</span>)-&gt;<span class="keyword">get</span>().min_edge_length();
<a name="l01412"></a>01412     }
<a name="l01413"></a>01413     <span class="keywordflow">else</span>
<a name="l01414"></a>01414     {
<a name="l01415"></a>01415         EXCEPTION(<span class="stringliteral">&quot;Adaptivity parameters have not been set&quot;</span>);
<a name="l01416"></a>01416     }
<a name="l01417"></a>01417 }
<a name="l01418"></a>01418 
<a name="l01419"></a><a class="code" href="classHeartConfig.html#aa5bca3744b53e11ec99ad2f3dc259600">01419</a> <span class="keywordtype">double</span> <a class="code" href="classHeartConfig.html#aa5bca3744b53e11ec99ad2f3dc259600">HeartConfig::GetGradationForAdaptivity</a>()<span class="keyword"> const</span>
<a name="l01420"></a>01420 <span class="keyword"></span>{
<a name="l01421"></a>01421     <span class="keywordflow">if</span> ( <a class="code" href="classHeartConfig.html#afacc6a848f43660c4cccfd9b66cc0df2">IsAdaptivityParametersPresent</a>() )
<a name="l01422"></a>01422     {
<a name="l01423"></a>01423         <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().AdaptivityParameters(),
<a name="l01424"></a>01424                                &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Numerical().AdaptivityParameters(),
<a name="l01425"></a>01425                                <span class="stringliteral">&quot;TargetError&quot;</span>)-&gt;<span class="keyword">get</span>().gradation();
<a name="l01426"></a>01426     }
<a name="l01427"></a>01427     <span class="keywordflow">else</span>
<a name="l01428"></a>01428     {
<a name="l01429"></a>01429         EXCEPTION(<span class="stringliteral">&quot;Adaptivity parameters have not been set&quot;</span>);
<a name="l01430"></a>01430     }
<a name="l01431"></a>01431 }
<a name="l01432"></a>01432 
<a name="l01433"></a><a class="code" href="classHeartConfig.html#a4e47a91fa230dda4fb4a708b546c5c2e">01433</a> <span class="keywordtype">unsigned</span> <a class="code" href="classHeartConfig.html#a4e47a91fa230dda4fb4a708b546c5c2e">HeartConfig::GetMaxNodesForAdaptivity</a>()<span class="keyword"> const</span>
<a name="l01434"></a>01434 <span class="keyword"></span>{
<a name="l01435"></a>01435     <span class="keywordflow">if</span> ( <a class="code" href="classHeartConfig.html#afacc6a848f43660c4cccfd9b66cc0df2">IsAdaptivityParametersPresent</a>() )
<a name="l01436"></a>01436     {
<a name="l01437"></a>01437         <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().AdaptivityParameters(),
<a name="l01438"></a>01438                                &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Numerical().AdaptivityParameters(),
<a name="l01439"></a>01439                                <span class="stringliteral">&quot;TargetError&quot;</span>)-&gt;<span class="keyword">get</span>().max_nodes();
<a name="l01440"></a>01440     }
<a name="l01441"></a>01441     <span class="keywordflow">else</span>
<a name="l01442"></a>01442     {
<a name="l01443"></a>01443         EXCEPTION(<span class="stringliteral">&quot;Adaptivity parameters have not been set&quot;</span>);
<a name="l01444"></a>01444     }
<a name="l01445"></a>01445 }
<a name="l01446"></a>01446 
<a name="l01447"></a><a class="code" href="classHeartConfig.html#a2dd2113b9c0b0ec6e1f86de50727cbf2">01447</a> <span class="keywordtype">unsigned</span> <a class="code" href="classHeartConfig.html#a2dd2113b9c0b0ec6e1f86de50727cbf2">HeartConfig::GetNumberOfAdaptiveSweeps</a>()<span class="keyword"> const</span>
<a name="l01448"></a>01448 <span class="keyword"></span>{
<a name="l01449"></a>01449     <span class="keywordflow">if</span> ( <a class="code" href="classHeartConfig.html#afacc6a848f43660c4cccfd9b66cc0df2">IsAdaptivityParametersPresent</a>() )
<a name="l01450"></a>01450     {
<a name="l01451"></a>01451         <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().AdaptivityParameters(),
<a name="l01452"></a>01452                                &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Numerical().AdaptivityParameters(),
<a name="l01453"></a>01453                                <span class="stringliteral">&quot;TargetError&quot;</span>)-&gt;<span class="keyword">get</span>().num_sweeps();
<a name="l01454"></a>01454     }
<a name="l01455"></a>01455     <span class="keywordflow">else</span>
<a name="l01456"></a>01456     {
<a name="l01457"></a>01457         EXCEPTION(<span class="stringliteral">&quot;Adaptivity parameters have not been set&quot;</span>);
<a name="l01458"></a>01458     }
<a name="l01459"></a>01459 }
<a name="l01460"></a>01460 
<a name="l01461"></a>01461 <span class="comment">/*</span>
<a name="l01462"></a>01462 <span class="comment"> * PostProcessing</span>
<a name="l01463"></a>01463 <span class="comment"> */</span>
<a name="l01464"></a>01464 
<a name="l01465"></a><a class="code" href="classHeartConfig.html#a1a13023d984e6bcab3faa854847654ce">01465</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#a1a13023d984e6bcab3faa854847654ce">HeartConfig::IsPostProcessingSectionPresent</a>()<span class="keyword"> const</span>
<a name="l01466"></a>01466 <span class="keyword"></span>{
<a name="l01467"></a>01467     <span class="keywordflow">try</span>
<a name="l01468"></a>01468     {
<a name="l01469"></a>01469         <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;PostProcessing(),
<a name="l01470"></a>01470                         &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;PostProcessing(),
<a name="l01471"></a>01471                         <span class="stringliteral">&quot;PostProcessing&quot;</span>)-&gt;present();
<a name="l01472"></a>01472         <span class="comment">//If there&#39;s a section</span>
<a name="l01473"></a>01473         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01474"></a>01474     }
<a name="l01475"></a>01475     <span class="keywordflow">catch</span> (<a class="code" href="classException.html">Exception</a> &amp;e)
<a name="l01476"></a>01476     {
<a name="l01477"></a>01477         <span class="comment">//No section</span>
<a name="l01478"></a>01478         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01479"></a>01479     }
<a name="l01480"></a>01480 }
<a name="l01481"></a>01481 
<a name="l01482"></a><a class="code" href="classHeartConfig.html#aa82a9d7071771f54527f2d749f428247">01482</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#aa82a9d7071771f54527f2d749f428247">HeartConfig::IsPostProcessingRequested</a>()<span class="keyword"> const</span>
<a name="l01483"></a>01483 <span class="keyword"></span>{
<a name="l01484"></a>01484     <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#a1a13023d984e6bcab3faa854847654ce">IsPostProcessingSectionPresent</a>() == <span class="keyword">false</span>)
<a name="l01485"></a>01485     {
<a name="l01486"></a>01486         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01487"></a>01487     }
<a name="l01488"></a>01488     <span class="keywordflow">else</span>
<a name="l01489"></a>01489     {
<a name="l01490"></a>01490         <span class="keywordflow">return</span>(<a class="code" href="classHeartConfig.html#ad6f240f8dc2d4158afa69fd3a7da9a15">IsApdMapsRequested</a>() ||
<a name="l01491"></a>01491                <a class="code" href="classHeartConfig.html#a38b9c3b57116747edcf71fd6d78029d5">IsUpstrokeTimeMapsRequested</a>() ||
<a name="l01492"></a>01492                <a class="code" href="classHeartConfig.html#ab8fa3c6d5dfada90205d5a6458d56d30">IsMaxUpstrokeVelocityMapRequested</a>() ||
<a name="l01493"></a>01493                <a class="code" href="classHeartConfig.html#ae842eee4b5d015df2d193d11857efb91">IsConductionVelocityMapsRequested</a>());
<a name="l01494"></a>01494     }
<a name="l01495"></a>01495 }
<a name="l01496"></a><a class="code" href="classHeartConfig.html#ad6f240f8dc2d4158afa69fd3a7da9a15">01496</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#ad6f240f8dc2d4158afa69fd3a7da9a15">HeartConfig::IsApdMapsRequested</a>()<span class="keyword"> const</span>
<a name="l01497"></a>01497 <span class="keyword"></span>{
<a name="l01498"></a>01498     assert(<a class="code" href="classHeartConfig.html#a1a13023d984e6bcab3faa854847654ce">IsPostProcessingSectionPresent</a>());
<a name="l01499"></a>01499 
<a name="l01500"></a>01500     XSD_SEQUENCE_TYPE(cp::postprocessing_type::ActionPotentialDurationMap)&amp;
<a name="l01501"></a>01501         apd_maps = <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;PostProcessing(),
<a name="l01502"></a>01502                                    &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;PostProcessing(),
<a name="l01503"></a>01503                                    <span class="stringliteral">&quot;ActionPotentialDurationMap&quot;</span>)-&gt;<span class="keyword">get</span>().ActionPotentialDurationMap();
<a name="l01504"></a>01504     <span class="keywordflow">return</span> (apd_maps.begin() != apd_maps.end());
<a name="l01505"></a>01505 }
<a name="l01506"></a>01506 
<a name="l01507"></a><a class="code" href="classHeartConfig.html#a14e095195f9959a3da1f6cbe8045d4db">01507</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a14e095195f9959a3da1f6cbe8045d4db">HeartConfig::GetApdMaps</a>(std::vector&lt;std::pair&lt;double,double&gt; &gt;&amp; apd_maps)<span class="keyword"> const</span>
<a name="l01508"></a>01508 <span class="keyword"></span>{
<a name="l01509"></a>01509     assert(<a class="code" href="classHeartConfig.html#ad6f240f8dc2d4158afa69fd3a7da9a15">IsApdMapsRequested</a>());
<a name="l01510"></a>01510     apd_maps.clear();
<a name="l01511"></a>01511 
<a name="l01512"></a>01512     XSD_SEQUENCE_TYPE(cp::postprocessing_type::ActionPotentialDurationMap)&amp;
<a name="l01513"></a>01513         apd_maps_sequence = <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;PostProcessing(),
<a name="l01514"></a>01514                                             &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;PostProcessing(),
<a name="l01515"></a>01515                                             <span class="stringliteral">&quot;ActionPotentialDurationMap&quot;</span>)-&gt;<span class="keyword">get</span>().ActionPotentialDurationMap();
<a name="l01516"></a>01516 
<a name="l01517"></a>01517     <span class="keywordflow">for</span> (XSD_ITERATOR_TYPE(cp::postprocessing_type::ActionPotentialDurationMap) i = apd_maps_sequence.begin();
<a name="l01518"></a>01518          i != apd_maps_sequence.end();
<a name="l01519"></a>01519          ++i)
<a name="l01520"></a>01520     {
<a name="l01521"></a>01521         std::pair&lt;double,double&gt; map(i-&gt;repolarisation_percentage(),i-&gt;threshold());
<a name="l01522"></a>01522 
<a name="l01523"></a>01523         apd_maps.push_back(map);
<a name="l01524"></a>01524     }
<a name="l01525"></a>01525 }
<a name="l01526"></a>01526 
<a name="l01527"></a><a class="code" href="classHeartConfig.html#a38b9c3b57116747edcf71fd6d78029d5">01527</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#a38b9c3b57116747edcf71fd6d78029d5">HeartConfig::IsUpstrokeTimeMapsRequested</a>()<span class="keyword"> const</span>
<a name="l01528"></a>01528 <span class="keyword"></span>{
<a name="l01529"></a>01529     assert(<a class="code" href="classHeartConfig.html#a1a13023d984e6bcab3faa854847654ce">IsPostProcessingSectionPresent</a>());
<a name="l01530"></a>01530 
<a name="l01531"></a>01531     XSD_SEQUENCE_TYPE(cp::postprocessing_type::UpstrokeTimeMap)&amp;
<a name="l01532"></a>01532         upstroke_map = <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;PostProcessing(),
<a name="l01533"></a>01533                                        &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;PostProcessing(),
<a name="l01534"></a>01534                                        <span class="stringliteral">&quot;UpstrokeTimeMap&quot;</span>)-&gt;<span class="keyword">get</span>().UpstrokeTimeMap();
<a name="l01535"></a>01535     <span class="keywordflow">return</span> (upstroke_map.begin() != upstroke_map.end());
<a name="l01536"></a>01536 }
<a name="l01537"></a><a class="code" href="classHeartConfig.html#a831d3088a0af82a409bb97723ca99aab">01537</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a831d3088a0af82a409bb97723ca99aab">HeartConfig::GetUpstrokeTimeMaps</a> (std::vector&lt;double&gt;&amp; upstroke_time_maps)<span class="keyword"> const</span>
<a name="l01538"></a>01538 <span class="keyword"></span>{
<a name="l01539"></a>01539     assert(<a class="code" href="classHeartConfig.html#a38b9c3b57116747edcf71fd6d78029d5">IsUpstrokeTimeMapsRequested</a>());
<a name="l01540"></a>01540     assert(upstroke_time_maps.size() == 0);
<a name="l01541"></a>01541 
<a name="l01542"></a>01542     XSD_SEQUENCE_TYPE(cp::postprocessing_type::UpstrokeTimeMap)&amp;
<a name="l01543"></a>01543         upstroke_maps_sequence = <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;PostProcessing(),
<a name="l01544"></a>01544                                                  &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;PostProcessing(),
<a name="l01545"></a>01545                                                  <span class="stringliteral">&quot;UpstrokeTimeMap&quot;</span>)-&gt;<span class="keyword">get</span>().UpstrokeTimeMap();
<a name="l01546"></a>01546 
<a name="l01547"></a>01547     <span class="keywordflow">for</span> (XSD_ITERATOR_TYPE(cp::postprocessing_type::UpstrokeTimeMap) i = upstroke_maps_sequence.begin();
<a name="l01548"></a>01548          i != upstroke_maps_sequence.end();
<a name="l01549"></a>01549          ++i)
<a name="l01550"></a>01550     {
<a name="l01551"></a>01551         upstroke_time_maps.push_back(i-&gt;threshold());
<a name="l01552"></a>01552     }
<a name="l01553"></a>01553 }
<a name="l01554"></a>01554 
<a name="l01555"></a><a class="code" href="classHeartConfig.html#ab8fa3c6d5dfada90205d5a6458d56d30">01555</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#ab8fa3c6d5dfada90205d5a6458d56d30">HeartConfig::IsMaxUpstrokeVelocityMapRequested</a>()<span class="keyword"> const</span>
<a name="l01556"></a>01556 <span class="keyword"></span>{
<a name="l01557"></a>01557     assert(<a class="code" href="classHeartConfig.html#a1a13023d984e6bcab3faa854847654ce">IsPostProcessingSectionPresent</a>());
<a name="l01558"></a>01558 
<a name="l01559"></a>01559     XSD_SEQUENCE_TYPE(cp::postprocessing_type::MaxUpstrokeVelocityMap)&amp;
<a name="l01560"></a>01560         max_upstroke_velocity_map = <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;PostProcessing(),
<a name="l01561"></a>01561                                                     &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;PostProcessing(),
<a name="l01562"></a>01562                                                     <span class="stringliteral">&quot;MaxUpstrokeVelocityMap&quot;</span>)-&gt;<span class="keyword">get</span>().MaxUpstrokeVelocityMap();
<a name="l01563"></a>01563 
<a name="l01564"></a>01564     <span class="keywordflow">return</span> (max_upstroke_velocity_map.begin() != max_upstroke_velocity_map.end());
<a name="l01565"></a>01565 }
<a name="l01566"></a>01566 
<a name="l01567"></a><a class="code" href="classHeartConfig.html#a855d41df21f249a6943f20b05d5f37f3">01567</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a855d41df21f249a6943f20b05d5f37f3">HeartConfig::GetMaxUpstrokeVelocityMaps</a>(std::vector&lt;double&gt;&amp; upstroke_velocity_maps)<span class="keyword"> const</span>
<a name="l01568"></a>01568 <span class="keyword"></span>{
<a name="l01569"></a>01569     assert(<a class="code" href="classHeartConfig.html#ab8fa3c6d5dfada90205d5a6458d56d30">IsMaxUpstrokeVelocityMapRequested</a>());
<a name="l01570"></a>01570     assert(upstroke_velocity_maps.size() == 0);
<a name="l01571"></a>01571 
<a name="l01572"></a>01572     XSD_SEQUENCE_TYPE(cp::postprocessing_type::MaxUpstrokeVelocityMap)&amp;
<a name="l01573"></a>01573         max_upstroke_velocity_maps_sequence = <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;PostProcessing(),
<a name="l01574"></a>01574                                                               &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;PostProcessing(),
<a name="l01575"></a>01575                                                               <span class="stringliteral">&quot;MaxUpstrokeVelocityMap&quot;</span>)-&gt;<span class="keyword">get</span>().MaxUpstrokeVelocityMap();
<a name="l01576"></a>01576 
<a name="l01577"></a>01577     <span class="keywordflow">for</span> (XSD_ITERATOR_TYPE(cp::postprocessing_type::MaxUpstrokeVelocityMap) i = max_upstroke_velocity_maps_sequence.begin();
<a name="l01578"></a>01578          i != max_upstroke_velocity_maps_sequence.end();
<a name="l01579"></a>01579          ++i)
<a name="l01580"></a>01580     {
<a name="l01581"></a>01581         upstroke_velocity_maps.push_back(i-&gt;threshold());
<a name="l01582"></a>01582     }
<a name="l01583"></a>01583 }
<a name="l01584"></a>01584 
<a name="l01585"></a><a class="code" href="classHeartConfig.html#ae842eee4b5d015df2d193d11857efb91">01585</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#ae842eee4b5d015df2d193d11857efb91">HeartConfig::IsConductionVelocityMapsRequested</a>()<span class="keyword"> const</span>
<a name="l01586"></a>01586 <span class="keyword"></span>{
<a name="l01587"></a>01587     assert(<a class="code" href="classHeartConfig.html#a1a13023d984e6bcab3faa854847654ce">IsPostProcessingSectionPresent</a>());
<a name="l01588"></a>01588 
<a name="l01589"></a>01589     XSD_SEQUENCE_TYPE(cp::postprocessing_type::ConductionVelocityMap)&amp;
<a name="l01590"></a>01590         cond_vel_maps = <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;PostProcessing(),
<a name="l01591"></a>01591                                         &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;PostProcessing(),
<a name="l01592"></a>01592                                         <span class="stringliteral">&quot;ConductionVelocityMap&quot;</span>)-&gt;<span class="keyword">get</span>().ConductionVelocityMap();
<a name="l01593"></a>01593     <span class="keywordflow">return</span> (cond_vel_maps.begin() != cond_vel_maps.end());
<a name="l01594"></a>01594 }
<a name="l01595"></a>01595 
<a name="l01596"></a><a class="code" href="classHeartConfig.html#a8fe3409e71215bfd0af08abb75c7012b">01596</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a8fe3409e71215bfd0af08abb75c7012b">HeartConfig::GetConductionVelocityMaps</a>(std::vector&lt;unsigned&gt;&amp; conduction_velocity_maps)<span class="keyword"> const</span>
<a name="l01597"></a>01597 <span class="keyword"></span>{
<a name="l01598"></a>01598     assert(<a class="code" href="classHeartConfig.html#ae842eee4b5d015df2d193d11857efb91">IsConductionVelocityMapsRequested</a>());
<a name="l01599"></a>01599     assert(conduction_velocity_maps.size() == 0);
<a name="l01600"></a>01600 
<a name="l01601"></a>01601     XSD_SEQUENCE_TYPE(cp::postprocessing_type::ConductionVelocityMap)&amp;
<a name="l01602"></a>01602         cond_vel_maps_sequence = <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;PostProcessing(),
<a name="l01603"></a>01603                                                  &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;PostProcessing(),
<a name="l01604"></a>01604                                                  <span class="stringliteral">&quot;ConductionVelocityMap&quot;</span>)-&gt;<span class="keyword">get</span>().ConductionVelocityMap();
<a name="l01605"></a>01605 
<a name="l01606"></a>01606     <span class="keywordflow">for</span> (XSD_ITERATOR_TYPE(cp::postprocessing_type::ConductionVelocityMap) i = cond_vel_maps_sequence.begin();
<a name="l01607"></a>01607          i != cond_vel_maps_sequence.end();
<a name="l01608"></a>01608          ++i)
<a name="l01609"></a>01609     {
<a name="l01610"></a>01610         conduction_velocity_maps.push_back(i-&gt;origin_node());
<a name="l01611"></a>01611     }
<a name="l01612"></a>01612 }
<a name="l01613"></a>01613 
<a name="l01614"></a>01614 <span class="comment">/*</span>
<a name="l01615"></a>01615 <span class="comment"> * Output visualization</span>
<a name="l01616"></a>01616 <span class="comment"> */</span>
<a name="l01617"></a>01617 
<a name="l01618"></a><a class="code" href="classHeartConfig.html#a3010845819f8f64a7d98f5fa022ea094">01618</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#a3010845819f8f64a7d98f5fa022ea094">HeartConfig::IsOutputVisualizerPresent</a>()<span class="keyword"> const</span>
<a name="l01619"></a>01619 <span class="keyword"></span>{
<a name="l01620"></a>01620     <a class="code" href="classHeartConfig.html#aab7ea75d3f83c1202127db592d934532">CheckSimulationIsDefined</a>(<span class="stringliteral">&quot;OutputVisualizer&quot;</span>);
<a name="l01621"></a>01621 
<a name="l01622"></a>01622     <span class="keywordflow">try</span>
<a name="l01623"></a>01623     {
<a name="l01624"></a>01624         <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().OutputVisualizer(),
<a name="l01625"></a>01625                         &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation().get().OutputVisualizer(),
<a name="l01626"></a>01626                         <span class="stringliteral">&quot;OutputVisualizer&quot;</span>)-&gt;present();
<a name="l01627"></a>01627         <span class="comment">// If there&#39;s an element</span>
<a name="l01628"></a>01628         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01629"></a>01629     }
<a name="l01630"></a>01630     <span class="keywordflow">catch</span> (<a class="code" href="classException.html">Exception</a> &amp;e)
<a name="l01631"></a>01631     {
<a name="l01632"></a>01632         <span class="comment">// No element</span>
<a name="l01633"></a>01633         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01634"></a>01634     }
<a name="l01635"></a>01635 }
<a name="l01636"></a>01636 
<a name="l01637"></a><a class="code" href="classHeartConfig.html#a5a6cd032e69ae941458277195ee966a2">01637</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#a5a6cd032e69ae941458277195ee966a2">HeartConfig::GetVisualizeWithMeshalyzer</a>()<span class="keyword"> const</span>
<a name="l01638"></a>01638 <span class="keyword"></span>{
<a name="l01639"></a>01639     <span class="keywordflow">if</span> (!<a class="code" href="classHeartConfig.html#a3010845819f8f64a7d98f5fa022ea094">IsOutputVisualizerPresent</a>())
<a name="l01640"></a>01640     {
<a name="l01641"></a>01641         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01642"></a>01642     }
<a name="l01643"></a>01643     <span class="keywordflow">else</span>
<a name="l01644"></a>01644     {
<a name="l01645"></a>01645         <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().OutputVisualizer(),
<a name="l01646"></a>01646                                &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation().get().OutputVisualizer(),
<a name="l01647"></a>01647                                <span class="stringliteral">&quot;OutputVisualizer&quot;</span>)-&gt;<span class="keyword">get</span>().meshalyzer() == cp::yesno_type::yes;
<a name="l01648"></a>01648     }
<a name="l01649"></a>01649 }
<a name="l01650"></a>01650 
<a name="l01651"></a><a class="code" href="classHeartConfig.html#a6d9e677168ec7c1de59d35254bb71faa">01651</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#a6d9e677168ec7c1de59d35254bb71faa">HeartConfig::GetVisualizeWithCmgui</a>()<span class="keyword"> const</span>
<a name="l01652"></a>01652 <span class="keyword"></span>{
<a name="l01653"></a>01653     <span class="keywordflow">if</span> (!<a class="code" href="classHeartConfig.html#a3010845819f8f64a7d98f5fa022ea094">IsOutputVisualizerPresent</a>())
<a name="l01654"></a>01654     {
<a name="l01655"></a>01655         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01656"></a>01656     }
<a name="l01657"></a>01657     <span class="keywordflow">else</span>
<a name="l01658"></a>01658     {
<a name="l01659"></a>01659         <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().OutputVisualizer(),
<a name="l01660"></a>01660                                &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation().get().OutputVisualizer(),
<a name="l01661"></a>01661                                <span class="stringliteral">&quot;OutputVisualizer&quot;</span>)-&gt;<span class="keyword">get</span>().cmgui() == cp::yesno_type::yes;
<a name="l01662"></a>01662     }
<a name="l01663"></a>01663 }
<a name="l01664"></a>01664 
<a name="l01665"></a><a class="code" href="classHeartConfig.html#aee1957a338ff90ace79271fda5cd3798">01665</a> <span class="keywordtype">bool</span> <a class="code" href="classHeartConfig.html#aee1957a338ff90ace79271fda5cd3798">HeartConfig::GetVisualizeWithVtk</a>()<span class="keyword"> const</span>
<a name="l01666"></a>01666 <span class="keyword"></span>{
<a name="l01667"></a>01667     <span class="keywordflow">if</span> (!<a class="code" href="classHeartConfig.html#a3010845819f8f64a7d98f5fa022ea094">IsOutputVisualizerPresent</a>())
<a name="l01668"></a>01668     {
<a name="l01669"></a>01669         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01670"></a>01670     }
<a name="l01671"></a>01671     <span class="keywordflow">else</span>
<a name="l01672"></a>01672     {
<a name="l01673"></a>01673         <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#a5f17c7c19474a80f9354b2b827c3a216">DecideLocation</a>( &amp; <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().OutputVisualizer(),
<a name="l01674"></a>01674                                &amp; <a class="code" href="classHeartConfig.html#ab9fda2d9a6104456c8935a16d6fff41f">mpDefaultParameters</a>-&gt;Simulation().get().OutputVisualizer(),
<a name="l01675"></a>01675                                <span class="stringliteral">&quot;OutputVisualizer&quot;</span>)-&gt;<span class="keyword">get</span>().vtk() == cp::yesno_type::yes;
<a name="l01676"></a>01676     }
<a name="l01677"></a>01677 }
<a name="l01678"></a>01678 
<a name="l01679"></a>01679 
<a name="l01680"></a>01680 <span class="comment">/*</span>
<a name="l01681"></a>01681 <span class="comment"> *  Set methods</span>
<a name="l01682"></a>01682 <span class="comment"> */</span>
<a name="l01683"></a><a class="code" href="classHeartConfig.html#a81e1ccab8ab0b3fa759f781a9690e42e">01683</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a81e1ccab8ab0b3fa759f781a9690e42e">HeartConfig::SetSpaceDimension</a>(<span class="keywordtype">unsigned</span> spaceDimension)
<a name="l01684"></a>01684 {
<a name="l01685"></a>01685     <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().SpaceDimension().set(spaceDimension);
<a name="l01686"></a>01686 }
<a name="l01687"></a>01687 
<a name="l01688"></a><a class="code" href="classHeartConfig.html#aad5f6297757ec9b088e6ef56b9a71686">01688</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#aad5f6297757ec9b088e6ef56b9a71686">HeartConfig::SetSimulationDuration</a>(<span class="keywordtype">double</span> simulationDuration)
<a name="l01689"></a>01689 {
<a name="l01690"></a>01690     XSD_CREATE_WITH_FIXED_ATTR1(cp::time_type, time, simulationDuration, <span class="stringliteral">&quot;ms&quot;</span>);
<a name="l01691"></a>01691     <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().SimulationDuration().set(time);
<a name="l01692"></a>01692 }
<a name="l01693"></a>01693 
<a name="l01694"></a><a class="code" href="classHeartConfig.html#a6b0caf98b061c8f132b17d272fc6da2d">01694</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a6b0caf98b061c8f132b17d272fc6da2d">HeartConfig::SetDomain</a>(<span class="keyword">const</span> cp::domain_type&amp; rDomain)
<a name="l01695"></a>01695 {
<a name="l01696"></a>01696     <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().Domain().set(rDomain);
<a name="l01697"></a>01697 }
<a name="l01698"></a>01698 
<a name="l01699"></a><a class="code" href="classHeartConfig.html#a315563a68be5dd8d00824a2b556239d8">01699</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a315563a68be5dd8d00824a2b556239d8">HeartConfig::SetDefaultIonicModel</a>(<span class="keyword">const</span> cp::ionic_models_available_type&amp; rIonicModel)
<a name="l01700"></a>01700 {
<a name="l01701"></a>01701     cp::ionic_model_selection_type ionic_model;
<a name="l01702"></a>01702     ionic_model.Hardcoded(rIonicModel);
<a name="l01703"></a>01703     cp::ionic_models_type container(ionic_model);
<a name="l01704"></a>01704     <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().IonicModels().set(container);
<a name="l01705"></a>01705 }
<a name="l01706"></a>01706 
<a name="l01707"></a><a class="code" href="classHeartConfig.html#a81d05b3efe45ab56d22b304bbee0be38">01707</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a81d05b3efe45ab56d22b304bbee0be38">HeartConfig::SetSlabDimensions</a>(<span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y, <span class="keywordtype">double</span> z, <span class="keywordtype">double</span> inter_node_space)
<a name="l01708"></a>01708 {
<a name="l01709"></a>01709     <span class="keywordflow">if</span> ( ! <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().Mesh().present())
<a name="l01710"></a>01710     {
<a name="l01711"></a>01711         XSD_CREATE_WITH_FIXED_ATTR(cp::mesh_type, mesh_to_load, <span class="stringliteral">&quot;cm&quot;</span>);
<a name="l01712"></a>01712         <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().Mesh().set(mesh_to_load);
<a name="l01713"></a>01713     }
<a name="l01714"></a>01714 
<a name="l01715"></a>01715     cp::slab_type slab_definition(x, y, z, inter_node_space);
<a name="l01716"></a>01716     <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().Mesh().get().Slab().set(slab_definition);
<a name="l01717"></a>01717 }
<a name="l01718"></a>01718 
<a name="l01719"></a><a class="code" href="classHeartConfig.html#a39e7189e1725e0e48fd38e4bc6e06a8e">01719</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a39e7189e1725e0e48fd38e4bc6e06a8e">HeartConfig::SetSheetDimensions</a>(<span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y, <span class="keywordtype">double</span> inter_node_space)
<a name="l01720"></a>01720 {
<a name="l01721"></a>01721     <span class="keywordflow">if</span> ( ! <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().Mesh().present())
<a name="l01722"></a>01722     {
<a name="l01723"></a>01723         XSD_CREATE_WITH_FIXED_ATTR(cp::mesh_type, mesh_to_load, <span class="stringliteral">&quot;cm&quot;</span>);
<a name="l01724"></a>01724         <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().Mesh().set(mesh_to_load);
<a name="l01725"></a>01725     }
<a name="l01726"></a>01726 
<a name="l01727"></a>01727     cp::sheet_type sheet_definition(x, y, inter_node_space);
<a name="l01728"></a>01728     <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().Mesh().get().Sheet().set(sheet_definition);
<a name="l01729"></a>01729 }
<a name="l01730"></a>01730 
<a name="l01731"></a><a class="code" href="classHeartConfig.html#a41771ff2cdb9689d5dff43036b8261ec">01731</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a41771ff2cdb9689d5dff43036b8261ec">HeartConfig::SetFibreLength</a>(<span class="keywordtype">double</span> x, <span class="keywordtype">double</span> inter_node_space)
<a name="l01732"></a>01732 {
<a name="l01733"></a>01733     <span class="keywordflow">if</span> ( ! <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().Mesh().present())
<a name="l01734"></a>01734     {
<a name="l01735"></a>01735         XSD_CREATE_WITH_FIXED_ATTR(cp::mesh_type, mesh_to_load, <span class="stringliteral">&quot;cm&quot;</span>);
<a name="l01736"></a>01736         <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().Mesh().set(mesh_to_load);
<a name="l01737"></a>01737     }
<a name="l01738"></a>01738 
<a name="l01739"></a>01739     cp::fibre_type fibre_definition(x, inter_node_space);
<a name="l01740"></a>01740     <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().Mesh().get().Fibre().set(fibre_definition);
<a name="l01741"></a>01741 }
<a name="l01742"></a>01742 
<a name="l01743"></a><a class="code" href="classHeartConfig.html#adc7f04b8d3bdf6a734c45fd57ffbd16d">01743</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#adc7f04b8d3bdf6a734c45fd57ffbd16d">HeartConfig::SetMeshFileName</a>(std::string meshPrefix, cp::media_type fibreDefinition)
<a name="l01744"></a>01744 {
<a name="l01745"></a>01745     <span class="keywordflow">if</span> ( ! <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().Mesh().present())
<a name="l01746"></a>01746     {
<a name="l01747"></a>01747         XSD_CREATE_WITH_FIXED_ATTR(cp::mesh_type, mesh_to_load, <span class="stringliteral">&quot;cm&quot;</span>);
<a name="l01748"></a>01748         <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().Mesh().set(mesh_to_load);
<a name="l01749"></a>01749     }
<a name="l01750"></a>01750 
<a name="l01751"></a>01751     XSD_NESTED_TYPE(cp::mesh_type::LoadMesh) mesh_prefix(meshPrefix, fibreDefinition);
<a name="l01752"></a>01752     <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().Mesh().get().LoadMesh().set(mesh_prefix);
<a name="l01753"></a>01753 }
<a name="l01754"></a>01754 
<a name="l01755"></a><a class="code" href="classHeartConfig.html#a165a75e6d71355cfcea146b578a02969">01755</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a165a75e6d71355cfcea146b578a02969">HeartConfig::SetIonicModelRegions</a>(std::vector&lt;<a class="code" href="classChasteCuboid.html">ChasteCuboid&lt;3&gt;</a> &gt;&amp; rDefinedRegions,
<a name="l01756"></a>01756                                        std::vector&lt;cp::ionic_model_selection_type&gt;&amp; rIonicModels)<span class="keyword"> const</span>
<a name="l01757"></a>01757 <span class="keyword"></span>{
<a name="l01758"></a>01758     assert(rDefinedRegions.size() == rIonicModels.size());
<a name="l01760"></a>01760     XSD_SEQUENCE_TYPE(cp::ionic_models_type::Region)&amp;
<a name="l01761"></a>01761         regions = <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().IonicModels().get().Region();
<a name="l01762"></a>01762     regions.clear();
<a name="l01763"></a>01763     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> region_index=0; region_index&lt;rDefinedRegions.size(); region_index++)
<a name="l01764"></a>01764     {
<a name="l01765"></a>01765         cp::point_type point_a(rDefinedRegions[region_index].rGetLowerCorner()[0],
<a name="l01766"></a>01766                                rDefinedRegions[region_index].rGetLowerCorner()[1],
<a name="l01767"></a>01767                                rDefinedRegions[region_index].rGetLowerCorner()[2]);
<a name="l01768"></a>01768 
<a name="l01769"></a>01769         cp::point_type point_b(rDefinedRegions[region_index].rGetUpperCorner()[0],
<a name="l01770"></a>01770                                rDefinedRegions[region_index].rGetUpperCorner()[1],
<a name="l01771"></a>01771                                rDefinedRegions[region_index].rGetUpperCorner()[2]);
<a name="l01772"></a>01772 
<a name="l01773"></a>01773         XSD_CREATE_WITH_FIXED_ATTR(cp::location_type, locn, <span class="stringliteral">&quot;cm&quot;</span>);
<a name="l01774"></a>01774         locn.Cuboid().set(cp::box_type(point_a, point_b));
<a name="l01775"></a>01775 
<a name="l01776"></a>01776         cp::ionic_model_region_type region(rIonicModels[region_index], locn);
<a name="l01777"></a>01777         regions.push_back(region);
<a name="l01778"></a>01778     }
<a name="l01779"></a>01779 }
<a name="l01780"></a>01780 
<a name="l01781"></a><a class="code" href="classHeartConfig.html#a01032c61c01ec53085091fc3a36aa813">01781</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a01032c61c01ec53085091fc3a36aa813">HeartConfig::SetConductivityHeterogeneities</a>(std::vector&lt;<a class="code" href="classChasteCuboid.html">ChasteCuboid&lt;3&gt;</a> &gt;&amp; conductivityAreas,
<a name="l01782"></a>01782         std::vector&lt; c_vector&lt;double,3&gt; &gt;&amp; intraConductivities,
<a name="l01783"></a>01783         std::vector&lt; c_vector&lt;double,3&gt; &gt;&amp; extraConductivities)
<a name="l01784"></a>01784 {
<a name="l01785"></a>01785     assert ( conductivityAreas.size() == intraConductivities.size() );
<a name="l01786"></a>01786     assert ( intraConductivities.size() == extraConductivities.size());
<a name="l01787"></a>01787 
<a name="l01788"></a>01788     XSD_ANON_SEQUENCE_TYPE(cp::simulation_type, ConductivityHeterogeneities, ConductivityHeterogeneity) heterogeneities_container;
<a name="l01789"></a>01789 
<a name="l01790"></a>01790     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> region_index=0; region_index&lt;conductivityAreas.size(); region_index++)
<a name="l01791"></a>01791     {
<a name="l01792"></a>01792         cp::point_type point_a(conductivityAreas[region_index].rGetLowerCorner()[0],
<a name="l01793"></a>01793                            conductivityAreas[region_index].rGetLowerCorner()[1],
<a name="l01794"></a>01794                            conductivityAreas[region_index].rGetLowerCorner()[2]);
<a name="l01795"></a>01795 
<a name="l01796"></a>01796         cp::point_type point_b(conductivityAreas[region_index].rGetUpperCorner()[0],
<a name="l01797"></a>01797                            conductivityAreas[region_index].rGetUpperCorner()[1],
<a name="l01798"></a>01798                            conductivityAreas[region_index].rGetUpperCorner()[2]);
<a name="l01799"></a>01799 
<a name="l01800"></a>01800         XSD_CREATE_WITH_FIXED_ATTR(cp::location_type, locn, <span class="stringliteral">&quot;cm&quot;</span>);
<a name="l01801"></a>01801         locn.Cuboid().set(cp::box_type(point_a, point_b));
<a name="l01802"></a>01802         cp::conductivity_heterogeneity_type ht(locn);
<a name="l01803"></a>01803 
<a name="l01804"></a>01804         XSD_CREATE_WITH_FIXED_ATTR3(cp::conductivities_type, intra,
<a name="l01805"></a>01805                                     intraConductivities[region_index][0],
<a name="l01806"></a>01806                                     intraConductivities[region_index][1],
<a name="l01807"></a>01807                                     intraConductivities[region_index][2],
<a name="l01808"></a>01808                                     <span class="stringliteral">&quot;mS/cm&quot;</span>);
<a name="l01809"></a>01809 
<a name="l01810"></a>01810         ht.IntracellularConductivities(intra);
<a name="l01811"></a>01811 
<a name="l01812"></a>01812         XSD_CREATE_WITH_FIXED_ATTR3(cp::conductivities_type, extra,
<a name="l01813"></a>01813                                     extraConductivities[region_index][0],
<a name="l01814"></a>01814                                     extraConductivities[region_index][1],
<a name="l01815"></a>01815                                     extraConductivities[region_index][2],
<a name="l01816"></a>01816                                     <span class="stringliteral">&quot;mS/cm&quot;</span>);
<a name="l01817"></a>01817 
<a name="l01818"></a>01818         ht.ExtracellularConductivities(extra);
<a name="l01819"></a>01819 
<a name="l01820"></a>01820         heterogeneities_container.push_back(ht);
<a name="l01821"></a>01821     }
<a name="l01822"></a>01822 
<a name="l01823"></a>01823     XSD_ANON_TYPE(cp::simulation_type, ConductivityHeterogeneities) heterogeneities_object;
<a name="l01824"></a>01824     heterogeneities_object.ConductivityHeterogeneity(heterogeneities_container);
<a name="l01825"></a>01825 
<a name="l01826"></a>01826     <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().ConductivityHeterogeneities().set(heterogeneities_object);
<a name="l01827"></a>01827 }
<a name="l01828"></a>01828 
<a name="l01829"></a>01829 
<a name="l01830"></a><a class="code" href="classHeartConfig.html#a5f5d3c0f60554e91bf3f670ff3d8720a">01830</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a5f5d3c0f60554e91bf3f670ff3d8720a">HeartConfig::SetOutputDirectory</a>(<span class="keyword">const</span> std::string&amp; rOutputDirectory)
<a name="l01831"></a>01831 {
<a name="l01832"></a>01832     <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().OutputDirectory().set(rOutputDirectory);
<a name="l01833"></a>01833 }
<a name="l01834"></a>01834 
<a name="l01835"></a><a class="code" href="classHeartConfig.html#ad6379d55fd7badb2720eb3d6f4b98f3f">01835</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#ad6379d55fd7badb2720eb3d6f4b98f3f">HeartConfig::SetOutputFilenamePrefix</a>(<span class="keyword">const</span> std::string&amp; rOutputFilenamePrefix)
<a name="l01836"></a>01836 {
<a name="l01837"></a>01837     <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().OutputFilenamePrefix().set(rOutputFilenamePrefix);
<a name="l01838"></a>01838 }
<a name="l01839"></a>01839 
<a name="l01840"></a><a class="code" href="classHeartConfig.html#ab4327ce8948dfdc306daaa5b733d8b7a">01840</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#ab4327ce8948dfdc306daaa5b733d8b7a">HeartConfig::SetOutputVariables</a>(<span class="keyword">const</span> std::vector&lt;std::string&gt;&amp; rOutputVariables)
<a name="l01841"></a>01841 {
<a name="l01842"></a>01842     <span class="keywordflow">if</span> ( ! <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().OutputVariables().present())
<a name="l01843"></a>01843     {
<a name="l01844"></a>01844         cp::output_variables_type variables_requested;
<a name="l01845"></a>01845         <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().OutputVariables().set(variables_requested);
<a name="l01846"></a>01846     }
<a name="l01847"></a>01847 
<a name="l01848"></a>01848     XSD_SEQUENCE_TYPE(cp::output_variables_type::Var)&amp;
<a name="l01849"></a>01849     var_type_sequence = <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().OutputVariables()-&gt;Var();
<a name="l01850"></a>01850     <span class="comment">//Erase or create a sequence</span>
<a name="l01851"></a>01851     var_type_sequence.clear();
<a name="l01852"></a>01852 
<a name="l01853"></a>01853     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0; i&lt;rOutputVariables.size(); i++)
<a name="l01854"></a>01854     {
<a name="l01855"></a>01855         cp::var_type temp(rOutputVariables[i]);
<a name="l01856"></a>01856         var_type_sequence.push_back(temp);
<a name="l01857"></a>01857     }
<a name="l01858"></a>01858 
<a name="l01859"></a>01859     <span class="keywordflow">if</span> (rOutputVariables.size() &gt; 0)
<a name="l01860"></a>01860     {
<a name="l01861"></a>01861         <span class="comment">// Turn off Meshalyzer etc. output, to avoid errors</span>
<a name="l01862"></a>01862         <a class="code" href="classHeartConfig.html#a7ef84b9090f708031aac64b7504742e0">SetVisualizeWithMeshalyzer</a>(<span class="keyword">false</span>);
<a name="l01863"></a>01863         <a class="code" href="classHeartConfig.html#af1c744570c4f03ee01b52c62ca4ef40f">SetVisualizeWithCmgui</a>(<span class="keyword">false</span>);
<a name="l01864"></a>01864         <a class="code" href="classHeartConfig.html#aa64153e80db50c971a58069dd3e1350e">SetVisualizeWithVtk</a>(<span class="keyword">false</span>);
<a name="l01865"></a>01865     }
<a name="l01866"></a>01866 }
<a name="l01867"></a>01867 
<a name="l01868"></a><a class="code" href="classHeartConfig.html#ad7acbc17d4e8fbf7f3c8dcf17340afe4">01868</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#ad7acbc17d4e8fbf7f3c8dcf17340afe4">HeartConfig::SetCheckpointSimulation</a>(<span class="keywordtype">bool</span> saveSimulation, <span class="keywordtype">double</span> checkpointTimestep, <span class="keywordtype">unsigned</span> maxCheckpointsOnDisk)
<a name="l01869"></a>01869 {
<a name="l01870"></a>01870     <span class="keywordflow">if</span> (saveSimulation)
<a name="l01871"></a>01871     {
<a name="l01872"></a>01872         <span class="comment">// Make sure values for the optional parameters have been provided</span>
<a name="l01873"></a>01873         assert(checkpointTimestep!=-1.0 &amp;&amp; maxCheckpointsOnDisk!=UINT_MAX);
<a name="l01874"></a>01874 
<a name="l01875"></a>01875         XSD_CREATE_WITH_FIXED_ATTR2(cp::simulation_type::XSD_NESTED_TYPE(CheckpointSimulation),
<a name="l01876"></a>01876                                     cs,
<a name="l01877"></a>01877                                     checkpointTimestep,
<a name="l01878"></a>01878                                     maxCheckpointsOnDisk,
<a name="l01879"></a>01879                                     <span class="stringliteral">&quot;ms&quot;</span>);
<a name="l01880"></a>01880         <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().CheckpointSimulation().set(cs);
<a name="l01881"></a>01881     }
<a name="l01882"></a>01882     <span class="keywordflow">else</span>
<a name="l01883"></a>01883     {
<a name="l01884"></a>01884         <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().CheckpointSimulation().reset();
<a name="l01885"></a>01885     }
<a name="l01886"></a>01886 
<a name="l01887"></a>01887     <a class="code" href="classHeartConfig.html#aef79708e5e663a9ea5ff236ecc0bbd85">CheckTimeSteps</a>();
<a name="l01888"></a>01888 }
<a name="l01889"></a>01889 
<a name="l01890"></a>01890 <span class="comment">// Physiological</span>
<a name="l01891"></a><a class="code" href="classHeartConfig.html#a35da1ea1ef3ce125106bae9358431596">01891</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a35da1ea1ef3ce125106bae9358431596">HeartConfig::SetIntracellularConductivities</a>(<span class="keyword">const</span> c_vector&lt;double, 3&gt;&amp; intraConductivities)
<a name="l01892"></a>01892 {
<a name="l01893"></a>01893     XSD_CREATE_WITH_FIXED_ATTR3(cp::conductivities_type, intra,
<a name="l01894"></a>01894                                 intraConductivities[0],
<a name="l01895"></a>01895                                 intraConductivities[1],
<a name="l01896"></a>01896                                 intraConductivities[2],
<a name="l01897"></a>01897                                 <span class="stringliteral">&quot;mS/cm&quot;</span>);
<a name="l01898"></a>01898 
<a name="l01899"></a>01899     <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Physiological().IntracellularConductivities().set(intra);
<a name="l01900"></a>01900 }
<a name="l01901"></a>01901 
<a name="l01902"></a><a class="code" href="classHeartConfig.html#a8a40785fd7ea30b7b12ccaab5f611343">01902</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a35da1ea1ef3ce125106bae9358431596">HeartConfig::SetIntracellularConductivities</a>(<span class="keyword">const</span> c_vector&lt;double, 2&gt;&amp; intraConductivities)
<a name="l01903"></a>01903 {
<a name="l01904"></a>01904     XSD_CREATE_WITH_FIXED_ATTR3(cp::conductivities_type, intra,
<a name="l01905"></a>01905                                 intraConductivities[0],
<a name="l01906"></a>01906                                 intraConductivities[1],
<a name="l01907"></a>01907                                 0.0, <span class="stringliteral">&quot;mS/cm&quot;</span>);
<a name="l01908"></a>01908 
<a name="l01909"></a>01909     <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Physiological().IntracellularConductivities().set(intra);
<a name="l01910"></a>01910 }
<a name="l01911"></a>01911 
<a name="l01912"></a><a class="code" href="classHeartConfig.html#a1214dcdd413d88685a7abb38355f7cbd">01912</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a35da1ea1ef3ce125106bae9358431596">HeartConfig::SetIntracellularConductivities</a>(<span class="keyword">const</span> c_vector&lt;double, 1&gt;&amp; intraConductivities)
<a name="l01913"></a>01913 {
<a name="l01914"></a>01914     XSD_CREATE_WITH_FIXED_ATTR3(cp::conductivities_type, intra,
<a name="l01915"></a>01915                                 intraConductivities[0],
<a name="l01916"></a>01916                                 0.0, 0.0, <span class="stringliteral">&quot;mS/cm&quot;</span>);
<a name="l01917"></a>01917 
<a name="l01918"></a>01918     <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Physiological().IntracellularConductivities().set(intra);
<a name="l01919"></a>01919 }
<a name="l01920"></a>01920 
<a name="l01921"></a><a class="code" href="classHeartConfig.html#a72ffd007fa86e2674cba71372eea6f62">01921</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a72ffd007fa86e2674cba71372eea6f62">HeartConfig::SetExtracellularConductivities</a>(<span class="keyword">const</span> c_vector&lt;double, 3&gt;&amp; extraConductivities)
<a name="l01922"></a>01922 {
<a name="l01923"></a>01923     XSD_CREATE_WITH_FIXED_ATTR3(cp::conductivities_type, extra,
<a name="l01924"></a>01924                                 extraConductivities[0],
<a name="l01925"></a>01925                                 extraConductivities[1],
<a name="l01926"></a>01926                                 extraConductivities[2],
<a name="l01927"></a>01927                                 <span class="stringliteral">&quot;mS/cm&quot;</span>);
<a name="l01928"></a>01928 
<a name="l01929"></a>01929     <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Physiological().ExtracellularConductivities().set(extra);
<a name="l01930"></a>01930 }
<a name="l01931"></a>01931 
<a name="l01932"></a><a class="code" href="classHeartConfig.html#a8b74b37169ff0fe519b1ca25f5d95341">01932</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a72ffd007fa86e2674cba71372eea6f62">HeartConfig::SetExtracellularConductivities</a>(<span class="keyword">const</span> c_vector&lt;double, 2&gt;&amp; extraConductivities)
<a name="l01933"></a>01933 {
<a name="l01934"></a>01934     XSD_CREATE_WITH_FIXED_ATTR3(cp::conductivities_type, extra,
<a name="l01935"></a>01935                                 extraConductivities[0],
<a name="l01936"></a>01936                                 extraConductivities[1],
<a name="l01937"></a>01937                                 0.0, <span class="stringliteral">&quot;mS/cm&quot;</span>);
<a name="l01938"></a>01938 
<a name="l01939"></a>01939     <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Physiological().ExtracellularConductivities().set(extra);
<a name="l01940"></a>01940 }
<a name="l01941"></a>01941 
<a name="l01942"></a><a class="code" href="classHeartConfig.html#ab3268f98a8a3112f097ac216e770e1ac">01942</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a72ffd007fa86e2674cba71372eea6f62">HeartConfig::SetExtracellularConductivities</a>(<span class="keyword">const</span> c_vector&lt;double, 1&gt;&amp; extraConductivities)
<a name="l01943"></a>01943 {
<a name="l01944"></a>01944     XSD_CREATE_WITH_FIXED_ATTR3(cp::conductivities_type, extra,
<a name="l01945"></a>01945                                 extraConductivities[0],
<a name="l01946"></a>01946                                 0.0, 0.0, <span class="stringliteral">&quot;mS/cm&quot;</span>);
<a name="l01947"></a>01947 
<a name="l01948"></a>01948     <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Physiological().ExtracellularConductivities().set(extra);
<a name="l01949"></a>01949 }
<a name="l01950"></a>01950 
<a name="l01951"></a><a class="code" href="classHeartConfig.html#a994cb2f7b3edc1c45ba43fc967a98a8a">01951</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a994cb2f7b3edc1c45ba43fc967a98a8a">HeartConfig::SetBathConductivity</a>(<span class="keywordtype">double</span> bathConductivity)
<a name="l01952"></a>01952 {
<a name="l01953"></a>01953     XSD_CREATE_WITH_FIXED_ATTR1(cp::conductivity_type, cond, bathConductivity, <span class="stringliteral">&quot;mS/cm&quot;</span>);
<a name="l01954"></a>01954     <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Physiological().BathConductivity().set(cond);
<a name="l01955"></a>01955 }
<a name="l01956"></a>01956 
<a name="l01957"></a><a class="code" href="classHeartConfig.html#a8a91b9567843043c5b9f1d05779816a9">01957</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a8a91b9567843043c5b9f1d05779816a9">HeartConfig::SetSurfaceAreaToVolumeRatio</a>(<span class="keywordtype">double</span> ratio)
<a name="l01958"></a>01958 {
<a name="l01959"></a>01959     XSD_CREATE_WITH_FIXED_ATTR1(cp::inverse_length_type, ratio_object, ratio, <span class="stringliteral">&quot;1/cm&quot;</span>);
<a name="l01960"></a>01960     <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Physiological().SurfaceAreaToVolumeRatio().set(ratio_object);
<a name="l01961"></a>01961 }
<a name="l01962"></a>01962 
<a name="l01963"></a><a class="code" href="classHeartConfig.html#aaed8e9a14106071416be8e010fed3875">01963</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#aaed8e9a14106071416be8e010fed3875">HeartConfig::SetCapacitance</a>(<span class="keywordtype">double</span> capacitance)
<a name="l01964"></a>01964 {
<a name="l01965"></a>01965     XSD_CREATE_WITH_FIXED_ATTR1(cp::capacitance_type, capacitance_object, capacitance, <span class="stringliteral">&quot;uF/cm^2&quot;</span>);
<a name="l01966"></a>01966     <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Physiological().Capacitance().set(capacitance_object);
<a name="l01967"></a>01967 }
<a name="l01968"></a>01968 
<a name="l01969"></a>01969 
<a name="l01970"></a>01970 <span class="comment">// Numerical</span>
<a name="l01971"></a><a class="code" href="classHeartConfig.html#afae11c8b1e28bbe357b62a6aff92ed26">01971</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#afae11c8b1e28bbe357b62a6aff92ed26">HeartConfig::SetOdePdeAndPrintingTimeSteps</a>(<span class="keywordtype">double</span> odeTimeStep, <span class="keywordtype">double</span> pdeTimeStep, <span class="keywordtype">double</span> printingTimeStep)
<a name="l01972"></a>01972 {
<a name="l01973"></a>01973     XSD_CREATE_WITH_FIXED_ATTR3(cp::time_steps_type, time_steps,
<a name="l01974"></a>01974                                 odeTimeStep, pdeTimeStep, printingTimeStep, <span class="stringliteral">&quot;ms&quot;</span>);
<a name="l01975"></a>01975     <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().TimeSteps().set(time_steps);
<a name="l01976"></a>01976     <a class="code" href="classHeartConfig.html#aef79708e5e663a9ea5ff236ecc0bbd85">CheckTimeSteps</a>();
<a name="l01977"></a>01977 }
<a name="l01978"></a>01978 
<a name="l01979"></a><a class="code" href="classHeartConfig.html#a937009fb9049e72e963d21a9962d2d2f">01979</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a937009fb9049e72e963d21a9962d2d2f">HeartConfig::SetOdeTimeStep</a>(<span class="keywordtype">double</span> odeTimeStep)
<a name="l01980"></a>01980 {
<a name="l01981"></a>01981     <a class="code" href="classHeartConfig.html#afae11c8b1e28bbe357b62a6aff92ed26">SetOdePdeAndPrintingTimeSteps</a>(odeTimeStep, <a class="code" href="classHeartConfig.html#ac20bbc4140281b206a260a82cb59ab0f">GetPdeTimeStep</a>(), <a class="code" href="classHeartConfig.html#a33ae21f4b16476aa5cb975a455c5ba19">GetPrintingTimeStep</a>());
<a name="l01982"></a>01982 }
<a name="l01983"></a>01983 
<a name="l01984"></a><a class="code" href="classHeartConfig.html#a7f6b79cb359a97a70ab489d6eebc3183">01984</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a7f6b79cb359a97a70ab489d6eebc3183">HeartConfig::SetPdeTimeStep</a>(<span class="keywordtype">double</span> pdeTimeStep)
<a name="l01985"></a>01985 {
<a name="l01986"></a>01986     <a class="code" href="classHeartConfig.html#afae11c8b1e28bbe357b62a6aff92ed26">SetOdePdeAndPrintingTimeSteps</a>(<a class="code" href="classHeartConfig.html#a383ab1c116a88ecd3f973ef371a2c8d9">GetOdeTimeStep</a>(), pdeTimeStep, <a class="code" href="classHeartConfig.html#a33ae21f4b16476aa5cb975a455c5ba19">GetPrintingTimeStep</a>());
<a name="l01987"></a>01987 }
<a name="l01988"></a>01988 
<a name="l01989"></a><a class="code" href="classHeartConfig.html#a3b331a2888f584fdcf391e012bb36062">01989</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a3b331a2888f584fdcf391e012bb36062">HeartConfig::SetPrintingTimeStep</a>(<span class="keywordtype">double</span> printingTimeStep)
<a name="l01990"></a>01990 {
<a name="l01991"></a>01991     <a class="code" href="classHeartConfig.html#afae11c8b1e28bbe357b62a6aff92ed26">SetOdePdeAndPrintingTimeSteps</a>(<a class="code" href="classHeartConfig.html#a383ab1c116a88ecd3f973ef371a2c8d9">GetOdeTimeStep</a>(), <a class="code" href="classHeartConfig.html#ac20bbc4140281b206a260a82cb59ab0f">GetPdeTimeStep</a>(), printingTimeStep);
<a name="l01992"></a>01992 }
<a name="l01993"></a>01993 
<a name="l01994"></a><a class="code" href="classHeartConfig.html#aef79708e5e663a9ea5ff236ecc0bbd85">01994</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#aef79708e5e663a9ea5ff236ecc0bbd85">HeartConfig::CheckTimeSteps</a>()<span class="keyword"> const</span>
<a name="l01995"></a>01995 <span class="keyword"></span>{
<a name="l01996"></a>01996     <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#a383ab1c116a88ecd3f973ef371a2c8d9">GetOdeTimeStep</a>() &lt;= 0)
<a name="l01997"></a>01997     {
<a name="l01998"></a>01998         EXCEPTION(<span class="stringliteral">&quot;Ode time-step should be positive&quot;</span>);
<a name="l01999"></a>01999     }
<a name="l02000"></a>02000     <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#ac20bbc4140281b206a260a82cb59ab0f">GetPdeTimeStep</a>() &lt;= 0)
<a name="l02001"></a>02001     {
<a name="l02002"></a>02002         EXCEPTION(<span class="stringliteral">&quot;Pde time-step should be positive&quot;</span>);
<a name="l02003"></a>02003     }
<a name="l02004"></a>02004     <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#a33ae21f4b16476aa5cb975a455c5ba19">GetPrintingTimeStep</a>() &lt;= 0.0)
<a name="l02005"></a>02005     {
<a name="l02006"></a>02006         EXCEPTION(<span class="stringliteral">&quot;Printing time-step should be positive&quot;</span>);
<a name="l02007"></a>02007     }
<a name="l02008"></a>02008 
<a name="l02009"></a>02009     <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#ac20bbc4140281b206a260a82cb59ab0f">GetPdeTimeStep</a>()&gt;<a class="code" href="classHeartConfig.html#a33ae21f4b16476aa5cb975a455c5ba19">GetPrintingTimeStep</a>())
<a name="l02010"></a>02010     {
<a name="l02011"></a>02011         EXCEPTION(<span class="stringliteral">&quot;Printing time-step should not be smaller than PDE time-step&quot;</span>);
<a name="l02012"></a>02012     }
<a name="l02013"></a>02013 
<a name="l02014"></a>02014     <span class="comment">//If pde divides printing then the floating remainder ought to be close to</span>
<a name="l02015"></a>02015     <span class="comment">//zero(+a smidge) or pde-a smidge</span>
<a name="l02016"></a>02016     <span class="keywordtype">double</span> remainder=fmod(<a class="code" href="classHeartConfig.html#a33ae21f4b16476aa5cb975a455c5ba19">GetPrintingTimeStep</a>(), <a class="code" href="classHeartConfig.html#ac20bbc4140281b206a260a82cb59ab0f">GetPdeTimeStep</a>());
<a name="l02017"></a>02017 
<a name="l02018"></a>02018     <span class="keywordflow">if</span> ( remainder &gt; DBL_EPSILON &amp;&amp; remainder &lt; <a class="code" href="classHeartConfig.html#ac20bbc4140281b206a260a82cb59ab0f">GetPdeTimeStep</a>()-DBL_EPSILON)
<a name="l02019"></a>02019     {
<a name="l02020"></a>02020         EXCEPTION(<span class="stringliteral">&quot;Printing time-step should be a multiple of PDE time step&quot;</span>);
<a name="l02021"></a>02021     }
<a name="l02022"></a>02022 
<a name="l02023"></a>02023     <span class="keywordflow">if</span> ( <a class="code" href="classHeartConfig.html#a383ab1c116a88ecd3f973ef371a2c8d9">GetOdeTimeStep</a>() &gt; <a class="code" href="classHeartConfig.html#ac20bbc4140281b206a260a82cb59ab0f">GetPdeTimeStep</a>() )
<a name="l02024"></a>02024     {
<a name="l02025"></a>02025         EXCEPTION(<span class="stringliteral">&quot;Ode time-step should not be greater than PDE time-step&quot;</span>);
<a name="l02026"></a>02026     }
<a name="l02027"></a>02027 
<a name="l02028"></a>02028     <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#a34e25b3a25618f0f8721c678e6b12f95">GetCheckpointSimulation</a>())
<a name="l02029"></a>02029     {
<a name="l02030"></a>02030         <span class="keywordflow">if</span> (<a class="code" href="classHeartConfig.html#a80bb45c8945a0a3b98b5a1151d79143a">GetCheckpointTimestep</a>() &lt;= 0.0)
<a name="l02031"></a>02031         {
<a name="l02032"></a>02032             EXCEPTION(<span class="stringliteral">&quot;Checkpoint time-step should be positive&quot;</span>);
<a name="l02033"></a>02033         }
<a name="l02034"></a>02034 
<a name="l02035"></a>02035         <span class="comment">//If printing divides checkpoint then the floating remainder ought to be close to</span>
<a name="l02036"></a>02036         <span class="comment">//zero(+a smidge) or pde-a smidge</span>
<a name="l02037"></a>02037         <span class="keywordtype">double</span> remainder_checkpoint_over_printing=fmod(<a class="code" href="classHeartConfig.html#a80bb45c8945a0a3b98b5a1151d79143a">GetCheckpointTimestep</a>(), <a class="code" href="classHeartConfig.html#a33ae21f4b16476aa5cb975a455c5ba19">GetPrintingTimeStep</a>());
<a name="l02038"></a>02038 
<a name="l02039"></a>02039         <span class="comment">// I (migb) had to scale DBL_EPSILON because the comparison wasn&#39;t working properly with GetCheckpointTimestep()=10.0 GetPrintingTimeStep()=0.1</span>
<a name="l02040"></a>02040         <span class="keywordflow">if</span> ( remainder_checkpoint_over_printing &gt; DBL_EPSILON &amp;&amp; remainder_checkpoint_over_printing &lt; <a class="code" href="classHeartConfig.html#a33ae21f4b16476aa5cb975a455c5ba19">GetPrintingTimeStep</a>()-DBL_EPSILON*(1/<a class="code" href="classHeartConfig.html#a33ae21f4b16476aa5cb975a455c5ba19">GetPrintingTimeStep</a>()))
<a name="l02041"></a>02041         {
<a name="l02042"></a>02042             EXCEPTION(<span class="stringliteral">&quot;Checkpoint time-step should be a multiple of printing time-step&quot;</span>);
<a name="l02043"></a>02043         }
<a name="l02044"></a>02044     }
<a name="l02045"></a>02045 }
<a name="l02046"></a>02046 
<a name="l02047"></a>02047 
<a name="l02048"></a><a class="code" href="classHeartConfig.html#a7af488fdbe5832371862ac122a174f2f">02048</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a7af488fdbe5832371862ac122a174f2f">HeartConfig::SetUseRelativeTolerance</a>(<span class="keywordtype">double</span> relativeTolerance)
<a name="l02049"></a>02049 {
<a name="l02050"></a>02050     <span class="comment">//Remove any reference to tolerances is user parameters</span>
<a name="l02051"></a>02051     <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().KSPTolerances().get().KSPAbsolute().reset();
<a name="l02052"></a>02052     <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().KSPTolerances().get().KSPRelative().set(relativeTolerance);
<a name="l02053"></a>02053 }
<a name="l02054"></a>02054 
<a name="l02055"></a><a class="code" href="classHeartConfig.html#a8d20fbbb42fd8f8d6afcc725f2b10acf">02055</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a8d20fbbb42fd8f8d6afcc725f2b10acf">HeartConfig::SetUseAbsoluteTolerance</a>(<span class="keywordtype">double</span> absoluteTolerance)
<a name="l02056"></a>02056 {
<a name="l02057"></a>02057     <span class="comment">//Remove any reference to tolerances is user parameters</span>
<a name="l02058"></a>02058     <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().KSPTolerances().get().KSPRelative().reset();
<a name="l02059"></a>02059     <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().KSPTolerances().get().KSPAbsolute().set(absoluteTolerance);
<a name="l02060"></a>02060 }
<a name="l02061"></a>02061 
<a name="l02062"></a><a class="code" href="classHeartConfig.html#a27906b4c0d83289b5779236fbcb27b4b">02062</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a27906b4c0d83289b5779236fbcb27b4b">HeartConfig::SetKSPSolver</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* kspSolver)
<a name="l02063"></a>02063 {
<a name="l02064"></a>02064     <span class="comment">/* Note that changes in these conditions need to be reflected in the Doxygen*/</span>
<a name="l02065"></a>02065     <span class="keywordflow">if</span> ( strcmp(kspSolver, <span class="stringliteral">&quot;gmres&quot;</span>) == 0)
<a name="l02066"></a>02066     {
<a name="l02067"></a>02067         <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().KSPSolver().set(cp::ksp_solver_type::gmres);
<a name="l02068"></a>02068         <span class="keywordflow">return</span>;
<a name="l02069"></a>02069     }
<a name="l02070"></a>02070     <span class="keywordflow">if</span> ( strcmp(kspSolver, <span class="stringliteral">&quot;cg&quot;</span>) == 0)
<a name="l02071"></a>02071     {
<a name="l02072"></a>02072         <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().KSPSolver().set(cp::ksp_solver_type::cg);
<a name="l02073"></a>02073         <span class="keywordflow">return</span>;
<a name="l02074"></a>02074     }
<a name="l02075"></a>02075     <span class="keywordflow">if</span> ( strcmp(kspSolver, <span class="stringliteral">&quot;symmlq&quot;</span>) == 0)
<a name="l02076"></a>02076     {
<a name="l02077"></a>02077         <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().KSPSolver().set(cp::ksp_solver_type::symmlq);
<a name="l02078"></a>02078         <span class="keywordflow">return</span>;
<a name="l02079"></a>02079     }
<a name="l02080"></a>02080 
<a name="l02081"></a>02081     EXCEPTION(<span class="stringliteral">&quot;Unknown solver type provided&quot;</span>);
<a name="l02082"></a>02082 }
<a name="l02083"></a>02083 
<a name="l02084"></a><a class="code" href="classHeartConfig.html#a913a9b2cab5c9223e61ec8033c60c20d">02084</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a913a9b2cab5c9223e61ec8033c60c20d">HeartConfig::SetKSPPreconditioner</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* kspPreconditioner)
<a name="l02085"></a>02085 {
<a name="l02086"></a>02086     <span class="comment">/* Note that changes in these conditions need to be reflected in the Doxygen*/</span>
<a name="l02087"></a>02087     <span class="keywordflow">if</span> ( strcmp(kspPreconditioner, <span class="stringliteral">&quot;ilu&quot;</span>) == 0)
<a name="l02088"></a>02088     {
<a name="l02089"></a>02089         <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().KSPPreconditioner().set(cp::ksp_preconditioner_type::ilu);
<a name="l02090"></a>02090         <span class="keywordflow">return</span>;
<a name="l02091"></a>02091     }
<a name="l02092"></a>02092     <span class="keywordflow">if</span> ( strcmp(kspPreconditioner, <span class="stringliteral">&quot;jacobi&quot;</span>) == 0)
<a name="l02093"></a>02093     {
<a name="l02094"></a>02094         <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().KSPPreconditioner().set(cp::ksp_preconditioner_type::jacobi);
<a name="l02095"></a>02095         <span class="keywordflow">return</span>;
<a name="l02096"></a>02096     }
<a name="l02097"></a>02097     <span class="keywordflow">if</span> ( strcmp(kspPreconditioner, <span class="stringliteral">&quot;bjacobi&quot;</span>) == 0)
<a name="l02098"></a>02098     {
<a name="l02099"></a>02099         <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().KSPPreconditioner().set(cp::ksp_preconditioner_type::bjacobi);
<a name="l02100"></a>02100         <span class="keywordflow">return</span>;
<a name="l02101"></a>02101     }
<a name="l02102"></a>02102     <span class="keywordflow">if</span> ( strcmp(kspPreconditioner, <span class="stringliteral">&quot;hypre&quot;</span>) == 0)
<a name="l02103"></a>02103     {
<a name="l02104"></a>02104         <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().KSPPreconditioner().set(cp::ksp_preconditioner_type::hypre);
<a name="l02105"></a>02105         <span class="keywordflow">return</span>;
<a name="l02106"></a>02106     }
<a name="l02107"></a>02107     <span class="keywordflow">if</span> ( strcmp(kspPreconditioner, <span class="stringliteral">&quot;ml&quot;</span>) == 0)
<a name="l02108"></a>02108     {
<a name="l02109"></a>02109         <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().KSPPreconditioner().set(cp::ksp_preconditioner_type::ml);
<a name="l02110"></a>02110         <span class="keywordflow">return</span>;
<a name="l02111"></a>02111     }
<a name="l02112"></a>02112     <span class="keywordflow">if</span> ( strcmp(kspPreconditioner, <span class="stringliteral">&quot;spai&quot;</span>) == 0)
<a name="l02113"></a>02113     {
<a name="l02114"></a>02114         <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().KSPPreconditioner().set(cp::ksp_preconditioner_type::spai);
<a name="l02115"></a>02115         <span class="keywordflow">return</span>;
<a name="l02116"></a>02116     }
<a name="l02117"></a>02117     <span class="keywordflow">if</span> ( strcmp(kspPreconditioner, <span class="stringliteral">&quot;blockdiagonal&quot;</span>) == 0)
<a name="l02118"></a>02118     {
<a name="l02119"></a>02119         <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().KSPPreconditioner().set(cp::ksp_preconditioner_type::blockdiagonal);
<a name="l02120"></a>02120         <span class="keywordflow">return</span>;
<a name="l02121"></a>02121     }
<a name="l02122"></a>02122     <span class="keywordflow">if</span> ( strcmp(kspPreconditioner, <span class="stringliteral">&quot;ldufactorisation&quot;</span>) == 0)
<a name="l02123"></a>02123     {
<a name="l02124"></a>02124         <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().KSPPreconditioner().set(cp::ksp_preconditioner_type::ldufactorisation);
<a name="l02125"></a>02125         <span class="keywordflow">return</span>;
<a name="l02126"></a>02126     }
<a name="l02127"></a>02127     <span class="keywordflow">if</span> ( strcmp(kspPreconditioner, <span class="stringliteral">&quot;none&quot;</span>) == 0)
<a name="l02128"></a>02128     {
<a name="l02129"></a>02129         <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().KSPPreconditioner().set(cp::ksp_preconditioner_type::none);
<a name="l02130"></a>02130         <span class="keywordflow">return</span>;
<a name="l02131"></a>02131     }
<a name="l02132"></a>02132 
<a name="l02133"></a>02133     EXCEPTION(<span class="stringliteral">&quot;Unknown preconditioner type provided&quot;</span>);
<a name="l02134"></a>02134 }
<a name="l02135"></a>02135 
<a name="l02136"></a><a class="code" href="classHeartConfig.html#aeaa1ff9d97c84353beaced74801b0677">02136</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#aeaa1ff9d97c84353beaced74801b0677">HeartConfig::SetAdaptivityParameters</a>(<span class="keywordtype">double</span> targetError,
<a name="l02137"></a>02137                                           <span class="keywordtype">double</span> sigma,
<a name="l02138"></a>02138                                           <span class="keywordtype">double</span> maxEdgeLength,
<a name="l02139"></a>02139                                           <span class="keywordtype">double</span> minEdgeLength,
<a name="l02140"></a>02140                                           <span class="keywordtype">double</span> gradation,
<a name="l02141"></a>02141                                           <span class="keywordtype">unsigned</span> maxNodes,
<a name="l02142"></a>02142                                           <span class="keywordtype">unsigned</span> numSweeps )
<a name="l02143"></a>02143 {
<a name="l02144"></a>02144     <span class="keywordflow">if</span> ( maxEdgeLength &lt; minEdgeLength )
<a name="l02145"></a>02145     {
<a name="l02146"></a>02146         EXCEPTION(<span class="stringliteral">&quot;AdaptivityParameters: maxEdgeLength must be greater than minEdgeLength.&quot;</span>);
<a name="l02147"></a>02147     }
<a name="l02148"></a>02148     <span class="keywordflow">if</span> (!<a class="code" href="classHeartConfig.html#afacc6a848f43660c4cccfd9b66cc0df2">IsAdaptivityParametersPresent</a>())
<a name="l02149"></a>02149     {
<a name="l02150"></a>02150         cp::adaptivity_parameters_type element(targetError,
<a name="l02151"></a>02151                                                sigma,
<a name="l02152"></a>02152                                                maxEdgeLength,
<a name="l02153"></a>02153                                                minEdgeLength,
<a name="l02154"></a>02154                                                gradation,
<a name="l02155"></a>02155                                                maxNodes,
<a name="l02156"></a>02156                                                numSweeps );
<a name="l02157"></a>02157         <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().AdaptivityParameters().set(element);
<a name="l02158"></a>02158     }
<a name="l02159"></a>02159     <span class="keywordflow">else</span>
<a name="l02160"></a>02160     {
<a name="l02161"></a>02161         <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().AdaptivityParameters().get().target_error(targetError);
<a name="l02162"></a>02162         <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().AdaptivityParameters().get().sigma(sigma);
<a name="l02163"></a>02163         <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().AdaptivityParameters().get().max_edge_length(maxEdgeLength);
<a name="l02164"></a>02164         <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().AdaptivityParameters().get().min_edge_length(minEdgeLength);
<a name="l02165"></a>02165         <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().AdaptivityParameters().get().gradation(gradation);
<a name="l02166"></a>02166         <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().AdaptivityParameters().get().max_nodes(maxNodes);
<a name="l02167"></a>02167         <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Numerical().AdaptivityParameters().get().num_sweeps(numSweeps);
<a name="l02168"></a>02168     }
<a name="l02169"></a>02169 }
<a name="l02170"></a>02170 
<a name="l02171"></a><a class="code" href="classHeartConfig.html#af61472d0d68690001248a53021136ede">02171</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#af61472d0d68690001248a53021136ede">HeartConfig::SetTargetErrorForAdaptivity</a>(<span class="keywordtype">double</span> targetError)
<a name="l02172"></a>02172 {
<a name="l02173"></a>02173     <a class="code" href="classHeartConfig.html#aeaa1ff9d97c84353beaced74801b0677">SetAdaptivityParameters</a>( targetError,
<a name="l02174"></a>02174                              <a class="code" href="classHeartConfig.html#a66fc480d24bc9f8535c89cccd989f9af">GetSigmaForAdaptivity</a>(),
<a name="l02175"></a>02175                              <a class="code" href="classHeartConfig.html#a89155d1726cbe35f76ade0648e769a4d">GetMaxEdgeLengthForAdaptivity</a>(),
<a name="l02176"></a>02176                              <a class="code" href="classHeartConfig.html#adcae58747ee8057177bc063ce4b9cc3b">GetMinEdgeLengthForAdaptivity</a>(),
<a name="l02177"></a>02177                              <a class="code" href="classHeartConfig.html#aa5bca3744b53e11ec99ad2f3dc259600">GetGradationForAdaptivity</a>(),
<a name="l02178"></a>02178                              <a class="code" href="classHeartConfig.html#a4e47a91fa230dda4fb4a708b546c5c2e">GetMaxNodesForAdaptivity</a>(),
<a name="l02179"></a>02179                              <a class="code" href="classHeartConfig.html#a2dd2113b9c0b0ec6e1f86de50727cbf2">GetNumberOfAdaptiveSweeps</a>() );
<a name="l02180"></a>02180 }
<a name="l02181"></a>02181 
<a name="l02182"></a><a class="code" href="classHeartConfig.html#a808a698e410f90ca8ba2672987a9251f">02182</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a808a698e410f90ca8ba2672987a9251f">HeartConfig::SetSigmaForAdaptivity</a>(<span class="keywordtype">double</span> sigma)
<a name="l02183"></a>02183 {
<a name="l02184"></a>02184     <a class="code" href="classHeartConfig.html#aeaa1ff9d97c84353beaced74801b0677">SetAdaptivityParameters</a>( <a class="code" href="classHeartConfig.html#a10bc06efde462cf251767739cd1b69ac">GetTargetErrorForAdaptivity</a>(),
<a name="l02185"></a>02185                              sigma,
<a name="l02186"></a>02186                              <a class="code" href="classHeartConfig.html#a89155d1726cbe35f76ade0648e769a4d">GetMaxEdgeLengthForAdaptivity</a>(),
<a name="l02187"></a>02187                              <a class="code" href="classHeartConfig.html#adcae58747ee8057177bc063ce4b9cc3b">GetMinEdgeLengthForAdaptivity</a>(),
<a name="l02188"></a>02188                              <a class="code" href="classHeartConfig.html#aa5bca3744b53e11ec99ad2f3dc259600">GetGradationForAdaptivity</a>(),
<a name="l02189"></a>02189                              <a class="code" href="classHeartConfig.html#a4e47a91fa230dda4fb4a708b546c5c2e">GetMaxNodesForAdaptivity</a>(),
<a name="l02190"></a>02190                              <a class="code" href="classHeartConfig.html#a2dd2113b9c0b0ec6e1f86de50727cbf2">GetNumberOfAdaptiveSweeps</a>() );
<a name="l02191"></a>02191 }
<a name="l02192"></a>02192 
<a name="l02193"></a><a class="code" href="classHeartConfig.html#a69b52a18a321d7c42e03e25828fffd81">02193</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a69b52a18a321d7c42e03e25828fffd81">HeartConfig::SetMaxEdgeLengthForAdaptivity</a>(<span class="keywordtype">double</span> maxEdgeLength)
<a name="l02194"></a>02194 {
<a name="l02195"></a>02195     <a class="code" href="classHeartConfig.html#aeaa1ff9d97c84353beaced74801b0677">SetAdaptivityParameters</a>( <a class="code" href="classHeartConfig.html#a10bc06efde462cf251767739cd1b69ac">GetTargetErrorForAdaptivity</a>(),
<a name="l02196"></a>02196                              <a class="code" href="classHeartConfig.html#a66fc480d24bc9f8535c89cccd989f9af">GetSigmaForAdaptivity</a>(),
<a name="l02197"></a>02197                              maxEdgeLength,
<a name="l02198"></a>02198                              <a class="code" href="classHeartConfig.html#adcae58747ee8057177bc063ce4b9cc3b">GetMinEdgeLengthForAdaptivity</a>(),
<a name="l02199"></a>02199                              <a class="code" href="classHeartConfig.html#aa5bca3744b53e11ec99ad2f3dc259600">GetGradationForAdaptivity</a>(),
<a name="l02200"></a>02200                              <a class="code" href="classHeartConfig.html#a4e47a91fa230dda4fb4a708b546c5c2e">GetMaxNodesForAdaptivity</a>(),
<a name="l02201"></a>02201                              <a class="code" href="classHeartConfig.html#a2dd2113b9c0b0ec6e1f86de50727cbf2">GetNumberOfAdaptiveSweeps</a>() );
<a name="l02202"></a>02202 }
<a name="l02203"></a>02203 
<a name="l02204"></a><a class="code" href="classHeartConfig.html#adb6d52afd86ecb6af18e8edbc90c4823">02204</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#adb6d52afd86ecb6af18e8edbc90c4823">HeartConfig::SetMinEdgeLengthForAdaptivity</a>(<span class="keywordtype">double</span> minEdgeLength)
<a name="l02205"></a>02205 {
<a name="l02206"></a>02206     <a class="code" href="classHeartConfig.html#aeaa1ff9d97c84353beaced74801b0677">SetAdaptivityParameters</a>( <a class="code" href="classHeartConfig.html#a10bc06efde462cf251767739cd1b69ac">GetTargetErrorForAdaptivity</a>(),
<a name="l02207"></a>02207                              <a class="code" href="classHeartConfig.html#a66fc480d24bc9f8535c89cccd989f9af">GetSigmaForAdaptivity</a>(),
<a name="l02208"></a>02208                              <a class="code" href="classHeartConfig.html#a89155d1726cbe35f76ade0648e769a4d">GetMaxEdgeLengthForAdaptivity</a>(),
<a name="l02209"></a>02209                              minEdgeLength,
<a name="l02210"></a>02210                              <a class="code" href="classHeartConfig.html#aa5bca3744b53e11ec99ad2f3dc259600">GetGradationForAdaptivity</a>(),
<a name="l02211"></a>02211                              <a class="code" href="classHeartConfig.html#a4e47a91fa230dda4fb4a708b546c5c2e">GetMaxNodesForAdaptivity</a>(),
<a name="l02212"></a>02212                              <a class="code" href="classHeartConfig.html#a2dd2113b9c0b0ec6e1f86de50727cbf2">GetNumberOfAdaptiveSweeps</a>() );
<a name="l02213"></a>02213 }
<a name="l02214"></a>02214 
<a name="l02215"></a><a class="code" href="classHeartConfig.html#af40cdcdc016ed78ab75eda3ba4aebbf6">02215</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#af40cdcdc016ed78ab75eda3ba4aebbf6">HeartConfig::SetGradationForAdaptivity</a>(<span class="keywordtype">double</span> gradation)
<a name="l02216"></a>02216 {
<a name="l02217"></a>02217     <a class="code" href="classHeartConfig.html#aeaa1ff9d97c84353beaced74801b0677">SetAdaptivityParameters</a>( <a class="code" href="classHeartConfig.html#a10bc06efde462cf251767739cd1b69ac">GetTargetErrorForAdaptivity</a>(),
<a name="l02218"></a>02218                              <a class="code" href="classHeartConfig.html#a66fc480d24bc9f8535c89cccd989f9af">GetSigmaForAdaptivity</a>(),
<a name="l02219"></a>02219                              <a class="code" href="classHeartConfig.html#a89155d1726cbe35f76ade0648e769a4d">GetMaxEdgeLengthForAdaptivity</a>(),
<a name="l02220"></a>02220                              <a class="code" href="classHeartConfig.html#adcae58747ee8057177bc063ce4b9cc3b">GetMinEdgeLengthForAdaptivity</a>(),
<a name="l02221"></a>02221                              gradation,
<a name="l02222"></a>02222                              <a class="code" href="classHeartConfig.html#a4e47a91fa230dda4fb4a708b546c5c2e">GetMaxNodesForAdaptivity</a>(),
<a name="l02223"></a>02223                              <a class="code" href="classHeartConfig.html#a2dd2113b9c0b0ec6e1f86de50727cbf2">GetNumberOfAdaptiveSweeps</a>() );
<a name="l02224"></a>02224 }
<a name="l02225"></a>02225 
<a name="l02226"></a><a class="code" href="classHeartConfig.html#a1a6b85e059d5e25943122374e24021ce">02226</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a1a6b85e059d5e25943122374e24021ce">HeartConfig::SetMaxNodesForAdaptivity</a>(<span class="keywordtype">unsigned</span> maxNodes)
<a name="l02227"></a>02227 {
<a name="l02228"></a>02228     <a class="code" href="classHeartConfig.html#aeaa1ff9d97c84353beaced74801b0677">SetAdaptivityParameters</a>( <a class="code" href="classHeartConfig.html#a10bc06efde462cf251767739cd1b69ac">GetTargetErrorForAdaptivity</a>(),
<a name="l02229"></a>02229                              <a class="code" href="classHeartConfig.html#a66fc480d24bc9f8535c89cccd989f9af">GetSigmaForAdaptivity</a>(),
<a name="l02230"></a>02230                              <a class="code" href="classHeartConfig.html#a89155d1726cbe35f76ade0648e769a4d">GetMaxEdgeLengthForAdaptivity</a>(),
<a name="l02231"></a>02231                              <a class="code" href="classHeartConfig.html#adcae58747ee8057177bc063ce4b9cc3b">GetMinEdgeLengthForAdaptivity</a>(),
<a name="l02232"></a>02232                              <a class="code" href="classHeartConfig.html#aa5bca3744b53e11ec99ad2f3dc259600">GetGradationForAdaptivity</a>(),
<a name="l02233"></a>02233                              maxNodes,
<a name="l02234"></a>02234                              <a class="code" href="classHeartConfig.html#a2dd2113b9c0b0ec6e1f86de50727cbf2">GetNumberOfAdaptiveSweeps</a>() );
<a name="l02235"></a>02235 }
<a name="l02236"></a>02236 
<a name="l02237"></a><a class="code" href="classHeartConfig.html#a6ea802a3b748b68e44d225437db5673c">02237</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a6ea802a3b748b68e44d225437db5673c">HeartConfig::SetNumberOfAdaptiveSweeps</a>(<span class="keywordtype">unsigned</span> numSweeps)
<a name="l02238"></a>02238 {
<a name="l02239"></a>02239     <a class="code" href="classHeartConfig.html#aeaa1ff9d97c84353beaced74801b0677">SetAdaptivityParameters</a>( <a class="code" href="classHeartConfig.html#a10bc06efde462cf251767739cd1b69ac">GetTargetErrorForAdaptivity</a>(),
<a name="l02240"></a>02240                              <a class="code" href="classHeartConfig.html#a66fc480d24bc9f8535c89cccd989f9af">GetSigmaForAdaptivity</a>(),
<a name="l02241"></a>02241                              <a class="code" href="classHeartConfig.html#a89155d1726cbe35f76ade0648e769a4d">GetMaxEdgeLengthForAdaptivity</a>(),
<a name="l02242"></a>02242                              <a class="code" href="classHeartConfig.html#adcae58747ee8057177bc063ce4b9cc3b">GetMinEdgeLengthForAdaptivity</a>(),
<a name="l02243"></a>02243                              <a class="code" href="classHeartConfig.html#aa5bca3744b53e11ec99ad2f3dc259600">GetGradationForAdaptivity</a>(),
<a name="l02244"></a>02244                              <a class="code" href="classHeartConfig.html#a4e47a91fa230dda4fb4a708b546c5c2e">GetMaxNodesForAdaptivity</a>(),
<a name="l02245"></a>02245                              numSweeps );
<a name="l02246"></a>02246 }
<a name="l02247"></a>02247 
<a name="l02248"></a><a class="code" href="classHeartConfig.html#acd2c4d1a539a70809ffc540834a4f772">02248</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#acd2c4d1a539a70809ffc540834a4f772">HeartConfig::SetApdMaps</a>(<span class="keyword">const</span> std::vector&lt;std::pair&lt;double,double&gt; &gt;&amp; apdMaps)
<a name="l02249"></a>02249 {
<a name="l02250"></a>02250     XSD_SEQUENCE_TYPE(cp::postprocessing_type::ActionPotentialDurationMap)&amp; apd_maps_sequence
<a name="l02251"></a>02251         = <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;PostProcessing()-&gt;ActionPotentialDurationMap();
<a name="l02252"></a>02252     <span class="comment">//Erase or create a sequence</span>
<a name="l02253"></a>02253     apd_maps_sequence.clear();
<a name="l02254"></a>02254 
<a name="l02255"></a>02255     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0; i&lt;apdMaps.size(); i++)
<a name="l02256"></a>02256     {
<a name="l02257"></a>02257         XSD_CREATE_WITH_FIXED_ATTR2(cp::apd_map_type, temp,
<a name="l02258"></a>02258                                     apdMaps[i].first, apdMaps[i].second,
<a name="l02259"></a>02259                                     <span class="stringliteral">&quot;mV&quot;</span>);
<a name="l02260"></a>02260         apd_maps_sequence.push_back( temp);
<a name="l02261"></a>02261     }
<a name="l02262"></a>02262 }
<a name="l02263"></a>02263 
<a name="l02264"></a>02264 
<a name="l02265"></a><a class="code" href="classHeartConfig.html#abba0cb5ca22b68dcaadc87ac24aab8ba">02265</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#abba0cb5ca22b68dcaadc87ac24aab8ba">HeartConfig::SetUpstrokeTimeMaps</a> (std::vector&lt;double&gt;&amp; upstrokeTimeMaps)
<a name="l02266"></a>02266 {
<a name="l02267"></a>02267     XSD_SEQUENCE_TYPE(cp::postprocessing_type::UpstrokeTimeMap)&amp; var_type_sequence
<a name="l02268"></a>02268         = <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;PostProcessing()-&gt;UpstrokeTimeMap();
<a name="l02269"></a>02269 
<a name="l02270"></a>02270     <span class="comment">//Erase or create a sequence</span>
<a name="l02271"></a>02271     var_type_sequence.clear();
<a name="l02272"></a>02272 
<a name="l02273"></a>02273     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0; i&lt;upstrokeTimeMaps.size(); i++)
<a name="l02274"></a>02274     {
<a name="l02275"></a>02275         XSD_CREATE_WITH_FIXED_ATTR1(cp::upstrokes_map_type, temp,
<a name="l02276"></a>02276                                     upstrokeTimeMaps[i],
<a name="l02277"></a>02277                                     <span class="stringliteral">&quot;mV&quot;</span>);
<a name="l02278"></a>02278         var_type_sequence.push_back(temp);
<a name="l02279"></a>02279     }
<a name="l02280"></a>02280 }
<a name="l02281"></a>02281 
<a name="l02282"></a><a class="code" href="classHeartConfig.html#a329e1bfc5785247315fdd4459afd4312">02282</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a329e1bfc5785247315fdd4459afd4312">HeartConfig::SetMaxUpstrokeVelocityMaps</a> (std::vector&lt;double&gt;&amp; maxUpstrokeVelocityMaps)
<a name="l02283"></a>02283 {
<a name="l02284"></a>02284     XSD_SEQUENCE_TYPE(cp::postprocessing_type::MaxUpstrokeVelocityMap)&amp; max_upstroke_velocity_maps_sequence
<a name="l02285"></a>02285         = <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;PostProcessing()-&gt;MaxUpstrokeVelocityMap();
<a name="l02286"></a>02286 
<a name="l02287"></a>02287     <span class="comment">//Erase or create a sequence</span>
<a name="l02288"></a>02288     max_upstroke_velocity_maps_sequence.clear();
<a name="l02289"></a>02289 
<a name="l02290"></a>02290     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0; i&lt;maxUpstrokeVelocityMaps.size(); i++)
<a name="l02291"></a>02291     {
<a name="l02292"></a>02292         XSD_CREATE_WITH_FIXED_ATTR1(cp::max_upstrokes_velocity_map_type, temp,
<a name="l02293"></a>02293                                     maxUpstrokeVelocityMaps[i],
<a name="l02294"></a>02294                                     <span class="stringliteral">&quot;mV&quot;</span>);
<a name="l02295"></a>02295 
<a name="l02296"></a>02296 
<a name="l02297"></a>02297         max_upstroke_velocity_maps_sequence.push_back(temp);
<a name="l02298"></a>02298     }
<a name="l02299"></a>02299 
<a name="l02300"></a>02300 }
<a name="l02301"></a>02301 
<a name="l02302"></a><a class="code" href="classHeartConfig.html#af8dc7801557f7308fff845c3385ff732">02302</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#af8dc7801557f7308fff845c3385ff732">HeartConfig::SetConductionVelocityMaps</a> (std::vector&lt;unsigned&gt;&amp; conductionVelocityMaps)
<a name="l02303"></a>02303 {
<a name="l02304"></a>02304     XSD_SEQUENCE_TYPE(cp::postprocessing_type::ConductionVelocityMap)&amp; conduction_velocity_maps_sequence
<a name="l02305"></a>02305         = <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;PostProcessing()-&gt;ConductionVelocityMap();
<a name="l02306"></a>02306 
<a name="l02307"></a>02307     <span class="comment">//Erase or create a sequence</span>
<a name="l02308"></a>02308     conduction_velocity_maps_sequence.clear();
<a name="l02309"></a>02309 
<a name="l02310"></a>02310     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0; i&lt;conductionVelocityMaps.size(); i++)
<a name="l02311"></a>02311     {
<a name="l02312"></a>02312         cp::conduction_velocity_map_type temp(conductionVelocityMaps[i]);
<a name="l02313"></a>02313         conduction_velocity_maps_sequence.push_back(temp);
<a name="l02314"></a>02314     }
<a name="l02315"></a>02315 }
<a name="l02316"></a>02316 
<a name="l02317"></a>02317 <span class="comment">/*</span>
<a name="l02318"></a>02318 <span class="comment"> * Output visualizer</span>
<a name="l02319"></a>02319 <span class="comment"> */</span>
<a name="l02320"></a>02320 
<a name="l02321"></a><a class="code" href="classHeartConfig.html#a73fef33f054b532719b5f83a784b2c0c">02321</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a73fef33f054b532719b5f83a784b2c0c">HeartConfig::EnsureOutputVisualizerExists</a>()
<a name="l02322"></a>02322 {
<a name="l02323"></a>02323     <span class="keywordflow">if</span> (!<a class="code" href="classHeartConfig.html#a3010845819f8f64a7d98f5fa022ea094">IsOutputVisualizerPresent</a>())
<a name="l02324"></a>02324     {
<a name="l02325"></a>02325         cp::output_visualizer_type element;
<a name="l02326"></a>02326         <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().OutputVisualizer().set(element);
<a name="l02327"></a>02327     }
<a name="l02328"></a>02328 }
<a name="l02329"></a>02329 
<a name="l02330"></a><a class="code" href="classHeartConfig.html#a7ef84b9090f708031aac64b7504742e0">02330</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a7ef84b9090f708031aac64b7504742e0">HeartConfig::SetVisualizeWithMeshalyzer</a>(<span class="keywordtype">bool</span> useMeshalyzer)
<a name="l02331"></a>02331 {
<a name="l02332"></a>02332     <a class="code" href="classHeartConfig.html#a73fef33f054b532719b5f83a784b2c0c">EnsureOutputVisualizerExists</a>();
<a name="l02333"></a>02333 
<a name="l02334"></a>02334     <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().OutputVisualizer().get().meshalyzer(
<a name="l02335"></a>02335         useMeshalyzer ? cp::yesno_type::yes : cp::yesno_type::no);
<a name="l02336"></a>02336 }
<a name="l02337"></a>02337 
<a name="l02338"></a><a class="code" href="classHeartConfig.html#af1c744570c4f03ee01b52c62ca4ef40f">02338</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#af1c744570c4f03ee01b52c62ca4ef40f">HeartConfig::SetVisualizeWithCmgui</a>(<span class="keywordtype">bool</span> useCmgui)
<a name="l02339"></a>02339 {
<a name="l02340"></a>02340     <a class="code" href="classHeartConfig.html#a73fef33f054b532719b5f83a784b2c0c">EnsureOutputVisualizerExists</a>();
<a name="l02341"></a>02341 
<a name="l02342"></a>02342     <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().OutputVisualizer().get().cmgui(
<a name="l02343"></a>02343         useCmgui ? cp::yesno_type::yes : cp::yesno_type::no);
<a name="l02344"></a>02344 }
<a name="l02345"></a>02345 
<a name="l02346"></a><a class="code" href="classHeartConfig.html#aa64153e80db50c971a58069dd3e1350e">02346</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#aa64153e80db50c971a58069dd3e1350e">HeartConfig::SetVisualizeWithVtk</a>(<span class="keywordtype">bool</span> useVtk)
<a name="l02347"></a>02347 {
<a name="l02348"></a>02348     <a class="code" href="classHeartConfig.html#a73fef33f054b532719b5f83a784b2c0c">EnsureOutputVisualizerExists</a>();
<a name="l02349"></a>02349 
<a name="l02350"></a>02350     <a class="code" href="classHeartConfig.html#a7b1c7f0c205126ad473b2410c17ad171">mpUserParameters</a>-&gt;Simulation().get().OutputVisualizer().get().vtk(
<a name="l02351"></a>02351         useVtk ? cp::yesno_type::yes : cp::yesno_type::no);
<a name="l02352"></a>02352 }
<a name="l02353"></a>02353 
<a name="l02354"></a>02354 <span class="comment">/**********************************************************************</span>
<a name="l02355"></a>02355 <span class="comment"> *                                                                    *</span>
<a name="l02356"></a>02356 <span class="comment"> *                                                                    *</span>
<a name="l02357"></a>02357 <span class="comment"> *                Utility methods for reading files                   *</span>
<a name="l02358"></a>02358 <span class="comment"> *                                                                    *</span>
<a name="l02359"></a>02359 <span class="comment"> *                                                                    *</span>
<a name="l02360"></a>02360 <span class="comment"> **********************************************************************/</span>
<a name="l02361"></a>02361 
<a name="l02362"></a>02362 <span class="preprocessor">#include &lt;string&gt;</span>
<a name="l02363"></a>02363 <span class="preprocessor">#include &lt;istream&gt;</span>
<a name="l02364"></a>02364 <span class="preprocessor">#include &lt;fstream&gt;</span>
<a name="l02365"></a>02365 
<a name="l02366"></a>02366 <span class="preprocessor">#include &lt;xercesc/util/XMLUniDefs.hpp&gt;</span> <span class="comment">// chLatin_*</span>
<a name="l02367"></a>02367 <span class="preprocessor">#include &lt;xercesc/framework/Wrapper4InputSource.hpp&gt;</span>
<a name="l02368"></a>02368 <span class="preprocessor">#include &lt;xercesc/validators/common/Grammar.hpp&gt;</span>
<a name="l02369"></a>02369 
<a name="l02370"></a>02370 <span class="preprocessor">#include &lt;xsd/cxx/xml/string.hxx&gt;</span>
<a name="l02371"></a>02371 <span class="preprocessor">#include &lt;xsd/cxx/xml/dom/auto-ptr.hxx&gt;</span>
<a name="l02372"></a>02372 <span class="preprocessor">#include &lt;xsd/cxx/xml/sax/std-input-source.hxx&gt;</span>
<a name="l02373"></a>02373 <span class="preprocessor">#include &lt;xsd/cxx/xml/dom/bits/error-handler-proxy.hxx&gt;</span>
<a name="l02374"></a>02374 
<a name="l02375"></a>02375 <span class="preprocessor">#include &lt;xsd/cxx/tree/exceptions.hxx&gt;</span>
<a name="l02376"></a>02376 <span class="preprocessor">#include &lt;xsd/cxx/tree/error-handler.hxx&gt;</span>
<a name="l02377"></a>02377 
<a name="l02378"></a>02378 
<a name="l02379"></a><a class="code" href="classHeartConfig.html#a4e69db53c7ebdbfc283c8d072c289373">02379</a> xsd::cxx::xml::dom::auto_ptr&lt;xercesc::DOMDocument&gt; <a class="code" href="classHeartConfig.html#a4e69db53c7ebdbfc283c8d072c289373">HeartConfig::ReadFileToDomDocument</a>(
<a name="l02380"></a>02380         <span class="keyword">const</span> std::string&amp; rFileName,
<a name="l02381"></a>02381         ::xml_schema::error_handler&amp; rErrorHandler,
<a name="l02382"></a>02382         const ::xml_schema::properties&amp; rProps)
<a name="l02383"></a>02383 {
<a name="l02384"></a>02384     <span class="keyword">using namespace </span>xercesc;
<a name="l02385"></a>02385     <span class="keyword">namespace </span>xml = xsd::cxx::xml;
<a name="l02386"></a>02386     <span class="keyword">namespace </span>tree = xsd::cxx::tree;
<a name="l02387"></a>02387 
<a name="l02388"></a>02388     <span class="comment">// Get an implementation of the Load-Store (LS) interface.</span>
<a name="l02389"></a>02389     <span class="keyword">const</span> XMLCh ls_id [] = {chLatin_L, chLatin_S, chNull};
<a name="l02390"></a>02390     DOMImplementation* p_impl(DOMImplementationRegistry::getDOMImplementation(ls_id));
<a name="l02391"></a>02391 
<a name="l02392"></a>02392 <span class="preprocessor">#if _XERCES_VERSION &gt;= 30000</span>
<a name="l02393"></a>02393 <span class="preprocessor"></span>    <span class="comment">// Xerces-C++ 3.0.0 and later.</span>
<a name="l02394"></a>02394     xml::dom::auto_ptr&lt;DOMLSParser&gt; p_parser(p_impl-&gt;createLSParser(DOMImplementationLS::MODE_SYNCHRONOUS, 0));
<a name="l02395"></a>02395     DOMConfiguration* p_conf(p_parser-&gt;getDomConfig());
<a name="l02396"></a>02396 
<a name="l02397"></a>02397     <span class="comment">// Discard comment nodes in the document.</span>
<a name="l02398"></a>02398     p_conf-&gt;setParameter(XMLUni::fgDOMComments, <span class="keyword">false</span>);
<a name="l02399"></a>02399 
<a name="l02400"></a>02400     <span class="comment">// Enable datatype normalization.</span>
<a name="l02401"></a>02401     p_conf-&gt;setParameter(XMLUni::fgDOMDatatypeNormalization, <span class="keyword">true</span>);
<a name="l02402"></a>02402 
<a name="l02403"></a>02403     <span class="comment">// Do not create EntityReference nodes in the DOM tree.  No</span>
<a name="l02404"></a>02404     <span class="comment">// EntityReference nodes will be created, only the nodes</span>
<a name="l02405"></a>02405     <span class="comment">// corresponding to their fully expanded substitution text</span>
<a name="l02406"></a>02406     <span class="comment">// will be created.</span>
<a name="l02407"></a>02407     p_conf-&gt;setParameter(XMLUni::fgDOMEntities, <span class="keyword">false</span>);
<a name="l02408"></a>02408 
<a name="l02409"></a>02409     <span class="comment">// Perform namespace processing.</span>
<a name="l02410"></a>02410     p_conf-&gt;setParameter(XMLUni::fgDOMNamespaces, <span class="keyword">true</span>);
<a name="l02411"></a>02411 
<a name="l02412"></a>02412     <span class="comment">// Do not include ignorable whitespace in the DOM tree.</span>
<a name="l02413"></a>02413     p_conf-&gt;setParameter(XMLUni::fgDOMElementContentWhitespace, <span class="keyword">false</span>);
<a name="l02414"></a>02414 
<a name="l02415"></a>02415     <span class="comment">// Enable validation.</span>
<a name="l02416"></a>02416     p_conf-&gt;setParameter(XMLUni::fgDOMValidate, <span class="keyword">true</span>);
<a name="l02417"></a>02417     p_conf-&gt;setParameter(XMLUni::fgXercesSchema, <span class="keyword">true</span>);
<a name="l02418"></a>02418     p_conf-&gt;setParameter(XMLUni::fgXercesSchemaFullChecking, <span class="keyword">false</span>);
<a name="l02419"></a>02419     <span class="comment">// Code taken from xsd/cxx/xml/dom/parsing-source.txx</span>
<a name="l02420"></a>02420     <span class="keywordflow">if</span> (!rProps.schema_location().empty())
<a name="l02421"></a>02421     {
<a name="l02422"></a>02422         xml::string locn(rProps.schema_location());
<a name="l02423"></a>02423         <span class="keyword">const</span> <span class="keywordtype">void</span>* p_locn(locn.c_str());
<a name="l02424"></a>02424         p_conf-&gt;setParameter(XMLUni::fgXercesSchemaExternalSchemaLocation,
<a name="l02425"></a>02425                              const_cast&lt;void*&gt;(p_locn));
<a name="l02426"></a>02426     }
<a name="l02427"></a>02427     <span class="keywordflow">if</span> (!rProps.no_namespace_schema_location().empty())
<a name="l02428"></a>02428     {
<a name="l02429"></a>02429         xml::string locn(rProps.no_namespace_schema_location());
<a name="l02430"></a>02430         <span class="keyword">const</span> <span class="keywordtype">void</span>* p_locn(locn.c_str());
<a name="l02431"></a>02431 
<a name="l02432"></a>02432         p_conf-&gt;setParameter(XMLUni::fgXercesSchemaExternalNoNameSpaceSchemaLocation,
<a name="l02433"></a>02433                              const_cast&lt;void*&gt;(p_locn));
<a name="l02434"></a>02434     }
<a name="l02435"></a>02435 
<a name="l02436"></a>02436     <span class="comment">// We will release the DOM document ourselves.</span>
<a name="l02437"></a>02437     p_conf-&gt;setParameter(XMLUni::fgXercesUserAdoptsDOMDocument, <span class="keyword">true</span>);
<a name="l02438"></a>02438 
<a name="l02439"></a>02439     <span class="comment">// Set error handler.</span>
<a name="l02440"></a>02440     xml::dom::bits::error_handler_proxy&lt;char&gt; ehp(rErrorHandler);
<a name="l02441"></a>02441     p_conf-&gt;setParameter(XMLUni::fgDOMErrorHandler, &amp;ehp);
<a name="l02442"></a>02442 
<a name="l02443"></a>02443 <span class="preprocessor">#else // _XERCES_VERSION &gt;= 30000</span>
<a name="l02444"></a>02444 <span class="preprocessor"></span>    <span class="comment">// Same as above but for Xerces-C++ 2 series.</span>
<a name="l02445"></a>02445     xml::dom::auto_ptr&lt;DOMBuilder&gt; p_parser(p_impl-&gt;createDOMBuilder(DOMImplementationLS::MODE_SYNCHRONOUS, 0));
<a name="l02446"></a>02446 
<a name="l02447"></a>02447     p_parser-&gt;setFeature(XMLUni::fgDOMComments, <span class="keyword">false</span>);
<a name="l02448"></a>02448     p_parser-&gt;setFeature(XMLUni::fgDOMDatatypeNormalization, <span class="keyword">true</span>);
<a name="l02449"></a>02449     p_parser-&gt;setFeature(XMLUni::fgDOMEntities, <span class="keyword">false</span>);
<a name="l02450"></a>02450     p_parser-&gt;setFeature(XMLUni::fgDOMNamespaces, <span class="keyword">true</span>);
<a name="l02451"></a>02451     p_parser-&gt;setFeature(XMLUni::fgDOMWhitespaceInElementContent, <span class="keyword">false</span>);
<a name="l02452"></a>02452     p_parser-&gt;setFeature(XMLUni::fgDOMValidation, <span class="keyword">true</span>);
<a name="l02453"></a>02453     p_parser-&gt;setFeature(XMLUni::fgXercesSchema, <span class="keyword">true</span>);
<a name="l02454"></a>02454     p_parser-&gt;setFeature(XMLUni::fgXercesSchemaFullChecking, <span class="keyword">false</span>);
<a name="l02455"></a>02455     p_parser-&gt;setFeature(XMLUni::fgXercesUserAdoptsDOMDocument, <span class="keyword">true</span>);
<a name="l02456"></a>02456 
<a name="l02457"></a>02457     <span class="comment">// Code taken from xsd/cxx/xml/dom/parsing-source.txx</span>
<a name="l02458"></a>02458     <span class="keywordflow">if</span> (!rProps.schema_location().empty())
<a name="l02459"></a>02459     {
<a name="l02460"></a>02460         xml::string locn(rProps.schema_location());
<a name="l02461"></a>02461         <span class="keyword">const</span> <span class="keywordtype">void</span>* p_locn(locn.c_str());
<a name="l02462"></a>02462         p_parser-&gt;setProperty(XMLUni::fgXercesSchemaExternalSchemaLocation,
<a name="l02463"></a>02463                               const_cast&lt;void*&gt;(p_locn));
<a name="l02464"></a>02464     }
<a name="l02465"></a>02465 
<a name="l02466"></a>02466     <span class="keywordflow">if</span> (!rProps.no_namespace_schema_location().empty())
<a name="l02467"></a>02467     {
<a name="l02468"></a>02468         xml::string locn(rProps.no_namespace_schema_location());
<a name="l02469"></a>02469         <span class="keyword">const</span> <span class="keywordtype">void</span>* p_locn(locn.c_str());
<a name="l02470"></a>02470 
<a name="l02471"></a>02471         p_parser-&gt;setProperty(XMLUni::fgXercesSchemaExternalNoNameSpaceSchemaLocation,
<a name="l02472"></a>02472                               const_cast&lt;void*&gt;(p_locn));
<a name="l02473"></a>02473     }
<a name="l02474"></a>02474 
<a name="l02475"></a>02475     xml::dom::bits::error_handler_proxy&lt;char&gt; ehp(rErrorHandler);
<a name="l02476"></a>02476     p_parser-&gt;setErrorHandler(&amp;ehp);
<a name="l02477"></a>02477 
<a name="l02478"></a>02478 <span class="preprocessor">#endif // _XERCES_VERSION &gt;= 30000</span>
<a name="l02479"></a>02479 <span class="preprocessor"></span>
<a name="l02480"></a>02480     <span class="comment">// Do the parse</span>
<a name="l02481"></a>02481     xml::dom::auto_ptr&lt;DOMDocument&gt; p_doc(p_parser-&gt;parseURI(rFileName.c_str()));
<a name="l02482"></a>02482 
<a name="l02483"></a>02483     <span class="keywordflow">if</span> (ehp.failed())
<a name="l02484"></a>02484     {
<a name="l02485"></a>02485         p_doc.reset();
<a name="l02486"></a>02486     }
<a name="l02487"></a>02487 
<a name="l02488"></a>02488     <span class="keywordflow">return</span> p_doc;
<a name="l02489"></a>02489 }
<a name="l02490"></a>02490 
<a name="l02491"></a><a class="code" href="classHeartConfig.html#ae7eb2f5589679671bc7ecac528f858bb">02491</a> xercesc::DOMElement* <a class="code" href="classHeartConfig.html#aeca3d17309388a980ce6e63f650a0cd0">HeartConfig::AddNamespace</a>(xercesc::DOMDocument* pDocument,
<a name="l02492"></a>02492                                                xercesc::DOMElement* pElement,
<a name="l02493"></a>02493                                                <span class="keyword">const</span> XMLCh* pNamespace)
<a name="l02494"></a>02494 {
<a name="l02495"></a>02495     <span class="keyword">using namespace </span>xercesc;
<a name="l02496"></a>02496 
<a name="l02497"></a>02497     DOMElement* p_new_elt = <span class="keyword">static_cast&lt;</span>DOMElement*<span class="keyword">&gt;</span>(
<a name="l02498"></a>02498         pDocument-&gt;renameNode(pElement, pNamespace, pElement-&gt;getLocalName()));
<a name="l02499"></a>02499 
<a name="l02500"></a>02500     <span class="keywordflow">for</span> (DOMNode* p_node = p_new_elt-&gt;getFirstChild();
<a name="l02501"></a>02501          p_node != NULL;
<a name="l02502"></a>02502          p_node = p_node-&gt;getNextSibling())
<a name="l02503"></a>02503     {
<a name="l02504"></a>02504         <span class="keywordflow">if</span> (p_node-&gt;getNodeType() == DOMNode::ELEMENT_NODE)
<a name="l02505"></a>02505         {
<a name="l02506"></a>02506             p_node = <a class="code" href="classHeartConfig.html#aeca3d17309388a980ce6e63f650a0cd0">AddNamespace</a>(pDocument, static_cast&lt;DOMElement*&gt;(p_node), pNamespace);
<a name="l02507"></a>02507         }
<a name="l02508"></a>02508     }
<a name="l02509"></a>02509 
<a name="l02510"></a>02510     <span class="keywordflow">return</span> p_new_elt;
<a name="l02511"></a>02511 }
<a name="l02512"></a>02512 
<a name="l02513"></a><a class="code" href="classHeartConfig.html#aeca3d17309388a980ce6e63f650a0cd0">02513</a> xercesc::DOMElement* <a class="code" href="classHeartConfig.html#aeca3d17309388a980ce6e63f650a0cd0">HeartConfig::AddNamespace</a>(xercesc::DOMDocument* pDocument,
<a name="l02514"></a>02514                                                xercesc::DOMElement* pElement,
<a name="l02515"></a>02515                                                <span class="keyword">const</span> std::string&amp; rNamespace)
<a name="l02516"></a>02516 {
<a name="l02517"></a>02517     <span class="keywordflow">return</span> <a class="code" href="classHeartConfig.html#aeca3d17309388a980ce6e63f650a0cd0">AddNamespace</a>(pDocument, pElement, xsd::cxx::xml::string(rNamespace).c_str());
<a name="l02518"></a>02518 }
<a name="l02519"></a>02519 
<a name="l02526"></a><a class="code" href="classXStr.html">02526</a> <span class="keyword">class </span><a class="code" href="classXStr.html">XStr</a>
<a name="l02527"></a>02527 {
<a name="l02528"></a>02528 <span class="keyword">public</span> :
<a name="l02533"></a><a class="code" href="classXStr.html#af8893bac33549ac393b484073b45721b">02533</a>     <a class="code" href="classXStr.html#af8893bac33549ac393b484073b45721b">XStr</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> toTranscode)
<a name="l02534"></a>02534     {
<a name="l02535"></a>02535         <span class="comment">// Call the private transcoding method</span>
<a name="l02536"></a>02536         <a class="code" href="classXStr.html#a7315b354c77b68168ff87162320fade6">mUnicodeForm</a> = xercesc::XMLString::transcode(toTranscode);
<a name="l02537"></a>02537     }
<a name="l02538"></a>02538 
<a name="l02540"></a><a class="code" href="classXStr.html#ac259a9f1088961438fc189a55979ddc0">02540</a>     <a class="code" href="classXStr.html#ac259a9f1088961438fc189a55979ddc0">~XStr</a>()
<a name="l02541"></a>02541     {
<a name="l02542"></a>02542         xercesc::XMLString::release(&amp;<a class="code" href="classXStr.html#a7315b354c77b68168ff87162320fade6">mUnicodeForm</a>);
<a name="l02543"></a>02543     }
<a name="l02544"></a>02544 
<a name="l02545"></a>02545 
<a name="l02547"></a><a class="code" href="classXStr.html#adbdf428785026c5c7d213aae73f5b3cc">02547</a>     <span class="keyword">const</span> XMLCh* <a class="code" href="classXStr.html#adbdf428785026c5c7d213aae73f5b3cc">UnicodeForm</a>()<span class="keyword"> const</span>
<a name="l02548"></a>02548 <span class="keyword">    </span>{
<a name="l02549"></a>02549         <span class="keywordflow">return</span> <a class="code" href="classXStr.html#a7315b354c77b68168ff87162320fade6">mUnicodeForm</a>;
<a name="l02550"></a>02550     }
<a name="l02551"></a>02551 
<a name="l02552"></a>02552 <span class="keyword">private</span> :
<a name="l02554"></a><a class="code" href="classXStr.html#a7315b354c77b68168ff87162320fade6">02554</a>     XMLCh* <a class="code" href="classXStr.html#a7315b354c77b68168ff87162320fade6">mUnicodeForm</a>;
<a name="l02555"></a>02555 };
<a name="l02556"></a>02556 
<a name="l02557"></a>02557 <span class="comment">//#define X(str) XStr(str).UnicodeForm()</span>
<a name="l02558"></a>02558 <span class="preprocessor">#define X(str) xsd::cxx::xml::string(str).c_str()</span>
<a name="l02559"></a>02559 <span class="preprocessor"></span>
<a name="l02560"></a>02560 
<a name="l02561"></a><a class="code" href="classHeartConfig.html#a8efab641595dfa357ab0b6ca7f1ffad1">02561</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#a8efab641595dfa357ab0b6ca7f1ffad1">HeartConfig::TransformIonicModelDefinitions</a>(xercesc::DOMDocument* pDocument,
<a name="l02562"></a>02562                                                  xercesc::DOMElement* pRootElement)
<a name="l02563"></a>02563 {
<a name="l02564"></a>02564     xercesc::DOMNodeList* p_sim_elt_list = pRootElement-&gt;getElementsByTagName(X(<span class="stringliteral">&quot;Simulation&quot;</span>));
<a name="l02565"></a>02565     <span class="keywordflow">if</span> (p_sim_elt_list-&gt;getLength() &gt; 0)
<a name="l02566"></a>02566     {
<a name="l02567"></a>02567         xercesc::DOMElement* p_sim_elt = <span class="keyword">static_cast&lt;</span>xercesc::DOMElement*<span class="keyword">&gt;</span>(p_sim_elt_list-&gt;item(0));
<a name="l02568"></a>02568         xercesc::DOMNodeList* p_ionic_models_elt_list = p_sim_elt-&gt;getElementsByTagName(X(<span class="stringliteral">&quot;IonicModels&quot;</span>));
<a name="l02569"></a>02569         <span class="keywordflow">if</span> (p_ionic_models_elt_list-&gt;getLength() &gt; 0)
<a name="l02570"></a>02570         {
<a name="l02571"></a>02571             xercesc::DOMElement* p_ionic_models_elt = <span class="keyword">static_cast&lt;</span>xercesc::DOMElement*<span class="keyword">&gt;</span>(p_ionic_models_elt_list-&gt;item(0));
<a name="l02572"></a>02572             <span class="comment">// Do the default ionic model</span>
<a name="l02573"></a>02573             xercesc::DOMNodeList* p_default_list = p_ionic_models_elt-&gt;getElementsByTagName(X(<span class="stringliteral">&quot;Default&quot;</span>));
<a name="l02574"></a>02574             assert(p_default_list-&gt;getLength() &gt; 0); <span class="comment">// Asserted by schema</span>
<a name="l02575"></a>02575             xercesc::DOMElement* p_default_elt = <span class="keyword">static_cast&lt;</span>xercesc::DOMElement*<span class="keyword">&gt;</span>(p_default_list-&gt;item(0));
<a name="l02576"></a>02576             <a class="code" href="classHeartConfig.html#ad9c3377fe151d0dd65ef05318f2461b9">WrapContentInElement</a>(pDocument, p_default_elt, X(<span class="stringliteral">&quot;Hardcoded&quot;</span>));
<a name="l02577"></a>02577             <span class="comment">// Now do any region-specific definitions</span>
<a name="l02578"></a>02578             xercesc::DOMNodeList* p_region_list = p_ionic_models_elt-&gt;getElementsByTagName(X(<span class="stringliteral">&quot;Region&quot;</span>));
<a name="l02579"></a>02579             <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0; i&lt;p_region_list-&gt;getLength(); i++)
<a name="l02580"></a>02580             {
<a name="l02581"></a>02581                 xercesc::DOMElement* p_region_elt = <span class="keyword">static_cast&lt;</span>xercesc::DOMElement*<span class="keyword">&gt;</span>(p_region_list-&gt;item(0));
<a name="l02582"></a>02582                 xercesc::DOMNodeList* p_ionic_model_list = p_region_elt-&gt;getElementsByTagName(X(<span class="stringliteral">&quot;IonicModel&quot;</span>));
<a name="l02583"></a>02583                 assert(p_ionic_model_list-&gt;getLength() &gt; 0); <span class="comment">// Asserted by schema</span>
<a name="l02584"></a>02584                 xercesc::DOMElement* p_ionic_model_elt = <span class="keyword">static_cast&lt;</span>xercesc::DOMElement*<span class="keyword">&gt;</span>(p_ionic_model_list-&gt;item(0));
<a name="l02585"></a>02585                 <a class="code" href="classHeartConfig.html#ad9c3377fe151d0dd65ef05318f2461b9">WrapContentInElement</a>(pDocument, p_ionic_model_elt, X(<span class="stringliteral">&quot;Hardcoded&quot;</span>));
<a name="l02586"></a>02586             }
<a name="l02587"></a>02587         }
<a name="l02588"></a>02588     }
<a name="l02589"></a>02589 }
<a name="l02590"></a>02590 
<a name="l02591"></a><a class="code" href="classHeartConfig.html#ad9c3377fe151d0dd65ef05318f2461b9">02591</a> <span class="keywordtype">void</span> <a class="code" href="classHeartConfig.html#ad9c3377fe151d0dd65ef05318f2461b9">HeartConfig::WrapContentInElement</a>(xercesc::DOMDocument* pDocument,
<a name="l02592"></a>02592                                        xercesc::DOMElement* pElement,
<a name="l02593"></a>02593                                        <span class="keyword">const</span> XMLCh* pNewElementLocalName)
<a name="l02594"></a>02594 {
<a name="l02595"></a>02595     <span class="keyword">const</span> XMLCh* p_namespace_uri = pElement-&gt;getNamespaceURI();
<a name="l02596"></a>02596     <span class="keyword">const</span> XMLCh* p_prefix = pElement-&gt;getPrefix();
<a name="l02597"></a>02597     <span class="keyword">const</span> XMLCh* p_qualified_name;
<a name="l02598"></a>02598     <span class="keywordflow">if</span> (p_prefix)
<a name="l02599"></a>02599     {
<a name="l02600"></a>02600 <span class="preprocessor">#define COVERAGE_IGNORE</span>
<a name="l02601"></a>02601 <span class="preprocessor"></span>        <span class="comment">// We can&#39;t actually cover this code, since previous versions of the parameters file didn&#39;t use a namespace,</span>
<a name="l02602"></a>02602         <span class="comment">// so can&#39;t have a namespace prefix!</span>
<a name="l02603"></a>02603         xercesc::QName qname(p_prefix, pNewElementLocalName, 0);
<a name="l02604"></a>02604         p_qualified_name = qname.getRawName();
<a name="l02605"></a>02605 <span class="preprocessor">#undef COVERAGE_IGNORE</span>
<a name="l02606"></a>02606 <span class="preprocessor"></span>    }
<a name="l02607"></a>02607     <span class="keywordflow">else</span>
<a name="l02608"></a>02608     {
<a name="l02609"></a>02609         p_qualified_name = pNewElementLocalName;
<a name="l02610"></a>02610     }
<a name="l02611"></a>02611     xercesc::DOMElement* p_wrapper_elt = pDocument-&gt;createElementNS(p_namespace_uri, p_qualified_name);
<a name="l02612"></a>02612     <span class="comment">// Move all child nodes of pElement to be children of p_wrapper_elt</span>
<a name="l02613"></a>02613     xercesc::DOMNodeList* p_children = pElement-&gt;getChildNodes();
<a name="l02614"></a>02614     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0; i&lt;p_children-&gt;getLength(); i++)
<a name="l02615"></a>02615     {
<a name="l02616"></a>02616         xercesc::DOMNode* p_child = pElement-&gt;removeChild(p_children-&gt;item(i));
<a name="l02617"></a>02617         p_wrapper_elt-&gt;appendChild(p_child);
<a name="l02618"></a>02618     }
<a name="l02619"></a>02619     <span class="comment">// Add the wrapper as the sole child of pElement</span>
<a name="l02620"></a>02620     pElement-&gt;appendChild(p_wrapper_elt);
<a name="l02621"></a>02621 }
<a name="l02622"></a>02622 
<a name="l02624"></a>02624 <span class="comment">// Explicit instantiation of the templated functions</span>
<a name="l02626"></a>02626 <span class="comment"></span><span class="preprocessor">#define COVERAGE_IGNORE //These methods are covered above with DIM=1,2,3 but the instantiations may fail spuriously</span>
<a name="l02627"></a>02627 <span class="preprocessor"></span>
<a name="l02631"></a>02631 <span class="keyword">template</span> <span class="keywordtype">void</span> HeartConfig::GetIonicModelRegions&lt;3u&gt;(std::vector&lt;ChasteCuboid&lt;3u&gt; &gt;&amp; , std::vector&lt;cp::ionic_model_selection_type&gt;&amp;) <span class="keyword">const</span>;
<a name="l02632"></a>02632 <span class="keyword">template</span> <span class="keywordtype">void</span> HeartConfig::GetStimuli&lt;3u&gt;(std::vector&lt;boost::shared_ptr&lt;SimpleStimulus&gt; &gt;&amp; , std::vector&lt;ChasteCuboid&lt;3u&gt; &gt;&amp; ) <span class="keyword">const</span>;
<a name="l02633"></a>02633 <span class="keyword">template</span> <span class="keywordtype">void</span> HeartConfig::GetCellHeterogeneities&lt;3u&gt;(std::vector&lt;AbstractChasteRegion&lt;3u&gt;* &gt;&amp; ,std::vector&lt;double&gt;&amp; ,std::vector&lt;double&gt;&amp; ,std::vector&lt;double&gt;&amp; ) ;
<a name="l02634"></a>02634 <span class="keyword">template</span> <span class="keywordtype">void</span> HeartConfig::GetConductivityHeterogeneities&lt;3u&gt;(std::vector&lt;ChasteCuboid&lt;3u&gt; &gt;&amp; ,std::vector&lt; c_vector&lt;double,3&gt; &gt;&amp; ,std::vector&lt; c_vector&lt;double,3&gt; &gt;&amp; ) <span class="keyword">const</span>;
<a name="l02635"></a>02635 
<a name="l02636"></a>02636 <span class="keyword">template</span> <span class="keywordtype">void</span> HeartConfig::GetIonicModelRegions&lt;2u&gt;(std::vector&lt;ChasteCuboid&lt;2u&gt; &gt;&amp; , std::vector&lt;cp::ionic_model_selection_type&gt;&amp;) <span class="keyword">const</span>;
<a name="l02637"></a>02637 <span class="keyword">template</span> <span class="keywordtype">void</span> HeartConfig::GetStimuli&lt;2u&gt;(std::vector&lt;boost::shared_ptr&lt;SimpleStimulus&gt; &gt;&amp; , std::vector&lt;ChasteCuboid&lt;2u&gt; &gt;&amp; ) <span class="keyword">const</span>;
<a name="l02638"></a>02638 <span class="keyword">template</span> <span class="keywordtype">void</span> HeartConfig::GetCellHeterogeneities&lt;2u&gt;(std::vector&lt;AbstractChasteRegion&lt;2u&gt;* &gt;&amp; ,std::vector&lt;double&gt;&amp; ,std::vector&lt;double&gt;&amp; ,std::vector&lt;double&gt;&amp; ) ;
<a name="l02639"></a>02639 <span class="keyword">template</span> <span class="keywordtype">void</span> HeartConfig::GetConductivityHeterogeneities&lt;2u&gt;(std::vector&lt;ChasteCuboid&lt;2u&gt; &gt;&amp; ,std::vector&lt; c_vector&lt;double,3&gt; &gt;&amp; ,std::vector&lt; c_vector&lt;double,3&gt; &gt;&amp; ) <span class="keyword">const</span>;
<a name="l02640"></a>02640 
<a name="l02641"></a>02641 <span class="keyword">template</span> <span class="keywordtype">void</span> HeartConfig::GetIonicModelRegions&lt;1u&gt;(std::vector&lt;ChasteCuboid&lt;1u&gt; &gt;&amp; , std::vector&lt;cp::ionic_model_selection_type&gt;&amp;) <span class="keyword">const</span>;
<a name="l02642"></a>02642 <span class="keyword">template</span> <span class="keywordtype">void</span> HeartConfig::GetStimuli&lt;1u&gt;(std::vector&lt;boost::shared_ptr&lt;SimpleStimulus&gt; &gt;&amp; , std::vector&lt;ChasteCuboid&lt;1u&gt; &gt;&amp; ) <span class="keyword">const</span>;
<a name="l02643"></a>02643 <span class="keyword">template</span> <span class="keywordtype">void</span> HeartConfig::GetCellHeterogeneities&lt;1u&gt;(std::vector&lt;AbstractChasteRegion&lt;1u&gt;* &gt;&amp; ,std::vector&lt;double&gt;&amp; ,std::vector&lt;double&gt;&amp; ,std::vector&lt;double&gt;&amp; );
<a name="l02644"></a>02644 <span class="keyword">template</span> <span class="keywordtype">void</span> HeartConfig::GetConductivityHeterogeneities&lt;1u&gt;(std::vector&lt;ChasteCuboid&lt;1u&gt; &gt;&amp; ,std::vector&lt; c_vector&lt;double,3&gt; &gt;&amp; ,std::vector&lt; c_vector&lt;double,3&gt; &gt;&amp; ) <span class="keyword">const</span>;
<a name="l02649"></a>02649 <span class="preprocessor">#undef COVERAGE_IGNORE //These methods are covered above with DIM=1,2,3 but the instantiations may fail spuriously</span>
<a name="l02650"></a>02650 <span class="preprocessor"></span>
<a name="l02651"></a>02651 
<a name="l02652"></a>02652 <span class="comment">// Serialization for Boost &gt;= 1.36</span>
<a name="l02653"></a>02653 <span class="preprocessor">#include &quot;<a class="code" href="SerializationExportWrapperForCpp_8hpp.html">SerializationExportWrapperForCpp.hpp</a>&quot;</span>
<a name="l02654"></a>02654 <a class="code" href="SerializationExportWrapper_8hpp.html#ace086cfef82d692752842bea698f6e7c">CHASTE_CLASS_EXPORT</a>(<a class="code" href="classHeartConfig.html">HeartConfig</a>);
</pre></div></div>
<hr size="1"/><address style="text-align: right;"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.2 </small></address>
</body>
</html>
