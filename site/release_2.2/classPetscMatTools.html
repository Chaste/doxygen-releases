<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Chaste: PetscMatTools Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.5 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li class="current"><a href="classes.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="classes.html"><span>Alphabetical&nbsp;List</span></a></li>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>PetscMatTools Class Reference</h1><!-- doxytag: class="PetscMatTools" --><code>#include &lt;<a class="el" href="PetscMatTools_8hpp-source.html">PetscMatTools.hpp</a>&gt;</code>
<p>

<p>
<a href="classPetscMatTools-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#d2991678b6341cb488fcf53bca9c7af1">SetElement</a> (Mat matrix, PetscInt row, PetscInt col, double value)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#07f631eba92647e0f96eb9c007668b89">AddToElement</a> (Mat matrix, PetscInt row, PetscInt col, double value)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#b148ae20570474ef9b0370de106abf28">AssembleFinal</a> (Mat matrix)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#43266198e6f80104ddb317e067eae75b">AssembleIntermediate</a> (Mat matrix)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#d78e39050573affee9679e2b5b2807fd">Display</a> (Mat matrix)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#4653d233e1382cf612d0cef06f43e630">SetRow</a> (Mat matrix, PetscInt row, double value)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#5a68cf8b1e9a1630f54a60feb03084b9">ZeroRowsWithValueOnDiagonal</a> (Mat matrix, std::vector&lt; unsigned &gt; &amp;rRows, double diagonalValue)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#bd1999b69733b9c343c4e8dbd99893c1">ZeroRowsAndColumnsWithValueOnDiagonal</a> (Mat matrix, std::vector&lt; unsigned &gt; &amp;rRowColIndices, double diagonalValue)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#c790257be5a8cc501376fef953a76cee">ZeroColumn</a> (Mat matrix, PetscInt col)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#18737a2adfa34aa5d7c9bec630c8a688">Zero</a> (Mat matrix)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static unsigned&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#871794b7b4edc05a98810c83a6e59f05">GetSize</a> (Mat matrix)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#7a9a78b5ccdd2ac99a9e46f09de9e04e">GetOwnershipRange</a> (Mat matrix, PetscInt &amp;lo, PetscInt &amp;hi)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#04bf4f209ef30a6118bba7c90279844a">GetElement</a> (Mat matrix, PetscInt row, PetscInt col)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#5aa09bdaed7d4372cab33f898c593399">SetOption</a> (Mat matrix, MatOption option)</td></tr>

<tr><td class="memTemplParams" nowrap colspan="2">template&lt;size_t MATRIX_SIZE&gt; </td></tr>
<tr><td class="memTemplItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classPetscMatTools.html#c2876ae775b40c4188e483c42aaf6017">AddMultipleValues</a> (Mat matrix, unsigned *matrixRowAndColIndices, c_matrix&lt; double, MATRIX_SIZE, MATRIX_SIZE &gt; &amp;rSmallMatrix)</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
A collection of static methods for working with PETSc matrices. 
<p>Definition at line <a class="el" href="PetscMatTools_8hpp-source.html#l00042">42</a> of file <a class="el" href="PetscMatTools_8hpp-source.html">PetscMatTools.hpp</a>.</p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="d2991678b6341cb488fcf53bca9c7af1"></a><!-- doxytag: member="PetscMatTools::SetElement" ref="d2991678b6341cb488fcf53bca9c7af1" args="(Mat matrix, PetscInt row, PetscInt col, double value)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::SetElement           </td>
          <td>(</td>
          <td class="paramtype">Mat&nbsp;</td>
          <td class="paramname"> <em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&nbsp;</td>
          <td class="paramname"> <em>row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&nbsp;</td>
          <td class="paramname"> <em>col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>value</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Change one of the entries of a matrix to the specified value.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>matrix</em>&nbsp;</td><td>the matrix </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>row</em>&nbsp;</td><td>the row index </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>col</em>&nbsp;</td><td>the column index </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td>the value for this entry </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp-source.html#l00037">37</a> of file <a class="el" href="PetscMatTools_8cpp-source.html">PetscMatTools.cpp</a>.</p>

<p>References <a class="el" href="PetscMatTools_8cpp-source.html#l00274">GetOwnershipRange()</a>.</p>

<p>Referenced by <a class="el" href="AbstractNonlinearAssemblerSolverHybrid_8hpp-source.html#l00332">AbstractNonlinearAssemblerSolverHybrid&lt; ELEMENT_DIM, SPACE_DIM, PROBLEM_DIM &gt;::ComputeJacobianNumerically()</a>, <a class="el" href="AbstractBidomainSolver_8cpp-source.html#l00335">AbstractBidomainSolver&lt; ELEMENT_DIM, SPACE_DIM &gt;::FinaliseForBath()</a>, <a class="el" href="LinearSystem_8cpp-source.html#l00298">LinearSystem::SetMatrixElement()</a>, and <a class="el" href="PetscMatTools_8cpp-source.html#l00076">SetRow()</a>.</p>

</div>
</div><p>
<a class="anchor" name="07f631eba92647e0f96eb9c007668b89"></a><!-- doxytag: member="PetscMatTools::AddToElement" ref="07f631eba92647e0f96eb9c007668b89" args="(Mat matrix, PetscInt row, PetscInt col, double value)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::AddToElement           </td>
          <td>(</td>
          <td class="paramtype">Mat&nbsp;</td>
          <td class="paramname"> <em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&nbsp;</td>
          <td class="paramname"> <em>row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&nbsp;</td>
          <td class="paramname"> <em>col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>value</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Add the specified value to an entry of a matrix.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>matrix</em>&nbsp;</td><td>the matrix </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>row</em>&nbsp;</td><td>the row index </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>col</em>&nbsp;</td><td>the column index </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td>the value for this entry </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp-source.html#l00048">48</a> of file <a class="el" href="PetscMatTools_8cpp-source.html">PetscMatTools.cpp</a>.</p>

<p>References <a class="el" href="PetscMatTools_8cpp-source.html#l00274">GetOwnershipRange()</a>.</p>

<p>Referenced by <a class="el" href="LinearSystem_8cpp-source.html#l00303">LinearSystem::AddToMatrixElement()</a>.</p>

</div>
</div><p>
<a class="anchor" name="b148ae20570474ef9b0370de106abf28"></a><!-- doxytag: member="PetscMatTools::AssembleFinal" ref="b148ae20570474ef9b0370de106abf28" args="(Mat matrix)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::AssembleFinal           </td>
          <td>(</td>
          <td class="paramtype">Mat&nbsp;</td>
          <td class="paramname"> <em>matrix</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Sets up the matrix ready for use, e.g. in solving a linear system.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>matrix</em>&nbsp;</td><td>the matrix </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp-source.html#l00059">59</a> of file <a class="el" href="PetscMatTools_8cpp-source.html">PetscMatTools.cpp</a>.</p>

<p>Referenced by <a class="el" href="BoundaryConditionsContainerImplementation_8hpp-source.html#l00409">BoundaryConditionsContainer&lt; ELEMENT_DIM, SPACE_DIM, PROBLEM_DIM &gt;::ApplyDirichletToNonlinearJacobian()</a>, <a class="el" href="LinearSystem_8cpp-source.html#l00320">LinearSystem::AssembleFinalLhsMatrix()</a>, <a class="el" href="LinearSystem_8cpp-source.html#l00330">LinearSystem::AssembleFinalPrecondMatrix()</a>, <a class="el" href="AbstractNonlinearAssemblerSolverHybrid_8hpp-source.html#l00310">AbstractNonlinearAssemblerSolverHybrid&lt; ELEMENT_DIM, SPACE_DIM, PROBLEM_DIM &gt;::ComputeJacobian()</a>, <a class="el" href="AbstractNonlinearAssemblerSolverHybrid_8hpp-source.html#l00332">AbstractNonlinearAssemblerSolverHybrid&lt; ELEMENT_DIM, SPACE_DIM, PROBLEM_DIM &gt;::ComputeJacobianNumerically()</a>, <a class="el" href="OperatorSplittingMonodomainSolver_8cpp-source.html#l00033">OperatorSplittingMonodomainSolver&lt; ELEMENT_DIM, SPACE_DIM &gt;::SetupLinearSystem()</a>, <a class="el" href="MatrixBasedMonodomainSolver_8cpp-source.html#l00035">MatrixBasedMonodomainSolver&lt; ELEMENT_DIM, SPACE_DIM &gt;::SetupLinearSystem()</a>, <a class="el" href="MatrixBasedBidomainSolver_8cpp-source.html#l00059">MatrixBasedBidomainSolver&lt; ELEMENT_DIM, SPACE_DIM &gt;::SetupLinearSystem()</a>, <a class="el" href="PetscMatTools_8cpp-source.html#l00223">ZeroColumn()</a>, <a class="el" href="PetscMatTools_8cpp-source.html#l00169">ZeroRowsAndColumnsWithValueOnDiagonal()</a>, and <a class="el" href="PetscMatTools_8cpp-source.html#l00092">ZeroRowsWithValueOnDiagonal()</a>.</p>

</div>
</div><p>
<a class="anchor" name="43266198e6f80104ddb317e067eae75b"></a><!-- doxytag: member="PetscMatTools::AssembleIntermediate" ref="43266198e6f80104ddb317e067eae75b" args="(Mat matrix)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::AssembleIntermediate           </td>
          <td>(</td>
          <td class="paramtype">Mat&nbsp;</td>
          <td class="paramname"> <em>matrix</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This must be called if switching between inserting or adding values to the matrix, to ensure all processes are in sync.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>matrix</em>&nbsp;</td><td>the matrix </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp-source.html#l00065">65</a> of file <a class="el" href="PetscMatTools_8cpp-source.html">PetscMatTools.cpp</a>.</p>

<p>Referenced by <a class="el" href="LinearSystem_8cpp-source.html#l00325">LinearSystem::AssembleIntermediateLhsMatrix()</a>, and <a class="el" href="AbstractNonlinearAssemblerSolverHybrid_8hpp-source.html#l00310">AbstractNonlinearAssemblerSolverHybrid&lt; ELEMENT_DIM, SPACE_DIM, PROBLEM_DIM &gt;::ComputeJacobian()</a>.</p>

</div>
</div><p>
<a class="anchor" name="d78e39050573affee9679e2b5b2807fd"></a><!-- doxytag: member="PetscMatTools::Display" ref="d78e39050573affee9679e2b5b2807fd" args="(Mat matrix)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::Display           </td>
          <td>(</td>
          <td class="paramtype">Mat&nbsp;</td>
          <td class="paramname"> <em>matrix</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Display a matrix.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>matrix</em>&nbsp;</td><td>the matrix </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp-source.html#l00071">71</a> of file <a class="el" href="PetscMatTools_8cpp-source.html">PetscMatTools.cpp</a>.</p>

<p>Referenced by <a class="el" href="LinearSystem_8cpp-source.html#l00350">LinearSystem::DisplayMatrix()</a>.</p>

</div>
</div><p>
<a class="anchor" name="4653d233e1382cf612d0cef06f43e630"></a><!-- doxytag: member="PetscMatTools::SetRow" ref="4653d233e1382cf612d0cef06f43e630" args="(Mat matrix, PetscInt row, double value)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::SetRow           </td>
          <td>(</td>
          <td class="paramtype">Mat&nbsp;</td>
          <td class="paramname"> <em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&nbsp;</td>
          <td class="paramname"> <em>row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>value</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set all entries in a given row of a matrix to a certain value. This must be called by the process who owns the row, (but other processors will treat it as a null-op<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>matrix</em>&nbsp;</td><td>the matrix </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>row</em>&nbsp;</td><td>the row index </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td>the value to set each entry in this row </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp-source.html#l00076">76</a> of file <a class="el" href="PetscMatTools_8cpp-source.html">PetscMatTools.cpp</a>.</p>

<p>References <a class="el" href="PetscMatTools_8cpp-source.html#l00274">GetOwnershipRange()</a>, and <a class="el" href="PetscMatTools_8cpp-source.html#l00037">SetElement()</a>.</p>

<p>Referenced by <a class="el" href="LinearSystem_8cpp-source.html#l00360">LinearSystem::SetMatrixRow()</a>.</p>

</div>
</div><p>
<a class="anchor" name="5a68cf8b1e9a1630f54a60feb03084b9"></a><!-- doxytag: member="PetscMatTools::ZeroRowsWithValueOnDiagonal" ref="5a68cf8b1e9a1630f54a60feb03084b9" args="(Mat matrix, std::vector&lt; unsigned &gt; &amp;rRows, double diagonalValue)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::ZeroRowsWithValueOnDiagonal           </td>
          <td>(</td>
          <td class="paramtype">Mat&nbsp;</td>
          <td class="paramname"> <em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; unsigned &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>rRows</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>diagonalValue</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Zero several rows of a matrix, putting a given value in the diagonal entries.<p>
*Massively* less expensive than zeroing each matrix row individually<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>matrix</em>&nbsp;</td><td>the matrix </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rRows</em>&nbsp;</td><td>std::vector of rows to be zeroed </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>diagonalValue</em>&nbsp;</td><td>value to put in the diagonal entries (of the zeroed rows) </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp-source.html#l00092">92</a> of file <a class="el" href="PetscMatTools_8cpp-source.html">PetscMatTools.cpp</a>.</p>

<p>References <a class="el" href="PetscMatTools_8cpp-source.html#l00059">AssembleFinal()</a>.</p>

<p>Referenced by <a class="el" href="BoundaryConditionsContainerImplementation_8hpp-source.html#l00409">BoundaryConditionsContainer&lt; ELEMENT_DIM, SPACE_DIM, PROBLEM_DIM &gt;::ApplyDirichletToNonlinearJacobian()</a>, <a class="el" href="LinearSystem_8cpp-source.html#l00398">LinearSystem::ZeroMatrixRowsWithValueOnDiagonal()</a>, and <a class="el" href="PetscMatTools_8cpp-source.html#l00169">ZeroRowsAndColumnsWithValueOnDiagonal()</a>.</p>

</div>
</div><p>
<a class="anchor" name="bd1999b69733b9c343c4e8dbd99893c1"></a><!-- doxytag: member="PetscMatTools::ZeroRowsAndColumnsWithValueOnDiagonal" ref="bd1999b69733b9c343c4e8dbd99893c1" args="(Mat matrix, std::vector&lt; unsigned &gt; &amp;rRowColIndices, double diagonalValue)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::ZeroRowsAndColumnsWithValueOnDiagonal           </td>
          <td>(</td>
          <td class="paramtype">Mat&nbsp;</td>
          <td class="paramname"> <em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; unsigned &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>rRowColIndices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>diagonalValue</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Zero several rows and columns of a matrix, putting a given value on the diagonal.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>matrix</em>&nbsp;</td><td>the matrix </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rRowColIndices</em>&nbsp;</td><td>A list of indices. All the rows with these indices, and all the columns with these indices, will be zeroed. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>diagonalValue</em>&nbsp;</td><td>value to put in the diagonal entries (of the zeroed rows) </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp-source.html#l00169">169</a> of file <a class="el" href="PetscMatTools_8cpp-source.html">PetscMatTools.cpp</a>.</p>

<p>References <a class="el" href="PetscMatTools_8cpp-source.html#l00059">AssembleFinal()</a>, <a class="el" href="PetscMatTools_8cpp-source.html#l00279">GetElement()</a>, <a class="el" href="PetscMatTools_8cpp-source.html#l00274">GetOwnershipRange()</a>, and <a class="el" href="PetscMatTools_8cpp-source.html#l00092">ZeroRowsWithValueOnDiagonal()</a>.</p>

<p>Referenced by <a class="el" href="LinearSystem_8cpp-source.html#l00404">LinearSystem::ZeroMatrixRowsAndColumnsWithValueOnDiagonal()</a>.</p>

</div>
</div><p>
<a class="anchor" name="c790257be5a8cc501376fef953a76cee"></a><!-- doxytag: member="PetscMatTools::ZeroColumn" ref="c790257be5a8cc501376fef953a76cee" args="(Mat matrix, PetscInt col)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::ZeroColumn           </td>
          <td>(</td>
          <td class="paramtype">Mat&nbsp;</td>
          <td class="paramname"> <em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&nbsp;</td>
          <td class="paramname"> <em>col</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Zero a column of a matrix.<p>
Unfortunately there is no equivalent method in Petsc, so this has to be done carefully to ensure that the sparsity structure of the matrix is not broken. Only owned entries which are non-zero are zeroed.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>matrix</em>&nbsp;</td><td>the matrix </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>col</em>&nbsp;</td><td>the column index </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp-source.html#l00223">223</a> of file <a class="el" href="PetscMatTools_8cpp-source.html">PetscMatTools.cpp</a>.</p>

<p>References <a class="el" href="PetscMatTools_8cpp-source.html#l00059">AssembleFinal()</a>, <a class="el" href="PetscMatTools_8cpp-source.html#l00279">GetElement()</a>, and <a class="el" href="PetscMatTools_8cpp-source.html#l00274">GetOwnershipRange()</a>.</p>

<p>Referenced by <a class="el" href="LinearSystem_8cpp-source.html#l00409">LinearSystem::ZeroMatrixColumn()</a>.</p>

</div>
</div><p>
<a class="anchor" name="18737a2adfa34aa5d7c9bec630c8a688"></a><!-- doxytag: member="PetscMatTools::Zero" ref="18737a2adfa34aa5d7c9bec630c8a688" args="(Mat matrix)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::Zero           </td>
          <td>(</td>
          <td class="paramtype">Mat&nbsp;</td>
          <td class="paramname"> <em>matrix</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Zero all entries of a matrix. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>matrix</em>&nbsp;</td><td>the matrix </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp-source.html#l00260">260</a> of file <a class="el" href="PetscMatTools_8cpp-source.html">PetscMatTools.cpp</a>.</p>

<p>Referenced by <a class="el" href="AbstractFeObjectAssembler_8hpp-source.html#l00520">AbstractFeObjectAssembler&lt; ELEMENT_DIM, SPACE_DIM, PROBLEM_DIM, CAN_ASSEMBLE_VECTOR, CAN_ASSEMBLE_MATRIX, INTERPOLATION_LEVEL &gt;::DoAssemble()</a>, and <a class="el" href="LinearSystem_8cpp-source.html#l00419">LinearSystem::ZeroLhsMatrix()</a>.</p>

</div>
</div><p>
<a class="anchor" name="871794b7b4edc05a98810c83a6e59f05"></a><!-- doxytag: member="PetscMatTools::GetSize" ref="871794b7b4edc05a98810c83a6e59f05" args="(Mat matrix)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned PetscMatTools::GetSize           </td>
          <td>(</td>
          <td class="paramtype">Mat&nbsp;</td>
          <td class="paramname"> <em>matrix</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get the size of a matrix <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>matrix</em>&nbsp;</td><td>the matrix </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp-source.html#l00265">265</a> of file <a class="el" href="PetscMatTools_8cpp-source.html">PetscMatTools.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="7a9a78b5ccdd2ac99a9e46f09de9e04e"></a><!-- doxytag: member="PetscMatTools::GetOwnershipRange" ref="7a9a78b5ccdd2ac99a9e46f09de9e04e" args="(Mat matrix, PetscInt &amp;lo, PetscInt &amp;hi)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::GetOwnershipRange           </td>
          <td>(</td>
          <td class="paramtype">Mat&nbsp;</td>
          <td class="paramname"> <em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt &amp;&nbsp;</td>
          <td class="paramname"> <em>lo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt &amp;&nbsp;</td>
          <td class="paramname"> <em>hi</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get this process's ownership range of the contents of the system.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>matrix</em>&nbsp;</td><td>the matrix </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>lo</em>&nbsp;</td><td>lowest index owned by this process </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>hi</em>&nbsp;</td><td>highest index owned by this process </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp-source.html#l00274">274</a> of file <a class="el" href="PetscMatTools_8cpp-source.html">PetscMatTools.cpp</a>.</p>

<p>Referenced by <a class="el" href="PetscMatTools_8hpp-source.html#l00182">AddMultipleValues()</a>, <a class="el" href="PetscMatTools_8cpp-source.html#l00048">AddToElement()</a>, <a class="el" href="PetscMatTools_8cpp-source.html#l00279">GetElement()</a>, <a class="el" href="PetscMatTools_8cpp-source.html#l00037">SetElement()</a>, <a class="el" href="PetscMatTools_8cpp-source.html#l00076">SetRow()</a>, <a class="el" href="PetscMatTools_8cpp-source.html#l00223">ZeroColumn()</a>, and <a class="el" href="PetscMatTools_8cpp-source.html#l00169">ZeroRowsAndColumnsWithValueOnDiagonal()</a>.</p>

</div>
</div><p>
<a class="anchor" name="04bf4f209ef30a6118bba7c90279844a"></a><!-- doxytag: member="PetscMatTools::GetElement" ref="04bf4f209ef30a6118bba7c90279844a" args="(Mat matrix, PetscInt row, PetscInt col)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double PetscMatTools::GetElement           </td>
          <td>(</td>
          <td class="paramtype">Mat&nbsp;</td>
          <td class="paramname"> <em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&nbsp;</td>
          <td class="paramname"> <em>row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&nbsp;</td>
          <td class="paramname"> <em>col</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return an element of a matrix. May only be called for elements you own.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>matrix</em>&nbsp;</td><td>the matrix </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>row</em>&nbsp;</td><td>the row index </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>col</em>&nbsp;</td><td>the column index </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp-source.html#l00279">279</a> of file <a class="el" href="PetscMatTools_8cpp-source.html">PetscMatTools.cpp</a>.</p>

<p>References <a class="el" href="PetscMatTools_8cpp-source.html#l00274">GetOwnershipRange()</a>.</p>

<p>Referenced by <a class="el" href="LinearSystem_8cpp-source.html#l00497">LinearSystem::GetMatrixElement()</a>, <a class="el" href="PetscMatTools_8cpp-source.html#l00223">ZeroColumn()</a>, and <a class="el" href="PetscMatTools_8cpp-source.html#l00169">ZeroRowsAndColumnsWithValueOnDiagonal()</a>.</p>

</div>
</div><p>
<a class="anchor" name="5aa09bdaed7d4372cab33f898c593399"></a><!-- doxytag: member="PetscMatTools::SetOption" ref="5aa09bdaed7d4372cab33f898c593399" args="(Mat matrix, MatOption option)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PetscMatTools::SetOption           </td>
          <td>(</td>
          <td class="paramtype">Mat&nbsp;</td>
          <td class="paramname"> <em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MatOption&nbsp;</td>
          <td class="paramname"> <em>option</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set a PETSc matrix option to be true, using the PETSc method MatSetOption.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>matrix</em>&nbsp;</td><td>the matrix for which to set the option </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>option</em>&nbsp;</td><td>the option to set </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="PetscMatTools_8cpp-source.html#l00298">298</a> of file <a class="el" href="PetscMatTools_8cpp-source.html">PetscMatTools.cpp</a>.</p>

<p>Referenced by <a class="el" href="LinearSystem_8cpp-source.html#l00553">LinearSystem::SetMatrixIsSymmetric()</a>.</p>

</div>
</div><p>
<a class="anchor" name="c2876ae775b40c4188e483c42aaf6017"></a><!-- doxytag: member="PetscMatTools::AddMultipleValues" ref="c2876ae775b40c4188e483c42aaf6017" args="(Mat matrix, unsigned *matrixRowAndColIndices, c_matrix&lt; double, MATRIX_SIZE, MATRIX_SIZE &gt; &amp;rSmallMatrix)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;size_t MATRIX_SIZE&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">static void PetscMatTools::AddMultipleValues           </td>
          <td>(</td>
          <td class="paramtype">Mat&nbsp;</td>
          <td class="paramname"> <em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned *&nbsp;</td>
          <td class="paramname"> <em>matrixRowAndColIndices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">c_matrix&lt; double, MATRIX_SIZE, MATRIX_SIZE &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>rSmallMatrix</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Add multiple values to a matrix.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>matrix</em>&nbsp;</td><td>the matrix </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>matrixRowAndColIndices</em>&nbsp;</td><td>mapping from index of the ublas matrix (see param below) to index of the Petsc matrix of this linear system </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rSmallMatrix</em>&nbsp;</td><td>Ublas matrix containing the values to be added</td></tr>
  </table>
</dl>
N.B. Values which are not local (ie the row is not owned) will be skipped. 
<p>Definition at line <a class="el" href="PetscMatTools_8hpp-source.html#l00182">182</a> of file <a class="el" href="PetscMatTools_8hpp-source.html">PetscMatTools.hpp</a>.</p>

<p>References <a class="el" href="PetscMatTools_8cpp-source.html#l00274">GetOwnershipRange()</a>.</p>

<p>Referenced by <a class="el" href="LinearSystem_8hpp-source.html#l00531">LinearSystem::AddLhsMultipleValues()</a>.</p>

</div>
</div><p>
<hr>The documentation for this class was generated from the following files:<ul>
<li>linalg/src/<a class="el" href="PetscMatTools_8hpp-source.html">PetscMatTools.hpp</a><li>linalg/src/<a class="el" href="PetscMatTools_8cpp-source.html">PetscMatTools.cpp</a></ul>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Apr 18 11:37:43 2011 for Chaste by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.5 </small></address>
</body>
</html>
